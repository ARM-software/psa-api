
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>3. Initial Attestation report &#8212; PSA Certified Attestation API 1.0.3</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="preconnect" type="text/css" href="https://fonts.googleapis.com" />
    <link rel="preconnect" type="text/css" href="https://fonts.gstatic.com" />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,400;0,700;1,400&display=swap" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="4. API reference" href="../api/api.html" />
    <link rel="prev" title="2. Use cases and rationale" href="use-cases.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="initial-attestation-report">
<span id="report"></span><h1><span class="section-number">3. </span>Initial Attestation report<a class="headerlink" href="#initial-attestation-report" title="Permalink to this headline">¶</a></h1>
<p>This section begins with a description of the information model for the report and then describes the expected format.</p>
<section id="information-model">
<h2><span class="section-number">3.1. </span>Information model<a class="headerlink" href="#information-model" title="Permalink to this headline">¶</a></h2>
<p>The following table describes the mandatory and optional claims in the report:</p>
<table class="colwidths-given longtable docutils align-right">
<colgroup>
<col style="width: 24%" />
<col style="width: 18%" />
<col style="width: 59%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Claim</p></th>
<th class="head"><p>Mandatory</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Auth challenge</p></td>
<td><p>Yes</p></td>
<td><p>Input object from the caller. For example, this can be a cryptographic nonce or a hash of locally attested data. The length must be 32, 48, or 64 bytes.</p>
<p>This is the <code class="docutils literal notranslate"><span class="pre">auth_challenge</span></code> parameter to <a class="reference internal" href="../api/api.html#c.psa_initial_attest_get_token" title="psa_initial_attest_get_token"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_initial_attest_get_token()</span></code></a>.</p>
</td>
</tr>
<tr class="row-odd"><td><p>Instance ID</p></td>
<td><p>Yes</p></td>
<td><p>Represents the unique identifier of the instance:</p>
<ul class="simple">
<li><p>When using an asymmetric key-pair for the <a class="reference internal" href="../about.html#term-initial-attestation-key"><span class="term">Initial Attestation Key</span></a> (IAK), Arm recommends the Instance ID be a hash of the corresponding public key.</p></li>
<li><p>When using a symmetric key for the IAK, Arm recommends that the Instance ID is always a double hash of the key, hence <code class="docutils literal notranslate"><span class="pre">InstanceID</span> <span class="pre">=</span> <span class="pre">H(H(IAK))</span></code>. This eliminates risks when exposing the key to different HMAC block size. For further information, read RFC2104.</p></li>
</ul>
<p>The use of the IAK is also discussed in <a class="reference internal" href="../about.html#cite-psm"><span class="cite atg_c atg_c-cite">[PSM]</span></a>.</p>
</td>
</tr>
<tr class="row-even"><td><p>Verification service indicator</p></td>
<td><p>No</p></td>
<td><p>A hint used by a relying party to locate a validation service for the token. The value is a text string that can be used to locate the service or a URL specifying the address of the service.</p>
<p>A verifier may choose to ignore this claim in favor of other information.</p>
</td>
</tr>
<tr class="row-odd"><td><p>Profile definition</p></td>
<td><p>No</p></td>
<td><p>Contains the name of a document that describes the ‘profile’ of the report. The document name may include versioning. The value for this specification is <strong>PSA_IOT_PROFILE_1</strong>.</p></td>
</tr>
<tr class="row-even"><td><p>Implementation ID</p></td>
<td><p>Yes</p></td>
<td><p>Uniquely identifies the underlying <a class="reference internal" href="../about.html#term-immutable-platform-root-of-trust"><span class="term">Immutable Platform Root of Trust</span></a>. A verification service can use this claim to locate the details of the verification process. Such details include the implementation’s origin and associated certification state. The full definition is in <a class="reference internal" href="../about.html#cite-psm"><span class="cite atg_c atg_c-cite">[PSM]</span></a>.</p></td>
</tr>
<tr class="row-odd"><td><p>Client ID</p></td>
<td><p>Yes</p></td>
<td><p>Represents the Partition ID of the caller. It is a signed integer whereby negative values represent callers from the <a class="reference internal" href="../about.html#term-nspe"><span class="term">NSPE</span></a> and where positive IDs represent callers from the <a class="reference internal" href="../about.html#term-spe"><span class="term">SPE</span></a>. The value <code class="docutils literal notranslate"><span class="pre">0</span></code> is not permitted. The full definition of a Partition ID is provided by <span><em>Arm® Platform Security Architecture Firmware Framework</em> <a class="reference internal" href="../about.html#cite-psa-ff-m"><span class="cite">[PSA-FF-M]</span></a></span>.</p>
<p>It is essential that this claim is checked in the verification process to ensure that a security domain cannot spoof a report from another security domain.</p>
</td>
</tr>
<tr class="row-even"><td><p>Security Lifecycle</p></td>
<td><p>Yes</p></td>
<td><p>Represents the current lifecycle state of the <a class="reference internal" href="../about.html#term-platform-root-of-trust"><span class="term">Platform Root of Trust</span></a> (PRoT). The state is represented by an integer that is partitioned to convey a major state and a minor state. The major state is mandatory and defined by <a class="reference internal" href="../about.html#cite-psm"><span class="cite atg_c atg_c-cite">[PSM]</span></a>. The minor state is optional and <span class="sc">implementation defined</span>. The PRoT security lifecycle state and implementation state are encoded as follows:</p>
<ul class="simple">
<li><p>version[15:8] — PRoT security lifecycle state</p></li>
<li><p>version[7:0] — <span class="sc">implementation defined</span> state.</p></li>
</ul>
<p>The PRoT security lifecycle states consist of the following values:</p>
<ul class="simple">
<li><p>PSA_LIFECYCLE_UNKNOWN (<code class="docutils literal notranslate"><span class="pre">0x0000u</span></code>)</p></li>
<li><p>PSA_LIFECYCLE_ASSEMBLY_AND_TEST (<code class="docutils literal notranslate"><span class="pre">0x1000u</span></code>)</p></li>
<li><p>PSA_LIFECYCLE_PSA_ROT_PROVISIONING (<code class="docutils literal notranslate"><span class="pre">0x2000u</span></code>)</p></li>
<li><p>PSA_LIFECYCLE_SECURED (<code class="docutils literal notranslate"><span class="pre">0x3000u</span></code>)</p></li>
<li><p>PSA_LIFECYCLE_NON_PSA_ROT_DEBUG (<code class="docutils literal notranslate"><span class="pre">0x4000u</span></code>)</p></li>
<li><p>PSA_LIFECYCLE_RECOVERABLE_PSA_ROT_DEBUG (<code class="docutils literal notranslate"><span class="pre">0x5000u</span></code>)</p></li>
<li><p>PSA_LIFECYCLE_DECOMMISSIONED (<code class="docutils literal notranslate"><span class="pre">0x6000u</span></code>)</p></li>
</ul>
<p>For PSA Certified, a remote verifier can only trust reports from the PRoT when it has a major state that is SECURED or NON_PSA_ROT_DEBUG.</p>
</td>
</tr>
<tr class="row-odd"><td><p>Hardware version</p></td>
<td><p>No</p></td>
<td><p>Provides metadata linking the token to the GDSII that went to fabrication for this instance. It can be used to link the class of chip and PRoT to the data on a certification website. It must be represented as a thirteen-digit <a class="reference internal" href="../about.html#cite-ean-13"><span class="cite atg_c atg_c-cite">[EAN-13]</span></a>.</p></td>
</tr>
<tr class="row-even"><td><p>Boot seed</p></td>
<td><p>Yes</p></td>
<td><p>Represents a random value created at system boot time that can allow differentiation of reports from different boot sessions.</p></td>
</tr>
<tr class="row-odd"><td><p>Software components</p></td>
<td><p>Yes (unless the No Software Measurements claim is specified)</p></td>
<td><p>A list of software components that represent all the software loaded by the PRoT. This claim is needed for the rules outlined in <a class="reference internal" href="../about.html#cite-psm"><span class="cite atg_c atg_c-cite">[PSM]</span></a>. Each entry has the following fields:
1. Measurement type
2. Measurement value
3. Version
4. Signer ID
5. Measurement description
The full definition of the software component is described in <a class="reference internal" href="#software-components"><span class="secref">Software components</span></a>. This claim is required to be compliant with <a class="reference internal" href="../about.html#cite-psm"><span class="cite atg_c atg_c-cite">[PSM]</span></a>.</p></td>
</tr>
<tr class="row-even"><td><p>No Software Measurements</p></td>
<td><p>Yes (if no software components specified)</p></td>
<td><p>In the event that the implementation does not contain any software measurements then the Software Components claim above can be omitted but instead it is mandatory to include this claim to indicate this is a deliberate state.</p>
<p>This claim is intended for devices that are not compliant with <a class="reference internal" href="../about.html#cite-psm"><span class="cite atg_c atg_c-cite">[PSM]</span></a>.</p>
</td>
</tr>
</tbody>
</table>
<section id="software-components">
<span id="id1"></span><h3><span class="section-number">3.1.1. </span>Software components<a class="headerlink" href="#software-components" title="Permalink to this headline">¶</a></h3>
<p>Each software component in the Software Components claim must include the required properties of the following table:</p>
<table class="colwidths-given longtable docutils align-left">
<colgroup>
<col style="width: 11%" />
<col style="width: 26%" />
<col style="width: 11%" />
<col style="width: 53%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Key ID</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Required</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>Measurement type</p></td>
<td><p>No</p></td>
<td><p>A short string representing the role of this software component (e.g. ‘BL’ for boot loader).</p>
<p>Expected types may include:</p>
<ul class="simple">
<li><p>BL (a bootloader)</p></li>
<li><p>PRoT (a component of the Platform Root of Trust)</p></li>
<li><p>ARoT (a component of the Application Root of Trust)</p></li>
<li><p>App (a component of the NSPE application)</p></li>
<li><p>TS (a component of a trusted subsystem)</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>Measurement value</p></td>
<td><p>Yes</p></td>
<td><p>Represents a hash of the invariant software component in memory at startup time. The value must be a cryptographic hash of 256 bits or stronger.</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>Reserved</p></td>
<td><p>No</p></td>
<td><p>Reserved</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>Version</p></td>
<td><p>No</p></td>
<td><p>The issued software version in the form of a text string. The value of this claim corresponds to the entry in the original signed manifest of the component.</p>
<p>This field must be present to be compliant with <a class="reference internal" href="../about.html#cite-psm"><span class="cite atg_c atg_c-cite">[PSM]</span></a>.</p>
</td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>Signer ID</p></td>
<td><p>No</p></td>
<td><p>The hash of a signing authority public key for the software component. The value of this claim corresponds to the entry in the original manifest for the component.</p>
<p>This can be used by a verifier to ensure the components were signed by an expected trusted source.</p>
<p>This field must be present to be compliant with <a class="reference internal" href="../about.html#cite-psm"><span class="cite atg_c atg_c-cite">[PSM]</span></a>.</p>
</td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>Measurement description</p></td>
<td><p>No</p></td>
<td><p>Description of the software component, which represents the way in which the measurement value of the software component is computed. The value is a text string containing an abbreviated description (or name) of the measurement method which can be used to lookup the details of the method in a profile document. This claim may normally be excluded, unless there is an exception to the default measurement described in the profile for a specific component.</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="report-format-and-signing">
<h2><span class="section-number">3.2. </span>Report format and signing<a class="headerlink" href="#report-format-and-signing" title="Permalink to this headline">¶</a></h2>
<p>This section describes the specific representation, encoding and signing of the information described in the Information Model.</p>
<section id="token-encoding">
<h3><span class="section-number">3.2.1. </span>Token encoding<a class="headerlink" href="#token-encoding" title="Permalink to this headline">¶</a></h3>
<p>The report is represented as a token, which must be formatted in accordance to <span><em>IETF Entity Attestation Token (EAT)</em> <a class="reference internal" href="../about.html#cite-eat"><span class="cite">[EAT]</span></a></span> draft specification. The token consists of a series of claims declaring evidence as to the nature of the instance of hardware and software. The claims are encoded with the <a class="reference internal" href="../about.html#term-cbor"><span class="term">CBOR</span></a> format, defined in <span><em>Concise Binary Object Representation (CBOR)</em> <a class="reference internal" href="../about.html#cite-std94"><span class="cite">[STD94]</span></a></span>.</p>
</section>
<section id="signing">
<h3><span class="section-number">3.2.2. </span>Signing<a class="headerlink" href="#signing" title="Permalink to this headline">¶</a></h3>
<p>The token is signed following the structure defined in <span><em>CBOR Object Signing and Encryption (COSE): Structures and Process</em> <a class="reference internal" href="../about.html#cite-std96"><span class="cite">[STD96]</span></a></span> specification:</p>
<ul>
<li><p>For asymmetric key algorithms, the signature structure must be COSE-Sign1. An asymmetric key algorithm is needed to achieve all the use cases defined in <a class="reference internal" href="use-cases.html#use-cases"><span class="secref">Use cases and rationale</span></a>.</p></li>
<li><p>For symmetric key algorithms, the structure must be COSE-Mac0.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>A symmetric key is <strong>strongly discouraged</strong> due to the associated infrastructure costs for key management and operational complexities. It may also restrict the ability to interoperate with scenarios that involve third parties (see <a class="reference internal" href="use-cases.html#use-cases"><span class="secref">Use cases and rationale</span></a>).</p>
</div>
</li>
</ul>
</section>
<section id="eat-standard-claims">
<h3><span class="section-number">3.2.3. </span>EAT standard claims<a class="headerlink" href="#eat-standard-claims" title="Permalink to this headline">¶</a></h3>
<p>The token is modelled to include custom values that correspond to the following EAT standard claims (as expressed in the draft EAT proposal):</p>
<ul class="simple">
<li><p><strong>nonce</strong> (mandatory); arm_psa_nonce is used instead</p></li>
<li><p><strong>UEID</strong> (mandatory); arm_psa_UEID is used instead</p></li>
</ul>
<p>A future version of the profile, corresponding to an issued standard, might declare support for both custom and standard claims as a transitionary state towards exclusive use of standard claims.</p>
</section>
<section id="eat-custom-claims">
<span id="custom-claims"></span><h3><span class="section-number">3.2.4. </span>EAT custom claims<a class="headerlink" href="#eat-custom-claims" title="Permalink to this headline">¶</a></h3>
<p>The token can include the following EAT custom claims. Custom claims for the Attestation API have a root identity of -75000.</p>
<p>Some fields must be at least 32 bytes to provide sufficient cryptographic strength.</p>
<table class="colwidths-given longtable docutils align-left">
<colgroup>
<col style="width: 11%" />
<col style="width: 27%" />
<col style="width: 29%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Key ID</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Name</p></th>
<th class="head"><p>CBOR type</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>-75000</p></td>
<td><p>Profile Definition</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">arm_psa_profile_id</span></code></p></td>
<td><p>Text string</p></td>
</tr>
<tr class="row-odd"><td><p>-75001</p></td>
<td><p>Client ID</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">arm_psa_partition_id</span></code></p></td>
<td><p>Unsigned integer or Negative integer</p></td>
</tr>
<tr class="row-even"><td><p>-75002</p></td>
<td><p>Security Lifecycle</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">arm_psa_security_lifecycle</span></code></p></td>
<td><p>Unsigned integer</p></td>
</tr>
<tr class="row-odd"><td><p>-75003</p></td>
<td><p>Implementation ID</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">arm_psa_implementation_id</span></code></p></td>
<td><p>Byte string (&gt;=32 bytes)</p></td>
</tr>
<tr class="row-even"><td><p>-75004</p></td>
<td><p>Boot seed</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">arm_psa_boot_seed</span></code></p></td>
<td><p>Byte string (&gt;=32 bytes)</p></td>
</tr>
<tr class="row-odd"><td><p>-75005</p></td>
<td><p>Hardware version</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">arm_psa_hw_version</span></code></p></td>
<td><p>Text string</p></td>
</tr>
<tr class="row-even"><td><p>-75006</p></td>
<td><p>Software components (compound map claim)</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">arm_psa_sw_components</span></code></p></td>
<td><p>Array of map entries. The map entries have the following types:</p>
<ol class="arabic simple">
<li><p>Text string (type)</p></li>
<li><p>Byte string (measurement, &gt;=32 bytes)</p></li>
<li><p>Reserved</p></li>
<li><p>Text string (version)</p></li>
<li><p>Byte string (signer ID, &gt;=32 bytes)</p></li>
<li><p>Text string (measurement description)</p></li>
</ol>
<p>See <a class="reference internal" href="#software-components"><span class="secref">Software components</span></a> for details.</p>
</td>
</tr>
<tr class="row-odd"><td><p>-75007</p></td>
<td><p>No software measurements</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">arm_psa_no_sw_measurements</span></code></p></td>
<td><p>Unsigned integer (the recommended value is <code class="docutils literal notranslate"><span class="pre">1</span></code>)</p></td>
</tr>
<tr class="row-even"><td><p>-75008</p></td>
<td><p>Auth challenge</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">arm_psa_nonce</span></code></p></td>
<td><p>Byte string</p></td>
</tr>
<tr class="row-odd"><td><p>-75009</p></td>
<td><p>Instance ID</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">arm_psa_UEID</span></code></p></td>
<td><p>Byte string (the type byte should be set to <code class="docutils literal notranslate"><span class="pre">0x01</span></code>. The type byte is described in the <a class="reference internal" href="../about.html#cite-eat"><span class="cite atg_c atg_c-cite">[EAT]</span></a> draft.)</p></td>
</tr>
<tr class="row-even"><td><p>-75010</p></td>
<td><p>Verification service indicator</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">arm_psa_origination</span></code></p></td>
<td><p>Text string</p></td>
</tr>
</tbody>
</table>
<p>An example report can be found in <a class="reference internal" href="../appendix/example-token.html#example-report"><span class="secref">Example report</span></a>.</p>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/Arm_logo_blue_RGB.svg" alt="Logo"/>
            </a></p><hr />
<h3><a href="../index.html"><b>PSA Certified<br />Attestation API</b></a></h3>
IHI 0085<br/>
Non-confidential<br/>
Version 1.0.3
<span style="font-weight: bold;"></span>
<hr />
<ul>
<li class="toctree-l1"><a class="reference internal" href="../about.html">About this document</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="use-cases.html">2. Use cases and rationale</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">3. Initial Attestation report</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#information-model">3.1. Information model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#software-components">3.1.1. Software components</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#report-format-and-signing">3.2. Report format and signing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#token-encoding">3.2.1. Token encoding</a></li>
<li class="toctree-l3"><a class="reference internal" href="#signing">3.2.2. Signing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#eat-standard-claims">3.2.3. EAT standard claims</a></li>
<li class="toctree-l3"><a class="reference internal" href="#eat-custom-claims">3.2.4. EAT custom claims</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/api.html">4. API reference</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../appendix/example-header.html">A. Example header file</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/example-token.html">B. Example report</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/cddl.html">C. CDDL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/history.html">D. Document history</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy; 2018-2020, 2022 Arm Limited and/or its affiliates.
      
    </div>

    

    
  </body>
</html>