<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="9.2 Key types" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://arm-software.github.io/psa-api/crypto/1.3/api/keys/types.html" />
<link rel="canonical" href="https://arm-software.github.io/psa-api/crypto/1.3/api/keys/types.html" />
<meta property="og:site_name" content="PSA Certified Crypto API 1.3" />
<meta property="og:description" content="Key type encoding: psa_key_type_t(typedef): Encoding of a key type. This is a structured bitfield that identifies the category and type of key. The range of key type values is divided as follows: P..." />
<meta name="description" content="Key type encoding: psa_key_type_t(typedef): Encoding of a key type. This is a structured bitfield that identifies the category and type of key. The range of key type values is divided as follows: P..." />

    <title>9.2 Key types &#8212; PSA Certified Crypto API 1.3</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic.css?v=686e5160" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=f6a572b4" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=4ae1632d" />
    <link rel="preconnect" type="text/css" href="https://fonts.googleapis.com" />
    <link rel="preconnect" type="text/css" href="https://fonts.gstatic.com" />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,400;0,700;1,400&display=swap" />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css2?family=Inconsolata:wght@400;700&display=swap" />
    <script src="../../_static/documentation_options.js?v=96647119"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>window.MathJax = {"chtml": {"mtextInheritFont": true}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="9.3 Key lifetimes" href="lifetimes.html" />
    <link rel="prev" title="9.1 Key attributes" href="attributes.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/Arm_logo_blue_RGB.svg" alt="Logo of PSA Certified Crypto API"/>
            </a></p><hr />
<h3><a href="../../index.html"><b>PSA Certified<br />Crypto API</b></a></h3>
IHI 0086<br/>
Non-confidential<br/>
Version 1.3.0
<hr />
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../about.html">About this document</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../overview/intro.html">1 Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/goals.html">2 Design goals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/functionality.html">3 Functionality overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/sample-arch.html">4 Sample architectures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/conventions.html">5 Library conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/implementation.html">6 Implementation considerations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/usage.html">7 Usage considerations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../library/index.html">8 Library management reference</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">9 Key management reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="attributes.html">9.1 Key attributes</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">9.2 Key types</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#key-type-encoding">9.2.1 Key type encoding</a></li>
<li class="toctree-l3"><a class="reference internal" href="#key-categories">9.2.2 Key categories</a></li>
<li class="toctree-l3"><a class="reference internal" href="#symmetric-keys">9.2.3 Symmetric keys</a></li>
<li class="toctree-l3"><a class="reference internal" href="#asymmetric-keys">9.2.4 Asymmetric keys</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rsa-keys">9.2.5 RSA keys</a></li>
<li class="toctree-l3"><a class="reference internal" href="#elliptic-curve-keys">9.2.6 Elliptic Curve keys</a></li>
<li class="toctree-l3"><a class="reference internal" href="#diffie-hellman-keys">9.2.7 Diffie Hellman keys</a></li>
<li class="toctree-l3"><a class="reference internal" href="#attribute-accessors">9.2.8 Attribute accessors</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lifetimes.html">9.3 Key lifetimes</a></li>
<li class="toctree-l2"><a class="reference internal" href="ids.html">9.4 Key identifiers</a></li>
<li class="toctree-l2"><a class="reference internal" href="policy.html">9.5 Key policies</a></li>
<li class="toctree-l2"><a class="reference internal" href="management.html">9.6 Key management functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ops/index.html">10 Cryptographic operation reference</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../appendix/example_header.html">A Example header file</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendix/encodings.html">B Algorithm and key type encoding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendix/specdef_values.html">C Example macro implementations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendix/sra.html">D Security Risk Assessment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendix/history.html">E Changes to the API</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../atg_c-identifiers.html">Index of API elements</a></li>
</ul>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="key-types">
<span id="id1"></span><h1><span class="section-number">9.2 </span>Key types<a class="headerlink" href="#key-types" title="Link to this heading">¶</a></h1>
<section id="key-type-encoding">
<h2><span class="section-number">9.2.1 </span>Key type encoding<a class="headerlink" href="#key-type-encoding" title="Link to this heading">¶</a></h2>
<section id="c.psa_key_type_t">
<h3><code class="docutils literal notranslate"><span class="pre">psa_key_type_t</span></code> (typedef)<a class="headerlink" href="#c.psa_key_type_t" title="Link to this heading">¶</a></h3>
<p>Encoding of a key type.</p>
<pre class="literal-block">typedef uint16_t <a class="reference internal" href="#c.psa_key_type_t" title="psa_key_type_t">psa_key_type_t</a>;</pre>
<p>This is a structured bitfield that identifies the category and type of key. The range of key type values is divided as follows:</p>
<dl class="simple">
<dt><a class="reference internal" href="#c.PSA_KEY_TYPE_NONE" title="PSA_KEY_TYPE_NONE"><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_NONE</span></code></a><code class="docutils literal notranslate"> <span class="pre">==</span> <span class="pre">0</span></code></dt><dd><p>Reserved as an invalid key type.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">0x0001</span> <span class="pre">-</span> <span class="pre">0x7fff</span></code></dt><dd><p>Specification-defined key types.
Key types defined by this standard always have bit 15 clear.
Unallocated key type values in this range are reserved for future use.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">0x8000</span> <span class="pre">-</span> <span class="pre">0xffff</span></code></dt><dd><p>Implementation-defined key types.
Implementations that define additional key types must use an encoding with bit 15 set.
The related support macros will be easier to write if these key encodings also respect the bitwise structure used by standard encodings.</p>
</dd>
</dl>
<p>The <a class="reference internal" href="../../appendix/encodings.html#appendix-encodings"><span class="secref">Algorithm and key type encoding</span></a> appendix provides a full definition of the key type encoding.</p>
</section>
<section id="c.PSA_KEY_TYPE_NONE">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_NONE</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_NONE" title="Link to this heading">¶</a></h3>
<p>An invalid key type value.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_NONE" title="PSA_KEY_TYPE_NONE">PSA_KEY_TYPE_NONE</a> ((<a class="reference internal" href="#c.psa_key_type_t" title="psa_key_type_t">psa_key_type_t</a>)0x0000)</pre>
<p>Zero is not the encoding of any key type.</p>
</section>
</section>
<section id="key-categories">
<h2><span class="section-number">9.2.2 </span>Key categories<a class="headerlink" href="#key-categories" title="Link to this heading">¶</a></h2>
<section id="c.PSA_KEY_TYPE_IS_UNSTRUCTURED">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_IS_UNSTRUCTURED</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_IS_UNSTRUCTURED" title="Link to this heading">¶</a></h3>
<p>Whether a key type is an unstructured array of bytes.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_IS_UNSTRUCTURED" title="PSA_KEY_TYPE_IS_UNSTRUCTURED">PSA_KEY_TYPE_IS_UNSTRUCTURED</a>(type) <em><a class="reference internal" href="../../overview/implementation.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">type</span></code></p>
</dt><dd><p>A key type: a value of type <a class="reference internal" href="#c.psa_key_type_t" title="psa_key_type_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_key_type_t</span></code></a>.</p>
</dd>
</dl>
</div>
<p class="rubric">Description</p>
<p>This encompasses both symmetric keys and non-key data.</p>
<p>See <a class="reference internal" href="#symmetric-keys"><span class="secref">Symmetric keys</span></a> for a list of symmetric key types.</p>
</section>
<section id="c.PSA_KEY_TYPE_IS_ASYMMETRIC">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_IS_ASYMMETRIC</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_IS_ASYMMETRIC" title="Link to this heading">¶</a></h3>
<p>Whether a key type is asymmetric: either a key pair or a public key.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_IS_ASYMMETRIC" title="PSA_KEY_TYPE_IS_ASYMMETRIC">PSA_KEY_TYPE_IS_ASYMMETRIC</a>(type) <em><a class="reference internal" href="../../overview/implementation.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">type</span></code></p>
</dt><dd><p>A key type: a value of type <a class="reference internal" href="#c.psa_key_type_t" title="psa_key_type_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_key_type_t</span></code></a>.</p>
</dd>
</dl>
</div>
<p class="rubric">Description</p>
<p>See <a class="reference internal" href="#asymmetric-keys"><span class="secref">Asymmetric keys</span></a> for a list of asymmetric key types.</p>
</section>
<section id="c.PSA_KEY_TYPE_IS_PUBLIC_KEY">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_IS_PUBLIC_KEY</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_IS_PUBLIC_KEY" title="Link to this heading">¶</a></h3>
<p>Whether a key type is the public part of a key pair.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_IS_PUBLIC_KEY" title="PSA_KEY_TYPE_IS_PUBLIC_KEY">PSA_KEY_TYPE_IS_PUBLIC_KEY</a>(type) <em><a class="reference internal" href="../../overview/implementation.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">type</span></code></p>
</dt><dd><p>A key type: a value of type <a class="reference internal" href="#c.psa_key_type_t" title="psa_key_type_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_key_type_t</span></code></a>.</p>
</dd>
</dl>
</div>
</section>
<section id="c.PSA_KEY_TYPE_IS_KEY_PAIR">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_IS_KEY_PAIR</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_IS_KEY_PAIR" title="Link to this heading">¶</a></h3>
<p>Whether a key type is a key pair containing a private part and a public part.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_IS_KEY_PAIR" title="PSA_KEY_TYPE_IS_KEY_PAIR">PSA_KEY_TYPE_IS_KEY_PAIR</a>(type) <em><a class="reference internal" href="../../overview/implementation.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">type</span></code></p>
</dt><dd><p>A key type: a value of type <a class="reference internal" href="#c.psa_key_type_t" title="psa_key_type_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_key_type_t</span></code></a>.</p>
</dd>
</dl>
</div>
</section>
</section>
<section id="symmetric-keys">
<span id="id2"></span><h2><span class="section-number">9.2.3 </span>Symmetric keys<a class="headerlink" href="#symmetric-keys" title="Link to this heading">¶</a></h2>
<section id="c.PSA_KEY_TYPE_RAW_DATA">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_RAW_DATA</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_RAW_DATA" title="Link to this heading">¶</a></h3>
<p>Raw data.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_RAW_DATA" title="PSA_KEY_TYPE_RAW_DATA">PSA_KEY_TYPE_RAW_DATA</a> ((<a class="reference internal" href="#c.psa_key_type_t" title="psa_key_type_t">psa_key_type_t</a>)0x1001)</pre>
<p>A “key” of this type cannot be used for any cryptographic operation. Applications can use this type to store arbitrary data in the keystore.</p>
<p>The bit size of a raw key must be a non-zero multiple of 8. The maximum size of a raw key is <a class="reference internal" href="../../about.html#term-implementation-defined"><span class="scterm">IMPLEMENTATION DEFINED</span></a>.</p>
<p class="rubric">Compatible algorithms</p>
<p>A key of this type can also be used as a non-secret input to the following key-derivation algorithms:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><p><a class="reference internal" href="../ops/key-derivation.html#c.PSA_ALG_HKDF" title="PSA_ALG_HKDF"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_HKDF</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/key-derivation.html#c.PSA_ALG_HKDF_EXPAND" title="PSA_ALG_HKDF_EXPAND"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_HKDF_EXPAND</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/key-derivation.html#c.PSA_ALG_HKDF_EXTRACT" title="PSA_ALG_HKDF_EXTRACT"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_HKDF_EXTRACT</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/key-derivation.html#c.PSA_ALG_SP800_108_COUNTER_HMAC" title="PSA_ALG_SP800_108_COUNTER_HMAC"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_SP800_108_COUNTER_HMAC</span></code></a></p></li>
</ul>
</td><td><ul class="simple">
<li><p><a class="reference internal" href="../ops/key-derivation.html#c.PSA_ALG_SP800_108_COUNTER_CMAC" title="PSA_ALG_SP800_108_COUNTER_CMAC"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_SP800_108_COUNTER_CMAC</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/key-derivation.html#c.PSA_ALG_TLS12_PRF" title="PSA_ALG_TLS12_PRF"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_TLS12_PRF</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/key-derivation.html#c.PSA_ALG_TLS12_PSK_TO_MS" title="PSA_ALG_TLS12_PSK_TO_MS"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_TLS12_PSK_TO_MS</span></code></a></p></li>
</ul>
</td></tr></table>
<p class="rubric">Key format</p>
<p>The data format for import and export of the key is the raw bytes of the key.</p>
<p class="rubric">Key derivation</p>
<p>A call to <a class="reference internal" href="../ops/key-derivation.html#c.psa_key_derivation_output_key" title="psa_key_derivation_output_key"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_key_derivation_output_key()</span></code></a> will draw <span class="math notranslate nohighlight">\(m/8\)</span> bytes of output and use these as the key data, where <span class="math notranslate nohighlight">\(m\)</span> is the bit-size of the key.</p>
</section>
<section id="c.PSA_KEY_TYPE_HMAC">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_HMAC</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_HMAC" title="Link to this heading">¶</a></h3>
<p>HMAC key.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_HMAC" title="PSA_KEY_TYPE_HMAC">PSA_KEY_TYPE_HMAC</a> ((<a class="reference internal" href="#c.psa_key_type_t" title="psa_key_type_t">psa_key_type_t</a>)0x1100)</pre>
<p>HMAC keys can be used in HMAC, or HMAC-based, algorithms.
Although HMAC is parameterized by a specific hash algorithm, for example SHA-256, the hash algorithm is not specified in the key type.
The permitted-algorithm policy for the key must specify a particular hash algorithm.</p>
<p>The bit size of an HMAC key must be a non-zero multiple of 8.
An HMAC key is typically the same size as the output of the underlying hash algorithm.
An HMAC key that is longer than the block size of the underlying hash algorithm will be hashed before use, see <span><em>HMAC: Keyed-Hashing for Message Authentication</em> <a class="reference internal" href="../../about.html#cite-rfc2104"><span class="cite">[RFC2104]</span></a></span> <a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc2104.html#section-2">§2</a>.</p>
<p>It is recommended that an application does not construct HMAC keys that are longer than the block size of the hash algorithm that will be used.
It is <a class="reference internal" href="../../about.html#term-implementation-defined"><span class="scterm">implementation defined</span></a> whether an HMAC key that is longer than the hash block size is supported.</p>
<p>If the application does not control the length of the data used to construct the HMAC key, it is recommended that the application hashes the key data, when it exceeds the hash block length, before constructing the HMAC key.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="../ops/hash.html#c.PSA_HASH_LENGTH" title="PSA_HASH_LENGTH"><code class="docutils literal notranslate"><span class="pre">PSA_HASH_LENGTH</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> provides the output size of hash algorithm <code class="docutils literal notranslate"><span class="pre">alg</span></code>, in bytes.</p>
<p><a class="reference internal" href="../ops/hash.html#c.PSA_HASH_BLOCK_LENGTH" title="PSA_HASH_BLOCK_LENGTH"><code class="docutils literal notranslate"><span class="pre">PSA_HASH_BLOCK_LENGTH</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> provides the block size of hash algorithm <code class="docutils literal notranslate"><span class="pre">alg</span></code>, in bytes.</p>
</div>
<p class="rubric">Compatible algorithms</p>
<table class="hlist"><tr><td><ul class="simple">
<li><p><a class="reference internal" href="../ops/mac.html#c.PSA_ALG_HMAC" title="PSA_ALG_HMAC"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_HMAC</span></code></a></p></li>
</ul>
</td><td><ul class="simple">
<li><p><a class="reference internal" href="../ops/key-derivation.html#c.PSA_ALG_SP800_108_COUNTER_HMAC" title="PSA_ALG_SP800_108_COUNTER_HMAC"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_SP800_108_COUNTER_HMAC</span></code></a> (secret input)</p></li>
</ul>
</td></tr></table>
<p class="rubric">Key format</p>
<p>The data format for import and export of the key is the raw bytes of the key.</p>
<p class="rubric">Key derivation</p>
<p>A call to <a class="reference internal" href="../ops/key-derivation.html#c.psa_key_derivation_output_key" title="psa_key_derivation_output_key"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_key_derivation_output_key()</span></code></a> will draw <span class="math notranslate nohighlight">\(m/8\)</span> bytes of output and use these as the key data, where <span class="math notranslate nohighlight">\(m\)</span> is the bit-size of the key.</p>
</section>
<section id="c.PSA_KEY_TYPE_DERIVE">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_DERIVE</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_DERIVE" title="Link to this heading">¶</a></h3>
<p>A secret for key derivation.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_DERIVE" title="PSA_KEY_TYPE_DERIVE">PSA_KEY_TYPE_DERIVE</a> ((<a class="reference internal" href="#c.psa_key_type_t" title="psa_key_type_t">psa_key_type_t</a>)0x1200)</pre>
<p>This key type is for high-entropy secrets only. For low-entropy secrets, <a class="reference internal" href="#c.PSA_KEY_TYPE_PASSWORD" title="PSA_KEY_TYPE_PASSWORD"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_PASSWORD</span></code></a> should be used instead.</p>
<p>These keys can be used in the <a class="reference internal" href="../ops/key-derivation.html#c.PSA_KEY_DERIVATION_INPUT_SECRET" title="PSA_KEY_DERIVATION_INPUT_SECRET"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_DERIVATION_INPUT_SECRET</span></code></a> or <a class="reference internal" href="../ops/key-derivation.html#c.PSA_KEY_DERIVATION_INPUT_PASSWORD" title="PSA_KEY_DERIVATION_INPUT_PASSWORD"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_DERIVATION_INPUT_PASSWORD</span></code></a> input step of key-derivation algorithms.</p>
<p>The key policy determines which key-derivation algorithm the key can be used for.</p>
<p>The bit size of a secret for key derivation must be a non-zero multiple of 8. The maximum size of a secret for key derivation is <a class="reference internal" href="../../about.html#term-implementation-defined"><span class="scterm">IMPLEMENTATION DEFINED</span></a>.</p>
<p class="rubric">Compatible algorithms</p>
<p>A key of this type can be used as the secret input to the following key-derivation algorithms:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><p><a class="reference internal" href="../ops/key-derivation.html#c.PSA_ALG_HKDF" title="PSA_ALG_HKDF"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_HKDF</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/key-derivation.html#c.PSA_ALG_HKDF_EXPAND" title="PSA_ALG_HKDF_EXPAND"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_HKDF_EXPAND</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/key-derivation.html#c.PSA_ALG_HKDF_EXTRACT" title="PSA_ALG_HKDF_EXTRACT"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_HKDF_EXTRACT</span></code></a></p></li>
</ul>
</td><td><ul class="simple">
<li><p><a class="reference internal" href="../ops/key-derivation.html#c.PSA_ALG_TLS12_PRF" title="PSA_ALG_TLS12_PRF"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_TLS12_PRF</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/key-derivation.html#c.PSA_ALG_TLS12_PSK_TO_MS" title="PSA_ALG_TLS12_PSK_TO_MS"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_TLS12_PSK_TO_MS</span></code></a></p></li>
</ul>
</td></tr></table>
<p class="rubric">Key format</p>
<p>The data format for import and export of the key is the raw bytes of the key.</p>
<p class="rubric">Key derivation</p>
<p>A call to <a class="reference internal" href="../ops/key-derivation.html#c.psa_key_derivation_output_key" title="psa_key_derivation_output_key"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_key_derivation_output_key()</span></code></a> will draw <span class="math notranslate nohighlight">\(m/8\)</span> bytes of output and use these as the key data, where <span class="math notranslate nohighlight">\(m\)</span> is the bit-size of the key.</p>
</section>
<section id="c.PSA_KEY_TYPE_PASSWORD">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_PASSWORD</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_PASSWORD" title="Link to this heading">¶</a></h3>
<p>A low-entropy secret for password hashing or key derivation.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.1.</span></p>
</div>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_PASSWORD" title="PSA_KEY_TYPE_PASSWORD">PSA_KEY_TYPE_PASSWORD</a> ((<a class="reference internal" href="#c.psa_key_type_t" title="psa_key_type_t">psa_key_type_t</a>)0x1203)</pre>
<p>This key type is suitable for passwords and passphrases which are typically intended to be memorizable by humans, and have a low entropy relative to their size.
It can be used for randomly generated or derived keys with maximum or near-maximum entropy, but <a class="reference internal" href="#c.PSA_KEY_TYPE_DERIVE" title="PSA_KEY_TYPE_DERIVE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_DERIVE</span></code></a> is more suitable for such keys.
It is not suitable for passwords with extremely low entropy, such as numerical PINs.</p>
<p>These keys can be used in the <a class="reference internal" href="../ops/key-derivation.html#c.PSA_KEY_DERIVATION_INPUT_PASSWORD" title="PSA_KEY_DERIVATION_INPUT_PASSWORD"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_DERIVATION_INPUT_PASSWORD</span></code></a> input step of key-derivation algorithms.
Algorithms that accept such an input were designed to accept low-entropy secret and are known as <em>password hashing</em> or <em>key stretching</em> algorithms.</p>
<p>These keys cannot be used in the <a class="reference internal" href="../ops/key-derivation.html#c.PSA_KEY_DERIVATION_INPUT_SECRET" title="PSA_KEY_DERIVATION_INPUT_SECRET"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_DERIVATION_INPUT_SECRET</span></code></a> input step of key-derivation algorithms, as the algorithms expect such an input to have high entropy.</p>
<p>The key policy determines which key-derivation algorithm the key can be used for, among the permissible subset defined above.</p>
<p class="rubric">Compatible algorithms</p>
<p>A key of this type can be used as the password input to the following key-stretching algorithms:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><p><a class="reference internal" href="../ops/key-derivation.html#c.PSA_ALG_PBKDF2_HMAC" title="PSA_ALG_PBKDF2_HMAC"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_PBKDF2_HMAC</span></code></a></p></li>
</ul>
</td><td><ul class="simple">
<li><p><a class="reference internal" href="../ops/key-derivation.html#c.PSA_ALG_PBKDF2_AES_CMAC_PRF_128" title="PSA_ALG_PBKDF2_AES_CMAC_PRF_128"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_PBKDF2_AES_CMAC_PRF_128</span></code></a></p></li>
</ul>
</td></tr></table>
<p class="rubric">Key format</p>
<p>The data format for import and export of the key is the raw bytes of the key.</p>
<p class="rubric">Key derivation</p>
<p>A call to <a class="reference internal" href="../ops/key-derivation.html#c.psa_key_derivation_output_key" title="psa_key_derivation_output_key"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_key_derivation_output_key()</span></code></a> will draw <span class="math notranslate nohighlight">\(m/8\)</span> bytes of output and use these as the key data, where <span class="math notranslate nohighlight">\(m\)</span> is the bit-size of the key.</p>
</section>
<section id="c.PSA_KEY_TYPE_PASSWORD_HASH">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_PASSWORD_HASH</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_PASSWORD_HASH" title="Link to this heading">¶</a></h3>
<p>A secret value that can be used to verify a password hash.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.1.</span></p>
</div>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_PASSWORD_HASH" title="PSA_KEY_TYPE_PASSWORD_HASH">PSA_KEY_TYPE_PASSWORD_HASH</a> ((<a class="reference internal" href="#c.psa_key_type_t" title="psa_key_type_t">psa_key_type_t</a>)0x1205)</pre>
<p>The key policy determines which key-derivation algorithm the key can be used for, among the same permissible subset as for <a class="reference internal" href="#c.PSA_KEY_TYPE_PASSWORD" title="PSA_KEY_TYPE_PASSWORD"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_PASSWORD</span></code></a>.</p>
<p class="rubric">Compatible algorithms</p>
<p>A key of this type can be used to output or verify the result of the following key-stretching algorithms:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><p><a class="reference internal" href="../ops/key-derivation.html#c.PSA_ALG_PBKDF2_HMAC" title="PSA_ALG_PBKDF2_HMAC"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_PBKDF2_HMAC</span></code></a></p></li>
</ul>
</td><td><ul class="simple">
<li><p><a class="reference internal" href="../ops/key-derivation.html#c.PSA_ALG_PBKDF2_AES_CMAC_PRF_128" title="PSA_ALG_PBKDF2_AES_CMAC_PRF_128"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_PBKDF2_AES_CMAC_PRF_128</span></code></a></p></li>
</ul>
</td></tr></table>
<p class="rubric">Key format</p>
<p>The data format for import and export of the key is the raw bytes of the key.</p>
<p class="rubric">Key derivation</p>
<p>A call to <a class="reference internal" href="../ops/key-derivation.html#c.psa_key_derivation_output_key" title="psa_key_derivation_output_key"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_key_derivation_output_key()</span></code></a> will draw <span class="math notranslate nohighlight">\(m/8\)</span> bytes of output and use these as the key data, where <span class="math notranslate nohighlight">\(m\)</span> is the bit-size of the key.</p>
</section>
<section id="c.PSA_KEY_TYPE_PEPPER">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_PEPPER</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_PEPPER" title="Link to this heading">¶</a></h3>
<p>A secret value that can be used when computing a password hash.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.1.</span></p>
</div>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_PEPPER" title="PSA_KEY_TYPE_PEPPER">PSA_KEY_TYPE_PEPPER</a> ((<a class="reference internal" href="#c.psa_key_type_t" title="psa_key_type_t">psa_key_type_t</a>)0x1206)</pre>
<p>The key policy determines which key-derivation algorithm the key can be used for, among the subset of algorithms that can use pepper.</p>
<p class="rubric">Compatible algorithms</p>
<p>A key of this type can be used as the salt input to the following key-stretching algorithms:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><p><a class="reference internal" href="../ops/key-derivation.html#c.PSA_ALG_PBKDF2_HMAC" title="PSA_ALG_PBKDF2_HMAC"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_PBKDF2_HMAC</span></code></a></p></li>
</ul>
</td><td><ul class="simple">
<li><p><a class="reference internal" href="../ops/key-derivation.html#c.PSA_ALG_PBKDF2_AES_CMAC_PRF_128" title="PSA_ALG_PBKDF2_AES_CMAC_PRF_128"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_PBKDF2_AES_CMAC_PRF_128</span></code></a></p></li>
</ul>
</td></tr></table>
<p class="rubric">Key format</p>
<p>The data format for import and export of the key is the raw bytes of the key.</p>
<p class="rubric">Key derivation</p>
<p>A call to <a class="reference internal" href="../ops/key-derivation.html#c.psa_key_derivation_output_key" title="psa_key_derivation_output_key"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_key_derivation_output_key()</span></code></a> will draw <span class="math notranslate nohighlight">\(m/8\)</span> bytes of output and use these as the key data, where <span class="math notranslate nohighlight">\(m\)</span> is the bit-size of the key.</p>
</section>
<section id="c.PSA_KEY_TYPE_AES">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_AES</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_AES" title="Link to this heading">¶</a></h3>
<p>Key for a cipher, AEAD or MAC algorithm based on the AES block cipher.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_AES" title="PSA_KEY_TYPE_AES">PSA_KEY_TYPE_AES</a> ((<a class="reference internal" href="#c.psa_key_type_t" title="psa_key_type_t">psa_key_type_t</a>)0x2400)</pre>
<p>The size of the key is related to the AES algorithm variant. For algorithms except the XTS block cipher mode, the following key sizes are used:</p>
<ul class="simple">
<li><p>AES-128 uses a 16-byte key : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">128</span></code></p></li>
<li><p>AES-192 uses a 24-byte key : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">192</span></code></p></li>
<li><p>AES-256 uses a 32-byte key : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">256</span></code></p></li>
</ul>
<p>For the XTS block cipher mode (<a class="reference internal" href="../ops/cipher.html#c.PSA_ALG_XTS" title="PSA_ALG_XTS"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_XTS</span></code></a>), the following key sizes are used:</p>
<ul class="simple">
<li><p>AES-128-XTS uses two 16-byte keys : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">256</span></code></p></li>
<li><p>AES-192-XTS uses two 24-byte keys : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">384</span></code></p></li>
<li><p>AES-256-XTS uses two 32-byte keys : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">512</span></code></p></li>
</ul>
<p>The AES block cipher is defined in <span><em>FIPS Publication 197: Advanced Encryption Standard (AES)</em> <a class="reference internal" href="../../about.html#cite-fips197"><span class="cite">[FIPS197]</span></a></span>.</p>
<p class="rubric">Compatible algorithms</p>
<table class="hlist"><tr><td><ul class="simple">
<li><p><a class="reference internal" href="../ops/mac.html#c.PSA_ALG_CBC_MAC" title="PSA_ALG_CBC_MAC"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_CBC_MAC</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/mac.html#c.PSA_ALG_CMAC" title="PSA_ALG_CMAC"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_CMAC</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/cipher.html#c.PSA_ALG_CTR" title="PSA_ALG_CTR"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_CTR</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/cipher.html#c.PSA_ALG_CFB" title="PSA_ALG_CFB"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_CFB</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/cipher.html#c.PSA_ALG_OFB" title="PSA_ALG_OFB"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_OFB</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/cipher.html#c.PSA_ALG_XTS" title="PSA_ALG_XTS"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_XTS</span></code></a></p></li>
</ul>
</td><td><ul class="simple">
<li><p><a class="reference internal" href="../ops/cipher.html#c.PSA_ALG_CBC_NO_PADDING" title="PSA_ALG_CBC_NO_PADDING"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_CBC_NO_PADDING</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/cipher.html#c.PSA_ALG_CBC_PKCS7" title="PSA_ALG_CBC_PKCS7"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_CBC_PKCS7</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/cipher.html#c.PSA_ALG_ECB_NO_PADDING" title="PSA_ALG_ECB_NO_PADDING"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ECB_NO_PADDING</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/aead.html#c.PSA_ALG_CCM" title="PSA_ALG_CCM"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_CCM</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/aead.html#c.PSA_ALG_GCM" title="PSA_ALG_GCM"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_GCM</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/key-derivation.html#c.PSA_ALG_SP800_108_COUNTER_CMAC" title="PSA_ALG_SP800_108_COUNTER_CMAC"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_SP800_108_COUNTER_CMAC</span></code></a> (secret input)</p></li>
</ul>
</td></tr></table>
<p class="rubric">Key format</p>
<p>The data format for import and export of the key is the raw bytes of the key.</p>
<p class="rubric">Key derivation</p>
<p>A call to <a class="reference internal" href="../ops/key-derivation.html#c.psa_key_derivation_output_key" title="psa_key_derivation_output_key"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_key_derivation_output_key()</span></code></a> will draw <span class="math notranslate nohighlight">\(m/8\)</span> bytes of output and use these as the key data, where <span class="math notranslate nohighlight">\(m\)</span> is the bit-size of the key.</p>
</section>
<section id="c.PSA_KEY_TYPE_ARIA">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_ARIA</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_ARIA" title="Link to this heading">¶</a></h3>
<p>Key for a cipher, AEAD or MAC algorithm based on the ARIA block cipher.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.1.</span></p>
</div>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_ARIA" title="PSA_KEY_TYPE_ARIA">PSA_KEY_TYPE_ARIA</a> ((<a class="reference internal" href="#c.psa_key_type_t" title="psa_key_type_t">psa_key_type_t</a>)0x2406)</pre>
<p>The size of the key is related to the ARIA algorithm variant. For algorithms except the XTS block cipher mode, the following key sizes are used:</p>
<ul class="simple">
<li><p>ARIA-128 uses a 16-byte key : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">128</span></code></p></li>
<li><p>ARIA-192 uses a 24-byte key : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">192</span></code></p></li>
<li><p>ARIA-256 uses a 32-byte key : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">256</span></code></p></li>
</ul>
<p>For the XTS block cipher mode (<a class="reference internal" href="../ops/cipher.html#c.PSA_ALG_XTS" title="PSA_ALG_XTS"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_XTS</span></code></a>), the following key sizes are used:</p>
<ul class="simple">
<li><p>ARIA-128-XTS uses two 16-byte keys : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">256</span></code></p></li>
<li><p>ARIA-192-XTS uses two 24-byte keys : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">384</span></code></p></li>
<li><p>ARIA-256-XTS uses two 32-byte keys : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">512</span></code></p></li>
</ul>
<p>The ARIA block cipher is defined in <span><em>A Description of the ARIA Encryption Algorithm</em> <a class="reference internal" href="../../about.html#cite-rfc5794"><span class="cite">[RFC5794]</span></a></span>.</p>
<p class="rubric">Compatible algorithms</p>
<table class="hlist"><tr><td><ul class="simple">
<li><p><a class="reference internal" href="../ops/mac.html#c.PSA_ALG_CBC_MAC" title="PSA_ALG_CBC_MAC"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_CBC_MAC</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/mac.html#c.PSA_ALG_CMAC" title="PSA_ALG_CMAC"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_CMAC</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/cipher.html#c.PSA_ALG_CTR" title="PSA_ALG_CTR"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_CTR</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/cipher.html#c.PSA_ALG_CFB" title="PSA_ALG_CFB"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_CFB</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/cipher.html#c.PSA_ALG_OFB" title="PSA_ALG_OFB"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_OFB</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/cipher.html#c.PSA_ALG_XTS" title="PSA_ALG_XTS"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_XTS</span></code></a></p></li>
</ul>
</td><td><ul class="simple">
<li><p><a class="reference internal" href="../ops/cipher.html#c.PSA_ALG_CBC_NO_PADDING" title="PSA_ALG_CBC_NO_PADDING"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_CBC_NO_PADDING</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/cipher.html#c.PSA_ALG_CBC_PKCS7" title="PSA_ALG_CBC_PKCS7"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_CBC_PKCS7</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/cipher.html#c.PSA_ALG_ECB_NO_PADDING" title="PSA_ALG_ECB_NO_PADDING"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ECB_NO_PADDING</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/aead.html#c.PSA_ALG_CCM" title="PSA_ALG_CCM"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_CCM</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/aead.html#c.PSA_ALG_GCM" title="PSA_ALG_GCM"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_GCM</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/key-derivation.html#c.PSA_ALG_SP800_108_COUNTER_CMAC" title="PSA_ALG_SP800_108_COUNTER_CMAC"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_SP800_108_COUNTER_CMAC</span></code></a> (secret input)</p></li>
</ul>
</td></tr></table>
<p class="rubric">Key format</p>
<p>The data format for import and export of the key is the raw bytes of the key.</p>
<p class="rubric">Key derivation</p>
<p>A call to <a class="reference internal" href="../ops/key-derivation.html#c.psa_key_derivation_output_key" title="psa_key_derivation_output_key"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_key_derivation_output_key()</span></code></a> will draw <span class="math notranslate nohighlight">\(m/8\)</span> bytes of output and use these as the key data, where <span class="math notranslate nohighlight">\(m\)</span> is the bit-size of the key.</p>
</section>
<section id="c.PSA_KEY_TYPE_DES">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_DES</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_DES" title="Link to this heading">¶</a></h3>
<p>Key for a cipher or MAC algorithm based on DES or 3DES (Triple-DES).</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_DES" title="PSA_KEY_TYPE_DES">PSA_KEY_TYPE_DES</a> ((<a class="reference internal" href="#c.psa_key_type_t" title="psa_key_type_t">psa_key_type_t</a>)0x2301)</pre>
<p>The size of the key determines which DES algorithm is used:</p>
<ul class="simple">
<li><p>Single DES uses an 8-byte key : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">64</span></code></p></li>
<li><p>2-key 3DES uses a 16-byte key : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">128</span></code></p></li>
<li><p>3-key 3DES uses a 24-byte key : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">192</span></code></p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Single DES and 2-key 3DES are weak and strongly deprecated and are only recommended for decrypting legacy data.</p>
<p>3-key 3DES is weak and deprecated and is only recommended for use in legacy applications.</p>
</div>
<p>The DES and 3DES block ciphers are defined in <span><em>NIST Special Publication 800-67: Recommendation for the Triple Data Encryption Algorithm (TDEA) Block Cipher</em> <a class="reference internal" href="../../about.html#cite-sp800-67"><span class="cite">[SP800-67]</span></a></span>.</p>
<p class="rubric">Compatible algorithms</p>
<table class="hlist"><tr><td><ul class="simple">
<li><p><a class="reference internal" href="../ops/mac.html#c.PSA_ALG_CBC_MAC" title="PSA_ALG_CBC_MAC"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_CBC_MAC</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/mac.html#c.PSA_ALG_CMAC" title="PSA_ALG_CMAC"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_CMAC</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/cipher.html#c.PSA_ALG_CTR" title="PSA_ALG_CTR"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_CTR</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/cipher.html#c.PSA_ALG_CFB" title="PSA_ALG_CFB"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_CFB</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/cipher.html#c.PSA_ALG_OFB" title="PSA_ALG_OFB"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_OFB</span></code></a></p></li>
</ul>
</td><td><ul class="simple">
<li><p><a class="reference internal" href="../ops/cipher.html#c.PSA_ALG_XTS" title="PSA_ALG_XTS"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_XTS</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/cipher.html#c.PSA_ALG_CBC_NO_PADDING" title="PSA_ALG_CBC_NO_PADDING"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_CBC_NO_PADDING</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/cipher.html#c.PSA_ALG_CBC_PKCS7" title="PSA_ALG_CBC_PKCS7"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_CBC_PKCS7</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/cipher.html#c.PSA_ALG_ECB_NO_PADDING" title="PSA_ALG_ECB_NO_PADDING"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ECB_NO_PADDING</span></code></a></p></li>
</ul>
</td></tr></table>
<p class="rubric">Key format</p>
<p>The data format for import and export of the key is the raw bytes of the key.
The parity bits in each 64-bit DES key element must be correct.</p>
<p class="rubric">Key derivation</p>
<p>A call to <a class="reference internal" href="../ops/key-derivation.html#c.psa_key_derivation_output_key" title="psa_key_derivation_output_key"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_key_derivation_output_key()</span></code></a> will construct a single 64-bit DES key using the following process:</p>
<ol class="arabic simple">
<li><p>Draw an 8-byte string.</p></li>
<li><p>Set/clear the parity bits in each byte.</p></li>
<li><p>If the result is a forbidden weak key, discard the result and return to step 1.</p></li>
<li><p>Output the string.</p></li>
</ol>
<p>For 2-key 3DES and 3-key 3DES, this process is repeated to derive the 2nd and 3rd keys, as required.</p>
</section>
<section id="c.PSA_KEY_TYPE_CAMELLIA">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_CAMELLIA</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_CAMELLIA" title="Link to this heading">¶</a></h3>
<p>Key for a cipher, AEAD or MAC algorithm based on the Camellia block cipher.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_CAMELLIA" title="PSA_KEY_TYPE_CAMELLIA">PSA_KEY_TYPE_CAMELLIA</a> ((<a class="reference internal" href="#c.psa_key_type_t" title="psa_key_type_t">psa_key_type_t</a>)0x2403)</pre>
<p>The size of the key is related to the Camellia algorithm variant. For algorithms except the XTS block cipher mode, the following key sizes are used:</p>
<ul class="simple">
<li><p>Camellia-128 uses a 16-byte key : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">128</span></code></p></li>
<li><p>Camellia-192 uses a 24-byte key : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">192</span></code></p></li>
<li><p>Camellia-256 uses a 32-byte key : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">256</span></code></p></li>
</ul>
<p>For the XTS block cipher mode (<a class="reference internal" href="../ops/cipher.html#c.PSA_ALG_XTS" title="PSA_ALG_XTS"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_XTS</span></code></a>), the following key sizes are used:</p>
<ul class="simple">
<li><p>Camellia-128-XTS uses two 16-byte keys : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">256</span></code></p></li>
<li><p>Camellia-192-XTS uses two 24-byte keys : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">384</span></code></p></li>
<li><p>Camellia-256-XTS uses two 32-byte keys : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">512</span></code></p></li>
</ul>
<p>The Camellia block cipher is defined in <span><em>Specification of Camellia — a 128-bit Block Cipher</em> <a class="reference internal" href="../../about.html#cite-ntt-cam"><span class="cite">[NTT-CAM]</span></a></span> and also described in <span><em>A Description of the Camellia Encryption Algorithm</em> <a class="reference internal" href="../../about.html#cite-rfc3713"><span class="cite">[RFC3713]</span></a></span>.</p>
<p class="rubric">Compatible algorithms</p>
<table class="hlist"><tr><td><ul class="simple">
<li><p><a class="reference internal" href="../ops/mac.html#c.PSA_ALG_CBC_MAC" title="PSA_ALG_CBC_MAC"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_CBC_MAC</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/mac.html#c.PSA_ALG_CMAC" title="PSA_ALG_CMAC"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_CMAC</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/cipher.html#c.PSA_ALG_CTR" title="PSA_ALG_CTR"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_CTR</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/cipher.html#c.PSA_ALG_CFB" title="PSA_ALG_CFB"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_CFB</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/cipher.html#c.PSA_ALG_OFB" title="PSA_ALG_OFB"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_OFB</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/cipher.html#c.PSA_ALG_XTS" title="PSA_ALG_XTS"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_XTS</span></code></a></p></li>
</ul>
</td><td><ul class="simple">
<li><p><a class="reference internal" href="../ops/cipher.html#c.PSA_ALG_CBC_NO_PADDING" title="PSA_ALG_CBC_NO_PADDING"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_CBC_NO_PADDING</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/cipher.html#c.PSA_ALG_CBC_PKCS7" title="PSA_ALG_CBC_PKCS7"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_CBC_PKCS7</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/cipher.html#c.PSA_ALG_ECB_NO_PADDING" title="PSA_ALG_ECB_NO_PADDING"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ECB_NO_PADDING</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/aead.html#c.PSA_ALG_CCM" title="PSA_ALG_CCM"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_CCM</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/aead.html#c.PSA_ALG_GCM" title="PSA_ALG_GCM"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_GCM</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/key-derivation.html#c.PSA_ALG_SP800_108_COUNTER_CMAC" title="PSA_ALG_SP800_108_COUNTER_CMAC"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_SP800_108_COUNTER_CMAC</span></code></a> (secret input)</p></li>
</ul>
</td></tr></table>
<p class="rubric">Key format</p>
<p>The data format for import and export of the key is the raw bytes of the key.</p>
<p class="rubric">Key derivation</p>
<p>A call to <a class="reference internal" href="../ops/key-derivation.html#c.psa_key_derivation_output_key" title="psa_key_derivation_output_key"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_key_derivation_output_key()</span></code></a> will draw <span class="math notranslate nohighlight">\(m/8\)</span> bytes of output and use these as the key data, where <span class="math notranslate nohighlight">\(m\)</span> is the bit-size of the key.</p>
</section>
<section id="c.PSA_KEY_TYPE_SM4">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_SM4</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_SM4" title="Link to this heading">¶</a></h3>
<p>Key for a cipher, AEAD or MAC algorithm based on the SM4 block cipher.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_SM4" title="PSA_KEY_TYPE_SM4">PSA_KEY_TYPE_SM4</a> ((<a class="reference internal" href="#c.psa_key_type_t" title="psa_key_type_t">psa_key_type_t</a>)0x2405)</pre>
<p>For algorithms except the XTS block cipher mode, the SM4 key size is 128 bits (16 bytes).</p>
<p>For the XTS block cipher mode (<a class="reference internal" href="../ops/cipher.html#c.PSA_ALG_XTS" title="PSA_ALG_XTS"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_XTS</span></code></a>), the SM4 key size is 256 bits (two 16-byte keys).</p>
<p>The SM4 block cipher is defined in <span><em>GM/T 0002-2012: SM4 block cipher algorithm</em> <a class="reference internal" href="../../about.html#cite-cstc0002"><span class="cite">[CSTC0002]</span></a></span>.</p>
<p class="rubric">Compatible algorithms</p>
<table class="hlist"><tr><td><ul class="simple">
<li><p><a class="reference internal" href="../ops/mac.html#c.PSA_ALG_CBC_MAC" title="PSA_ALG_CBC_MAC"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_CBC_MAC</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/mac.html#c.PSA_ALG_CMAC" title="PSA_ALG_CMAC"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_CMAC</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/cipher.html#c.PSA_ALG_CTR" title="PSA_ALG_CTR"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_CTR</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/cipher.html#c.PSA_ALG_CFB" title="PSA_ALG_CFB"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_CFB</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/cipher.html#c.PSA_ALG_OFB" title="PSA_ALG_OFB"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_OFB</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/cipher.html#c.PSA_ALG_XTS" title="PSA_ALG_XTS"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_XTS</span></code></a></p></li>
</ul>
</td><td><ul class="simple">
<li><p><a class="reference internal" href="../ops/cipher.html#c.PSA_ALG_CBC_NO_PADDING" title="PSA_ALG_CBC_NO_PADDING"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_CBC_NO_PADDING</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/cipher.html#c.PSA_ALG_CBC_PKCS7" title="PSA_ALG_CBC_PKCS7"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_CBC_PKCS7</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/cipher.html#c.PSA_ALG_ECB_NO_PADDING" title="PSA_ALG_ECB_NO_PADDING"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ECB_NO_PADDING</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/aead.html#c.PSA_ALG_CCM" title="PSA_ALG_CCM"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_CCM</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/aead.html#c.PSA_ALG_GCM" title="PSA_ALG_GCM"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_GCM</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/key-derivation.html#c.PSA_ALG_SP800_108_COUNTER_CMAC" title="PSA_ALG_SP800_108_COUNTER_CMAC"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_SP800_108_COUNTER_CMAC</span></code></a> (secret input)</p></li>
</ul>
</td></tr></table>
<p class="rubric">Key format</p>
<p>The data format for import and export of the key is the raw bytes of the key.</p>
<p class="rubric">Key derivation</p>
<p>A call to <a class="reference internal" href="../ops/key-derivation.html#c.psa_key_derivation_output_key" title="psa_key_derivation_output_key"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_key_derivation_output_key()</span></code></a> will draw <span class="math notranslate nohighlight">\(m/8\)</span> bytes of output and use these as the key data, where <span class="math notranslate nohighlight">\(m\)</span> is the bit-size of the key.</p>
</section>
<section id="c.PSA_KEY_TYPE_ARC4">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_ARC4</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_ARC4" title="Link to this heading">¶</a></h3>
<p>Key for the ARC4 stream cipher.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_ARC4" title="PSA_KEY_TYPE_ARC4">PSA_KEY_TYPE_ARC4</a> ((<a class="reference internal" href="#c.psa_key_type_t" title="psa_key_type_t">psa_key_type_t</a>)0x2002)</pre>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The ARC4 cipher is weak and deprecated and is only recommended for use in legacy applications.</p>
</div>
<p>The ARC4 cipher supports key sizes between 40 and 2048 bits, that are multiples of 8. (5 to 256 bytes)</p>
<p>Use algorithm <a class="reference internal" href="../ops/cipher.html#c.PSA_ALG_STREAM_CIPHER" title="PSA_ALG_STREAM_CIPHER"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_STREAM_CIPHER</span></code></a> to use this key with the ARC4 cipher.</p>
<p class="rubric">Compatible algorithms</p>
<table class="hlist"><tr><td><ul class="simple">
<li><p><a class="reference internal" href="../ops/cipher.html#c.PSA_ALG_STREAM_CIPHER" title="PSA_ALG_STREAM_CIPHER"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_STREAM_CIPHER</span></code></a></p></li>
</ul>
</td><td><ul class="simple">
</ul>
</td></tr></table>
<p class="rubric">Key format</p>
<p>The data format for import and export of the key is the raw bytes of the key.</p>
<p class="rubric">Key derivation</p>
<p>A call to <a class="reference internal" href="../ops/key-derivation.html#c.psa_key_derivation_output_key" title="psa_key_derivation_output_key"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_key_derivation_output_key()</span></code></a> will draw <span class="math notranslate nohighlight">\(m/8\)</span> bytes of output and use these as the key data, where <span class="math notranslate nohighlight">\(m\)</span> is the bit-size of the key.</p>
</section>
<section id="c.PSA_KEY_TYPE_CHACHA20">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_CHACHA20</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_CHACHA20" title="Link to this heading">¶</a></h3>
<p>Key for the ChaCha20 stream cipher or the ChaCha20-Poly1305 AEAD algorithm.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_CHACHA20" title="PSA_KEY_TYPE_CHACHA20">PSA_KEY_TYPE_CHACHA20</a> ((<a class="reference internal" href="#c.psa_key_type_t" title="psa_key_type_t">psa_key_type_t</a>)0x2004)</pre>
<p>The ChaCha20 key size is 256 bits (32 bytes).</p>
<ul class="simple">
<li><p>Use algorithm <a class="reference internal" href="../ops/cipher.html#c.PSA_ALG_STREAM_CIPHER" title="PSA_ALG_STREAM_CIPHER"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_STREAM_CIPHER</span></code></a> to use this key with the ChaCha20 cipher for unauthenticated encryption. See <a class="reference internal" href="../ops/cipher.html#c.PSA_ALG_STREAM_CIPHER" title="PSA_ALG_STREAM_CIPHER"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_STREAM_CIPHER</span></code></a> for details of this algorithm.</p></li>
<li><p>Use algorithm <a class="reference internal" href="../ops/aead.html#c.PSA_ALG_CHACHA20_POLY1305" title="PSA_ALG_CHACHA20_POLY1305"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_CHACHA20_POLY1305</span></code></a> to use this key with the ChaCha20 cipher and Poly1305 authenticator for AEAD. See <a class="reference internal" href="../ops/aead.html#c.PSA_ALG_CHACHA20_POLY1305" title="PSA_ALG_CHACHA20_POLY1305"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_CHACHA20_POLY1305</span></code></a> for details of this algorithm.</p></li>
</ul>
<p class="rubric">Compatible algorithms</p>
<table class="hlist"><tr><td><ul class="simple">
<li><p><a class="reference internal" href="../ops/cipher.html#c.PSA_ALG_STREAM_CIPHER" title="PSA_ALG_STREAM_CIPHER"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_STREAM_CIPHER</span></code></a></p></li>
</ul>
</td><td><ul class="simple">
<li><p><a class="reference internal" href="../ops/aead.html#c.PSA_ALG_CHACHA20_POLY1305" title="PSA_ALG_CHACHA20_POLY1305"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_CHACHA20_POLY1305</span></code></a></p></li>
</ul>
</td></tr></table>
<p class="rubric">Key format</p>
<p>The data format for import and export of the key is the raw bytes of the key.</p>
<p class="rubric">Key derivation</p>
<p>A call to <a class="reference internal" href="../ops/key-derivation.html#c.psa_key_derivation_output_key" title="psa_key_derivation_output_key"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_key_derivation_output_key()</span></code></a> will draw 32 bytes of output and use these as the key data.</p>
</section>
<section id="c.PSA_KEY_TYPE_XCHACHA20">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_XCHACHA20</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_XCHACHA20" title="Link to this heading">¶</a></h3>
<p>Key for the XChaCha20 stream cipher or the XChaCha20-Poly1305 AEAD algorithm.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.2.</span></p>
</div>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_XCHACHA20" title="PSA_KEY_TYPE_XCHACHA20">PSA_KEY_TYPE_XCHACHA20</a> ((<a class="reference internal" href="#c.psa_key_type_t" title="psa_key_type_t">psa_key_type_t</a>)0x2007)</pre>
<p>The XChaCha20 key size is 256 bits (32 bytes).</p>
<ul class="simple">
<li><p>Use algorithm <a class="reference internal" href="../ops/cipher.html#c.PSA_ALG_STREAM_CIPHER" title="PSA_ALG_STREAM_CIPHER"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_STREAM_CIPHER</span></code></a> to use this key with the XChaCha20 cipher for unauthenticated encryption. See <a class="reference internal" href="../ops/cipher.html#c.PSA_ALG_STREAM_CIPHER" title="PSA_ALG_STREAM_CIPHER"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_STREAM_CIPHER</span></code></a> for details of this algorithm.</p></li>
<li><p>Use algorithm <a class="reference internal" href="../ops/aead.html#c.PSA_ALG_XCHACHA20_POLY1305" title="PSA_ALG_XCHACHA20_POLY1305"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_XCHACHA20_POLY1305</span></code></a> to use this key with the XChaCha20 cipher and Poly1305 authenticator for AEAD. See <a class="reference internal" href="../ops/aead.html#c.PSA_ALG_XCHACHA20_POLY1305" title="PSA_ALG_XCHACHA20_POLY1305"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_XCHACHA20_POLY1305</span></code></a> for details of this algorithm.</p></li>
</ul>
<p class="rubric">Compatible algorithms</p>
<table class="hlist"><tr><td><ul class="simple">
<li><p><a class="reference internal" href="../ops/cipher.html#c.PSA_ALG_STREAM_CIPHER" title="PSA_ALG_STREAM_CIPHER"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_STREAM_CIPHER</span></code></a></p></li>
</ul>
</td><td><ul class="simple">
<li><p><a class="reference internal" href="../ops/aead.html#c.PSA_ALG_XCHACHA20_POLY1305" title="PSA_ALG_XCHACHA20_POLY1305"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_XCHACHA20_POLY1305</span></code></a></p></li>
</ul>
</td></tr></table>
<p class="rubric">Key format</p>
<p>The data format for import and export of the key is the raw bytes of the key.</p>
<p class="rubric">Key derivation</p>
<p>A call to <a class="reference internal" href="../ops/key-derivation.html#c.psa_key_derivation_output_key" title="psa_key_derivation_output_key"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_key_derivation_output_key()</span></code></a> will draw 32 bytes of output and use these as the key data.</p>
</section>
</section>
<section id="asymmetric-keys">
<span id="id3"></span><h2><span class="section-number">9.2.4 </span>Asymmetric keys<a class="headerlink" href="#asymmetric-keys" title="Link to this heading">¶</a></h2>
<p>The Crypto API defines the following types of asymmetric key:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#rsa-keys"><span class="secref">RSA keys</span></a></p></li>
<li><p><a class="reference internal" href="#ecc-keys"><span class="secref">Elliptic Curve keys</span></a></p></li>
<li><p><a class="reference internal" href="#dh-keys"><span class="secref">Diffie Hellman keys</span></a></p></li>
<li><p><a class="reference internal" href="#spake2p-keys"><span class="secref">SPAKE2+ keys</span></a></p></li>
</ul>
</section>
<section id="rsa-keys">
<span id="id4"></span><h2><span class="section-number">9.2.5 </span>RSA keys<a class="headerlink" href="#rsa-keys" title="Link to this heading">¶</a></h2>
<section id="c.PSA_KEY_TYPE_RSA_KEY_PAIR">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_RSA_KEY_PAIR</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_RSA_KEY_PAIR" title="Link to this heading">¶</a></h3>
<p>RSA key pair: both the private and public key.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_RSA_KEY_PAIR" title="PSA_KEY_TYPE_RSA_KEY_PAIR">PSA_KEY_TYPE_RSA_KEY_PAIR</a> ((<a class="reference internal" href="#c.psa_key_type_t" title="psa_key_type_t">psa_key_type_t</a>)0x7001)</pre>
<p>The size of an RSA key is the bit size of the modulus.</p>
<p class="rubric">Compatible algorithms</p>
<table class="hlist"><tr><td><ul class="simple">
<li><p><a class="reference internal" href="../ops/pk-encryption.html#c.PSA_ALG_RSA_OAEP" title="PSA_ALG_RSA_OAEP"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_RSA_OAEP</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/pk-encryption.html#c.PSA_ALG_RSA_PKCS1V15_CRYPT" title="PSA_ALG_RSA_PKCS1V15_CRYPT"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_RSA_PKCS1V15_CRYPT</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/signature.html#c.PSA_ALG_RSA_PKCS1V15_SIGN" title="PSA_ALG_RSA_PKCS1V15_SIGN"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_RSA_PKCS1V15_SIGN</span></code></a></p></li>
</ul>
</td><td><ul class="simple">
<li><p><a class="reference internal" href="../ops/signature.html#c.PSA_ALG_RSA_PKCS1V15_SIGN_RAW" title="PSA_ALG_RSA_PKCS1V15_SIGN_RAW"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_RSA_PKCS1V15_SIGN_RAW</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/signature.html#c.PSA_ALG_RSA_PSS" title="PSA_ALG_RSA_PSS"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_RSA_PSS</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/signature.html#c.PSA_ALG_RSA_PSS_ANY_SALT" title="PSA_ALG_RSA_PSS_ANY_SALT"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_RSA_PSS_ANY_SALT</span></code></a></p></li>
</ul>
</td></tr></table>
<p class="rubric">Key format</p>
<p>The data format for import and export of a key-pair is the non-encrypted DER encoding of the representation defined by in <span><em>PKCS #1: RSA Cryptography Specifications Version 2.2</em> <a class="reference internal" href="../../about.html#cite-rfc8017"><span class="cite">[RFC8017]</span></a></span> as <code class="docutils literal notranslate"><span class="pre">RSAPrivateKey</span></code>, version <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>RSAPrivateKey ::= SEQUENCE {
    version             INTEGER,  -- must be 0
    modulus             INTEGER,  -- n
    publicExponent      INTEGER,  -- e
    privateExponent     INTEGER,  -- d
    prime1              INTEGER,  -- p
    prime2              INTEGER,  -- q
    exponent1           INTEGER,  -- d mod (p-1)
    exponent2           INTEGER,  -- d mod (q-1)
    coefficient         INTEGER,  -- (inverse of q) mod p
}
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although it is possible to define an RSA key pair or private key using a subset of these elements, the output from <a class="reference internal" href="management.html#c.psa_export_key" title="psa_export_key"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_export_key()</span></code></a> for an RSA key pair must include all of these elements.</p>
</div>
<p>See <a class="reference internal" href="#c.PSA_KEY_TYPE_RSA_PUBLIC_KEY" title="PSA_KEY_TYPE_RSA_PUBLIC_KEY"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_RSA_PUBLIC_KEY</span></code></a> for the data format used when exporting the public key with <a class="reference internal" href="management.html#c.psa_export_public_key" title="psa_export_public_key"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_export_public_key()</span></code></a>.</p>
<p class="rubric">Key generation</p>
<p>A call to <a class="reference internal" href="management.html#c.psa_generate_key" title="psa_generate_key"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_generate_key()</span></code></a> will generate an RSA key-pair with the default public exponent of <code class="docutils literal notranslate"><span class="pre">65537</span></code>. The modulus <span class="math notranslate nohighlight">\(n=pq\)</span> is a product of two probabilistic primes <span class="math notranslate nohighlight">\(p\ \text{and}\ q\)</span>, where <span class="math notranslate nohighlight">\(2^{r-1} \le n &lt; 2^r\)</span> and <span class="math notranslate nohighlight">\(r\)</span> is the bit size specified in the attributes.</p>
<p>The exponent can be explicitly specified in non-default production parameters in a call to <a class="reference internal" href="management.html#c.psa_generate_key_custom" title="psa_generate_key_custom"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_generate_key_custom()</span></code></a>. Use the following custom production parameters:</p>
<ul>
<li><p>The production parameters structure, <code class="docutils literal notranslate"><span class="pre">custom</span></code>, must have <code class="docutils literal notranslate"><span class="pre">flags</span></code> set to zero.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">custom_data_length</span> <span class="pre">==</span> <span class="pre">0</span></code>, the default exponent value <code class="docutils literal notranslate"><span class="pre">65537</span></code> is used.</p></li>
<li><p>The additional production parameter buffer <code class="docutils literal notranslate"><span class="pre">custom_data</span></code> is the public exponent, in little-endian byte order.</p>
<p>The exponent must be an odd integer greater than <code class="docutils literal notranslate"><span class="pre">1</span></code>.
An implementation must support an exponent of <code class="docutils literal notranslate"><span class="pre">65537</span></code>, and is recommended to support an exponent of <code class="docutils literal notranslate"><span class="pre">3</span></code>, and can support other values.</p>
<p>The maximum supported exponent value is <a class="reference internal" href="../../about.html#term-implementation-defined"><span class="scterm">implementation defined</span></a>.</p>
</li>
</ul>
<p class="rubric">Key derivation</p>
<p>The method used by <a class="reference internal" href="../ops/key-derivation.html#c.psa_key_derivation_output_key" title="psa_key_derivation_output_key"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_key_derivation_output_key()</span></code></a> to derive an RSA key-pair is <a class="reference internal" href="../../about.html#term-implementation-defined"><span class="term">implementation defined</span></a>.</p>
</section>
<section id="c.PSA_KEY_TYPE_RSA_PUBLIC_KEY">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_RSA_PUBLIC_KEY</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_RSA_PUBLIC_KEY" title="Link to this heading">¶</a></h3>
<p>RSA public key.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_RSA_PUBLIC_KEY" title="PSA_KEY_TYPE_RSA_PUBLIC_KEY">PSA_KEY_TYPE_RSA_PUBLIC_KEY</a> ((<a class="reference internal" href="#c.psa_key_type_t" title="psa_key_type_t">psa_key_type_t</a>)0x4001)</pre>
<p>The size of an RSA key is the bit size of the modulus.</p>
<p class="rubric">Compatible algorithms</p>
<table class="hlist"><tr><td><ul class="simple">
<li><p><a class="reference internal" href="../ops/pk-encryption.html#c.PSA_ALG_RSA_OAEP" title="PSA_ALG_RSA_OAEP"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_RSA_OAEP</span></code></a> (encryption only)</p></li>
<li><p><a class="reference internal" href="../ops/pk-encryption.html#c.PSA_ALG_RSA_PKCS1V15_CRYPT" title="PSA_ALG_RSA_PKCS1V15_CRYPT"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_RSA_PKCS1V15_CRYPT</span></code></a> (encryption only)</p></li>
<li><p><a class="reference internal" href="../ops/signature.html#c.PSA_ALG_RSA_PKCS1V15_SIGN" title="PSA_ALG_RSA_PKCS1V15_SIGN"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_RSA_PKCS1V15_SIGN</span></code></a> (signature verification only)</p></li>
<li><p><a class="reference internal" href="../ops/signature.html#c.PSA_ALG_RSA_PKCS1V15_SIGN_RAW" title="PSA_ALG_RSA_PKCS1V15_SIGN_RAW"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_RSA_PKCS1V15_SIGN_RAW</span></code></a> (signature verification only)</p></li>
<li><p><a class="reference internal" href="../ops/signature.html#c.PSA_ALG_RSA_PSS" title="PSA_ALG_RSA_PSS"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_RSA_PSS</span></code></a> (signature verification only)</p></li>
<li><p><a class="reference internal" href="../ops/signature.html#c.PSA_ALG_RSA_PSS_ANY_SALT" title="PSA_ALG_RSA_PSS_ANY_SALT"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_RSA_PSS_ANY_SALT</span></code></a> (signature verification only)</p></li>
</ul>
</td></tr></table>
<p class="rubric">Key format</p>
<p>The data format for import and export of a public key is the DER encoding of the representation defined by <span><em>Algorithms and Identifiers for the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</em> <a class="reference internal" href="../../about.html#cite-rfc3279"><span class="cite">[RFC3279]</span></a></span> <a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc3279.html#section-2.3.1">§2.3.1</a> as <code class="docutils literal notranslate"><span class="pre">RSAPublicKey</span></code>.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>RSAPublicKey ::= SEQUENCE {
    modulus            INTEGER,    -- n
    publicExponent     INTEGER  }  -- e
</pre></div>
</div>
</section>
<section id="c.PSA_KEY_TYPE_IS_RSA">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_IS_RSA</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_IS_RSA" title="Link to this heading">¶</a></h3>
<p>Whether a key type is an RSA key. This includes both key pairs and public keys.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_IS_RSA" title="PSA_KEY_TYPE_IS_RSA">PSA_KEY_TYPE_IS_RSA</a>(type) <em><a class="reference internal" href="../../overview/implementation.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">type</span></code></p>
</dt><dd><p>A key type: a value of type <a class="reference internal" href="#c.psa_key_type_t" title="psa_key_type_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_key_type_t</span></code></a>.</p>
</dd>
</dl>
</div>
</section>
</section>
<section id="elliptic-curve-keys">
<span id="ecc-keys"></span><h2><span class="section-number">9.2.6 </span>Elliptic Curve keys<a class="headerlink" href="#elliptic-curve-keys" title="Link to this heading">¶</a></h2>
<p>Elliptic curve keys are grouped into families of related curves.
A keys for a specific curve is specified by a combination of the elliptic curve family and the bit-size of the key.</p>
<p>There are three categories of elliptic curve key, shown in <span><a class="reference internal" href="#tab-ecc-groups"><span class="numref">Table 5</span></a></span>.
The curve type affects the key format, the key-derivation procedure, and the algorithms which the key can be used with.</p>
<table class="docutils align-left" id="tab-ecc-groups">
<caption><span class="caption-number">Table 5 </span><span class="caption-text">Types of elliptic curve key</span><a class="headerlink" href="#tab-ecc-groups" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Curve type</p></th>
<th class="head"><p>Curve families</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Weierstrass</p></td>
<td><p><a class="reference internal" href="#c.PSA_ECC_FAMILY_SECP_K1" title="PSA_ECC_FAMILY_SECP_K1"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_SECP_K1</span></code></a></p>
<p><a class="reference internal" href="#c.PSA_ECC_FAMILY_SECP_R1" title="PSA_ECC_FAMILY_SECP_R1"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_SECP_R1</span></code></a></p>
<p><a class="reference internal" href="#c.PSA_ECC_FAMILY_SECP_R2" title="PSA_ECC_FAMILY_SECP_R2"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_SECP_R2</span></code></a></p>
<p><a class="reference internal" href="#c.PSA_ECC_FAMILY_SECT_K1" title="PSA_ECC_FAMILY_SECT_K1"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_SECT_K1</span></code></a></p>
<p><a class="reference internal" href="#c.PSA_ECC_FAMILY_SECT_R1" title="PSA_ECC_FAMILY_SECT_R1"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_SECT_R1</span></code></a></p>
<p><a class="reference internal" href="#c.PSA_ECC_FAMILY_SECT_R2" title="PSA_ECC_FAMILY_SECT_R2"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_SECT_R2</span></code></a></p>
<p><a class="reference internal" href="#c.PSA_ECC_FAMILY_BRAINPOOL_P_R1" title="PSA_ECC_FAMILY_BRAINPOOL_P_R1"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_BRAINPOOL_P_R1</span></code></a></p>
<p><a class="reference internal" href="#c.PSA_ECC_FAMILY_FRP" title="PSA_ECC_FAMILY_FRP"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_FRP</span></code></a></p>
</td>
</tr>
<tr class="row-odd"><td><p>Montgomery</p></td>
<td><p><a class="reference internal" href="#c.PSA_ECC_FAMILY_MONTGOMERY" title="PSA_ECC_FAMILY_MONTGOMERY"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_MONTGOMERY</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>Twisted Edwards</p></td>
<td><p><a class="reference internal" href="#c.PSA_ECC_FAMILY_TWISTED_EDWARDS" title="PSA_ECC_FAMILY_TWISTED_EDWARDS"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_TWISTED_EDWARDS</span></code></a></p></td>
</tr>
</tbody>
</table>
<section id="c.psa_ecc_family_t">
<h3><code class="docutils literal notranslate"><span class="pre">psa_ecc_family_t</span></code> (typedef)<a class="headerlink" href="#c.psa_ecc_family_t" title="Link to this heading">¶</a></h3>
<p>The type of identifiers of an elliptic curve family.</p>
<pre class="literal-block">typedef uint8_t <a class="reference internal" href="#c.psa_ecc_family_t" title="psa_ecc_family_t">psa_ecc_family_t</a>;</pre>
<p>The curve identifier is required to create an ECC key using the <a class="reference internal" href="#c.PSA_KEY_TYPE_ECC_KEY_PAIR" title="PSA_KEY_TYPE_ECC_KEY_PAIR"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_ECC_KEY_PAIR()</span></code></a> or <a class="reference internal" href="#c.PSA_KEY_TYPE_ECC_PUBLIC_KEY" title="PSA_KEY_TYPE_ECC_PUBLIC_KEY"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_ECC_PUBLIC_KEY()</span></code></a> macros.</p>
<p>The specific ECC curve within a family is identified by the <code class="docutils literal notranslate"><span class="pre">key_bits</span></code> attribute of the key.</p>
<p>The range of elliptic curve family identifier values is divided as follows:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">0x00</span></code></dt><dd><p>Reserved.
Not allocated to an ECC family.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">0x01</span> <span class="pre">-</span> <span class="pre">0x7f</span></code></dt><dd><p>ECC family identifiers defined by this standard.
Unallocated values in this range are reserved for future use.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">0x80</span> <span class="pre">-</span> <span class="pre">0xff</span></code></dt><dd><p>Invalid.
Values in this range must not be used.</p>
</dd>
</dl>
<p>The least significant bit of a elliptic curve family identifier is a parity bit for the whole key type.
See <a class="reference internal" href="../../appendix/encodings.html#asymmetric-key-encoding"><span class="secref">Asymmetric key encoding</span></a> for details of the encoding of asymmetric key types.</p>
<div class="admonition-implementation-note admonition">
<p class="admonition-title">Implementation note</p>
<p>To provide other elliptic curve families, it is recommended that an implementation defines a key type with bit 15 set, which indicates an <a class="reference internal" href="../../about.html#term-implementation-defined"><span class="scterm">implementation defined</span></a> key type.</p>
</div>
</section>
<section id="c.PSA_KEY_TYPE_ECC_KEY_PAIR">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_ECC_KEY_PAIR</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_ECC_KEY_PAIR" title="Link to this heading">¶</a></h3>
<p>Elliptic curve key pair: both the private and public key.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_ECC_KEY_PAIR" title="PSA_KEY_TYPE_ECC_KEY_PAIR">PSA_KEY_TYPE_ECC_KEY_PAIR</a>(curve) <em><a class="reference internal" href="../../overview/implementation.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">curve</span></code></p>
</dt><dd><p>A value of type <a class="reference internal" href="#c.psa_ecc_family_t" title="psa_ecc_family_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_ecc_family_t</span></code></a> that identifies the ECC curve family to be used.</p>
</dd>
</dl>
</div>
<p class="rubric">Description</p>
<p>The size of an elliptic curve key is the bit size associated with the curve, that is, the bit size of <span class="math notranslate nohighlight">\(q`\)</span> for a curve over a field <span class="math notranslate nohighlight">\(\mathbb{F}_q\)</span>.
See the documentation of each elliptic curve family for details.</p>
<p class="rubric">Compatible algorithms</p>
<p><span><a class="reference internal" href="#tab-ecc-key-pair-algorithms"><span class="numref">Table 6</span></a></span> shows the compatible algorithms for each type of elliptic curve key-pair.</p>
<table class="longtable docutils align-default" id="tab-ecc-key-pair-algorithms">
<caption><span class="caption-number">Table 6 </span><span class="caption-text">Compatible algorithms for elliptic curve key-pairs</span><a class="headerlink" href="#tab-ecc-key-pair-algorithms" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Curve type</p></th>
<th class="head"><p>Compatible algorithms</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Weierstrass</p></td>
<td><p>Weierstrass curve key-pairs can be used in asymmetric signature, key-agreement, and key-encapsulation algorithms.</p>
<p><a class="reference internal" href="../ops/signature.html#c.PSA_ALG_DETERMINISTIC_ECDSA" title="PSA_ALG_DETERMINISTIC_ECDSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_DETERMINISTIC_ECDSA</span></code></a></p>
<p><a class="reference internal" href="../ops/signature.html#c.PSA_ALG_ECDSA" title="PSA_ALG_ECDSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ECDSA</span></code></a></p>
<p><a class="reference internal" href="../ops/signature.html#c.PSA_ALG_ECDSA_ANY" title="PSA_ALG_ECDSA_ANY"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ECDSA_ANY</span></code></a></p>
<p><a class="reference internal" href="../ops/key-agreement.html#c.PSA_ALG_ECDH" title="PSA_ALG_ECDH"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ECDH</span></code></a></p>
<p><a class="reference internal" href="../ops/key-encapsulation.html#c.PSA_ALG_ECIES_SEC1" title="PSA_ALG_ECIES_SEC1"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ECIES_SEC1</span></code></a></p>
</td>
</tr>
<tr class="row-odd"><td><p>Montgomery</p></td>
<td><p>Montgomery curve key-pairs can be used in key-agreement and key-encapsulation algorithms.</p>
<p><a class="reference internal" href="../ops/key-agreement.html#c.PSA_ALG_ECDH" title="PSA_ALG_ECDH"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ECDH</span></code></a></p>
<p><a class="reference internal" href="../ops/key-encapsulation.html#c.PSA_ALG_ECIES_SEC1" title="PSA_ALG_ECIES_SEC1"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ECIES_SEC1</span></code></a></p>
</td>
</tr>
<tr class="row-even"><td><p>Twisted Edwards</p></td>
<td><p>Twisted Edwards curve key-pairs can only be used in asymmetric signature algorithms.</p>
<p><a class="reference internal" href="../ops/signature.html#c.PSA_ALG_PURE_EDDSA" title="PSA_ALG_PURE_EDDSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_PURE_EDDSA</span></code></a></p>
<p><a class="reference internal" href="../ops/signature.html#c.PSA_ALG_ED25519PH" title="PSA_ALG_ED25519PH"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ED25519PH</span></code></a> (Edwards25519 only)</p>
<p><a class="reference internal" href="../ops/signature.html#c.PSA_ALG_ED448PH" title="PSA_ALG_ED448PH"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ED448PH</span></code></a> (Edwards448 only)</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Key format</p>
<p>The data format for import and export of the key-pair depends on the type of elliptic curve.
<span><a class="reference internal" href="#tab-ecc-key-pair-format"><span class="numref">Table 7</span></a></span> shows the format for each type of elliptic curve key-pair.</p>
<p>See <a class="reference internal" href="#c.PSA_KEY_TYPE_ECC_PUBLIC_KEY" title="PSA_KEY_TYPE_ECC_PUBLIC_KEY"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_ECC_PUBLIC_KEY</span></code></a> for the data format used when exporting the public key with <a class="reference internal" href="management.html#c.psa_export_public_key" title="psa_export_public_key"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_export_public_key()</span></code></a>.</p>
<table class="longtable docutils align-default" id="tab-ecc-key-pair-format">
<caption><span class="caption-number">Table 7 </span><span class="caption-text">Key-pair formats for elliptic curve keys</span><a class="headerlink" href="#tab-ecc-key-pair-format" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Curve type</p></th>
<th class="head"><p>Key-pair format</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Weierstrass</p></td>
<td><p>The key data is the content of the <code class="docutils literal notranslate"><span class="pre">privateKey</span></code> field of the <code class="docutils literal notranslate"><span class="pre">ECPrivateKey</span></code> format defined by <span><em>Elliptic Curve Private Key Structure</em> <a class="reference internal" href="../../about.html#cite-rfc5915"><span class="cite">[RFC5915]</span></a></span>.</p>
<p>This is a <span class="math notranslate nohighlight">\(\lceil{m/8}\rceil\)</span>-byte string in big-endian order, where <span class="math notranslate nohighlight">\(m\)</span> is the key size in bits.</p>
</td>
</tr>
<tr class="row-odd"><td><p>Montgomery</p></td>
<td><p>The key data is the scalar value of the ‘private key’ in little-endian order as defined by <span><em>Elliptic Curves for Security</em> <a class="reference internal" href="../../about.html#cite-rfc7748"><span class="cite">[RFC7748]</span></a></span> <a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc7748.html#section-6">§6</a>.
The value must have the forced bits set to zero or one as specified by <code class="docutils literal notranslate"><span class="pre">decodeScalar25519()</span></code> and <code class="docutils literal notranslate"><span class="pre">decodeScalar448()</span></code> in <a class="reference internal" href="../../about.html#cite-rfc7748"><span class="cite">[RFC7748]</span></a> <a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc7748.html#section-5">§5</a>.</p>
<p>This is a <span class="math notranslate nohighlight">\(\lceil{m/8}\rceil\)</span>-byte string where <span class="math notranslate nohighlight">\(m\)</span> is the key size in bits.
This is 32 bytes for Curve25519, and 56 bytes for Curve448.</p>
</td>
</tr>
<tr class="row-even"><td><p>Twisted Edwards</p></td>
<td><p>The key data is the private key, as defined by <span><em>Edwards-Curve Digital Signature Algorithm (EdDSA)</em> <a class="reference internal" href="../../about.html#cite-rfc8032"><span class="cite">[RFC8032]</span></a></span>.</p>
<p>This is a 32-byte string for Edwards25519, and a 57-byte string for Edwards448.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Key derivation</p>
<p>The key-derivation method used when calling <a class="reference internal" href="../ops/key-derivation.html#c.psa_key_derivation_output_key" title="psa_key_derivation_output_key"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_key_derivation_output_key()</span></code></a> depends on the type of elliptic curve.
<span><a class="reference internal" href="#tab-ecc-key-derivation"><span class="numref">Table 8</span></a></span> shows the derivation method for each type of elliptic curve key.</p>
<table class="longtable docutils align-default" id="tab-ecc-key-derivation">
<caption><span class="caption-number">Table 8 </span><span class="caption-text">Key derivation for elliptic curve keys</span><a class="headerlink" href="#tab-ecc-key-derivation" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Curve type</p></th>
<th class="head"><p>Key derivation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Weierstrass</p></td>
<td><p>A Weierstrass elliptic curve private key is <span class="math notranslate nohighlight">\(d \in [1, N - 1]\)</span>, where <span class="math notranslate nohighlight">\(N\)</span> is the order of the curve’s base point for ECC.</p>
<p>Let <span class="math notranslate nohighlight">\(m\)</span> be the bit size of <span class="math notranslate nohighlight">\(N\)</span>, such that <span class="math notranslate nohighlight">\(2^{m-1} \leq N &lt; 2^m\)</span>. This function generates the private key using the following process:</p>
<ol class="arabic simple">
<li><p>Draw a byte string of length <span class="math notranslate nohighlight">\(\lceil{m/8}\rceil\)</span> bytes.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(m\)</span> is not a multiple of 8, set the most significant <span class="math notranslate nohighlight">\(8 * \lceil{m/8}\rceil - m`\)</span> bits of the first byte in the string to zero.</p></li>
<li><p>Convert the string to integer <span class="math notranslate nohighlight">\(k\)</span> by decoding it as a big-endian byte-string.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(k &gt; N-2\)</span>, discard the result and return to step 1.</p></li>
<li><p>Output <span class="math notranslate nohighlight">\(d = k + 1\)</span> as the private key.</p></li>
</ol>
<p>This method allows compliance to NIST standards, specifically the methods titled <em>Key-Pair Generation by Testing Candidates</em> in <a class="reference internal" href="../../about.html#cite-sp800-56a"><span class="cite">[SP800-56A]</span></a> §5.6.1.2.2 or <span><em>FIPS Publication 186-4: Digital Signature Standard (DSS)</em> <a class="reference internal" href="../../about.html#cite-fips186-4"><span class="cite">[FIPS186-4]</span></a></span> §B.4.2.</p>
</td>
</tr>
<tr class="row-odd"><td><p>Montgomery</p></td>
<td><p>Draw a byte string whose length is determined by the curve, and set the mandatory bits accordingly.
That is:</p>
<ul class="simple">
<li><p>Curve25519 (<a class="reference internal" href="#c.PSA_ECC_FAMILY_MONTGOMERY" title="PSA_ECC_FAMILY_MONTGOMERY"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_MONTGOMERY</span></code></a>, 255 bits): draw a 32-byte string and process it as specified in <span><em>Elliptic Curves for Security</em> <a class="reference internal" href="../../about.html#cite-rfc7748"><span class="cite">[RFC7748]</span></a></span> <a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc7748.html#section-5">§5</a>.</p></li>
<li><p>Curve448 (<a class="reference internal" href="#c.PSA_ECC_FAMILY_MONTGOMERY" title="PSA_ECC_FAMILY_MONTGOMERY"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_MONTGOMERY</span></code></a>, 448 bits): draw a 56-byte string and process it as specified in <a class="reference internal" href="../../about.html#cite-rfc7748"><span class="cite">[RFC7748]</span></a> <a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc7748.html#section-5">§5</a>.</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>Twisted Edwards</p></td>
<td><p>Draw a byte string whose length is determined by the curve, and use this as the private key.
That is:</p>
<ul class="simple">
<li><p>Ed25519 (<a class="reference internal" href="#c.PSA_ECC_FAMILY_MONTGOMERY" title="PSA_ECC_FAMILY_MONTGOMERY"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_MONTGOMERY</span></code></a>, 255 bits): draw a 32-byte string.</p></li>
<li><p>Ed448 (<a class="reference internal" href="#c.PSA_ECC_FAMILY_MONTGOMERY" title="PSA_ECC_FAMILY_MONTGOMERY"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_MONTGOMERY</span></code></a>, 448 bits): draw a 57-byte string.</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
</section>
<section id="c.PSA_KEY_TYPE_ECC_PUBLIC_KEY">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_ECC_PUBLIC_KEY</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_ECC_PUBLIC_KEY" title="Link to this heading">¶</a></h3>
<p>Elliptic curve public key.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_ECC_PUBLIC_KEY" title="PSA_KEY_TYPE_ECC_PUBLIC_KEY">PSA_KEY_TYPE_ECC_PUBLIC_KEY</a>(curve) <em><a class="reference internal" href="../../overview/implementation.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">curve</span></code></p>
</dt><dd><p>A value of type <a class="reference internal" href="#c.psa_ecc_family_t" title="psa_ecc_family_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_ecc_family_t</span></code></a> that identifies the ECC curve family to be used.</p>
</dd>
</dl>
</div>
<p class="rubric">Description</p>
<p>The size of an elliptic curve public key is the same as the corresponding private key. See <a class="reference internal" href="#c.PSA_KEY_TYPE_ECC_KEY_PAIR" title="PSA_KEY_TYPE_ECC_KEY_PAIR"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_ECC_KEY_PAIR()</span></code></a> and the documentation of each elliptic curve family for details.</p>
<p class="rubric">Compatible algorithms</p>
<p><span><a class="reference internal" href="#tab-ecc-public-key-algorithms"><span class="numref">Table 9</span></a></span> shows the compatible algorithms for each type of elliptic curve public key.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For key agreement, the public key of the peer is provided to the Crypto API as a buffer.
This avoids the need to import the public-key data that is received from the peer, just to carry out the key-agreement algorithm.</p>
</div>
<table class="longtable docutils align-default" id="tab-ecc-public-key-algorithms">
<caption><span class="caption-number">Table 9 </span><span class="caption-text">Compatible algorithms for elliptic curve public keys</span><a class="headerlink" href="#tab-ecc-public-key-algorithms" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Curve type</p></th>
<th class="head"><p>Compatible algorithms</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Weierstrass</p></td>
<td><p>Weierstrass curve public keys can be used in asymmetric signature and key-encapsulation algorithms.</p>
<p><a class="reference internal" href="../ops/signature.html#c.PSA_ALG_DETERMINISTIC_ECDSA" title="PSA_ALG_DETERMINISTIC_ECDSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_DETERMINISTIC_ECDSA</span></code></a></p>
<p><a class="reference internal" href="../ops/signature.html#c.PSA_ALG_ECDSA" title="PSA_ALG_ECDSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ECDSA</span></code></a></p>
<p><a class="reference internal" href="../ops/signature.html#c.PSA_ALG_ECDSA_ANY" title="PSA_ALG_ECDSA_ANY"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ECDSA_ANY</span></code></a></p>
<p><a class="reference internal" href="../ops/key-encapsulation.html#c.PSA_ALG_ECIES_SEC1" title="PSA_ALG_ECIES_SEC1"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ECIES_SEC1</span></code></a></p>
</td>
</tr>
<tr class="row-odd"><td><p>Montgomery</p></td>
<td><p>Montgomery curve public keys can only be used in key-encapsulation algorithms.</p>
<p><a class="reference internal" href="../ops/key-encapsulation.html#c.PSA_ALG_ECIES_SEC1" title="PSA_ALG_ECIES_SEC1"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ECIES_SEC1</span></code></a></p>
</td>
</tr>
<tr class="row-even"><td><p>Twisted Edwards</p></td>
<td><p>Twisted Edwards curve public keys can only be used in asymmetric signature algorithms.</p>
<p><a class="reference internal" href="../ops/signature.html#c.PSA_ALG_PURE_EDDSA" title="PSA_ALG_PURE_EDDSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_PURE_EDDSA</span></code></a></p>
<p><a class="reference internal" href="../ops/signature.html#c.PSA_ALG_ED25519PH" title="PSA_ALG_ED25519PH"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ED25519PH</span></code></a> (Edwards25519 only)</p>
<p><a class="reference internal" href="../ops/signature.html#c.PSA_ALG_ED448PH" title="PSA_ALG_ED448PH"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ED448PH</span></code></a> (Edwards448 only)</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Key format</p>
<p>The data format for import and export of the public key depends on the type of elliptic curve.
<span><a class="reference internal" href="#tab-ecc-public-key-format"><span class="numref">Table 10</span></a></span> shows the format for each type of elliptic curve public key.</p>
<table class="longtable docutils align-default" id="tab-ecc-public-key-format">
<caption><span class="caption-number">Table 10 </span><span class="caption-text">Public-key formats for elliptic curve keys</span><a class="headerlink" href="#tab-ecc-public-key-format" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Curve type</p></th>
<th class="head"><p>Public-key format</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Weierstrass</p></td>
<td><p>The key data is the uncompressed representation of an elliptic curve point as an octet string defined in <span><em>SEC 1: Elliptic Curve Cryptography</em> <a class="reference internal" href="../../about.html#cite-sec1"><span class="cite">[SEC1]</span></a></span> §2.3.3.
If <span class="math notranslate nohighlight">\(m\)</span> is the bit size associated with the curve, i.e. the bit size of <span class="math notranslate nohighlight">\(q\)</span> for a curve over <span class="math notranslate nohighlight">\(\mathbb{F}_q\)</span>, then the representation of point <span class="math notranslate nohighlight">\(P\)</span> consists of:</p>
<ul class="simple">
<li><p>The byte <code class="docutils literal notranslate"><span class="pre">0x04</span></code>;</p></li>
<li><p><span class="math notranslate nohighlight">\(x_P\)</span> as a <span class="math notranslate nohighlight">\(\lceil{m/8}\rceil\)</span>-byte string, big-endian;</p></li>
<li><p><span class="math notranslate nohighlight">\(y_P\)</span> as a <span class="math notranslate nohighlight">\(\lceil{m/8}\rceil\)</span>-byte string, big-endian.</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>Montgomery</p></td>
<td><p>The key data is the scalar value of the ‘public key’ in little-endian order as defined by <span><em>Elliptic Curves for Security</em> <a class="reference internal" href="../../about.html#cite-rfc7748"><span class="cite">[RFC7748]</span></a></span> <a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc7748.html#section-6">§6</a>.
This is a <span class="math notranslate nohighlight">\(\lceil{m/8}\rceil\)</span>-byte string where <span class="math notranslate nohighlight">\(m\)</span> is the key size in bits.</p>
<ul class="simple">
<li><p>This is 32 bytes for Curve25519, computed as <code class="docutils literal notranslate"><span class="pre">X25519(private_key,</span> <span class="pre">9)</span></code>.</p></li>
<li><p>This is 56 bytes for Curve448, computed as <code class="docutils literal notranslate"><span class="pre">X448(private_key,</span> <span class="pre">5)</span></code>.</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>Twisted Edwards</p></td>
<td><p>The key data is the public key, as defined by <span><em>Edwards-Curve Digital Signature Algorithm (EdDSA)</em> <a class="reference internal" href="../../about.html#cite-rfc8032"><span class="cite">[RFC8032]</span></a></span>.</p>
<p>This is a 32-byte string for Edwards25519, and a 57-byte string for Edwards448.</p>
</td>
</tr>
</tbody>
</table>
</section>
<section id="c.PSA_ECC_FAMILY_SECP_K1">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_SECP_K1</span></code> (macro)<a class="headerlink" href="#c.PSA_ECC_FAMILY_SECP_K1" title="Link to this heading">¶</a></h3>
<p>SEC Koblitz curves over prime fields.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ECC_FAMILY_SECP_K1" title="PSA_ECC_FAMILY_SECP_K1">PSA_ECC_FAMILY_SECP_K1</a> ((<a class="reference internal" href="#c.psa_ecc_family_t" title="psa_ecc_family_t">psa_ecc_family_t</a>) 0x17)</pre>
<p>This family comprises the following curves:</p>
<ul class="simple">
<li><p>secp192k1 : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">192</span></code></p></li>
<li><p>secp224k1 : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">225</span></code></p></li>
<li><p>secp256k1 : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">256</span></code></p></li>
</ul>
<p>They are defined in <span><em>SEC 2: Recommended Elliptic Curve Domain Parameters</em> <a class="reference internal" href="../../about.html#cite-sec2"><span class="cite">[SEC2]</span></a></span>.</p>
</section>
<section id="c.PSA_ECC_FAMILY_SECP_R1">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_SECP_R1</span></code> (macro)<a class="headerlink" href="#c.PSA_ECC_FAMILY_SECP_R1" title="Link to this heading">¶</a></h3>
<p>SEC random curves over prime fields.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ECC_FAMILY_SECP_R1" title="PSA_ECC_FAMILY_SECP_R1">PSA_ECC_FAMILY_SECP_R1</a> ((<a class="reference internal" href="#c.psa_ecc_family_t" title="psa_ecc_family_t">psa_ecc_family_t</a>) 0x12)</pre>
<p>This family comprises the following curves:</p>
<ul class="simple">
<li><p>secp192r1 : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">192</span></code></p></li>
<li><p>secp224r1 : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">224</span></code></p></li>
<li><p>secp256r1 : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">256</span></code></p></li>
<li><p>secp384r1 : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">384</span></code></p></li>
<li><p>secp521r1 : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">521</span></code></p></li>
</ul>
<p>They are defined in <a class="reference internal" href="../../about.html#cite-sec2"><span class="cite">[SEC2]</span></a>.</p>
</section>
<section id="c.PSA_ECC_FAMILY_SECP_R2">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_SECP_R2</span></code> (macro)<a class="headerlink" href="#c.PSA_ECC_FAMILY_SECP_R2" title="Link to this heading">¶</a></h3>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This family of curves is weak and deprecated.</p>
</div>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ECC_FAMILY_SECP_R2" title="PSA_ECC_FAMILY_SECP_R2">PSA_ECC_FAMILY_SECP_R2</a> ((<a class="reference internal" href="#c.psa_ecc_family_t" title="psa_ecc_family_t">psa_ecc_family_t</a>) 0x1b)</pre>
<p>This family comprises the following curves:</p>
<ul class="simple">
<li><p>secp160r2 : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">160</span></code> <em>(Deprecated)</em></p></li>
</ul>
<p>It is defined in the superseded <span><em>SEC 2: Recommended Elliptic Curve Domain Parameters, Version 1.0</em> <a class="reference internal" href="../../about.html#cite-sec2v1"><span class="cite">[SEC2v1]</span></a></span>.</p>
</section>
<section id="c.PSA_ECC_FAMILY_SECT_K1">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_SECT_K1</span></code> (macro)<a class="headerlink" href="#c.PSA_ECC_FAMILY_SECT_K1" title="Link to this heading">¶</a></h3>
<p>SEC Koblitz curves over binary fields.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ECC_FAMILY_SECT_K1" title="PSA_ECC_FAMILY_SECT_K1">PSA_ECC_FAMILY_SECT_K1</a> ((<a class="reference internal" href="#c.psa_ecc_family_t" title="psa_ecc_family_t">psa_ecc_family_t</a>) 0x27)</pre>
<p>This family comprises the following curves:</p>
<ul class="simple">
<li><p>sect163k1 : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">163</span></code> <em>(Deprecated)</em></p></li>
<li><p>sect233k1 : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">233</span></code></p></li>
<li><p>sect239k1 : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">239</span></code></p></li>
<li><p>sect283k1 : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">283</span></code></p></li>
<li><p>sect409k1 : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">409</span></code></p></li>
<li><p>sect571k1 : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">571</span></code></p></li>
</ul>
<p>They are defined in <a class="reference internal" href="../../about.html#cite-sec2"><span class="cite">[SEC2]</span></a>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The 163-bit curve sect163k1 is weak and deprecated and is only recommended for use in legacy applications.</p>
</div>
</section>
<section id="c.PSA_ECC_FAMILY_SECT_R1">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_SECT_R1</span></code> (macro)<a class="headerlink" href="#c.PSA_ECC_FAMILY_SECT_R1" title="Link to this heading">¶</a></h3>
<p>SEC random curves over binary fields.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ECC_FAMILY_SECT_R1" title="PSA_ECC_FAMILY_SECT_R1">PSA_ECC_FAMILY_SECT_R1</a> ((<a class="reference internal" href="#c.psa_ecc_family_t" title="psa_ecc_family_t">psa_ecc_family_t</a>) 0x22)</pre>
<p>This family comprises the following curves:</p>
<ul class="simple">
<li><p>sect163r1 : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">163</span></code> <em>(Deprecated)</em></p></li>
<li><p>sect233r1 : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">233</span></code></p></li>
<li><p>sect283r1 : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">283</span></code></p></li>
<li><p>sect409r1 : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">409</span></code></p></li>
<li><p>sect571r1 : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">571</span></code></p></li>
</ul>
<p>They are defined in <a class="reference internal" href="../../about.html#cite-sec2"><span class="cite">[SEC2]</span></a>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The 163-bit curve sect163r1 is weak and deprecated and is only recommended for use in legacy applications.</p>
</div>
</section>
<section id="c.PSA_ECC_FAMILY_SECT_R2">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_SECT_R2</span></code> (macro)<a class="headerlink" href="#c.PSA_ECC_FAMILY_SECT_R2" title="Link to this heading">¶</a></h3>
<p>SEC additional random curves over binary fields.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ECC_FAMILY_SECT_R2" title="PSA_ECC_FAMILY_SECT_R2">PSA_ECC_FAMILY_SECT_R2</a> ((<a class="reference internal" href="#c.psa_ecc_family_t" title="psa_ecc_family_t">psa_ecc_family_t</a>) 0x2b)</pre>
<p>This family comprises the following curves:</p>
<ul class="simple">
<li><p>sect163r2 : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">163</span></code> <em>(Deprecated)</em></p></li>
</ul>
<p>It is defined in <a class="reference internal" href="../../about.html#cite-sec2"><span class="cite">[SEC2]</span></a>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The 163-bit curve sect163r2 is weak and deprecated and is only recommended for use in legacy applications.</p>
</div>
</section>
<section id="c.PSA_ECC_FAMILY_BRAINPOOL_P_R1">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_BRAINPOOL_P_R1</span></code> (macro)<a class="headerlink" href="#c.PSA_ECC_FAMILY_BRAINPOOL_P_R1" title="Link to this heading">¶</a></h3>
<p>Brainpool P random curves.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ECC_FAMILY_BRAINPOOL_P_R1" title="PSA_ECC_FAMILY_BRAINPOOL_P_R1">PSA_ECC_FAMILY_BRAINPOOL_P_R1</a> ((<a class="reference internal" href="#c.psa_ecc_family_t" title="psa_ecc_family_t">psa_ecc_family_t</a>) 0x30)</pre>
<p>This family comprises the following curves:</p>
<ul class="simple">
<li><p>brainpoolP160r1 : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">160</span></code> <em>(Deprecated)</em></p></li>
<li><p>brainpoolP192r1 : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">192</span></code></p></li>
<li><p>brainpoolP224r1 : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">224</span></code></p></li>
<li><p>brainpoolP256r1 : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">256</span></code></p></li>
<li><p>brainpoolP320r1 : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">320</span></code></p></li>
<li><p>brainpoolP384r1 : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">384</span></code></p></li>
<li><p>brainpoolP512r1 : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">512</span></code></p></li>
</ul>
<p>They are defined in <span><em>Elliptic Curve Cryptography (ECC) Brainpool Standard Curves and Curve Generation</em> <a class="reference internal" href="../../about.html#cite-rfc5639"><span class="cite">[RFC5639]</span></a></span>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The 160-bit curve brainpoolP160r1 is weak and deprecated and is only recommended for use in legacy applications.</p>
</div>
</section>
<section id="c.PSA_ECC_FAMILY_FRP">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_FRP</span></code> (macro)<a class="headerlink" href="#c.PSA_ECC_FAMILY_FRP" title="Link to this heading">¶</a></h3>
<p>Curve used primarily in France and elsewhere in Europe.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ECC_FAMILY_FRP" title="PSA_ECC_FAMILY_FRP">PSA_ECC_FAMILY_FRP</a> ((<a class="reference internal" href="#c.psa_ecc_family_t" title="psa_ecc_family_t">psa_ecc_family_t</a>) 0x33)</pre>
<p>This family comprises one 256-bit curve:</p>
<ul class="simple">
<li><p>FRP256v1 : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">256</span></code></p></li>
</ul>
<p>This is defined by <span><em>Publication d'un paramétrage de courbe elliptique visant des applications de passeport électronique et de l'administration électronique française</em> <a class="reference internal" href="../../about.html#cite-frp"><span class="cite">[FRP]</span></a></span>.</p>
</section>
<section id="c.PSA_ECC_FAMILY_MONTGOMERY">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_MONTGOMERY</span></code> (macro)<a class="headerlink" href="#c.PSA_ECC_FAMILY_MONTGOMERY" title="Link to this heading">¶</a></h3>
<p>Montgomery curves.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ECC_FAMILY_MONTGOMERY" title="PSA_ECC_FAMILY_MONTGOMERY">PSA_ECC_FAMILY_MONTGOMERY</a> ((<a class="reference internal" href="#c.psa_ecc_family_t" title="psa_ecc_family_t">psa_ecc_family_t</a>) 0x41)</pre>
<p>This family comprises the following Montgomery curves:</p>
<ul class="simple">
<li><p>Curve25519 : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">255</span></code></p></li>
<li><p>Curve448 : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">448</span></code></p></li>
</ul>
<p>Curve25519 is defined in <span><em>Curve25519: new Diffie-Hellman speed records</em> <a class="reference internal" href="../../about.html#cite-curve25519"><span class="cite">[Curve25519]</span></a></span>. Curve448 is defined in <span><em>Ed448-Goldilocks, a new elliptic curve</em> <a class="reference internal" href="../../about.html#cite-curve448"><span class="cite">[Curve448]</span></a></span>.</p>
</section>
<section id="c.PSA_ECC_FAMILY_TWISTED_EDWARDS">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_TWISTED_EDWARDS</span></code> (macro)<a class="headerlink" href="#c.PSA_ECC_FAMILY_TWISTED_EDWARDS" title="Link to this heading">¶</a></h3>
<p>Twisted Edwards curves.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.1.</span></p>
</div>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ECC_FAMILY_TWISTED_EDWARDS" title="PSA_ECC_FAMILY_TWISTED_EDWARDS">PSA_ECC_FAMILY_TWISTED_EDWARDS</a> ((<a class="reference internal" href="#c.psa_ecc_family_t" title="psa_ecc_family_t">psa_ecc_family_t</a>) 0x42)</pre>
<p>This family comprises the following twisted Edwards curves:</p>
<ul class="simple">
<li><p>Edwards25519 : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">255</span></code>. This curve is birationally equivalent to Curve25519.</p></li>
<li><p>Edwards448 : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">448</span></code>. This curve is birationally equivalent to Curve448.</p></li>
</ul>
<p>Edwards25519 is defined in <span><em>Twisted Edwards curves</em> <a class="reference internal" href="../../about.html#cite-ed25519"><span class="cite">[Ed25519]</span></a></span>. Edwards448 is defined in <span><em>Ed448-Goldilocks, a new elliptic curve</em> <a class="reference internal" href="../../about.html#cite-curve448"><span class="cite">[Curve448]</span></a></span>.</p>
</section>
<section id="c.PSA_KEY_TYPE_IS_ECC">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_IS_ECC</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_IS_ECC" title="Link to this heading">¶</a></h3>
<p>Whether a key type is an elliptic curve key, either a key pair or a public key.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_IS_ECC" title="PSA_KEY_TYPE_IS_ECC">PSA_KEY_TYPE_IS_ECC</a>(type) <em><a class="reference internal" href="../../overview/implementation.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">type</span></code></p>
</dt><dd><p>A key type: a value of type <a class="reference internal" href="#c.psa_key_type_t" title="psa_key_type_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_key_type_t</span></code></a>.</p>
</dd>
</dl>
</div>
</section>
<section id="c.PSA_KEY_TYPE_IS_ECC_KEY_PAIR">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_IS_ECC_KEY_PAIR</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_IS_ECC_KEY_PAIR" title="Link to this heading">¶</a></h3>
<p>Whether a key type is an elliptic curve key pair.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_IS_ECC_KEY_PAIR" title="PSA_KEY_TYPE_IS_ECC_KEY_PAIR">PSA_KEY_TYPE_IS_ECC_KEY_PAIR</a>(type) <em><a class="reference internal" href="../../overview/implementation.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">type</span></code></p>
</dt><dd><p>A key type: a value of type <a class="reference internal" href="#c.psa_key_type_t" title="psa_key_type_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_key_type_t</span></code></a>.</p>
</dd>
</dl>
</div>
</section>
<section id="c.PSA_KEY_TYPE_IS_ECC_PUBLIC_KEY">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_IS_ECC_PUBLIC_KEY</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_IS_ECC_PUBLIC_KEY" title="Link to this heading">¶</a></h3>
<p>Whether a key type is an elliptic curve public key.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_IS_ECC_PUBLIC_KEY" title="PSA_KEY_TYPE_IS_ECC_PUBLIC_KEY">PSA_KEY_TYPE_IS_ECC_PUBLIC_KEY</a>(type) <em><a class="reference internal" href="../../overview/implementation.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">type</span></code></p>
</dt><dd><p>A key type: a value of type <a class="reference internal" href="#c.psa_key_type_t" title="psa_key_type_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_key_type_t</span></code></a>.</p>
</dd>
</dl>
</div>
</section>
<section id="c.PSA_KEY_TYPE_ECC_GET_FAMILY">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_ECC_GET_FAMILY</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_ECC_GET_FAMILY" title="Link to this heading">¶</a></h3>
<p>Extract the curve family from an elliptic curve key type.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_ECC_GET_FAMILY" title="PSA_KEY_TYPE_ECC_GET_FAMILY">PSA_KEY_TYPE_ECC_GET_FAMILY</a>(type) <em><a class="reference internal" href="../../overview/implementation.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">type</span></code></p>
</dt><dd><p>An elliptic curve key type: a value of type <a class="reference internal" href="#c.psa_key_type_t" title="psa_key_type_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_key_type_t</span></code></a> such that <a class="reference internal" href="#c.PSA_KEY_TYPE_IS_ECC" title="PSA_KEY_TYPE_IS_ECC"><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_IS_ECC</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">type</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> is true.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns: <a class="reference internal" href="#c.psa_ecc_family_t" title="psa_ecc_family_t"><code class="docutils literal notranslate"><span class="pre">psa_ecc_family_t</span></code></a></p>
<p>The elliptic curve family id, if <code class="docutils literal notranslate"><span class="pre">type</span></code> is a supported elliptic curve key. Unspecified if <code class="docutils literal notranslate"><span class="pre">type</span></code> is not a supported elliptic curve key.</p>
</section>
</section>
<section id="diffie-hellman-keys">
<span id="dh-keys"></span><h2><span class="section-number">9.2.7 </span>Diffie Hellman keys<a class="headerlink" href="#diffie-hellman-keys" title="Link to this heading">¶</a></h2>
<section id="c.psa_dh_family_t">
<h3><code class="docutils literal notranslate"><span class="pre">psa_dh_family_t</span></code> (typedef)<a class="headerlink" href="#c.psa_dh_family_t" title="Link to this heading">¶</a></h3>
<p>The type of identifiers of a finite-field Diffie-Hellman group family.</p>
<pre class="literal-block">typedef uint8_t <a class="reference internal" href="#c.psa_dh_family_t" title="psa_dh_family_t">psa_dh_family_t</a>;</pre>
<p>The group family identifier is required to create a finite-field Diffie-Hellman key using the <a class="reference internal" href="#c.PSA_KEY_TYPE_DH_KEY_PAIR" title="PSA_KEY_TYPE_DH_KEY_PAIR"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_DH_KEY_PAIR()</span></code></a> or <a class="reference internal" href="#c.PSA_KEY_TYPE_DH_PUBLIC_KEY" title="PSA_KEY_TYPE_DH_PUBLIC_KEY"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_DH_PUBLIC_KEY()</span></code></a> macros.</p>
<p>The specific Diffie-Hellman group within a family is identified by the <code class="docutils literal notranslate"><span class="pre">key_bits</span></code> attribute of the key.</p>
<p>The range of Diffie-Hellman group family identifier values is divided as follows:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">0x00</span></code></dt><dd><p>Reserved.
Not allocated to a DH group family.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">0x01</span> <span class="pre">-</span> <span class="pre">0x7f</span></code></dt><dd><p>DH group family identifiers defined by this standard.
Unallocated values in this range are reserved for future use.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">0x80</span> <span class="pre">-</span> <span class="pre">0xff</span></code></dt><dd><p>Invalid.
Values in this range must not be used.</p>
</dd>
</dl>
<p>The least significant bit of a Diffie-Hellman group family identifier is a parity bit for the whole key type.
See <a class="reference internal" href="../../appendix/encodings.html#asymmetric-key-encoding"><span class="secref">Asymmetric key encoding</span></a> for details of the encoding of asymmetric key types.</p>
<div class="admonition-implementation-note admonition">
<p class="admonition-title">Implementation note</p>
<p>To provide other Diffie-Hellman group families, it is recommended that an implementation defines a key type with bit 15 set, which indicates an <a class="reference internal" href="../../about.html#term-implementation-defined"><span class="scterm">implementation defined</span></a> key type.</p>
</div>
</section>
<section id="c.PSA_KEY_TYPE_DH_KEY_PAIR">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_DH_KEY_PAIR</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_DH_KEY_PAIR" title="Link to this heading">¶</a></h3>
<p>Finite-field Diffie-Hellman key pair: both the private key and public key.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_DH_KEY_PAIR" title="PSA_KEY_TYPE_DH_KEY_PAIR">PSA_KEY_TYPE_DH_KEY_PAIR</a>(group) <em><a class="reference internal" href="../../overview/implementation.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">group</span></code></p>
</dt><dd><p>A value of type <a class="reference internal" href="#c.psa_dh_family_t" title="psa_dh_family_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_dh_family_t</span></code></a> that identifies the Diffie-Hellman group family to be used.</p>
</dd>
</dl>
</div>
<p class="rubric">Compatible algorithms</p>
<table class="hlist"><tr><td><ul class="simple">
<li><p><a class="reference internal" href="../ops/key-agreement.html#c.PSA_ALG_FFDH" title="PSA_ALG_FFDH"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_FFDH</span></code></a></p></li>
</ul>
</td><td><ul class="simple">
</ul>
</td></tr></table>
<p class="rubric">Key format</p>
<p>The data format for import and export of the key pair is the representation of the private key <span class="math notranslate nohighlight">\(x\)</span> as a big-endian byte string.
The length of the byte string is the private key’s size in bytes, and leading zeroes are not stripped.</p>
<p>See <a class="reference internal" href="#c.PSA_KEY_TYPE_DH_PUBLIC_KEY" title="PSA_KEY_TYPE_DH_PUBLIC_KEY"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_DH_PUBLIC_KEY</span></code></a> for the data format used when exporting the public key with <a class="reference internal" href="management.html#c.psa_export_public_key" title="psa_export_public_key"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_export_public_key()</span></code></a>.</p>
<p class="rubric">Key derivation</p>
<p>A call to <a class="reference internal" href="../ops/key-derivation.html#c.psa_key_derivation_output_key" title="psa_key_derivation_output_key"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_key_derivation_output_key()</span></code></a> will use the following process, defined in <em>Key-Pair Generation by Testing Candidates</em> in <span><em>NIST Special Publication 800-56A: Recommendation for Pair-Wise Key-Establishment Schemes Using Discrete Logarithm Cryptography</em> <a class="reference internal" href="../../about.html#cite-sp800-56a"><span class="cite">[SP800-56A]</span></a></span> §5.6.1.1.4.</p>
<p>A Diffie-Hellman private key is <span class="math notranslate nohighlight">\(x \in [1, p - 1]\)</span>, where <span class="math notranslate nohighlight">\(p\)</span> is the group’s prime modulus.
Let <span class="math notranslate nohighlight">\(m\)</span> be the bit size of <span class="math notranslate nohighlight">\(p\)</span>, such that <span class="math notranslate nohighlight">\(2^{m-1} \leq p &lt; 2^m\)</span>.</p>
<p>This function generates the private key using the following process:</p>
<ol class="arabic simple">
<li><p>Draw a byte string of length <span class="math notranslate nohighlight">\(\lceil{m/8}\rceil\)</span> bytes.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(m\)</span> is not a multiple of 8, set the most significant <span class="math notranslate nohighlight">\(8 * \lceil{m/8}\rceil - m`\)</span> bits of the first byte in the string to zero.</p></li>
<li><p>Convert the string to integer <span class="math notranslate nohighlight">\(k\)</span> by decoding it as a big-endian byte-string.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(k &gt; p-2\)</span>, discard the result and return to step 1.</p></li>
<li><p>Output <span class="math notranslate nohighlight">\(x = k + 1\)</span> as the private key.</p></li>
</ol>
</section>
<section id="c.PSA_KEY_TYPE_DH_PUBLIC_KEY">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_DH_PUBLIC_KEY</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_DH_PUBLIC_KEY" title="Link to this heading">¶</a></h3>
<p>Finite-field Diffie-Hellman public key.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_DH_PUBLIC_KEY" title="PSA_KEY_TYPE_DH_PUBLIC_KEY">PSA_KEY_TYPE_DH_PUBLIC_KEY</a>(group) <em><a class="reference internal" href="../../overview/implementation.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">group</span></code></p>
</dt><dd><p>A value of type <a class="reference internal" href="#c.psa_dh_family_t" title="psa_dh_family_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_dh_family_t</span></code></a> that identifies the Diffie-Hellman group family to be used.</p>
</dd>
</dl>
</div>
<p class="rubric">Compatible algorithms</p>
<p>None: Finite-field Diffie-Hellman public keys are exported to use in a key-agreement algorithm, and the peer key is provided to the <a class="reference internal" href="../ops/key-agreement.html#c.PSA_ALG_FFDH" title="PSA_ALG_FFDH"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_FFDH</span></code></a> key-agreement algorithm as a buffer of key data.</p>
<p class="rubric">Key format</p>
<p>The data format for export of the public key is the representation of the public key <span class="math notranslate nohighlight">\(y = g^x\!\mod p\)</span> as a big-endian byte string.
The length of the byte string is the length of the base prime <span class="math notranslate nohighlight">\(p\)</span> in bytes.</p>
</section>
<section id="c.PSA_DH_FAMILY_RFC7919">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_DH_FAMILY_RFC7919</span></code> (macro)<a class="headerlink" href="#c.PSA_DH_FAMILY_RFC7919" title="Link to this heading">¶</a></h3>
<p>Finite-field Diffie-Hellman groups defined for TLS in RFC 7919.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_DH_FAMILY_RFC7919" title="PSA_DH_FAMILY_RFC7919">PSA_DH_FAMILY_RFC7919</a> ((<a class="reference internal" href="#c.psa_dh_family_t" title="psa_dh_family_t">psa_dh_family_t</a>) 0x03)</pre>
<p>This family includes groups with the following key sizes (in bits): 2048, 3072, 4096, 6144, 8192.
An implementation can support all of these sizes or only a subset.</p>
<p>Keys is this group can only be used with the <a class="reference internal" href="../ops/key-agreement.html#c.PSA_ALG_FFDH" title="PSA_ALG_FFDH"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_FFDH</span></code></a> key-agreement algorithm.</p>
<p>These groups are defined by <span><em>Negotiated Finite Field Diffie-Hellman Ephemeral Parameters for Transport Layer Security (TLS)</em> <a class="reference internal" href="../../about.html#cite-rfc7919"><span class="cite">[RFC7919]</span></a></span> <a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc7919.html#appendix-A">Appendix A</a>.</p>
</section>
<section id="c.PSA_KEY_TYPE_KEY_PAIR_OF_PUBLIC_KEY">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_KEY_PAIR_OF_PUBLIC_KEY</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_KEY_PAIR_OF_PUBLIC_KEY" title="Link to this heading">¶</a></h3>
<p>The key-pair type corresponding to a public-key type.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_KEY_PAIR_OF_PUBLIC_KEY" title="PSA_KEY_TYPE_KEY_PAIR_OF_PUBLIC_KEY">PSA_KEY_TYPE_KEY_PAIR_OF_PUBLIC_KEY</a>(type) \
    <em><a class="reference internal" href="../../overview/implementation.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">type</span></code></p>
</dt><dd><p>A public-key type or key-pair type.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns</p>
<p>The corresponding key-pair type. If <code class="docutils literal notranslate"><span class="pre">type</span></code> is not a public key or a key pair, the return value is undefined.</p>
<p class="rubric">Description</p>
<p>If <code class="docutils literal notranslate"><span class="pre">type</span></code> is a key-pair type, it will be left unchanged.</p>
</section>
<section id="c.PSA_KEY_TYPE_PUBLIC_KEY_OF_KEY_PAIR">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_PUBLIC_KEY_OF_KEY_PAIR</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_PUBLIC_KEY_OF_KEY_PAIR" title="Link to this heading">¶</a></h3>
<p>The public-key type corresponding to a key-pair type.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_PUBLIC_KEY_OF_KEY_PAIR" title="PSA_KEY_TYPE_PUBLIC_KEY_OF_KEY_PAIR">PSA_KEY_TYPE_PUBLIC_KEY_OF_KEY_PAIR</a>(type) \
    <em><a class="reference internal" href="../../overview/implementation.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">type</span></code></p>
</dt><dd><p>A public-key type or key-pair type.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns</p>
<p>The corresponding public-key type. If <code class="docutils literal notranslate"><span class="pre">type</span></code> is not a public key or a key pair, the return value is undefined.</p>
<p class="rubric">Description</p>
<p>If <code class="docutils literal notranslate"><span class="pre">type</span></code> is a public-key type, it will be left unchanged.</p>
</section>
<section id="c.PSA_KEY_TYPE_IS_DH">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_IS_DH</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_IS_DH" title="Link to this heading">¶</a></h3>
<p>Whether a key type is a Diffie-Hellman key, either a key pair or a public key.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_IS_DH" title="PSA_KEY_TYPE_IS_DH">PSA_KEY_TYPE_IS_DH</a>(type) <em><a class="reference internal" href="../../overview/implementation.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">type</span></code></p>
</dt><dd><p>A key type: a value of type <a class="reference internal" href="#c.psa_key_type_t" title="psa_key_type_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_key_type_t</span></code></a>.</p>
</dd>
</dl>
</div>
</section>
<section id="c.PSA_KEY_TYPE_IS_DH_KEY_PAIR">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_IS_DH_KEY_PAIR</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_IS_DH_KEY_PAIR" title="Link to this heading">¶</a></h3>
<p>Whether a key type is a Diffie-Hellman key pair.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_IS_DH_KEY_PAIR" title="PSA_KEY_TYPE_IS_DH_KEY_PAIR">PSA_KEY_TYPE_IS_DH_KEY_PAIR</a>(type) <em><a class="reference internal" href="../../overview/implementation.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">type</span></code></p>
</dt><dd><p>A key type: a value of type <a class="reference internal" href="#c.psa_key_type_t" title="psa_key_type_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_key_type_t</span></code></a>.</p>
</dd>
</dl>
</div>
</section>
<section id="c.PSA_KEY_TYPE_IS_DH_PUBLIC_KEY">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_IS_DH_PUBLIC_KEY</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_IS_DH_PUBLIC_KEY" title="Link to this heading">¶</a></h3>
<p>Whether a key type is a Diffie-Hellman public key.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_IS_DH_PUBLIC_KEY" title="PSA_KEY_TYPE_IS_DH_PUBLIC_KEY">PSA_KEY_TYPE_IS_DH_PUBLIC_KEY</a>(type) <em><a class="reference internal" href="../../overview/implementation.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">type</span></code></p>
</dt><dd><p>A key type: a value of type <a class="reference internal" href="#c.psa_key_type_t" title="psa_key_type_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_key_type_t</span></code></a>.</p>
</dd>
</dl>
</div>
</section>
<section id="c.PSA_KEY_TYPE_DH_GET_FAMILY">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_DH_GET_FAMILY</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_DH_GET_FAMILY" title="Link to this heading">¶</a></h3>
<p>Extract the group family from a Diffie-Hellman key type.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_DH_GET_FAMILY" title="PSA_KEY_TYPE_DH_GET_FAMILY">PSA_KEY_TYPE_DH_GET_FAMILY</a>(type) <em><a class="reference internal" href="../../overview/implementation.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">type</span></code></p>
</dt><dd><p>A Diffie-Hellman key type: a value of type <a class="reference internal" href="#c.psa_key_type_t" title="psa_key_type_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_key_type_t</span></code></a> such that <a class="reference internal" href="#c.PSA_KEY_TYPE_IS_DH" title="PSA_KEY_TYPE_IS_DH"><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_IS_DH</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">type</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> is true.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns: <a class="reference internal" href="#c.psa_dh_family_t" title="psa_dh_family_t"><code class="docutils literal notranslate"><span class="pre">psa_dh_family_t</span></code></a></p>
<p>The Diffie-Hellman group family id, if <code class="docutils literal notranslate"><span class="pre">type</span></code> is a supported Diffie-Hellman key. Unspecified if <code class="docutils literal notranslate"><span class="pre">type</span></code> is not a supported Diffie-Hellman key.</p>
</section>
<section id="spake2-keys">
<span id="spake2p-keys"></span><h3>SPAKE2+ keys<a class="headerlink" href="#spake2-keys" title="Link to this heading">¶</a></h3>
<section id="c.PSA_KEY_TYPE_SPAKE2P_KEY_PAIR">
<h4><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_SPAKE2P_KEY_PAIR</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_SPAKE2P_KEY_PAIR" title="Link to this heading">¶</a></h4>
<p>SPAKE2+ key pair: both the prover and verifier key.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.2.</span></p>
</div>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_SPAKE2P_KEY_PAIR" title="PSA_KEY_TYPE_SPAKE2P_KEY_PAIR">PSA_KEY_TYPE_SPAKE2P_KEY_PAIR</a>(curve) <em><a class="reference internal" href="../../overview/implementation.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">curve</span></code></p>
</dt><dd><p>A value of type <a class="reference internal" href="#c.psa_ecc_family_t" title="psa_ecc_family_t"><code class="docutils literal notranslate"><span class="pre">psa_ecc_family_t</span></code></a> that identifies the elliptic curve family to be used.</p>
</dd>
</dl>
</div>
<p class="rubric">Description</p>
<p>The bit-size of a SPAKE2+ key is the size associated with the elliptic curve group, that is, <span class="math notranslate nohighlight">\(\lceil{log_2(q)}\rceil\)</span> for a curve over a field <span class="math notranslate nohighlight">\(\mathbb{F}_q\)</span>.
See <a class="reference internal" href="#ecc-keys"><span class="secref">Elliptic Curve keys</span></a> for details of each elliptic curve family.</p>
<p>To create a new SPAKE2+ key pair, use <a class="reference internal" href="../ops/key-derivation.html#c.psa_key_derivation_output_key" title="psa_key_derivation_output_key"><code class="docutils literal notranslate"><span class="pre">psa_key_derivation_output_key</span></code></a><code class="docutils literal notranslate"><span class="pre">()</span></code> as described in <a class="reference internal" href="../ops/pake.html#spake2p-registration"><span class="secref">SPAKE2+ registration</span></a>.
The SPAKE2+ protocol recommends that a key-stretching key-derivation function, such as PBKDF2, is used to hash the SPAKE2+ password.
This follows the recommended process described in <a class="reference internal" href="../../about.html#cite-rfc9383"><span class="cite">[RFC9383]</span></a>.</p>
<p>A SPAKE2+ key pair can also be imported from a previously exported SPAKE2+ key pair.</p>
<p>The corresponding public key can be exported using <a class="reference internal" href="management.html#c.psa_export_public_key" title="psa_export_public_key"><code class="docutils literal notranslate"><span class="pre">psa_export_public_key</span></code></a><code class="docutils literal notranslate"><span class="pre">()</span></code>.
See also <a class="reference internal" href="#c.PSA_KEY_TYPE_SPAKE2P_PUBLIC_KEY" title="PSA_KEY_TYPE_SPAKE2P_PUBLIC_KEY"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_SPAKE2P_PUBLIC_KEY()</span></code></a>.</p>
<p class="rubric">Compatible algorithms</p>
<table class="hlist"><tr><td><ul class="simple">
<li><p><a class="reference internal" href="../ops/pake.html#c.PSA_ALG_SPAKE2P_HMAC" title="PSA_ALG_SPAKE2P_HMAC"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_SPAKE2P_HMAC</span></code></a></p></li>
<li><p><a class="reference internal" href="../ops/pake.html#c.PSA_ALG_SPAKE2P_CMAC" title="PSA_ALG_SPAKE2P_CMAC"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_SPAKE2P_CMAC</span></code></a></p></li>
</ul>
</td><td><ul class="simple">
<li><p><a class="reference internal" href="../ops/pake.html#c.PSA_ALG_SPAKE2P_MATTER" title="PSA_ALG_SPAKE2P_MATTER"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_SPAKE2P_MATTER</span></code></a></p></li>
</ul>
</td></tr></table>
<p class="rubric">Key format</p>
<p>A SPAKE2+ key pair consists of the two values <span class="math notranslate nohighlight">\(w0\)</span> and <span class="math notranslate nohighlight">\(w1\)</span>, which result from the SPAKE2+ registration phase, see <a class="reference internal" href="../ops/pake.html#spake2p-registration"><span class="secref">SPAKE2+ registration</span></a>.
<span class="math notranslate nohighlight">\(w0\)</span> and <span class="math notranslate nohighlight">\(w1\)</span> are scalars in the same range as an elliptic curve private key from the group used as the SPAKE2+ primitive group.</p>
<p>The data format for import and export of the key pair is the concatenation of the formatted values for <span class="math notranslate nohighlight">\(w0\)</span> and <span class="math notranslate nohighlight">\(w1\)</span>, using the standard formats for elliptic curve keys used by the Crypto API.
For example, for SPAKE2+ over P-256 (secp256r1), the output from <a class="reference internal" href="management.html#c.psa_export_key" title="psa_export_key"><code class="docutils literal notranslate"><span class="pre">psa_export_key</span></code></a><code class="docutils literal notranslate"><span class="pre">()</span></code> would be the concatenation of:</p>
<ul class="simple">
<li><p>The P-256 private key <span class="math notranslate nohighlight">\(w0\)</span>.
This is a 32-byte big-endian encoding of the integer <span class="math notranslate nohighlight">\(w0\)</span>.</p></li>
<li><p>The P-256 private key <span class="math notranslate nohighlight">\(w1\)</span>.
This is a 32-byte big-endian encoding of the integer <span class="math notranslate nohighlight">\(w1\)</span>.</p></li>
</ul>
<p>See <a class="reference internal" href="#c.PSA_KEY_TYPE_SPAKE2P_PUBLIC_KEY" title="PSA_KEY_TYPE_SPAKE2P_PUBLIC_KEY"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_SPAKE2P_PUBLIC_KEY</span></code></a> for the data format used when exporting the public key with <a class="reference internal" href="management.html#c.psa_export_public_key" title="psa_export_public_key"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_export_public_key()</span></code></a>.</p>
<p class="rubric">Key derivation</p>
<p>A call to <a class="reference internal" href="../ops/key-derivation.html#c.psa_key_derivation_output_key" title="psa_key_derivation_output_key"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_key_derivation_output_key()</span></code></a> will use the following process, which follows the recommendations for the registration process in <span><em>SPAKE2+, an Augmented Password-Authenticated Key Exchange (PAKE) Protocol</em> <a class="reference internal" href="../../about.html#cite-rfc9383"><span class="cite">[RFC9383]</span></a></span>, and matches the specification of this process in <span><em>Matter Specification, Version 1.2</em> <a class="reference internal" href="../../about.html#cite-matter"><span class="cite">[MATTER]</span></a></span>.</p>
<p>The derivation of SPAKE2+ keys extracts <span class="math notranslate nohighlight">\(\lceil{log_2(p)/8}\rceil+8\)</span> bytes from the PBKDF for each of <span class="math notranslate nohighlight">\(w0s\)</span> and <span class="math notranslate nohighlight">\(w1s\)</span>, where <span class="math notranslate nohighlight">\(p\)</span> is the prime factor of the order of the elliptic curve group.
The following sizes are used for extracting <span class="math notranslate nohighlight">\(w0s\)</span> and <span class="math notranslate nohighlight">\(w1s\)</span>, depending on the elliptic curve:</p>
<ul class="simple">
<li><p>P-256: 40 bytes</p></li>
<li><p>P-384: 56 bytes</p></li>
<li><p>P-521: 74 bytes</p></li>
<li><p>edwards25519: 40 bytes</p></li>
<li><p>edwards448: 64 bytes</p></li>
</ul>
<p>The calculation of <span class="math notranslate nohighlight">\(w0\)</span>, <span class="math notranslate nohighlight">\(w1\)</span>, and <span class="math notranslate nohighlight">\(L\)</span> then proceeds as described in <a class="reference internal" href="../../about.html#cite-rfc9383"><span class="cite">[RFC9383]</span></a>.</p>
<div class="admonition-implementation-note admonition">
<p class="admonition-title">Implementation note</p>
<p>The values of <span class="math notranslate nohighlight">\(w0\)</span> and <span class="math notranslate nohighlight">\(w1\)</span> are required as part of the SPAKE2+ key pair.</p>
<p>It is <a class="reference internal" href="../../about.html#term-implementation-defined"><span class="scterm">implementation defined</span></a> whether <span class="math notranslate nohighlight">\(L\)</span> is computed during key derivation, and stored as part of the key pair; or only computed when required from the key pair.</p>
</div>
</section>
<section id="c.PSA_KEY_TYPE_SPAKE2P_PUBLIC_KEY">
<h4><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_SPAKE2P_PUBLIC_KEY</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_SPAKE2P_PUBLIC_KEY" title="Link to this heading">¶</a></h4>
<p>SPAKE2+ public key: the verifier key.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.2.</span></p>
</div>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_SPAKE2P_PUBLIC_KEY" title="PSA_KEY_TYPE_SPAKE2P_PUBLIC_KEY">PSA_KEY_TYPE_SPAKE2P_PUBLIC_KEY</a>(curve) \
    <em><a class="reference internal" href="../../overview/implementation.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">curve</span></code></p>
</dt><dd><p>A value of type <a class="reference internal" href="#c.psa_ecc_family_t" title="psa_ecc_family_t"><code class="docutils literal notranslate"><span class="pre">psa_ecc_family_t</span></code></a> that identifies the elliptic curve family to be used.</p>
</dd>
</dl>
</div>
<p class="rubric">Description</p>
<p>The bit-size of an SPAKE2+ public key is the same as the corresponding private key.
See <a class="reference internal" href="#c.PSA_KEY_TYPE_SPAKE2P_KEY_PAIR" title="PSA_KEY_TYPE_SPAKE2P_KEY_PAIR"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_SPAKE2P_KEY_PAIR()</span></code></a> and the documentation of each elliptic curve family for details.</p>
<p>To construct a SPAKE2+ public key, it must be imported.</p>
<p class="rubric">Compatible algorithms</p>
<table class="hlist"><tr><td><ul class="simple">
<li><p><a class="reference internal" href="../ops/pake.html#c.PSA_ALG_SPAKE2P_HMAC" title="PSA_ALG_SPAKE2P_HMAC"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_SPAKE2P_HMAC</span></code></a> (verification only)</p></li>
<li><p><a class="reference internal" href="../ops/pake.html#c.PSA_ALG_SPAKE2P_CMAC" title="PSA_ALG_SPAKE2P_CMAC"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_SPAKE2P_CMAC</span></code></a> (verification only)</p></li>
</ul>
</td><td><ul class="simple">
<li><p><a class="reference internal" href="../ops/pake.html#c.PSA_ALG_SPAKE2P_MATTER" title="PSA_ALG_SPAKE2P_MATTER"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_SPAKE2P_MATTER</span></code></a> (verification only)</p></li>
</ul>
</td></tr></table>
<p class="rubric">Key format</p>
<p>A SPAKE2+ public key consists of the two values <span class="math notranslate nohighlight">\(w0\)</span> and <span class="math notranslate nohighlight">\(L\)</span>, which result from the SPAKE2+ registration phase, see <a class="reference internal" href="../ops/pake.html#spake2p-registration"><span class="secref">SPAKE2+ registration</span></a>.
<span class="math notranslate nohighlight">\(w0\)</span> is a scalar in the same range as a elliptic curve private key from the group used as the SPAKE2+ primitive group.
<span class="math notranslate nohighlight">\(L\)</span> is a point on the curve, similar to a public key from the same group, corresponding to the <span class="math notranslate nohighlight">\(w1\)</span> value in the key pair.</p>
<p>The data format for import and export of the public key is the concatenation of the formatted values for <span class="math notranslate nohighlight">\(w0\)</span> and <span class="math notranslate nohighlight">\(L\)</span>, using the standard formats for elliptic curve keys used by the Crypto API.
For example, for SPAKE2+ over P-256 (secp256r1), the output from <a class="reference internal" href="management.html#c.psa_export_public_key" title="psa_export_public_key"><code class="docutils literal notranslate"><span class="pre">psa_export_public_key</span></code></a><code class="docutils literal notranslate"><span class="pre">()</span></code> would be the concatenation of:</p>
<ul class="simple">
<li><p>The P-256 private key <span class="math notranslate nohighlight">\(w0\)</span>.
This is a 32-byte big-endian encoding of the integer <span class="math notranslate nohighlight">\(w0\)</span>.</p></li>
<li><p>The P-256 public key <span class="math notranslate nohighlight">\(L\)</span>.
This is a 65-byte concatenation of:</p>
<ul>
<li><p>The byte <code class="docutils literal notranslate"><span class="pre">0x04</span></code>.</p></li>
<li><p>The 32-byte big-endian encoding of the x-coordinate of <span class="math notranslate nohighlight">\(L\)</span>.</p></li>
<li><p>The 32-byte big-endian encoding of the y-coordinate of <span class="math notranslate nohighlight">\(L\)</span>.</p></li>
</ul>
</li>
</ul>
</section>
<section id="c.PSA_KEY_TYPE_IS_SPAKE2P">
<h4><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_IS_SPAKE2P</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_IS_SPAKE2P" title="Link to this heading">¶</a></h4>
<p>Whether a key type is a SPAKE2+ key, either a key pair or a public key.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.2.</span></p>
</div>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_IS_SPAKE2P" title="PSA_KEY_TYPE_IS_SPAKE2P">PSA_KEY_TYPE_IS_SPAKE2P</a>(type) <em><a class="reference internal" href="../../overview/implementation.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">type</span></code></p>
</dt><dd><p>A key type: a value of type <a class="reference internal" href="#c.psa_key_type_t" title="psa_key_type_t"><code class="docutils literal notranslate"><span class="pre">psa_key_type_t</span></code></a>.</p>
</dd>
</dl>
</div>
</section>
<section id="c.PSA_KEY_TYPE_IS_SPAKE2P_KEY_PAIR">
<h4><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_IS_SPAKE2P_KEY_PAIR</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_IS_SPAKE2P_KEY_PAIR" title="Link to this heading">¶</a></h4>
<p>Whether a key type is a SPAKE2+ key pair.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.2.</span></p>
</div>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_IS_SPAKE2P_KEY_PAIR" title="PSA_KEY_TYPE_IS_SPAKE2P_KEY_PAIR">PSA_KEY_TYPE_IS_SPAKE2P_KEY_PAIR</a>(type) \
    <em><a class="reference internal" href="../../overview/implementation.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">type</span></code></p>
</dt><dd><p>A key type: a value of type <a class="reference internal" href="#c.psa_key_type_t" title="psa_key_type_t"><code class="docutils literal notranslate"><span class="pre">psa_key_type_t</span></code></a>.</p>
</dd>
</dl>
</div>
</section>
<section id="c.PSA_KEY_TYPE_IS_SPAKE2P_PUBLIC_KEY">
<h4><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_IS_SPAKE2P_PUBLIC_KEY</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_IS_SPAKE2P_PUBLIC_KEY" title="Link to this heading">¶</a></h4>
<p>Whether a key type is a SPAKE2+ public key.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.2.</span></p>
</div>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_IS_SPAKE2P_PUBLIC_KEY" title="PSA_KEY_TYPE_IS_SPAKE2P_PUBLIC_KEY">PSA_KEY_TYPE_IS_SPAKE2P_PUBLIC_KEY</a>(type) \
    <em><a class="reference internal" href="../../overview/implementation.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">type</span></code></p>
</dt><dd><p>A key type: a value of type <a class="reference internal" href="#c.psa_key_type_t" title="psa_key_type_t"><code class="docutils literal notranslate"><span class="pre">psa_key_type_t</span></code></a>.</p>
</dd>
</dl>
</div>
</section>
<section id="c.PSA_KEY_TYPE_SPAKE2P_GET_FAMILY">
<h4><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_SPAKE2P_GET_FAMILY</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_SPAKE2P_GET_FAMILY" title="Link to this heading">¶</a></h4>
<p>Extract the curve family from a SPAKE2+ key type.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.2.</span></p>
</div>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_SPAKE2P_GET_FAMILY" title="PSA_KEY_TYPE_SPAKE2P_GET_FAMILY">PSA_KEY_TYPE_SPAKE2P_GET_FAMILY</a>(type) <em><a class="reference internal" href="../../overview/implementation.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">type</span></code></p>
</dt><dd><p>A SPAKE2+ key type: a value of type <a class="reference internal" href="#c.psa_key_type_t" title="psa_key_type_t"><code class="docutils literal notranslate"><span class="pre">psa_key_type_t</span></code></a> such that <a class="reference internal" href="#c.PSA_KEY_TYPE_IS_SPAKE2P" title="PSA_KEY_TYPE_IS_SPAKE2P"><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_IS_SPAKE2P</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">type</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> is true.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns: <a class="reference internal" href="#c.psa_ecc_family_t" title="psa_ecc_family_t"><code class="docutils literal notranslate"><span class="pre">psa_ecc_family_t</span></code></a></p>
<p>The elliptic curve family id, if <code class="docutils literal notranslate"><span class="pre">type</span></code> is a supported SPAKE2+ key. Unspecified if <code class="docutils literal notranslate"><span class="pre">type</span></code> is not a supported SPAKE2+ key.</p>
</section>
</section>
</section>
<section id="attribute-accessors">
<h2><span class="section-number">9.2.8 </span>Attribute accessors<a class="headerlink" href="#attribute-accessors" title="Link to this heading">¶</a></h2>
<section id="c.psa_set_key_type">
<h3><code class="docutils literal notranslate"><span class="pre">psa_set_key_type</span></code> (function)<a class="headerlink" href="#c.psa_set_key_type" title="Link to this heading">¶</a></h3>
<p>Declare the type of a key.</p>
<pre class="literal-block">void <a class="reference internal" href="#c.psa_set_key_type" title="psa_set_key_type">psa_set_key_type</a>(<a class="reference internal" href="attributes.html#c.psa_key_attributes_t" title="psa_key_attributes_t">psa_key_attributes_t</a> * attributes,
                      <a class="reference internal" href="#c.psa_key_type_t" title="psa_key_type_t">psa_key_type_t</a> type);</pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">attributes</span></code></p>
</dt><dd><p>The attribute object to write to.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">type</span></code></p>
</dt><dd><p>The key type to write. If this is <a class="reference internal" href="#c.PSA_KEY_TYPE_NONE" title="PSA_KEY_TYPE_NONE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_NONE</span></code></a>, the key type in <code class="docutils literal notranslate"><span class="pre">attributes</span></code> becomes unspecified.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns: <code class="docutils literal notranslate"><span class="pre">void</span></code></p>
<p class="rubric">Description</p>
<p>This function overwrites any key type previously set in <code class="docutils literal notranslate"><span class="pre">attributes</span></code>.</p>
<div class="admonition-implementation-note admonition">
<p class="admonition-title">Implementation note</p>
<p>This is a simple accessor function that is not required to validate its inputs. It can be efficiently implemented as a <code class="docutils literal notranslate"><span class="pre">static</span> <span class="pre">inline</span></code> function or a function-like-macro.</p>
</div>
</section>
<section id="c.psa_get_key_type">
<h3><code class="docutils literal notranslate"><span class="pre">psa_get_key_type</span></code> (function)<a class="headerlink" href="#c.psa_get_key_type" title="Link to this heading">¶</a></h3>
<p>Retrieve the key type from key attributes.</p>
<pre class="literal-block"><a class="reference internal" href="#c.psa_key_type_t" title="psa_key_type_t">psa_key_type_t</a> <a class="reference internal" href="#c.psa_get_key_type" title="psa_get_key_type">psa_get_key_type</a>(const <a class="reference internal" href="attributes.html#c.psa_key_attributes_t" title="psa_key_attributes_t">psa_key_attributes_t</a> * attributes);</pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">attributes</span></code></p>
</dt><dd><p>The key attribute object to query.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns: <a class="reference internal" href="#c.psa_key_type_t" title="psa_key_type_t"><code class="docutils literal notranslate"><span class="pre">psa_key_type_t</span></code></a></p>
<p>The key type stored in the attribute object.</p>
<p class="rubric">Description</p>
<div class="admonition-implementation-note admonition">
<p class="admonition-title">Implementation note</p>
<p>This is a simple accessor function that is not required to validate its inputs. It can be efficiently implemented as a <code class="docutils literal notranslate"><span class="pre">static</span> <span class="pre">inline</span></code> function or a function-like-macro.</p>
</div>
</section>
<section id="c.psa_get_key_bits">
<h3><code class="docutils literal notranslate"><span class="pre">psa_get_key_bits</span></code> (function)<a class="headerlink" href="#c.psa_get_key_bits" title="Link to this heading">¶</a></h3>
<p>Retrieve the key size from key attributes.</p>
<pre class="literal-block">size_t <a class="reference internal" href="#c.psa_get_key_bits" title="psa_get_key_bits">psa_get_key_bits</a>(const <a class="reference internal" href="attributes.html#c.psa_key_attributes_t" title="psa_key_attributes_t">psa_key_attributes_t</a> * attributes);</pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">attributes</span></code></p>
</dt><dd><p>The key attribute object to query.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns: <code class="docutils literal notranslate"><span class="pre">size_t</span></code></p>
<p>The key size stored in the attribute object, in bits.</p>
<p class="rubric">Description</p>
<div class="admonition-implementation-note admonition">
<p class="admonition-title">Implementation note</p>
<p>This is a simple accessor function that is not required to validate its inputs. It can be efficiently implemented as a <code class="docutils literal notranslate"><span class="pre">static</span> <span class="pre">inline</span></code> function or a function-like-macro.</p>
</div>
</section>
<section id="c.psa_set_key_bits">
<h3><code class="docutils literal notranslate"><span class="pre">psa_set_key_bits</span></code> (function)<a class="headerlink" href="#c.psa_set_key_bits" title="Link to this heading">¶</a></h3>
<p>Declare the size of a key.</p>
<pre class="literal-block">void <a class="reference internal" href="#c.psa_set_key_bits" title="psa_set_key_bits">psa_set_key_bits</a>(<a class="reference internal" href="attributes.html#c.psa_key_attributes_t" title="psa_key_attributes_t">psa_key_attributes_t</a> * attributes,
                      size_t bits);</pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">attributes</span></code></p>
</dt><dd><p>The attribute object to write to.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">bits</span></code></p>
</dt><dd><p>The key size in bits. If this is <code class="docutils literal notranslate"><span class="pre">0</span></code>, the key size in <code class="docutils literal notranslate"><span class="pre">attributes</span></code> becomes unspecified. Keys of size <code class="docutils literal notranslate"><span class="pre">0</span></code> are not supported.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns: <code class="docutils literal notranslate"><span class="pre">void</span></code></p>
<p class="rubric">Description</p>
<p>This function overwrites any key size previously set in <code class="docutils literal notranslate"><span class="pre">attributes</span></code>.</p>
<div class="admonition-implementation-note admonition">
<p class="admonition-title">Implementation note</p>
<p>This is a simple accessor function that is not required to validate its inputs. It can be efficiently implemented as a <code class="docutils literal notranslate"><span class="pre">static</span> <span class="pre">inline</span></code> function or a function-like-macro.</p>
</div>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &#169; 2018-2025 Arm Limited and/or its affiliates.
      
    </div>

    

    
  </body>
</html>