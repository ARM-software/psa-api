---
---

<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="2.3 Module Lattice-based signatures" />
<meta property="og:type" content="website" />
<meta property="og:url" content="{{ page.url | absolute_url }}" />
<link rel="canonical" href="{{ page.url | absolute_url }}" />
<meta property="og:site_name" content="PSA Certified Crypto API 1.3 PQC Extension" />
<meta property="og:description" content="Module Lattice-based signature keys: The Crypto API supports Module Lattice-based digital signatures (ML-DSA), as defined in FIPS Publication 204: Module-Lattice-Based Digital Signature Standard[FI..." />
<meta name="description" content="Module Lattice-based signature keys: The Crypto API supports Module Lattice-based digital signatures (ML-DSA), as defined in FIPS Publication 204: Module-Lattice-Based Digital Signature Standard[FI..." />

    <title>2.3 Module Lattice-based signatures &#8212; PSA Certified Crypto API 1.3 PQC Extension</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=686e5160" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=f6a572b4" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
    <link rel="preconnect" type="text/css" href="https://fonts.googleapis.com" />
    <link rel="preconnect" type="text/css" href="https://fonts.gstatic.com" />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,300;0,400;1,300;1,400&display=swap" />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css2?family=Noto+Sans+Mono:ital,wght@0,300;0,400;1,300&display=swap" />
    <script src="../_static/documentation_options.js?v=27ed2039"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>window.MathJax = {"chtml": {"mtextInheritFont": false, "mtextFont": "Lato-Light"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="2.4 Stateless Hash-based signatures" href="slhdsa.html" />
    <link rel="prev" title="2.2 Module Lattice-based key encapsulation" href="mlkem.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/ARM_LOGO-2025_INK_RGB.svg" alt="Logo of PSA Certified Crypto API"/>
            </a></p><hr />
<h3><a href="../index.html">PSA Certified<br />Crypto API</a></h3>
AES 0119<br/>
Non-confidential<br/>
Version 1.3 PQC Extension Beta (Issue 1)
<hr />
<ul>
<li class="toctree-l1"><a class="reference internal" href="../about.html">About this document</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview/intro.html">1 Introduction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="pqc.html">2 API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="hash.html">2.1 Additional Hash algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlkem.html">2.2 Module Lattice-based key encapsulation</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">2.3 Module Lattice-based signatures</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-lattice-based-signature-keys">2.3.1 Module Lattice-based signature keys</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-lattice-based-signature-algorithms">2.3.2 Module Lattice-based signature algorithms</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="slhdsa.html">2.4 Stateless Hash-based signatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="lms.html">2.5 Leighton-Micali Signatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="xmss.html">2.6 eXtended Merkle Signature Scheme</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../appendix/example_header.html">A Example header file</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/encodings.html">B Algorithm and key type encoding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/specdef_values.html">C Example macro implementations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/history.html">D Changes to the API</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../atg_c-identifiers.html">Index of API elements</a></li>
</ul>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="module-lattice-based-signatures">
<span id="ml-dsa"></span><h1><span class="section-number">2.3 </span>Module Lattice-based signatures<a class="headerlink" href="#module-lattice-based-signatures" title="Link to this heading">¶</a></h1>
<section id="module-lattice-based-signature-keys">
<span id="ml-dsa-keys"></span><h2><span class="section-number">2.3.1 </span>Module Lattice-based signature keys<a class="headerlink" href="#module-lattice-based-signature-keys" title="Link to this heading">¶</a></h2>
<p>The Crypto API supports Module Lattice-based digital signatures (ML-DSA), as defined in <span><em>FIPS Publication 204: Module-Lattice-Based Digital Signature Standard</em> <a class="reference internal" href="../about.html#cite-fips204"><span class="cite">[FIPS204]</span></a></span>.</p>
<section id="c.PSA_KEY_TYPE_ML_DSA_KEY_PAIR">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_ML_DSA_KEY_PAIR</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_ML_DSA_KEY_PAIR" title="Link to this heading">¶</a></h3>
<p>ML-DSA key pair: both the private and public key.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.3.</span></p>
</div>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_ML_DSA_KEY_PAIR" title="PSA_KEY_TYPE_ML_DSA_KEY_PAIR">PSA_KEY_TYPE_ML_DSA_KEY_PAIR</a> ((psa_key_type_t)0x7002)</pre>
<p>The key attribute size of an ML-DSA key is a measure of the security strength of the ML-DSA parameter set in <a class="reference internal" href="../about.html#cite-fips204"><span class="cite atg_c atg_c-cite">[FIPS204]</span></a>:</p>
<ul class="simple">
<li><p>ML-DSA-44 : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">128</span></code></p></li>
<li><p>ML-DSA-65 : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">192</span></code></p></li>
<li><p>ML-DSA-87 : <code class="docutils literal notranslate"><span class="pre">key_bits</span> <span class="pre">=</span> <span class="pre">256</span></code></p></li>
</ul>
<p>See also §4 in <a class="reference internal" href="../about.html#cite-fips204"><span class="cite atg_c atg_c-cite">[FIPS204]</span></a>.</p>
<p class="rubric">Compatible algorithms</p>
<table class="hlist"><tr><td><ul class="simple">
<li><p><a class="reference internal" href="#c.PSA_ALG_ML_DSA" title="PSA_ALG_ML_DSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ML_DSA</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.PSA_ALG_HASH_ML_DSA" title="PSA_ALG_HASH_ML_DSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_HASH_ML_DSA</span></code></a></p></li>
</ul>
</td><td><ul class="simple">
<li><p><a class="reference internal" href="#c.PSA_ALG_DETERMINISTIC_ML_DSA" title="PSA_ALG_DETERMINISTIC_ML_DSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_DETERMINISTIC_ML_DSA</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.PSA_ALG_DETERMINISTIC_HASH_ML_DSA" title="PSA_ALG_DETERMINISTIC_HASH_ML_DSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_DETERMINISTIC_HASH_ML_DSA</span></code></a></p></li>
</ul>
</td></tr></table>
<p class="rubric">Key format</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The key format may change in a final version of this API.
The standardization of exchange formats for ML-DSA public and private keys is in progress, but final documents have not been published.
See <span><em>Internet X.509 Public Key Infrastructure: Algorithm Identifiers for ML-DSA</em> <a class="reference internal" href="../about.html#cite-lamps-mldsa"><span class="cite">[LAMPS-MLDSA]</span></a></span>.</p>
<p>The current proposed format is based on the expected outcome of that process.</p>
</div>
<p>An ML-DSA key pair is the <span class="math notranslate nohighlight">\((pk,sk)\)</span> pair of public key and secret key, which are generated from a secret 32-byte seed, <span class="math notranslate nohighlight">\(\xi\)</span>. See <a class="reference internal" href="../about.html#cite-fips204"><span class="cite atg_c atg_c-cite">[FIPS204]</span></a> §5.1.</p>
<p>The data format for import and export of the key pair is the 32-byte seed <span class="math notranslate nohighlight">\(\xi\)</span>.</p>
<div class="rationale admonition docutils container">
<p class="admonition-title"><strong>Rationale</strong></p>
<p>The IETF working group responsible for defining the format of the ML-DSA keys in <em>SubjectPublicKeyInfo</em> and <em>OneAsymmetricKey</em> structures is discussing the formats at present (September 2024), with the current consensus to using just the seed value as the private key, for the following reasons:</p>
<ul>
<li><p>ML-DSA key pairs are several kB in size, but can be recomputed efficiently from the initial 32-byte seed.</p></li>
<li><p>There is no need to validate an imported ML-DSA private key — every 32-byte seed values is valid.</p></li>
<li><p>The public key cannot be derived from the secret key, so a key pair must store both the secret key and the public key.
The size of the key pair depends on the ML-DSA parameter set as follows:</p>
<table class="docutils align-left">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter set</p></th>
<th class="head"><p>Key-pair size in bytes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ML-DSA-44</p></td>
<td><p>3872</p></td>
</tr>
<tr class="row-odd"><td><p>ML-DSA-65</p></td>
<td><p>5984</p></td>
</tr>
<tr class="row-even"><td><p>ML-DSA-87</p></td>
<td><p>7488</p></td>
</tr>
</tbody>
</table>
</li>
<li><p>It is better for the standard to choose a single format to improve interoperability.</p></li>
</ul>
</div>
<p>See <a class="reference internal" href="#c.PSA_KEY_TYPE_ML_DSA_PUBLIC_KEY" title="PSA_KEY_TYPE_ML_DSA_PUBLIC_KEY"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_ML_DSA_PUBLIC_KEY</span></code></a> for the data format used when exporting the public key with <code class="docutils literal notranslate"><span class="pre">psa_export_public_key</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code>.</p>
<div class="admonition-implementation-note admonition">
<p class="admonition-title">Implementation note</p>
<p>An implementation can optionally compute and store the <span class="math notranslate nohighlight">\((pk,sk)\)</span> values, to accelerate operations that use the key.
It is recommended that an implementation retains the seed <span class="math notranslate nohighlight">\(\xi\)</span> with the key pair, in order to export the key, or copy the key to a different location.</p>
</div>
<p class="rubric">Key derivation</p>
<p>A call to <code class="docutils literal notranslate"><span class="pre">psa_key_derivation_output_key</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code> will draw 32 bytes of output and use these as the 32-byte ML-DSA key-pair seed, <span class="math notranslate nohighlight">\(xi\)</span>.
The key pair <span class="math notranslate nohighlight">\((pk, sk)\)</span> is generated from the seed as defined by <code class="docutils literal notranslate"><span class="pre">ML-DSA.KeyGen_internal()</span></code> in <a class="reference internal" href="../about.html#cite-fips204"><span class="cite atg_c atg_c-cite">[FIPS204]</span></a> §6.1.</p>
<div class="admonition-implementation-note admonition">
<p class="admonition-title">Implementation note</p>
<p>It is <a class="reference internal" href="../about.html#term-implementation-defined"><span class="scterm">implementation defined</span></a> whether the seed <span class="math notranslate nohighlight">\(xi\)</span> is expanded to <span class="math notranslate nohighlight">\((pk, sk)\)</span> at the point of derivation, or only just before the key is used.</p>
</div>
</section>
<section id="c.PSA_KEY_TYPE_ML_DSA_PUBLIC_KEY">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_ML_DSA_PUBLIC_KEY</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_ML_DSA_PUBLIC_KEY" title="Link to this heading">¶</a></h3>
<p>ML-DSA public key.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.3.</span></p>
</div>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_ML_DSA_PUBLIC_KEY" title="PSA_KEY_TYPE_ML_DSA_PUBLIC_KEY">PSA_KEY_TYPE_ML_DSA_PUBLIC_KEY</a> ((psa_key_type_t)0x4002)</pre>
<p>The key attribute size of an ML-DSA public key is the same as the corresponding private key. See <a class="reference internal" href="#c.PSA_KEY_TYPE_ML_DSA_KEY_PAIR" title="PSA_KEY_TYPE_ML_DSA_KEY_PAIR"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_ML_DSA_KEY_PAIR</span></code></a>.</p>
<p class="rubric">Compatible algorithms</p>
<table class="hlist"><tr><td><ul class="simple">
<li><p><a class="reference internal" href="#c.PSA_ALG_ML_DSA" title="PSA_ALG_ML_DSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ML_DSA</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.PSA_ALG_HASH_ML_DSA" title="PSA_ALG_HASH_ML_DSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_HASH_ML_DSA</span></code></a></p></li>
</ul>
</td><td><ul class="simple">
<li><p><a class="reference internal" href="#c.PSA_ALG_DETERMINISTIC_ML_DSA" title="PSA_ALG_DETERMINISTIC_ML_DSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_DETERMINISTIC_ML_DSA</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.PSA_ALG_DETERMINISTIC_HASH_ML_DSA" title="PSA_ALG_DETERMINISTIC_HASH_ML_DSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_DETERMINISTIC_HASH_ML_DSA</span></code></a></p></li>
</ul>
</td></tr></table>
<p class="rubric">Key format</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The key format may change in a final version of this API.
The standardization of exchange formats for ML-DSA public and private keys is in progress, but final documents have not been published.
See <span><em>Internet X.509 Public Key Infrastructure: Algorithm Identifiers for ML-DSA</em> <a class="reference internal" href="../about.html#cite-lamps-mldsa"><span class="cite">[LAMPS-MLDSA]</span></a></span>.</p>
<p>The current proposed format is based on the expected outcome of that process.</p>
</div>
<p>An ML-DSA public key is the <span class="math notranslate nohighlight">\(pk\)</span> output of <code class="docutils literal notranslate"><span class="pre">ML-DSA.KeyGen()</span></code>, defined in <a class="reference internal" href="../about.html#cite-fips204"><span class="cite atg_c atg_c-cite">[FIPS204]</span></a> §5.1.</p>
<p>The size of the public key depends on the ML-DSA parameter set as follows:</p>
<table class="docutils align-left">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter set</p></th>
<th class="head"><p>Public-key size in bytes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ML-DSA-44</p></td>
<td><p>1312</p></td>
</tr>
<tr class="row-odd"><td><p>ML-DSA-65</p></td>
<td><p>1952</p></td>
</tr>
<tr class="row-even"><td><p>ML-DSA-87</p></td>
<td><p>2592</p></td>
</tr>
</tbody>
</table>
</section>
<section id="c.PSA_KEY_TYPE_IS_ML_DSA">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_IS_ML_DSA</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_IS_ML_DSA" title="Link to this heading">¶</a></h3>
<p>Whether a key type is an ML-DSA key, either a key pair or a public key.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.3.</span></p>
</div>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_IS_ML_DSA" title="PSA_KEY_TYPE_IS_ML_DSA">PSA_KEY_TYPE_IS_ML_DSA</a>(type) <em><a class="reference internal" href="../appendix/specdef_values.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">type</span></code></p>
</dt><dd><p>A key type: a value of type <code class="docutils literal notranslate"><span class="pre">psa_key_type_t</span></code>.</p>
</dd>
</dl>
</div>
</section>
</section>
<section id="module-lattice-based-signature-algorithms">
<span id="ml-dsa-algorithms"></span><h2><span class="section-number">2.3.2 </span>Module Lattice-based signature algorithms<a class="headerlink" href="#module-lattice-based-signature-algorithms" title="Link to this heading">¶</a></h2>
<p>These algorithms extend those defined in <span><em>PSA Certified Crypto API</em> <a class="reference internal" href="../about.html#cite-psa-crypt"><span class="cite">[PSA-CRYPT]</span></a></span> §10.7 <em>Asymmetric signature</em>, for use with the signature functions.</p>
<p>The ML-DSA signature and verification scheme is defined in <span><em>FIPS Publication 204: Module-Lattice-Based Digital Signature Standard</em> <a class="reference internal" href="../about.html#cite-fips204"><span class="cite">[FIPS204]</span></a></span>.
ML-DSA has three parameter sets which provide differing security strengths.</p>
<p>ML-DSA keys are large: 1.2–2.5kB for the public key, and triple that for the key pair.
ML-DSA signatures are much larger than those for RSA and Elliptic curve schemes, between 2.4kB and 4.6kB, depending on the selected parameter set.</p>
<p>See <a class="reference internal" href="../about.html#cite-fips204"><span class="cite atg_c atg_c-cite">[FIPS204]</span></a> §4 for details on the parameter sets, and the key and generated signature sizes.</p>
<p>The generation of an ML-DSA key depends on the full parameter specification.
The encoding of each parameter set into the key attributes is described in <a class="reference internal" href="#ml-dsa-keys"><span class="secref">Module Lattice-based signature keys</span></a>.</p>
<p><a class="reference internal" href="../about.html#cite-fips204"><span class="cite atg_c atg_c-cite">[FIPS204]</span></a> defines pure and pre-hashed variants of the signature scheme, which can either be hedged (randomized) or deterministic.
Four algorithms are defined to support these variants: <a class="reference internal" href="#c.PSA_ALG_ML_DSA" title="PSA_ALG_ML_DSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ML_DSA</span></code></a>, <a class="reference internal" href="#c.PSA_ALG_DETERMINISTIC_ML_DSA" title="PSA_ALG_DETERMINISTIC_ML_DSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_DETERMINISTIC_ML_DSA</span></code></a>, <a class="reference internal" href="#c.PSA_ALG_HASH_ML_DSA" title="PSA_ALG_HASH_ML_DSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_HASH_ML_DSA()</span></code></a>, and <a class="reference internal" href="#c.PSA_ALG_DETERMINISTIC_HASH_ML_DSA" title="PSA_ALG_DETERMINISTIC_HASH_ML_DSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_DETERMINISTIC_HASH_ML_DSA()</span></code></a>.</p>
<p class="rubric" id="ml-dsa-deterministic-signatures">Hedged and deterministic signatures</p>
<p>Hedging incorporates fresh randomness in the signature computation, resulting in distinct signatures on every signing operation when given identical inputs.
Deterministic signatures do not require additional random data, and result in an identical signature for the same inputs.</p>
<p>Signature verification does not distinguish between a hedged and a deterministic signature.
Either hedged or deterministic algorithms can be used when verifying a signature.</p>
<p>When computing a signature, the key’s permitted-algorithm policy must match the requested algorithm, treating hedged and deterministic versions as distinct.
When verifying a signature, the hedged and deterministic versions of each algorithm are considered equivalent when checking the key’s permitted-algorithm policy.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The hedged version provides message secrecy and some protection against side-channels.
<a class="reference internal" href="../about.html#cite-fips204"><span class="cite atg_c atg_c-cite">[FIPS204]</span></a> recommends that users should use the hedged version if either of these issues are a concern.
The deterministic variant should only be used if the implementation does not include any source of randomness.</p>
</div>
<div class="admonition-implementation-note admonition">
<p class="admonition-title">Implementation note</p>
<p><a class="reference internal" href="../about.html#cite-fips204"><span class="cite atg_c atg_c-cite">[FIPS204]</span></a> recommends that implementations use an approved random number generator to provide the random value in the hedged version.
However, it notes that use of the hedged variant with a weak RNG is generally preferable to the deterministic variant.</p>
</div>
<div class="rationale admonition docutils container">
<p class="admonition-title"><strong>Rationale</strong></p>
<p>The use of fresh randomness, or not, when computing a signature seems like an implementation decision based on the capability of the system, and its vulnerability to specific threats, following the recommendations in <a class="reference internal" href="../about.html#cite-fips204"><span class="cite atg_c atg_c-cite">[FIPS204]</span></a>.</p>
<p>However, the Crypto API gives distinct algorithm identifiers for the hedged and deterministic variants, to enable an application use case to require a specific variant.</p>
</div>
<p class="rubric">Pure and pre-hashed algorithms</p>
<p>The pre-hashed signature computation <em>HashML-DSA</em> generates distinct signatures to a pure signature <em>ML-DSA</em>, with the same key and message hashing algorithm.</p>
<p>An ML-DSA signature can only be verified with an ML-DSA algorithm.
A HashML-DSA signature can only be verified with a HashML-DSA algorithm.</p>
<p class="rubric">Contexts</p>
<p>Contexts are not supported in the current version of this specification because there is no suitable signature interface that can take the context as a parameter.
A empty context string is used when computing or verifying ML-DSA signatures.</p>
<p>A future version of this specification may add suitable functions and extend this algorithm to support contexts.</p>
<section id="c.PSA_ALG_ML_DSA">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_ALG_ML_DSA</span></code> (macro)<a class="headerlink" href="#c.PSA_ALG_ML_DSA" title="Link to this heading">¶</a></h3>
<p>Module lattice-based digital signature algorithm without pre-hashing (ML-DSA).</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.3.</span></p>
</div>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ALG_ML_DSA" title="PSA_ALG_ML_DSA">PSA_ALG_ML_DSA</a> ((psa_algorithm_t) 0x06004400)</pre>
<p>This algorithm can only be used with the <code class="docutils literal notranslate"><span class="pre">psa_sign_message</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code> and <code class="docutils literal notranslate"><span class="pre">psa_verify_message</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code> functions.</p>
<p>This is the pure ML-DSA digital signature algorithm, defined by <span><em>FIPS Publication 204: Module-Lattice-Based Digital Signature Standard</em> <a class="reference internal" href="../about.html#cite-fips204"><span class="cite">[FIPS204]</span></a></span>, using hedging.
ML-DSA requires an ML-DSA key, which determines the ML-DSA parameter set for the operation.</p>
<p>This algorithm is randomized: each invocation returns a different, equally valid signature.
See the <a class="reference internal" href="#ml-dsa-deterministic-signatures">notes on hedged signatures</a>.</p>
<p>When <a class="reference internal" href="#c.PSA_ALG_ML_DSA" title="PSA_ALG_ML_DSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ML_DSA</span></code></a> is used as a permitted algorithm in a key policy, this permits:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#c.PSA_ALG_ML_DSA" title="PSA_ALG_ML_DSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ML_DSA</span></code></a> as the algorithm in a call to <code class="docutils literal notranslate"><span class="pre">psa_sign_message</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code>.</p></li>
<li><p><a class="reference internal" href="#c.PSA_ALG_ML_DSA" title="PSA_ALG_ML_DSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ML_DSA</span></code></a> or <a class="reference internal" href="#c.PSA_ALG_DETERMINISTIC_ML_DSA" title="PSA_ALG_DETERMINISTIC_ML_DSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_DETERMINISTIC_ML_DSA</span></code></a> as the algorithm in a call to <code class="docutils literal notranslate"><span class="pre">psa_verify_message</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code>.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To sign or verify the pre-computed hash of a message using ML-DSA, the HashML-DSA algorithms (<a class="reference internal" href="#c.PSA_ALG_HASH_ML_DSA" title="PSA_ALG_HASH_ML_DSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_HASH_ML_DSA()</span></code></a> and <a class="reference internal" href="#c.PSA_ALG_DETERMINISTIC_HASH_ML_DSA" title="PSA_ALG_DETERMINISTIC_HASH_ML_DSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_DETERMINISTIC_HASH_ML_DSA()</span></code></a>) can also be used with <code class="docutils literal notranslate"><span class="pre">psa_sign_hash</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code> and <code class="docutils literal notranslate"><span class="pre">psa_verify_hash</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code>.</p>
<p>The signature produced by HashML-DSA is distinct from that produced by ML-DSA.</p>
</div>
<p class="rubric">Compatible key types</p>
<div class="line-block">
<div class="line"><a class="reference internal" href="#c.PSA_KEY_TYPE_ML_DSA_KEY_PAIR" title="PSA_KEY_TYPE_ML_DSA_KEY_PAIR"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_ML_DSA_KEY_PAIR</span></code></a></div>
<div class="line"><a class="reference internal" href="#c.PSA_KEY_TYPE_ML_DSA_PUBLIC_KEY" title="PSA_KEY_TYPE_ML_DSA_PUBLIC_KEY"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_ML_DSA_PUBLIC_KEY</span></code></a> (signature verification only)</div>
</div>
</section>
<section id="c.PSA_ALG_DETERMINISTIC_ML_DSA">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_ALG_DETERMINISTIC_ML_DSA</span></code> (macro)<a class="headerlink" href="#c.PSA_ALG_DETERMINISTIC_ML_DSA" title="Link to this heading">¶</a></h3>
<p>Deterministic module lattice-based digital signature algorithm without pre-hashing (ML-DSA).</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.3.</span></p>
</div>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ALG_DETERMINISTIC_ML_DSA" title="PSA_ALG_DETERMINISTIC_ML_DSA">PSA_ALG_DETERMINISTIC_ML_DSA</a> ((psa_algorithm_t) 0x06004500)</pre>
<p>This algorithm can only be used with the <code class="docutils literal notranslate"><span class="pre">psa_sign_message</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code> and <code class="docutils literal notranslate"><span class="pre">psa_verify_message</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code> functions.</p>
<p>This is the pure ML-DSA digital signature algorithm, defined by <span><em>FIPS Publication 204: Module-Lattice-Based Digital Signature Standard</em> <a class="reference internal" href="../about.html#cite-fips204"><span class="cite">[FIPS204]</span></a></span>, without hedging.
ML-DSA requires an ML-DSA key, which determines the ML-DSA parameter set for the operation.</p>
<p>This algorithm is deterministic: each invocation with the same inputs returns an identical signature.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It is recommended to use the hedged <a class="reference internal" href="#c.PSA_ALG_ML_DSA" title="PSA_ALG_ML_DSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ML_DSA</span></code></a> algorithm instead, when supported by the implementation.
See the <a class="reference internal" href="#ml-dsa-deterministic-signatures">notes on deterministic signatures</a>.</p>
</div>
<p>When <a class="reference internal" href="#c.PSA_ALG_DETERMINISTIC_ML_DSA" title="PSA_ALG_DETERMINISTIC_ML_DSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_DETERMINISTIC_ML_DSA</span></code></a> is used as a permitted algorithm in a key policy, this permits:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#c.PSA_ALG_DETERMINISTIC_ML_DSA" title="PSA_ALG_DETERMINISTIC_ML_DSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_DETERMINISTIC_ML_DSA</span></code></a> as the algorithm in a call to <code class="docutils literal notranslate"><span class="pre">psa_sign_message</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code>.</p></li>
<li><p><a class="reference internal" href="#c.PSA_ALG_ML_DSA" title="PSA_ALG_ML_DSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ML_DSA</span></code></a> or <a class="reference internal" href="#c.PSA_ALG_DETERMINISTIC_ML_DSA" title="PSA_ALG_DETERMINISTIC_ML_DSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_DETERMINISTIC_ML_DSA</span></code></a> as the algorithm in a call to <code class="docutils literal notranslate"><span class="pre">psa_verify_message</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code>.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To sign or verify the pre-computed hash of a message using ML-DSA, the HashML-DSA algorithms (<a class="reference internal" href="#c.PSA_ALG_HASH_ML_DSA" title="PSA_ALG_HASH_ML_DSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_HASH_ML_DSA()</span></code></a> and <a class="reference internal" href="#c.PSA_ALG_DETERMINISTIC_HASH_ML_DSA" title="PSA_ALG_DETERMINISTIC_HASH_ML_DSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_DETERMINISTIC_HASH_ML_DSA()</span></code></a>) can also be used with <code class="docutils literal notranslate"><span class="pre">psa_sign_hash</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code> and <code class="docutils literal notranslate"><span class="pre">psa_verify_hash</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code>.</p>
<p>The signature produced by HashML-DSA is distinct from that produced by ML-DSA.</p>
</div>
<p class="rubric">Compatible key types</p>
<div class="line-block">
<div class="line"><a class="reference internal" href="#c.PSA_KEY_TYPE_ML_DSA_KEY_PAIR" title="PSA_KEY_TYPE_ML_DSA_KEY_PAIR"><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_ML_DSA_KEY_PAIR</span></code></a></div>
<div class="line"><a class="reference internal" href="#c.PSA_KEY_TYPE_ML_DSA_PUBLIC_KEY" title="PSA_KEY_TYPE_ML_DSA_PUBLIC_KEY"><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_ML_DSA_PUBLIC_KEY</span></code></a> (signature verification only)</div>
</div>
</section>
<section id="c.PSA_ALG_HASH_ML_DSA">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_ALG_HASH_ML_DSA</span></code> (macro)<a class="headerlink" href="#c.PSA_ALG_HASH_ML_DSA" title="Link to this heading">¶</a></h3>
<p>Module lattice-based digital signature algorithm with pre-hashing (HashML-DSA).</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.3.</span></p>
</div>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ALG_HASH_ML_DSA" title="PSA_ALG_HASH_ML_DSA">PSA_ALG_HASH_ML_DSA</a>(hash_alg) <em><a class="reference internal" href="../appendix/specdef_values.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">hash_alg</span></code></p>
</dt><dd><p>A hash algorithm: a value of type <code class="docutils literal notranslate"><span class="pre">psa_algorithm_t</span></code> such that <code class="docutils literal notranslate"><span class="pre">PSA_ALG_IS_HASH</span></code><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">hash_alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> is true.
This includes <code class="docutils literal notranslate"><span class="pre">PSA_ALG_ANY_HASH</span></code> when specifying the algorithm in a key policy.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns</p>
<p>The corresponding HashML-DSA signature algorithm, using <code class="docutils literal notranslate"><span class="pre">hash_alg</span></code> to pre-hash the message.</p>
<p>Unspecified if <code class="docutils literal notranslate"><span class="pre">hash_alg</span></code> is not a supported hash algorithm.</p>
<p class="rubric">Description</p>
<p>This algorithm can be used with both the message and hash signature functions.</p>
<p>This is the pre-hashed ML-DSA digital signature algorithm, defined by <span><em>FIPS Publication 204: Module-Lattice-Based Digital Signature Standard</em> <a class="reference internal" href="../about.html#cite-fips204"><span class="cite">[FIPS204]</span></a></span>, using hedging.
ML-DSA requires an ML-DSA key, which determines the ML-DSA parameter set for the operation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the pre-hashing, <a class="reference internal" href="../about.html#cite-fips204"><span class="cite atg_c atg_c-cite">[FIPS204]</span></a> §5.4 recommends the use of an approved hash function with an equivalent, or better, security strength than the chosen ML-DSA parameter set.</p>
</div>
<p>This algorithm is randomized: each invocation returns a different, equally valid signature.
See the <a class="reference internal" href="#ml-dsa-deterministic-signatures">notes on hedged signatures</a>.</p>
<p>When <a class="reference internal" href="#c.PSA_ALG_HASH_ML_DSA" title="PSA_ALG_HASH_ML_DSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_HASH_ML_DSA()</span></code></a> is used as a permitted algorithm in a key policy, this permits:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#c.PSA_ALG_HASH_ML_DSA" title="PSA_ALG_HASH_ML_DSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_HASH_ML_DSA()</span></code></a> as the algorithm in a call to <code class="docutils literal notranslate"><span class="pre">psa_sign_message</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code> and <code class="docutils literal notranslate"><span class="pre">psa_sign_hash</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code>.</p></li>
<li><p><a class="reference internal" href="#c.PSA_ALG_HASH_ML_DSA" title="PSA_ALG_HASH_ML_DSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_HASH_ML_DSA()</span></code></a> or <a class="reference internal" href="#c.PSA_ALG_DETERMINISTIC_HASH_ML_DSA" title="PSA_ALG_DETERMINISTIC_HASH_ML_DSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_DETERMINISTIC_HASH_ML_DSA()</span></code></a> as the algorithm in a call to <code class="docutils literal notranslate"><span class="pre">psa_verify_message</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code> and <code class="docutils literal notranslate"><span class="pre">psa_verify_hash</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code>.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The signature produced by HashML-DSA is distinct from that produced by ML-DSA.</p>
</div>
<p class="rubric">Usage</p>
<p>This is a hash-and-sign algorithm. To calculate a signature, use one of the following approaches:</p>
<ul class="simple">
<li><p>Call <code class="docutils literal notranslate"><span class="pre">psa_sign_message</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code> with the message.</p></li>
<li><p>Calculate the hash of the message with <code class="docutils literal notranslate"><span class="pre">psa_hash_compute</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code>, or with a multi-part hash operation, using the <code class="docutils literal notranslate"><span class="pre">hash_alg</span></code> hash algorithm.
Note that <code class="docutils literal notranslate"><span class="pre">hash_alg</span></code> can be extracted from the signature algorithm using <code class="docutils literal notranslate"><span class="pre">PSA_ALG_GET_HASH</span></code><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">sig_alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code>.
Then sign the calculated hash with <code class="docutils literal notranslate"><span class="pre">psa_sign_hash</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code>.</p></li>
</ul>
<p>Verifying a signature is similar, using <code class="docutils literal notranslate"><span class="pre">psa_verify_message</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code> or <code class="docutils literal notranslate"><span class="pre">psa_verify_hash</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code> instead of the signature function.</p>
<p class="rubric">Compatible key types</p>
<div class="line-block">
<div class="line"><a class="reference internal" href="#c.PSA_KEY_TYPE_ML_DSA_KEY_PAIR" title="PSA_KEY_TYPE_ML_DSA_KEY_PAIR"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_ML_DSA_KEY_PAIR</span></code></a></div>
<div class="line"><a class="reference internal" href="#c.PSA_KEY_TYPE_ML_DSA_PUBLIC_KEY" title="PSA_KEY_TYPE_ML_DSA_PUBLIC_KEY"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_ML_DSA_PUBLIC_KEY</span></code></a> (signature verification only)</div>
</div>
</section>
<section id="c.PSA_ALG_DETERMINISTIC_HASH_ML_DSA">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_ALG_DETERMINISTIC_HASH_ML_DSA</span></code> (macro)<a class="headerlink" href="#c.PSA_ALG_DETERMINISTIC_HASH_ML_DSA" title="Link to this heading">¶</a></h3>
<p>Deterministic module lattice-based digital signature algorithm with pre-hashing (HashML-DSA).</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.3.</span></p>
</div>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ALG_DETERMINISTIC_HASH_ML_DSA" title="PSA_ALG_DETERMINISTIC_HASH_ML_DSA">PSA_ALG_DETERMINISTIC_HASH_ML_DSA</a>(hash_alg) \
    <em><a class="reference internal" href="../appendix/specdef_values.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">hash_alg</span></code></p>
</dt><dd><p>A hash algorithm: a value of type <code class="docutils literal notranslate"><span class="pre">psa_algorithm_t</span></code> such that <code class="docutils literal notranslate"><span class="pre">PSA_ALG_IS_HASH</span></code><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">hash_alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> is true.
This includes <code class="docutils literal notranslate"><span class="pre">PSA_ALG_ANY_HASH</span></code> when specifying the algorithm in a key policy.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns</p>
<p>The corresponding deterministic HashML-DSA signature algorithm, using <code class="docutils literal notranslate"><span class="pre">hash_alg</span></code> to pre-hash the message.</p>
<p>Unspecified if <code class="docutils literal notranslate"><span class="pre">hash_alg</span></code> is not a supported hash algorithm.</p>
<p class="rubric">Description</p>
<p>This algorithm can be used with both the message and hash signature functions.</p>
<p>This is the pre-hashed ML-DSA digital signature algorithm, defined by <span><em>FIPS Publication 204: Module-Lattice-Based Digital Signature Standard</em> <a class="reference internal" href="../about.html#cite-fips204"><span class="cite">[FIPS204]</span></a></span>, without hedging.
ML-DSA requires an ML-DSA key, which determines the ML-DSA parameter set for the operation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the pre-hashing, <a class="reference internal" href="../about.html#cite-fips204"><span class="cite atg_c atg_c-cite">[FIPS204]</span></a> §5.4 recommends the use of an approved hash function with an equivalent, or better, security strength than the chosen ML-DSA parameter set.</p>
</div>
<p>This algorithm is deterministic: each invocation with the same inputs returns an identical signature.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It is recommended to use the hedged <a class="reference internal" href="#c.PSA_ALG_HASH_ML_DSA" title="PSA_ALG_HASH_ML_DSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_HASH_ML_DSA()</span></code></a> algorithm instead, when supported by the implementation.
See the <a class="reference internal" href="#ml-dsa-deterministic-signatures">notes on deterministic signatures</a>.</p>
</div>
<p>When <a class="reference internal" href="#c.PSA_ALG_DETERMINISTIC_HASH_ML_DSA" title="PSA_ALG_DETERMINISTIC_HASH_ML_DSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_DETERMINISTIC_HASH_ML_DSA()</span></code></a> is used as a permitted algorithm in a key policy, this permits:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#c.PSA_ALG_DETERMINISTIC_HASH_ML_DSA" title="PSA_ALG_DETERMINISTIC_HASH_ML_DSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_DETERMINISTIC_HASH_ML_DSA()</span></code></a> as the algorithm in a call to <code class="docutils literal notranslate"><span class="pre">psa_sign_message</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code> and <code class="docutils literal notranslate"><span class="pre">psa_sign_hash</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code>.</p></li>
<li><p><a class="reference internal" href="#c.PSA_ALG_HASH_ML_DSA" title="PSA_ALG_HASH_ML_DSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_HASH_ML_DSA()</span></code></a> or <a class="reference internal" href="#c.PSA_ALG_DETERMINISTIC_HASH_ML_DSA" title="PSA_ALG_DETERMINISTIC_HASH_ML_DSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_DETERMINISTIC_HASH_ML_DSA()</span></code></a> as the algorithm in a call to <code class="docutils literal notranslate"><span class="pre">psa_verify_message</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code> and <code class="docutils literal notranslate"><span class="pre">psa_verify_hash</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code>.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The signature produced by HashML-DSA is distinct from that produced by ML-DSA.</p>
</div>
<p class="rubric">Usage</p>
<p>See <a class="reference internal" href="#c.PSA_ALG_HASH_ML_DSA" title="PSA_ALG_HASH_ML_DSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_HASH_ML_DSA()</span></code></a> for example usage.</p>
<p class="rubric">Compatible key types</p>
<div class="line-block">
<div class="line"><a class="reference internal" href="#c.PSA_KEY_TYPE_ML_DSA_KEY_PAIR" title="PSA_KEY_TYPE_ML_DSA_KEY_PAIR"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_ML_DSA_KEY_PAIR</span></code></a></div>
<div class="line"><a class="reference internal" href="#c.PSA_KEY_TYPE_ML_DSA_PUBLIC_KEY" title="PSA_KEY_TYPE_ML_DSA_PUBLIC_KEY"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_ML_DSA_PUBLIC_KEY</span></code></a> (signature verification only)</div>
</div>
</section>
<section id="c.PSA_ALG_IS_ML_DSA">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_ALG_IS_ML_DSA</span></code> (macro)<a class="headerlink" href="#c.PSA_ALG_IS_ML_DSA" title="Link to this heading">¶</a></h3>
<p>Whether the specified algorithm is ML-DSA, without pre-hashing.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.3.</span></p>
</div>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ALG_IS_ML_DSA" title="PSA_ALG_IS_ML_DSA">PSA_ALG_IS_ML_DSA</a>(alg) <em><a class="reference internal" href="../appendix/specdef_values.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">alg</span></code></p>
</dt><dd><p>An algorithm identifier: a value of type <code class="docutils literal notranslate"><span class="pre">psa_algorithm_t</span></code>.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns</p>
<p><code class="docutils literal notranslate"><span class="pre">1</span></code> if <code class="docutils literal notranslate"><span class="pre">alg</span></code> is a pure ML-DSA algorithm, <code class="docutils literal notranslate"><span class="pre">0</span></code> otherwise.</p>
<p>This macro can return either <code class="docutils literal notranslate"><span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code> if <code class="docutils literal notranslate"><span class="pre">alg</span></code> is not a supported algorithm identifier.</p>
<p class="rubric">Description</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Use <a class="reference internal" href="#c.PSA_ALG_IS_HASH_ML_DSA" title="PSA_ALG_IS_HASH_ML_DSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_IS_HASH_ML_DSA()</span></code></a> to determine if an algorithm identifier is a HashML-DSA algorithm.</p>
</div>
</section>
<section id="c.PSA_ALG_IS_HASH_ML_DSA">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_ALG_IS_HASH_ML_DSA</span></code> (macro)<a class="headerlink" href="#c.PSA_ALG_IS_HASH_ML_DSA" title="Link to this heading">¶</a></h3>
<p>Whether the specified algorithm is HashML-DSA.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.3.</span></p>
</div>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ALG_IS_HASH_ML_DSA" title="PSA_ALG_IS_HASH_ML_DSA">PSA_ALG_IS_HASH_ML_DSA</a>(alg) <em><a class="reference internal" href="../appendix/specdef_values.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">alg</span></code></p>
</dt><dd><p>An algorithm identifier: a value of type <code class="docutils literal notranslate"><span class="pre">psa_algorithm_t</span></code>.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns</p>
<p><code class="docutils literal notranslate"><span class="pre">1</span></code> if <code class="docutils literal notranslate"><span class="pre">alg</span></code> is a HashML-DSA algorithm, <code class="docutils literal notranslate"><span class="pre">0</span></code> otherwise.</p>
<p>This macro can return either <code class="docutils literal notranslate"><span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code> if <code class="docutils literal notranslate"><span class="pre">alg</span></code> is not a supported algorithm identifier.</p>
<p class="rubric">Description</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Use <a class="reference internal" href="#c.PSA_ALG_IS_ML_DSA" title="PSA_ALG_IS_ML_DSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_IS_ML_DSA()</span></code></a> to determine if an algorithm identifier is a pre-hashed ML-DSA algorithm.</p>
</div>
</section>
<section id="c.PSA_ALG_IS_DETERMINISTIC_HASH_ML_DSA">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_ALG_IS_DETERMINISTIC_HASH_ML_DSA</span></code> (macro)<a class="headerlink" href="#c.PSA_ALG_IS_DETERMINISTIC_HASH_ML_DSA" title="Link to this heading">¶</a></h3>
<p>Whether the specified algorithm is deterministic HashML-DSA.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.3.</span></p>
</div>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ALG_IS_DETERMINISTIC_HASH_ML_DSA" title="PSA_ALG_IS_DETERMINISTIC_HASH_ML_DSA">PSA_ALG_IS_DETERMINISTIC_HASH_ML_DSA</a>(alg) \
    <em><a class="reference internal" href="../appendix/specdef_values.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">alg</span></code></p>
</dt><dd><p>An algorithm identifier: a value of type <code class="docutils literal notranslate"><span class="pre">psa_algorithm_t</span></code>.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns</p>
<p><code class="docutils literal notranslate"><span class="pre">1</span></code> if <code class="docutils literal notranslate"><span class="pre">alg</span></code> is a deterministic HashML-DSA algorithm, <code class="docutils literal notranslate"><span class="pre">0</span></code> otherwise.</p>
<p>This macro can return either <code class="docutils literal notranslate"><span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code> if <code class="docutils literal notranslate"><span class="pre">alg</span></code> is not a supported algorithm identifier.</p>
<p class="rubric">Description</p>
<p>See also <a class="reference internal" href="#c.PSA_ALG_IS_HASH_ML_DSA" title="PSA_ALG_IS_HASH_ML_DSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_IS_HASH_ML_DSA()</span></code></a> and <a class="reference internal" href="#c.PSA_ALG_IS_HEDGED_HASH_ML_DSA" title="PSA_ALG_IS_HEDGED_HASH_ML_DSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_IS_HEDGED_HASH_ML_DSA()</span></code></a>.</p>
</section>
<section id="c.PSA_ALG_IS_HEDGED_HASH_ML_DSA">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_ALG_IS_HEDGED_HASH_ML_DSA</span></code> (macro)<a class="headerlink" href="#c.PSA_ALG_IS_HEDGED_HASH_ML_DSA" title="Link to this heading">¶</a></h3>
<p>Whether the specified algorithm is hedged HashML-DSA.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.3.</span></p>
</div>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ALG_IS_HEDGED_HASH_ML_DSA" title="PSA_ALG_IS_HEDGED_HASH_ML_DSA">PSA_ALG_IS_HEDGED_HASH_ML_DSA</a>(alg) <em><a class="reference internal" href="../appendix/specdef_values.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">alg</span></code></p>
</dt><dd><p>An algorithm identifier: a value of type <code class="docutils literal notranslate"><span class="pre">psa_algorithm_t</span></code>.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns</p>
<p><code class="docutils literal notranslate"><span class="pre">1</span></code> if <code class="docutils literal notranslate"><span class="pre">alg</span></code> is a hedged HashML-DSA algorithm, <code class="docutils literal notranslate"><span class="pre">0</span></code> otherwise.</p>
<p>This macro can return either <code class="docutils literal notranslate"><span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code> if <code class="docutils literal notranslate"><span class="pre">alg</span></code> is not a supported algorithm identifier.</p>
<p class="rubric">Description</p>
<p>See also <a class="reference internal" href="#c.PSA_ALG_IS_HASH_ML_DSA" title="PSA_ALG_IS_HASH_ML_DSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_IS_HASH_ML_DSA()</span></code></a> and <a class="reference internal" href="#c.PSA_ALG_IS_DETERMINISTIC_HASH_ML_DSA" title="PSA_ALG_IS_DETERMINISTIC_HASH_ML_DSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_IS_DETERMINISTIC_HASH_ML_DSA()</span></code></a>.</p>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &#169; 2024-2025 Arm Limited and/or its affiliates.
      
    </div>

    

    
  </body>
</html>