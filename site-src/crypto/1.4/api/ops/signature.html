---
---

<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="10.9 Asymmetric signature" />
<meta property="og:type" content="website" />
<meta property="og:url" content="{{ page.url | absolute_url }}" />
<link rel="canonical" href="{{ page.url | absolute_url }}" />
<meta property="og:site_name" content="PSA Certified Crypto API 1.4" />
<meta property="og:description" content="An asymmetric signature algorithm provides two functions: Sign: Calculate a message signature using a private, or secret, key., Verify: Check that a signature matches a message using a public key....." />
<meta name="description" content="An asymmetric signature algorithm provides two functions: Sign: Calculate a message signature using a private, or secret, key., Verify: Check that a signature matches a message using a public key....." />

    <title>10.9 Asymmetric signature &#8212; PSA Certified Crypto API 1.4</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic.css?v=686e5160" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=f6a572b4" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=4ae1632d" />
    <link rel="preconnect" type="text/css" href="https://fonts.googleapis.com" />
    <link rel="preconnect" type="text/css" href="https://fonts.gstatic.com" />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,300;0,400;1,300;1,400&display=swap" />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css2?family=Noto+Sans+Mono:ital,wght@0,300;0,400;1,300&display=swap" />
    <script src="../../_static/documentation_options.js?v=ea36c55f"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>window.MathJax = {"chtml": {"mtextInheritFont": false, "mtextFont": "Lato-Light"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="10.10 Asymmetric encryption" href="pk-encryption.html" />
    <link rel="prev" title="10.8 Key derivation" href="key-derivation.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/ARM_LOGO-2025_INK_RGB.svg" alt="Logo of PSA Certified Crypto API"/>
            </a></p><hr />
<h3><a href="../../index.html">PSA Certified<br />Crypto API</a></h3>
IHI 0086<br/>
Non-confidential<br/>
Version 1.4.0
<hr />
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../about/about.html">About this document</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../overview/intro.html">1 Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/goals.html">2 Design goals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/functionality.html">3 Functionality overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/sample-arch.html">4 Sample architectures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/conventions.html">5 Library conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/implementation.html">6 Implementation considerations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/usage.html">7 Usage considerations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../library/index.html">8 Library management reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../keys/index.html">9 Key management reference</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">10 Cryptographic operation reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="algorithms.html">10.1 Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="hash.html">10.2 Message digests (Hashes)</a></li>
<li class="toctree-l2"><a class="reference internal" href="xof.html">10.3 Extendable-output functions (XOF)</a></li>
<li class="toctree-l2"><a class="reference internal" href="mac.html">10.4 Message authentication codes (MAC)</a></li>
<li class="toctree-l2"><a class="reference internal" href="cipher.html">10.5 Unauthenticated ciphers</a></li>
<li class="toctree-l2"><a class="reference internal" href="aead.html">10.6 Authenticated encryption with associated data (AEAD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="key-wrapping.html">10.7 Key wrapping</a></li>
<li class="toctree-l2"><a class="reference internal" href="key-derivation.html">10.8 Key derivation</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">10.9 Asymmetric signature</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#rsa-signature-algorithms">10.9.1 RSA signature algorithms</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ecdsa-signature-algorithms">10.9.2 ECDSA signature algorithms</a></li>
<li class="toctree-l3"><a class="reference internal" href="#eddsa-signature-algorithms">10.9.3 EdDSA signature algorithms</a></li>
<li class="toctree-l3"><a class="reference internal" href="#asymmetric-signature-functions">10.9.4 Asymmetric signature functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#support-macros">10.9.5 Support macros</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pk-encryption.html">10.10 Asymmetric encryption</a></li>
<li class="toctree-l2"><a class="reference internal" href="key-agreement.html">10.11 Key agreement</a></li>
<li class="toctree-l2"><a class="reference internal" href="key-encapsulation.html">10.12 Key encapsulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="pake.html">10.13 Password-authenticated key exchange (PAKE)</a></li>
<li class="toctree-l2"><a class="reference internal" href="rng.html">10.14 Other cryptographic services</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../appendix/example_header.html">A Example header file</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendix/encodings.html">B Algorithm and key type encoding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendix/specdef_values.html">C Example macro implementations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendix/sra.html">D Security Risk Assessment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendix/history.html">E Changes to the API</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../atg_c-identifiers.html">Index of API elements</a></li>
</ul>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="asymmetric-signature">
<span id="sign"></span><h1><span class="section-number">10.9 </span>Asymmetric signature<a class="headerlink" href="#asymmetric-signature" title="Link to this heading">¶</a></h1>
<p>An asymmetric signature algorithm provides two functions:</p>
<ul class="simple">
<li><p><strong>Sign</strong>: Calculate a message signature using a private, or secret, key.</p></li>
<li><p><strong>Verify</strong>: Check that a signature matches a message using a public key.</p></li>
</ul>
<p>Successful verification indicates that the message signature was calculated using the private key that is associated with the public key.</p>
<p>In the Crypto API, an asymmetric-sign function requires an asymmetric key pair; and an asymmetric-verify function requires an asymmetric public key or key pair.</p>
<p class="rubric">Signature schemes</p>
<p>The Crypto API supports the following signature schemes:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#rsa-sign-algorithms"><span class="secref">RSA signature algorithms</span></a></p></li>
<li><p><a class="reference internal" href="#ecdsa-sign-algorithms"><span class="secref">ECDSA signature algorithms</span></a></p></li>
<li><p><a class="reference internal" href="#eddsa-sign-algorithms"><span class="secref">EdDSA signature algorithms</span></a></p></li>
</ul>
<p class="rubric">Types of signature algorithm</p>
<p>There are three categories of asymmetric signature algorithm in the Crypto API:</p>
<ul>
<li><p>Hash-and-sign algorithms, that have two distinct phases:</p>
<ul class="simple">
<li><p>Calculate a hash of the message</p></li>
<li><p>Calculate a signature over the hash</p></li>
</ul>
<p>For these algorithms, the asymmetric signature API allows applications to either calculate the full message signature, or calculate the signature of a pre-computed hash. For example, this enables the application to use a multi-part hash operation to calculate the hash of a large message, prior to calculating or verifying a signature on the calculated hash.</p>
<p>The following algorithms are in this category:</p>
<div class="line-block">
<div class="line"><a class="reference internal" href="#c.PSA_ALG_RSA_PKCS1V15_SIGN" title="PSA_ALG_RSA_PKCS1V15_SIGN"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_RSA_PKCS1V15_SIGN</span></code></a></div>
<div class="line"><a class="reference internal" href="#c.PSA_ALG_RSA_PSS" title="PSA_ALG_RSA_PSS"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_RSA_PSS</span></code></a></div>
<div class="line"><a class="reference internal" href="#c.PSA_ALG_RSA_PSS_ANY_SALT" title="PSA_ALG_RSA_PSS_ANY_SALT"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_RSA_PSS_ANY_SALT</span></code></a></div>
<div class="line"><a class="reference internal" href="#c.PSA_ALG_ECDSA" title="PSA_ALG_ECDSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ECDSA</span></code></a></div>
<div class="line"><a class="reference internal" href="#c.PSA_ALG_DETERMINISTIC_ECDSA" title="PSA_ALG_DETERMINISTIC_ECDSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_DETERMINISTIC_ECDSA</span></code></a></div>
<div class="line"><a class="reference internal" href="#c.PSA_ALG_ED25519PH" title="PSA_ALG_ED25519PH"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ED25519PH</span></code></a></div>
<div class="line"><a class="reference internal" href="#c.PSA_ALG_ED448PH" title="PSA_ALG_ED448PH"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ED448PH</span></code></a></div>
</div>
</li>
<li><p>Message signature algorithms that do not separate the message processing from the signature calculations. This approach can provide better security against certain types of attack.</p>
<p>For these algorithms, it is not possible to inject a pre-computed hash into the middle of the algorithm. An application can choose to calculate a message hash, and sign that instead of the message — but this is not functionally equivalent to signing the message, and eliminates the security benefits of signing the message directly.</p>
<p>Some of these algorithms still permit the signature of a large message to be calculated, or verified, by providing the message data in fragments. This is possible when the algorithm only processes the message data once. See the individual algorithm descriptions for details.</p>
<p>The following algorithms are in this category:</p>
<div class="line-block">
<div class="line"><a class="reference internal" href="#c.PSA_ALG_PURE_EDDSA" title="PSA_ALG_PURE_EDDSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_PURE_EDDSA</span></code></a></div>
<div class="line"><a class="reference internal" href="#c.PSA_ALG_EDDSA_CTX" title="PSA_ALG_EDDSA_CTX"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_EDDSA_CTX</span></code></a></div>
</div>
</li>
<li><p>Specialized signature algorithms, that use part of a standard signature algorithm within a specific protocol. It is recommended that these algorithms are only used for that purpose, with inputs as specified by the higher-level protocol. See the individual algorithm descriptions for details on their usage.</p>
<p>The following algorithms are in this category:</p>
<div class="line-block">
<div class="line"><a class="reference internal" href="#c.PSA_ALG_RSA_PKCS1V15_SIGN_RAW" title="PSA_ALG_RSA_PKCS1V15_SIGN_RAW"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_RSA_PKCS1V15_SIGN_RAW</span></code></a></div>
<div class="line"><a class="reference internal" href="#c.PSA_ALG_ECDSA_ANY" title="PSA_ALG_ECDSA_ANY"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ECDSA_ANY</span></code></a></div>
</div>
</li>
</ul>
<p class="rubric">Signature functions</p>
<p>The Crypto API provides several functions for calculating and verifying signatures:</p>
<ul>
<li><p>The single-part signature and verification functions, <a class="reference internal" href="#c.psa_sign_message" title="psa_sign_message"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_sign_message()</span></code></a> and <a class="reference internal" href="#c.psa_verify_message" title="psa_verify_message"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_verify_message()</span></code></a>, take a message as one of their inputs, and perform the sign or verify algorithm.</p>
<p>These functions can be used on any hash-and-sign, or message signature, algorithms. See also <a class="reference internal" href="#c.PSA_ALG_IS_SIGN_MESSAGE" title="PSA_ALG_IS_SIGN_MESSAGE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_IS_SIGN_MESSAGE()</span></code></a>.</p>
</li>
<li><p>The single-part functions, <a class="reference internal" href="#c.psa_sign_hash" title="psa_sign_hash"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_sign_hash()</span></code></a> and <a class="reference internal" href="#c.psa_verify_hash" title="psa_verify_hash"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_verify_hash()</span></code></a>, typically take a message hash as one of their inputs, and perform the sign or verify algorithm.</p>
<p>These functions can be used on any hash-and-sign signature algorithm. It is recommended that the input to these functions is a hash, computed using the corresponding hash algorithm. To determine which hash algorithm to use, the macro <a class="reference internal" href="algorithms.html#c.PSA_ALG_GET_HASH" title="PSA_ALG_GET_HASH"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_GET_HASH()</span></code></a> can be called on the signature algorithm identifier.</p>
<p>These functions can also be used on the specialized signature algorithms, with a hash or encoded-hash as input. See also <a class="reference internal" href="#c.PSA_ALG_IS_SIGN_HASH" title="PSA_ALG_IS_SIGN_HASH"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_IS_SIGN_HASH()</span></code></a>.</p>
</li>
<li><p>Many modern signature algorithms have been designed to also accept a context parameter to provide domain separation.
Version 1.4 of the Crypto API introduced four new functions that accept contexts: <a class="reference internal" href="#c.psa_sign_message_with_context" title="psa_sign_message_with_context"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_sign_message_with_context()</span></code></a>, <a class="reference internal" href="#c.psa_sign_hash_with_context" title="psa_sign_hash_with_context"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_sign_hash_with_context()</span></code></a>, <a class="reference internal" href="#c.psa_verify_message_with_context" title="psa_verify_message_with_context"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_verify_message_with_context()</span></code></a>, and <a class="reference internal" href="#c.psa_verify_hash_with_context" title="psa_verify_hash_with_context"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_verify_hash_with_context()</span></code></a>.</p>
<p>If called with a zero-length context, these functions produce the same signature as the associated function without a context parameter.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If a signature scheme treats the absence of a context parameter differently to a zero-length context, the Crypto API defines distinct algorithm identifiers for the two variants.
For example, when using a 255-bit key with EdDSA, <a class="reference internal" href="#c.PSA_ALG_PURE_EDDSA" title="PSA_ALG_PURE_EDDSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_PURE_EDDSA</span></code></a> implements Ed25519 (without a context) and <a class="reference internal" href="#c.PSA_ALG_EDDSA_CTX" title="PSA_ALG_EDDSA_CTX"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_EDDSA_CTX</span></code></a> implements Ed25519ctx (with a context, which can be zero-length).
See <a class="reference internal" href="#eddsa-sign-algorithms"><span class="secref">EdDSA signature algorithms</span></a>.</p>
</div>
<p>It is an error to provide a non-zero-length context with an algorithm that does not accept contexts.</p>
<p>Code written to be cryptographically agile can use the new functions, provided it guards against providing a non-zero-length context with an algorithm that does not support them.</p>
<p>The <a class="reference internal" href="#c.PSA_ALG_SIGN_SUPPORTS_CONTEXT" title="PSA_ALG_SIGN_SUPPORTS_CONTEXT"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_SIGN_SUPPORTS_CONTEXT()</span></code></a> macro can be used to determine if the implementation of an algorithm supports the use of non-zero-length contexts.</p>
</li>
</ul>
<p>See <a class="reference internal" href="#single-part-signature"><span class="secref">Asymmetric signature functions</span></a>.</p>
<section id="rsa-signature-algorithms">
<span id="rsa-sign-algorithms"></span><h2><span class="section-number">10.9.1 </span>RSA signature algorithms<a class="headerlink" href="#rsa-signature-algorithms" title="Link to this heading">¶</a></h2>
<section id="c.PSA_ALG_RSA_PKCS1V15_SIGN">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_ALG_RSA_PKCS1V15_SIGN</span></code> (macro)<a class="headerlink" href="#c.PSA_ALG_RSA_PKCS1V15_SIGN" title="Link to this heading">¶</a></h3>
<p>The RSA PKCS#1 v1.5 message signature scheme, with hashing.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ALG_RSA_PKCS1V15_SIGN" title="PSA_ALG_RSA_PKCS1V15_SIGN">PSA_ALG_RSA_PKCS1V15_SIGN</a>(hash_alg) <em><a class="reference internal" href="../../overview/implementation.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">hash_alg</span></code></p>
</dt><dd><p>A hash algorithm: a value of type <a class="reference internal" href="algorithms.html#c.psa_algorithm_t" title="psa_algorithm_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_algorithm_t</span></code></a> such that <a class="reference internal" href="algorithms.html#c.PSA_ALG_IS_HASH" title="PSA_ALG_IS_HASH"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_IS_HASH</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">hash_alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> is true. This includes <a class="reference internal" href="#c.PSA_ALG_ANY_HASH" title="PSA_ALG_ANY_HASH"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ANY_HASH</span></code></a> when specifying the algorithm in a key policy.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns</p>
<p>The corresponding RSA PKCS#1 v1.5 signature algorithm.</p>
<p>Unspecified if <code class="docutils literal notranslate"><span class="pre">hash_alg</span></code> is not a supported hash algorithm.</p>
<p class="rubric">Description</p>
<p>This hash-and-sign signature algorithm can be used with both the message and hash signature functions.
RSA PKCS#1 v1.5 does not have a context parameter.
However, the sign or verify with context functions can be used with a zero-length context.</p>
<p>This signature scheme is defined by <span><em>PKCS #1: RSA Cryptography Specifications Version 2.2</em> <a class="reference internal" href="../../about/about.html#cite-rfc8017"><span class="cite">[RFC8017]</span></a></span> <a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc8017.html#section-8.2">§8.2</a> under the name RSASSA-PKCS1-v1_5.</p>
<p>When used with <a class="reference internal" href="#c.psa_sign_hash" title="psa_sign_hash"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_sign_hash()</span></code></a> or <a class="reference internal" href="#c.psa_verify_hash" title="psa_verify_hash"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_verify_hash()</span></code></a>, the provided <code class="docutils literal notranslate"><span class="pre">hash</span></code> parameter is used as <span class="math notranslate nohighlight">\(H\)</span> from step 2 onwards in the message encoding algorithm <code class="docutils literal notranslate"><span class="pre">EMSA-PKCS1-V1_5-ENCODE()</span></code> in <a class="reference internal" href="../../about/about.html#cite-rfc8017"><span class="cite">[RFC8017]</span></a> <a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc8017.html#section-9.2">§9.2</a>. <span class="math notranslate nohighlight">\(H\)</span> is the message digest, computed using the <code class="docutils literal notranslate"><span class="pre">hash_alg</span></code> hash algorithm.</p>
<p class="rubric">Compatible key types</p>
<div class="line-block">
<div class="line"><a class="reference internal" href="../keys/types.html#c.PSA_KEY_TYPE_RSA_KEY_PAIR" title="PSA_KEY_TYPE_RSA_KEY_PAIR"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_RSA_KEY_PAIR</span></code></a></div>
<div class="line"><a class="reference internal" href="../keys/types.html#c.PSA_KEY_TYPE_RSA_PUBLIC_KEY" title="PSA_KEY_TYPE_RSA_PUBLIC_KEY"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_RSA_PUBLIC_KEY</span></code></a> (signature verification only)</div>
</div>
</section>
<section id="c.PSA_ALG_RSA_PKCS1V15_SIGN_RAW">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_ALG_RSA_PKCS1V15_SIGN_RAW</span></code> (macro)<a class="headerlink" href="#c.PSA_ALG_RSA_PKCS1V15_SIGN_RAW" title="Link to this heading">¶</a></h3>
<p>The raw RSA PKCS#1 v1.5 signature algorithm, without hashing.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ALG_RSA_PKCS1V15_SIGN_RAW" title="PSA_ALG_RSA_PKCS1V15_SIGN_RAW">PSA_ALG_RSA_PKCS1V15_SIGN_RAW</a> ((<a class="reference internal" href="algorithms.html#c.psa_algorithm_t" title="psa_algorithm_t">psa_algorithm_t</a>) 0x06000200)</pre>
<p>This specialized signature algorithm can only be used with the <a class="reference internal" href="#c.psa_sign_hash" title="psa_sign_hash"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_sign_hash()</span></code></a> and <a class="reference internal" href="#c.psa_verify_hash" title="psa_verify_hash"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_verify_hash()</span></code></a> functions.
RSA PKCS#1 v1.5 does not have a context parameter.
However, <a class="reference internal" href="#c.psa_sign_hash_with_context" title="psa_sign_hash_with_context"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_sign_hash_with_context()</span></code></a> or <a class="reference internal" href="#c.psa_verify_hash_with_context" title="psa_verify_hash_with_context"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_verify_hash_with_context()</span></code></a> can be used with a zero-length context.</p>
<p>This signature scheme is defined by <span><em>PKCS #1: RSA Cryptography Specifications Version 2.2</em> <a class="reference internal" href="../../about/about.html#cite-rfc8017"><span class="cite">[RFC8017]</span></a></span> <a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc8017.html#section-8.2">§8.2</a> under the name RSASSA-PKCS1-v1_5.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">hash</span></code> parameter to <a class="reference internal" href="#c.psa_sign_hash" title="psa_sign_hash"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_sign_hash()</span></code></a> or <a class="reference internal" href="#c.psa_verify_hash" title="psa_verify_hash"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_verify_hash()</span></code></a> is used as <span class="math notranslate nohighlight">\(T\)</span> from step 3 onwards in the message encoding algorithm <code class="docutils literal notranslate"><span class="pre">EMSA-PKCS1-V1_5-ENCODE()</span></code> in <a class="reference internal" href="../../about/about.html#cite-rfc8017"><span class="cite">[RFC8017]</span></a> <a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc8017.html#section-9.2">§9.2</a>. <span class="math notranslate nohighlight">\(T\)</span> is normally the DER encoding of the <em>DigestInfo</em> structure produced by step 2 in the message encoding algorithm, but it can be any byte string within the available length.</p>
<p>The wildcard key policy <a class="reference internal" href="#c.PSA_ALG_RSA_PKCS1V15_SIGN" title="PSA_ALG_RSA_PKCS1V15_SIGN"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_RSA_PKCS1V15_SIGN</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><a class="reference internal" href="#c.PSA_ALG_ANY_HASH" title="PSA_ALG_ANY_HASH"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_ANY_HASH</span></code></a><code class="docutils literal notranslate"><span class="pre">)</span></code> also permits a key to be used with the <a class="reference internal" href="#c.PSA_ALG_RSA_PKCS1V15_SIGN_RAW" title="PSA_ALG_RSA_PKCS1V15_SIGN_RAW"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_RSA_PKCS1V15_SIGN_RAW</span></code></a> signature algorithm.</p>
<p class="rubric">Compatible key types</p>
<div class="line-block">
<div class="line"><a class="reference internal" href="../keys/types.html#c.PSA_KEY_TYPE_RSA_KEY_PAIR" title="PSA_KEY_TYPE_RSA_KEY_PAIR"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_RSA_KEY_PAIR</span></code></a></div>
<div class="line"><a class="reference internal" href="../keys/types.html#c.PSA_KEY_TYPE_RSA_PUBLIC_KEY" title="PSA_KEY_TYPE_RSA_PUBLIC_KEY"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_RSA_PUBLIC_KEY</span></code></a> (signature verification only)</div>
</div>
</section>
<section id="c.PSA_ALG_RSA_PSS">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_ALG_RSA_PSS</span></code> (macro)<a class="headerlink" href="#c.PSA_ALG_RSA_PSS" title="Link to this heading">¶</a></h3>
<p>The RSA PSS message signature scheme, with hashing.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ALG_RSA_PSS" title="PSA_ALG_RSA_PSS">PSA_ALG_RSA_PSS</a>(hash_alg) <em><a class="reference internal" href="../../overview/implementation.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">hash_alg</span></code></p>
</dt><dd><p>A hash algorithm: a value of type <a class="reference internal" href="algorithms.html#c.psa_algorithm_t" title="psa_algorithm_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_algorithm_t</span></code></a> such that <a class="reference internal" href="algorithms.html#c.PSA_ALG_IS_HASH" title="PSA_ALG_IS_HASH"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_IS_HASH</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">hash_alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> is true. This includes <a class="reference internal" href="#c.PSA_ALG_ANY_HASH" title="PSA_ALG_ANY_HASH"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ANY_HASH</span></code></a> when specifying the algorithm in a key policy.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns</p>
<p>The corresponding RSA PSS signature algorithm.</p>
<p>Unspecified if <code class="docutils literal notranslate"><span class="pre">hash_alg</span></code> is not a supported hash algorithm.</p>
<p class="rubric">Description</p>
<p>This hash-and-sign signature algorithm can be used with both the message and hash signature functions.
RSA PSS does not have a context parameter.
However, the sign or verify with context functions can be used with a zero-length context.</p>
<p>This algorithm is randomized: each invocation returns a different, equally valid signature.</p>
<p>This is the signature scheme defined by <a class="reference internal" href="../../about/about.html#cite-rfc8017"><span class="cite">[RFC8017]</span></a> <a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc8017.html#section-8.1">§8.1</a> under the name RSASSA-PSS, with the following options:</p>
<ul class="simple">
<li><p>The mask generation function is <em>MGF1</em> defined by <a class="reference internal" href="../../about/about.html#cite-rfc8017"><span class="cite">[RFC8017]</span></a> <a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc8017.html#appendix-B">Appendix B</a>.</p></li>
<li><p>When creating a signature, the salt length is equal to the length of the hash, or the largest possible salt length for the algorithm and key size if that is smaller than the hash length.</p></li>
<li><p>When verifying a signature, the salt length must be equal to the length of the hash, or the largest possible salt length for the algorithm and key size if that is smaller than the hash length.</p></li>
<li><p>The specified hash algorithm, <code class="docutils literal notranslate"><span class="pre">hash_alg</span></code>,  is used to hash the input message, to create the salted hash, and for the mask generation.</p></li>
</ul>
<p>When used with <a class="reference internal" href="#c.psa_sign_hash" title="psa_sign_hash"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_sign_hash()</span></code></a> or <a class="reference internal" href="#c.psa_verify_hash" title="psa_verify_hash"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_verify_hash()</span></code></a>, the provided <code class="docutils literal notranslate"><span class="pre">hash</span></code> parameter is the message digest, computed using the <code class="docutils literal notranslate"><span class="pre">hash_alg</span></code> hash algorithm.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <a class="reference internal" href="#c.PSA_ALG_RSA_PSS_ANY_SALT" title="PSA_ALG_RSA_PSS_ANY_SALT"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_RSA_PSS_ANY_SALT()</span></code></a> algorithm is equivalent to <a class="reference internal" href="#c.PSA_ALG_RSA_PSS" title="PSA_ALG_RSA_PSS"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_RSA_PSS()</span></code></a> when creating a signature, but permits any salt length when verifying a signature.</p>
</div>
<p class="rubric">Compatible key types</p>
<div class="line-block">
<div class="line"><a class="reference internal" href="../keys/types.html#c.PSA_KEY_TYPE_RSA_KEY_PAIR" title="PSA_KEY_TYPE_RSA_KEY_PAIR"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_RSA_KEY_PAIR</span></code></a></div>
<div class="line"><a class="reference internal" href="../keys/types.html#c.PSA_KEY_TYPE_RSA_PUBLIC_KEY" title="PSA_KEY_TYPE_RSA_PUBLIC_KEY"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_RSA_PUBLIC_KEY</span></code></a> (signature verification only)</div>
</div>
</section>
<section id="c.PSA_ALG_RSA_PSS_ANY_SALT">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_ALG_RSA_PSS_ANY_SALT</span></code> (macro)<a class="headerlink" href="#c.PSA_ALG_RSA_PSS_ANY_SALT" title="Link to this heading">¶</a></h3>
<p>The RSA PSS message signature scheme, with hashing.
This variant permits any salt length for signature verification.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.1.</span></p>
</div>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ALG_RSA_PSS_ANY_SALT" title="PSA_ALG_RSA_PSS_ANY_SALT">PSA_ALG_RSA_PSS_ANY_SALT</a>(hash_alg) <em><a class="reference internal" href="../../overview/implementation.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">hash_alg</span></code></p>
</dt><dd><p>A hash algorithm: a value of type <a class="reference internal" href="algorithms.html#c.psa_algorithm_t" title="psa_algorithm_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_algorithm_t</span></code></a> such that <a class="reference internal" href="algorithms.html#c.PSA_ALG_IS_HASH" title="PSA_ALG_IS_HASH"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_IS_HASH</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">hash_alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> is true. This includes <a class="reference internal" href="#c.PSA_ALG_ANY_HASH" title="PSA_ALG_ANY_HASH"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ANY_HASH</span></code></a> when specifying the algorithm in a key policy.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns</p>
<p>The corresponding RSA PSS signature algorithm.</p>
<p>Unspecified if <code class="docutils literal notranslate"><span class="pre">hash_alg</span></code> is not a supported hash algorithm.</p>
<p class="rubric">Description</p>
<p>This hash-and-sign signature algorithm can be used with both the message and hash signature functions.
RSA PSS does not have a context parameter.
However, the sign or verify with context functions can be used with a zero-length context.</p>
<p>This algorithm is randomized: each invocation returns a different, equally valid signature.</p>
<p>This is the signature scheme defined by <a class="reference internal" href="../../about/about.html#cite-rfc8017"><span class="cite">[RFC8017]</span></a> <a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc8017.html#section-8.1">§8.1</a> under the name RSASSA-PSS, with the following options:</p>
<ul class="simple">
<li><p>The mask generation function is <em>MGF1</em> defined by <a class="reference internal" href="../../about/about.html#cite-rfc8017"><span class="cite">[RFC8017]</span></a> <a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc8017.html#appendix-B">Appendix B</a>.</p></li>
<li><p>When creating a signature, the salt length is equal to the length of the hash, or the largest possible salt length for the algorithm and key size if that is smaller than the hash length.</p></li>
<li><p>When verifying a signature, any salt length permitted by the RSASSA-PSS signature algorithm is accepted.</p></li>
<li><p>The specified hash algorithm, <code class="docutils literal notranslate"><span class="pre">hash_alg</span></code>,  is used to hash the input message, to create the salted hash, and for the mask generation.</p></li>
</ul>
<p>When used with <a class="reference internal" href="#c.psa_sign_hash" title="psa_sign_hash"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_sign_hash()</span></code></a> or <a class="reference internal" href="#c.psa_verify_hash" title="psa_verify_hash"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_verify_hash()</span></code></a>, the provided <code class="docutils literal notranslate"><span class="pre">hash</span></code> parameter is the message digest, computed using the <code class="docutils literal notranslate"><span class="pre">hash_alg</span></code> hash algorithm.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <a class="reference internal" href="#c.PSA_ALG_RSA_PSS" title="PSA_ALG_RSA_PSS"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_RSA_PSS()</span></code></a> algorithm is equivalent to <a class="reference internal" href="#c.PSA_ALG_RSA_PSS_ANY_SALT" title="PSA_ALG_RSA_PSS_ANY_SALT"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_RSA_PSS_ANY_SALT()</span></code></a> when creating a signature, but is strict about the permitted salt length when verifying a signature.</p>
</div>
<p class="rubric">Compatible key types</p>
<div class="line-block">
<div class="line"><a class="reference internal" href="../keys/types.html#c.PSA_KEY_TYPE_RSA_KEY_PAIR" title="PSA_KEY_TYPE_RSA_KEY_PAIR"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_RSA_KEY_PAIR</span></code></a></div>
<div class="line"><a class="reference internal" href="../keys/types.html#c.PSA_KEY_TYPE_RSA_PUBLIC_KEY" title="PSA_KEY_TYPE_RSA_PUBLIC_KEY"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_RSA_PUBLIC_KEY</span></code></a> (signature verification only)</div>
</div>
</section>
<section id="c.PSA_ALG_IS_RSA_PKCS1V15_SIGN">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_ALG_IS_RSA_PKCS1V15_SIGN</span></code> (macro)<a class="headerlink" href="#c.PSA_ALG_IS_RSA_PKCS1V15_SIGN" title="Link to this heading">¶</a></h3>
<p>Whether the specified algorithm is an RSA PKCS#1 v1.5 signature algorithm.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ALG_IS_RSA_PKCS1V15_SIGN" title="PSA_ALG_IS_RSA_PKCS1V15_SIGN">PSA_ALG_IS_RSA_PKCS1V15_SIGN</a>(alg) <em><a class="reference internal" href="../../overview/implementation.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">alg</span></code></p>
</dt><dd><p>An algorithm identifier: a value of type <a class="reference internal" href="algorithms.html#c.psa_algorithm_t" title="psa_algorithm_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_algorithm_t</span></code></a>.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns</p>
<p><code class="docutils literal notranslate"><span class="pre">1</span></code> if <code class="docutils literal notranslate"><span class="pre">alg</span></code> is an RSA PKCS#1 v1.5 signature algorithm, <code class="docutils literal notranslate"><span class="pre">0</span></code> otherwise.</p>
<p>This macro can return either <code class="docutils literal notranslate"><span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code> if <code class="docutils literal notranslate"><span class="pre">alg</span></code> is not a supported algorithm identifier.</p>
</section>
<section id="c.PSA_ALG_IS_RSA_PSS">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_ALG_IS_RSA_PSS</span></code> (macro)<a class="headerlink" href="#c.PSA_ALG_IS_RSA_PSS" title="Link to this heading">¶</a></h3>
<p>Whether the specified algorithm is an RSA PSS signature algorithm.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ALG_IS_RSA_PSS" title="PSA_ALG_IS_RSA_PSS">PSA_ALG_IS_RSA_PSS</a>(alg) <em><a class="reference internal" href="../../overview/implementation.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">alg</span></code></p>
</dt><dd><p>An algorithm identifier: a value of type <a class="reference internal" href="algorithms.html#c.psa_algorithm_t" title="psa_algorithm_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_algorithm_t</span></code></a>.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns</p>
<p><code class="docutils literal notranslate"><span class="pre">1</span></code> if <code class="docutils literal notranslate"><span class="pre">alg</span></code> is an RSA PSS signature algorithm, <code class="docutils literal notranslate"><span class="pre">0</span></code> otherwise.</p>
<p>This macro can return either <code class="docutils literal notranslate"><span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code> if <code class="docutils literal notranslate"><span class="pre">alg</span></code> is not a supported algorithm identifier.</p>
<p class="rubric">Description</p>
<p>This macro returns <code class="docutils literal notranslate"><span class="pre">1</span></code> for algorithms constructed using either <a class="reference internal" href="#c.PSA_ALG_RSA_PSS" title="PSA_ALG_RSA_PSS"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_RSA_PSS()</span></code></a> or <a class="reference internal" href="#c.PSA_ALG_RSA_PSS_ANY_SALT" title="PSA_ALG_RSA_PSS_ANY_SALT"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_RSA_PSS_ANY_SALT()</span></code></a>.</p>
</section>
<section id="c.PSA_ALG_IS_RSA_PSS_ANY_SALT">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_ALG_IS_RSA_PSS_ANY_SALT</span></code> (macro)<a class="headerlink" href="#c.PSA_ALG_IS_RSA_PSS_ANY_SALT" title="Link to this heading">¶</a></h3>
<p>Whether the specified algorithm is an RSA PSS signature algorithm that permits any salt length.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.1.</span></p>
</div>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ALG_IS_RSA_PSS_ANY_SALT" title="PSA_ALG_IS_RSA_PSS_ANY_SALT">PSA_ALG_IS_RSA_PSS_ANY_SALT</a>(alg) <em><a class="reference internal" href="../../overview/implementation.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">alg</span></code></p>
</dt><dd><p>An algorithm identifier: a value of type <a class="reference internal" href="algorithms.html#c.psa_algorithm_t" title="psa_algorithm_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_algorithm_t</span></code></a>.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns</p>
<p><code class="docutils literal notranslate"><span class="pre">1</span></code> if <code class="docutils literal notranslate"><span class="pre">alg</span></code> is an RSA PSS signature algorithm that permits any salt length, <code class="docutils literal notranslate"><span class="pre">0</span></code> otherwise.</p>
<p>This macro can return either <code class="docutils literal notranslate"><span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code> if <code class="docutils literal notranslate"><span class="pre">alg</span></code> is not a supported algorithm identifier.</p>
<p class="rubric">Description</p>
<p>An RSA PSS signature algorithm that permits any salt length is constructed using <a class="reference internal" href="#c.PSA_ALG_RSA_PSS_ANY_SALT" title="PSA_ALG_RSA_PSS_ANY_SALT"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_RSA_PSS_ANY_SALT()</span></code></a>.</p>
<p>See also <a class="reference internal" href="#c.PSA_ALG_IS_RSA_PSS" title="PSA_ALG_IS_RSA_PSS"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_IS_RSA_PSS()</span></code></a> and <a class="reference internal" href="#c.PSA_ALG_IS_RSA_PSS_STANDARD_SALT" title="PSA_ALG_IS_RSA_PSS_STANDARD_SALT"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_IS_RSA_PSS_STANDARD_SALT()</span></code></a>.</p>
</section>
<section id="c.PSA_ALG_IS_RSA_PSS_STANDARD_SALT">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_ALG_IS_RSA_PSS_STANDARD_SALT</span></code> (macro)<a class="headerlink" href="#c.PSA_ALG_IS_RSA_PSS_STANDARD_SALT" title="Link to this heading">¶</a></h3>
<p>Whether the specified algorithm is an RSA PSS signature algorithm that requires the standard salt length.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.1.</span></p>
</div>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ALG_IS_RSA_PSS_STANDARD_SALT" title="PSA_ALG_IS_RSA_PSS_STANDARD_SALT">PSA_ALG_IS_RSA_PSS_STANDARD_SALT</a>(alg) <em><a class="reference internal" href="../../overview/implementation.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">alg</span></code></p>
</dt><dd><p>An algorithm identifier: a value of type <a class="reference internal" href="algorithms.html#c.psa_algorithm_t" title="psa_algorithm_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_algorithm_t</span></code></a>.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns</p>
<p><code class="docutils literal notranslate"><span class="pre">1</span></code> if <code class="docutils literal notranslate"><span class="pre">alg</span></code> is an RSA PSS signature algorithm that requires the standard salt length, <code class="docutils literal notranslate"><span class="pre">0</span></code> otherwise.</p>
<p>This macro can return either <code class="docutils literal notranslate"><span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code> if <code class="docutils literal notranslate"><span class="pre">alg</span></code> is not a supported algorithm identifier.</p>
<p class="rubric">Description</p>
<p>An RSA PSS signature algorithm that requires the standard salt length is constructed using <a class="reference internal" href="#c.PSA_ALG_RSA_PSS" title="PSA_ALG_RSA_PSS"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_RSA_PSS()</span></code></a>.</p>
<p>See also <a class="reference internal" href="#c.PSA_ALG_IS_RSA_PSS" title="PSA_ALG_IS_RSA_PSS"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_IS_RSA_PSS()</span></code></a> and <a class="reference internal" href="#c.PSA_ALG_IS_RSA_PSS_ANY_SALT" title="PSA_ALG_IS_RSA_PSS_ANY_SALT"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_IS_RSA_PSS_ANY_SALT()</span></code></a>.</p>
</section>
</section>
<section id="ecdsa-signature-algorithms">
<span id="ecdsa-sign-algorithms"></span><h2><span class="section-number">10.9.2 </span>ECDSA signature algorithms<a class="headerlink" href="#ecdsa-signature-algorithms" title="Link to this heading">¶</a></h2>
<section id="c.PSA_ALG_ECDSA">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_ALG_ECDSA</span></code> (macro)<a class="headerlink" href="#c.PSA_ALG_ECDSA" title="Link to this heading">¶</a></h3>
<p>The randomized ECDSA signature scheme, with hashing.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ALG_ECDSA" title="PSA_ALG_ECDSA">PSA_ALG_ECDSA</a>(hash_alg) <em><a class="reference internal" href="../../overview/implementation.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">hash_alg</span></code></p>
</dt><dd><p>A hash algorithm: a value of type <a class="reference internal" href="algorithms.html#c.psa_algorithm_t" title="psa_algorithm_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_algorithm_t</span></code></a> such that <a class="reference internal" href="algorithms.html#c.PSA_ALG_IS_HASH" title="PSA_ALG_IS_HASH"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_IS_HASH</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">hash_alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> is true. This includes <a class="reference internal" href="#c.PSA_ALG_ANY_HASH" title="PSA_ALG_ANY_HASH"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ANY_HASH</span></code></a> when specifying the algorithm in a key policy.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns</p>
<p>The corresponding randomized ECDSA signature algorithm.</p>
<p>Unspecified if <code class="docutils literal notranslate"><span class="pre">hash_alg</span></code> is not a supported hash algorithm.</p>
<p class="rubric">Description</p>
<p>This hash-and-sign signature algorithm can be used with both the message and hash signature functions.
ECDSA does not have a context parameter.
However, the sign or verify with context functions can be used with a zero-length context.</p>
<p>When used with <a class="reference internal" href="#c.psa_sign_hash" title="psa_sign_hash"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_sign_hash()</span></code></a> or <a class="reference internal" href="#c.psa_verify_hash" title="psa_verify_hash"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_verify_hash()</span></code></a>, the provided <code class="docutils literal notranslate"><span class="pre">hash</span></code> parameter is the message digest, computed using the <code class="docutils literal notranslate"><span class="pre">hash_alg</span></code> hash algorithm.</p>
<p>This algorithm is randomized: each invocation returns a different, equally valid signature.</p>
<p>The ECDSA signature scheme is defined by <span><em>SEC 1: Elliptic Curve Cryptography</em> <a class="reference internal" href="../../about/about.html#cite-sec1"><span class="cite">[SEC1]</span></a></span>, and also by <span><em>Public Key Cryptography For The Financial Services Industry: The Elliptic Curve Digital Signature Algorithm (ECDSA)</em> <a class="reference internal" href="../../about/about.html#cite-x9-62"><span class="cite">[X9-62]</span></a></span>, with a random per-message secret number <span class="math notranslate nohighlight">\(k\)</span>.</p>
<p>The representation of the signature as a byte string consists of the concatenation of the signature values <span class="math notranslate nohighlight">\(r\)</span> and <span class="math notranslate nohighlight">\(s\)</span>.
Each of <span class="math notranslate nohighlight">\(r\)</span> and <span class="math notranslate nohighlight">\(s\)</span> is encoded as a big-endian <span class="math notranslate nohighlight">\(m\)</span>-octet string, where <span class="math notranslate nohighlight">\(m\)</span> is the integer for which <span class="math notranslate nohighlight">\(2^{8(m-1)} \leq q &lt; 2^{8m}\)</span>, and <span class="math notranslate nohighlight">\(q\)</span> is the order of the elliptic curve.</p>
<p>When based on the same hash algorithm, the verification operations for <a class="reference internal" href="#c.PSA_ALG_ECDSA" title="PSA_ALG_ECDSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ECDSA</span></code></a> and <a class="reference internal" href="#c.PSA_ALG_DETERMINISTIC_ECDSA" title="PSA_ALG_DETERMINISTIC_ECDSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_DETERMINISTIC_ECDSA</span></code></a> are identical. A signature created using <a class="reference internal" href="#c.PSA_ALG_ECDSA" title="PSA_ALG_ECDSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ECDSA</span></code></a> can be verified with the same key using either <a class="reference internal" href="#c.PSA_ALG_ECDSA" title="PSA_ALG_ECDSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ECDSA</span></code></a> or <a class="reference internal" href="#c.PSA_ALG_DETERMINISTIC_ECDSA" title="PSA_ALG_DETERMINISTIC_ECDSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_DETERMINISTIC_ECDSA</span></code></a>. Similarly, a signature created using <a class="reference internal" href="#c.PSA_ALG_DETERMINISTIC_ECDSA" title="PSA_ALG_DETERMINISTIC_ECDSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_DETERMINISTIC_ECDSA</span></code></a> can be verified with the same key using either <a class="reference internal" href="#c.PSA_ALG_ECDSA" title="PSA_ALG_ECDSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ECDSA</span></code></a> or <a class="reference internal" href="#c.PSA_ALG_DETERMINISTIC_ECDSA" title="PSA_ALG_DETERMINISTIC_ECDSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_DETERMINISTIC_ECDSA</span></code></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A verifier cannot determine whether a signature was produced with deterministic ECDSA or with randomized ECDSA: it is only possible to verify that a signature was made with ECDSA with the private key corresponding to the public key used for the verification.</p>
</div>
<p>When <a class="reference internal" href="#c.PSA_ALG_ECDSA" title="PSA_ALG_ECDSA"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_ECDSA</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">hash_alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> is used as a permitted algorithm in a key policy, this permits:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#c.PSA_ALG_ECDSA" title="PSA_ALG_ECDSA"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_ECDSA</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">hash_alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> as the algorithm in a call to any signing function.</p></li>
<li><p><a class="reference internal" href="#c.PSA_ALG_ECDSA" title="PSA_ALG_ECDSA"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_ECDSA</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">hash_alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> or <a class="reference internal" href="#c.PSA_ALG_DETERMINISTIC_ECDSA" title="PSA_ALG_DETERMINISTIC_ECDSA"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_DETERMINISTIC_ECDSA</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">hash_alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> as the algorithm in a call to any signature verification function.</p></li>
</ul>
<p class="rubric">Compatible key types</p>
<div class="line-block">
<div class="line"><a class="reference internal" href="../keys/types.html#c.PSA_KEY_TYPE_ECC_KEY_PAIR" title="PSA_KEY_TYPE_ECC_KEY_PAIR"><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_ECC_KEY_PAIR</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">family</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code></div>
<div class="line"><a class="reference internal" href="../keys/types.html#c.PSA_KEY_TYPE_ECC_PUBLIC_KEY" title="PSA_KEY_TYPE_ECC_PUBLIC_KEY"><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_ECC_PUBLIC_KEY</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">family</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> (signature verification only)</div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">family</span></code> is a Weierstrass Elliptic curve family. That is, one of the following values:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_SECT_XX</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_SECP_XX</span></code></p></li>
<li><p><a class="reference internal" href="../keys/types.html#c.PSA_ECC_FAMILY_FRP" title="PSA_ECC_FAMILY_FRP"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_FRP</span></code></a></p></li>
<li><p><a class="reference internal" href="../keys/types.html#c.PSA_ECC_FAMILY_BRAINPOOL_P_R1" title="PSA_ECC_FAMILY_BRAINPOOL_P_R1"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_BRAINPOOL_P_R1</span></code></a></p></li>
</ul>
</section>
<section id="c.PSA_ALG_ECDSA_ANY">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_ALG_ECDSA_ANY</span></code> (macro)<a class="headerlink" href="#c.PSA_ALG_ECDSA_ANY" title="Link to this heading">¶</a></h3>
<p>The randomized ECDSA signature scheme, without hashing.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ALG_ECDSA_ANY" title="PSA_ALG_ECDSA_ANY">PSA_ALG_ECDSA_ANY</a> ((<a class="reference internal" href="algorithms.html#c.psa_algorithm_t" title="psa_algorithm_t">psa_algorithm_t</a>) 0x06000600)</pre>
<p>This specialized signature algorithm can only be used with the <a class="reference internal" href="#c.psa_sign_hash" title="psa_sign_hash"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_sign_hash()</span></code></a> and <a class="reference internal" href="#c.psa_verify_hash" title="psa_verify_hash"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_verify_hash()</span></code></a> functions.
ECDSA does not have a context parameter.
However, <a class="reference internal" href="#c.psa_sign_hash_with_context" title="psa_sign_hash_with_context"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_sign_hash_with_context()</span></code></a> or <a class="reference internal" href="#c.psa_verify_hash_with_context" title="psa_verify_hash_with_context"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_verify_hash_with_context()</span></code></a> can be used with a zero-length context.</p>
<p>This algorithm is randomized: each invocation returns a different, equally valid signature.</p>
<p>This is the same signature scheme as <a class="reference internal" href="#c.PSA_ALG_ECDSA" title="PSA_ALG_ECDSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ECDSA</span></code></a>, but without specifying a hash algorithm, and skipping the message hashing operation.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This algorithm is only recommended to sign or verify a sequence of bytes that are a pre-computed hash. Note that the input is padded with zeros on the left or truncated on the right as required to fit the curve size.</p>
</div>
<p>This algorithm cannot be used with the wildcard key policy <a class="reference internal" href="#c.PSA_ALG_ECDSA" title="PSA_ALG_ECDSA"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_ECDSA</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><a class="reference internal" href="#c.PSA_ALG_ANY_HASH" title="PSA_ALG_ANY_HASH"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_ANY_HASH</span></code></a><code class="docutils literal notranslate"><span class="pre">)</span></code>. It is only permitted when <a class="reference internal" href="#c.PSA_ALG_ECDSA_ANY" title="PSA_ALG_ECDSA_ANY"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ECDSA_ANY</span></code></a> is the key’s permitted-algorithm policy.</p>
<p class="rubric">Compatible key types</p>
<div class="line-block">
<div class="line"><a class="reference internal" href="../keys/types.html#c.PSA_KEY_TYPE_ECC_KEY_PAIR" title="PSA_KEY_TYPE_ECC_KEY_PAIR"><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_ECC_KEY_PAIR</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">family</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code></div>
<div class="line"><a class="reference internal" href="../keys/types.html#c.PSA_KEY_TYPE_ECC_PUBLIC_KEY" title="PSA_KEY_TYPE_ECC_PUBLIC_KEY"><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_ECC_PUBLIC_KEY</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">family</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> (signature verification only)</div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">family</span></code> is a Weierstrass Elliptic curve family. That is, one of the following values:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_SECT_XX</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_SECP_XX</span></code></p></li>
<li><p><a class="reference internal" href="../keys/types.html#c.PSA_ECC_FAMILY_FRP" title="PSA_ECC_FAMILY_FRP"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_FRP</span></code></a></p></li>
<li><p><a class="reference internal" href="../keys/types.html#c.PSA_ECC_FAMILY_BRAINPOOL_P_R1" title="PSA_ECC_FAMILY_BRAINPOOL_P_R1"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_BRAINPOOL_P_R1</span></code></a></p></li>
</ul>
</section>
<section id="c.PSA_ALG_DETERMINISTIC_ECDSA">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_ALG_DETERMINISTIC_ECDSA</span></code> (macro)<a class="headerlink" href="#c.PSA_ALG_DETERMINISTIC_ECDSA" title="Link to this heading">¶</a></h3>
<p>Deterministic ECDSA signature scheme, with hashing.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ALG_DETERMINISTIC_ECDSA" title="PSA_ALG_DETERMINISTIC_ECDSA">PSA_ALG_DETERMINISTIC_ECDSA</a>(hash_alg) <em><a class="reference internal" href="../../overview/implementation.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">hash_alg</span></code></p>
</dt><dd><p>A hash algorithm: a value of type <a class="reference internal" href="algorithms.html#c.psa_algorithm_t" title="psa_algorithm_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_algorithm_t</span></code></a> such that <a class="reference internal" href="algorithms.html#c.PSA_ALG_IS_HASH" title="PSA_ALG_IS_HASH"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_IS_HASH</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">hash_alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> is true. This includes <a class="reference internal" href="#c.PSA_ALG_ANY_HASH" title="PSA_ALG_ANY_HASH"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ANY_HASH</span></code></a> when specifying the algorithm in a key policy.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns</p>
<p>The corresponding deterministic ECDSA signature algorithm.</p>
<p>Unspecified if <code class="docutils literal notranslate"><span class="pre">hash_alg</span></code> is not a supported hash algorithm.</p>
<p class="rubric">Description</p>
<p>This hash-and-sign signature algorithm can be used with both the message and hash signature functions.
ECDSA does not have a context parameter.
However, the sign or verify with context functions can be used with a zero-length context.</p>
<p>When used with <a class="reference internal" href="#c.psa_sign_hash" title="psa_sign_hash"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_sign_hash()</span></code></a> or <a class="reference internal" href="#c.psa_verify_hash" title="psa_verify_hash"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_verify_hash()</span></code></a>, the provided <code class="docutils literal notranslate"><span class="pre">hash</span></code> parameter is the message digest, computed using the <code class="docutils literal notranslate"><span class="pre">hash_alg</span></code> hash algorithm.</p>
<p>This is the deterministic ECDSA signature scheme defined by <span><em>Deterministic Usage of the Digital Signature Algorithm (DSA) and Elliptic Curve Digital Signature Algorithm (ECDSA)</em> <a class="reference internal" href="../../about/about.html#cite-rfc6979"><span class="cite">[RFC6979]</span></a></span>.</p>
<p>The representation of a signature is the same as with <a class="reference internal" href="#c.PSA_ALG_ECDSA" title="PSA_ALG_ECDSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ECDSA</span></code></a>.</p>
<p>When based on the same hash algorithm, the verification operations for <a class="reference internal" href="#c.PSA_ALG_ECDSA" title="PSA_ALG_ECDSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ECDSA</span></code></a> and <a class="reference internal" href="#c.PSA_ALG_DETERMINISTIC_ECDSA" title="PSA_ALG_DETERMINISTIC_ECDSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_DETERMINISTIC_ECDSA</span></code></a> are identical. A signature created using <a class="reference internal" href="#c.PSA_ALG_ECDSA" title="PSA_ALG_ECDSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ECDSA</span></code></a> can be verified with the same key using either <a class="reference internal" href="#c.PSA_ALG_ECDSA" title="PSA_ALG_ECDSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ECDSA</span></code></a> or <a class="reference internal" href="#c.PSA_ALG_DETERMINISTIC_ECDSA" title="PSA_ALG_DETERMINISTIC_ECDSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_DETERMINISTIC_ECDSA</span></code></a>. Similarly, a signature created using <a class="reference internal" href="#c.PSA_ALG_DETERMINISTIC_ECDSA" title="PSA_ALG_DETERMINISTIC_ECDSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_DETERMINISTIC_ECDSA</span></code></a> can be verified with the same key using either <a class="reference internal" href="#c.PSA_ALG_ECDSA" title="PSA_ALG_ECDSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ECDSA</span></code></a> or <a class="reference internal" href="#c.PSA_ALG_DETERMINISTIC_ECDSA" title="PSA_ALG_DETERMINISTIC_ECDSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_DETERMINISTIC_ECDSA</span></code></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A verifier cannot determine whether a signature was produced with deterministic ECDSA or with randomized ECDSA: it is only possible to verify that a signature was made with ECDSA with the private key corresponding to the public key used for the verification.</p>
</div>
<p>When <a class="reference internal" href="#c.PSA_ALG_DETERMINISTIC_ECDSA" title="PSA_ALG_DETERMINISTIC_ECDSA"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_DETERMINISTIC_ECDSA</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">hash_alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> is used as a permitted algorithm in a key policy, this permits:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#c.PSA_ALG_DETERMINISTIC_ECDSA" title="PSA_ALG_DETERMINISTIC_ECDSA"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_DETERMINISTIC_ECDSA</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">hash_alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> as the algorithm in a call to any signing function.</p></li>
<li><p><a class="reference internal" href="#c.PSA_ALG_DETERMINISTIC_ECDSA" title="PSA_ALG_DETERMINISTIC_ECDSA"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_DETERMINISTIC_ECDSA</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">hash_alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> or <a class="reference internal" href="#c.PSA_ALG_ECDSA" title="PSA_ALG_ECDSA"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_ECDSA</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">hash_alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> as the algorithm in a call to any signature verification function.</p></li>
</ul>
<p class="rubric">Compatible key types</p>
<div class="line-block">
<div class="line"><a class="reference internal" href="../keys/types.html#c.PSA_KEY_TYPE_ECC_KEY_PAIR" title="PSA_KEY_TYPE_ECC_KEY_PAIR"><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_ECC_KEY_PAIR</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">family</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code></div>
<div class="line"><a class="reference internal" href="../keys/types.html#c.PSA_KEY_TYPE_ECC_PUBLIC_KEY" title="PSA_KEY_TYPE_ECC_PUBLIC_KEY"><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_ECC_PUBLIC_KEY</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">family</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> (signature verification only)</div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">family</span></code> is a Weierstrass Elliptic curve family. That is, one of the following values:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_SECT_XX</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_SECP_XX</span></code></p></li>
<li><p><a class="reference internal" href="../keys/types.html#c.PSA_ECC_FAMILY_FRP" title="PSA_ECC_FAMILY_FRP"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_FRP</span></code></a></p></li>
<li><p><a class="reference internal" href="../keys/types.html#c.PSA_ECC_FAMILY_BRAINPOOL_P_R1" title="PSA_ECC_FAMILY_BRAINPOOL_P_R1"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_BRAINPOOL_P_R1</span></code></a></p></li>
</ul>
</section>
<section id="c.PSA_ALG_IS_ECDSA">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_ALG_IS_ECDSA</span></code> (macro)<a class="headerlink" href="#c.PSA_ALG_IS_ECDSA" title="Link to this heading">¶</a></h3>
<p>Whether the specified algorithm is ECDSA.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ALG_IS_ECDSA" title="PSA_ALG_IS_ECDSA">PSA_ALG_IS_ECDSA</a>(alg) <em><a class="reference internal" href="../../overview/implementation.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">alg</span></code></p>
</dt><dd><p>An algorithm identifier: a value of type <a class="reference internal" href="algorithms.html#c.psa_algorithm_t" title="psa_algorithm_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_algorithm_t</span></code></a>.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns</p>
<p><code class="docutils literal notranslate"><span class="pre">1</span></code> if <code class="docutils literal notranslate"><span class="pre">alg</span></code> is an ECDSA algorithm, <code class="docutils literal notranslate"><span class="pre">0</span></code> otherwise.</p>
<p>This macro can return either <code class="docutils literal notranslate"><span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code> if <code class="docutils literal notranslate"><span class="pre">alg</span></code> is not a supported algorithm identifier.</p>
</section>
<section id="c.PSA_ALG_IS_DETERMINISTIC_ECDSA">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_ALG_IS_DETERMINISTIC_ECDSA</span></code> (macro)<a class="headerlink" href="#c.PSA_ALG_IS_DETERMINISTIC_ECDSA" title="Link to this heading">¶</a></h3>
<p>Whether the specified algorithm is deterministic ECDSA.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ALG_IS_DETERMINISTIC_ECDSA" title="PSA_ALG_IS_DETERMINISTIC_ECDSA">PSA_ALG_IS_DETERMINISTIC_ECDSA</a>(alg) <em><a class="reference internal" href="../../overview/implementation.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">alg</span></code></p>
</dt><dd><p>An algorithm identifier: a value of type <a class="reference internal" href="algorithms.html#c.psa_algorithm_t" title="psa_algorithm_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_algorithm_t</span></code></a>.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns</p>
<p><code class="docutils literal notranslate"><span class="pre">1</span></code> if <code class="docutils literal notranslate"><span class="pre">alg</span></code> is a deterministic ECDSA algorithm, <code class="docutils literal notranslate"><span class="pre">0</span></code> otherwise.</p>
<p>This macro can return either <code class="docutils literal notranslate"><span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code> if <code class="docutils literal notranslate"><span class="pre">alg</span></code> is not a supported algorithm identifier.</p>
<p class="rubric">Description</p>
<p>See also <a class="reference internal" href="#c.PSA_ALG_IS_ECDSA" title="PSA_ALG_IS_ECDSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_IS_ECDSA()</span></code></a> and <a class="reference internal" href="#c.PSA_ALG_IS_RANDOMIZED_ECDSA" title="PSA_ALG_IS_RANDOMIZED_ECDSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_IS_RANDOMIZED_ECDSA()</span></code></a>.</p>
</section>
<section id="c.PSA_ALG_IS_RANDOMIZED_ECDSA">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_ALG_IS_RANDOMIZED_ECDSA</span></code> (macro)<a class="headerlink" href="#c.PSA_ALG_IS_RANDOMIZED_ECDSA" title="Link to this heading">¶</a></h3>
<p>Whether the specified algorithm is randomized ECDSA.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ALG_IS_RANDOMIZED_ECDSA" title="PSA_ALG_IS_RANDOMIZED_ECDSA">PSA_ALG_IS_RANDOMIZED_ECDSA</a>(alg) <em><a class="reference internal" href="../../overview/implementation.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">alg</span></code></p>
</dt><dd><p>An algorithm identifier: a value of type <a class="reference internal" href="algorithms.html#c.psa_algorithm_t" title="psa_algorithm_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_algorithm_t</span></code></a>.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns</p>
<p><code class="docutils literal notranslate"><span class="pre">1</span></code> if <code class="docutils literal notranslate"><span class="pre">alg</span></code> is a randomized ECDSA algorithm, <code class="docutils literal notranslate"><span class="pre">0</span></code> otherwise.</p>
<p>This macro can return either <code class="docutils literal notranslate"><span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code> if <code class="docutils literal notranslate"><span class="pre">alg</span></code> is not a supported algorithm identifier.</p>
<p class="rubric">Description</p>
<p>See also <a class="reference internal" href="#c.PSA_ALG_IS_ECDSA" title="PSA_ALG_IS_ECDSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_IS_ECDSA()</span></code></a> and <a class="reference internal" href="#c.PSA_ALG_IS_DETERMINISTIC_ECDSA" title="PSA_ALG_IS_DETERMINISTIC_ECDSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_IS_DETERMINISTIC_ECDSA()</span></code></a>.</p>
</section>
</section>
<section id="eddsa-signature-algorithms">
<span id="eddsa-sign-algorithms"></span><h2><span class="section-number">10.9.3 </span>EdDSA signature algorithms<a class="headerlink" href="#eddsa-signature-algorithms" title="Link to this heading">¶</a></h2>
<p>The PureEdDSA and HashEdDSA digital signature algorithms are defined by <span><em>Edwards-Curve Digital Signature Algorithm (EdDSA)</em> <a class="reference internal" href="../../about/about.html#cite-rfc8032"><span class="cite">[RFC8032]</span></a></span>.
They are used with the Edwards25519 and Edwards448 elliptic curve keys, see <a class="reference internal" href="../keys/types.html#c.PSA_ECC_FAMILY_TWISTED_EDWARDS" title="PSA_ECC_FAMILY_TWISTED_EDWARDS"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_TWISTED_EDWARDS</span></code></a>.</p>
<ul class="simple">
<li><p>PureEdDSA is a set of message-signing algorithms, that cannot be split into a hash step, followed by a signature or verification step.</p></li>
<li><p>HashEdDSA is a pair of hash-and-sign algorithms, with a specified hash algorithm associated with each key size.</p></li>
</ul>
<p>Both PureEdDSA and HashEdDSA can be used with contexts, which enables domain-separation when signatures are made of different message structures with the same key.
For EdDSA, the context is an arbitrary byte string between zero and 255 bytes in length.</p>
<p>The development of EdDSA resulted in a total of five distinct algorithms:</p>
<ul class="simple">
<li><p>Ed25519: the original PureEdDSA algorithm for the Edwards25519 curve, which does not accept a context.</p></li>
<li><p>Ed25519ctx: a second PureEdDSA algorithm for the Edwards25519 curve, with a context parameter.</p></li>
<li><p>Ed448: the PureEdDSA algorithm for the Edwards448 curve, with a context parameter.</p></li>
<li><p>Ed25519ph: the HashEdDSA algorithm for the Edwards25519 curve, with a context parameter.</p></li>
<li><p>Ed448ph: the HashEdDSA algorithm for the Edwards448 curve, with a context parameter.</p></li>
</ul>
<p><span><a class="reference internal" href="#table-eddsa-algs"><span class="numref">Table 15</span></a></span> shows the algorithm identifiers in the Crypto API, and how they are used to select the appropriate EdDSA algorithm.</p>
<table class="docutils align-default" id="table-eddsa-algs">
<caption><span class="caption-number">Table 15 </span><span class="caption-text">EdDSA algorithm identifiers</span><a class="headerlink" href="#table-eddsa-algs" title="Link to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Algorithm identifier</p></th>
<th class="head"><p>With 255-bit key</p></th>
<th class="head"><p>With 448-bit key</p></th>
<th class="head"><p>Sign/verify hash</p></th>
<th class="head"><p>Support non-zero-length context</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="#c.PSA_ALG_PURE_EDDSA" title="PSA_ALG_PURE_EDDSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_PURE_EDDSA</span></code></a></p></td>
<td><p>Ed25519</p></td>
<td><p>Ed448</p></td>
<td><p>No</p></td>
<td><p>No</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#c.PSA_ALG_ED25519PH" title="PSA_ALG_ED25519PH"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ED25519PH</span></code></a></p></td>
<td><p>Ed25519ph</p></td>
<td><p><em>Invalid</em></p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#c.PSA_ALG_ED448PH" title="PSA_ALG_ED448PH"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ED448PH</span></code></a></p></td>
<td><p><em>Invalid</em></p></td>
<td><p>Ed448ph</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#c.PSA_ALG_EDDSA_CTX" title="PSA_ALG_EDDSA_CTX"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_EDDSA_CTX</span></code></a></p></td>
<td><p>Ed25519ctx</p></td>
<td><p>Ed448</p></td>
<td><p>No</p></td>
<td><p>Yes</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Ed25519ctx produces a distinct signature to Ed25519, even with a zero-length context.</p>
</div>
<section id="c.PSA_ALG_PURE_EDDSA">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_ALG_PURE_EDDSA</span></code> (macro)<a class="headerlink" href="#c.PSA_ALG_PURE_EDDSA" title="Link to this heading">¶</a></h3>
<p>Edwards-curve digital signature algorithm without pre-hashing (PureEdDSA), with zero-length context.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.1.</span></p>
</div>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ALG_PURE_EDDSA" title="PSA_ALG_PURE_EDDSA">PSA_ALG_PURE_EDDSA</a> ((<a class="reference internal" href="algorithms.html#c.psa_algorithm_t" title="psa_algorithm_t">psa_algorithm_t</a>) 0x06000800)</pre>
<p>This message-signature algorithm can be used with the <a class="reference internal" href="#c.psa_sign_message" title="psa_sign_message"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_sign_message()</span></code></a> and <a class="reference internal" href="#c.psa_verify_message" title="psa_verify_message"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_verify_message()</span></code></a> functions.
With a zero-length context, <a class="reference internal" href="#c.PSA_ALG_PURE_EDDSA" title="PSA_ALG_PURE_EDDSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_PURE_EDDSA</span></code></a> can also be used with the <a class="reference internal" href="#c.psa_sign_message_with_context" title="psa_sign_message_with_context"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_sign_message_with_context()</span></code></a> and <a class="reference internal" href="#c.psa_verify_message_with_context" title="psa_verify_message_with_context"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_verify_message_with_context()</span></code></a> functions.
It cannot be used to sign hashes.</p>
<p>This is the PureEdDSA digital signature algorithm defined by <span><em>Edwards-Curve Digital Signature Algorithm (EdDSA)</em> <a class="reference internal" href="../../about/about.html#cite-rfc8032"><span class="cite">[RFC8032]</span></a></span>, with zero-length context.</p>
<p>PureEdDSA requires an elliptic curve key on a twisted Edwards curve (see <a class="reference internal" href="../keys/types.html#c.PSA_ECC_FAMILY_TWISTED_EDWARDS" title="PSA_ECC_FAMILY_TWISTED_EDWARDS"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_TWISTED_EDWARDS</span></code></a>).
The following curves are supported:</p>
<ul class="simple">
<li><p>Edwards25519: the Ed25519 algorithm is computed.
The output signature is a 64-byte string: the concatenation of <span class="math notranslate nohighlight">\(R\)</span> and <span class="math notranslate nohighlight">\(S\)</span> as defined by <a class="reference internal" href="../../about/about.html#cite-rfc8032"><span class="cite">[RFC8032]</span></a> <a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc8032.html#section-5.1.6">§5.1.6</a>.</p></li>
<li><p>Edwards448: the Ed448 algorithm is computed, with a zero-length context.
The output signature is a 114-byte string: the concatenation of <span class="math notranslate nohighlight">\(R\)</span> and <span class="math notranslate nohighlight">\(S\)</span> as defined by <a class="reference internal" href="../../about/about.html#cite-rfc8032"><span class="cite">[RFC8032]</span></a> <a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc8032.html#section-5.2.6">§5.2.6</a>.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To sign or verify the pre-computed hash of a message using EdDSA, the HashEdDSA algorithms (<a class="reference internal" href="#c.PSA_ALG_ED25519PH" title="PSA_ALG_ED25519PH"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ED25519PH</span></code></a> and <a class="reference internal" href="#c.PSA_ALG_ED448PH" title="PSA_ALG_ED448PH"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ED448PH</span></code></a>) can be used.
The signature produced by HashEdDSA is distinct from that produced by PureEdDSA.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To sign or verify a message with a non-zero-length context using PureEdDSA, use the <a class="reference internal" href="#c.PSA_ALG_EDDSA_CTX" title="PSA_ALG_EDDSA_CTX"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_EDDSA_CTX</span></code></a> algorithm.</p>
<p>With an Edwards25519 curve key, <a class="reference internal" href="#c.PSA_ALG_EDDSA_CTX" title="PSA_ALG_EDDSA_CTX"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_EDDSA_CTX</span></code></a> with a zero-length context creates different signatures to <a class="reference internal" href="#c.PSA_ALG_PURE_EDDSA" title="PSA_ALG_PURE_EDDSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_PURE_EDDSA</span></code></a>.</p>
</div>
<p class="rubric">Compatible key types</p>
<div class="line-block">
<div class="line"><a class="reference internal" href="../keys/types.html#c.PSA_KEY_TYPE_ECC_KEY_PAIR" title="PSA_KEY_TYPE_ECC_KEY_PAIR"><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_ECC_KEY_PAIR</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><a class="reference internal" href="../keys/types.html#c.PSA_ECC_FAMILY_TWISTED_EDWARDS" title="PSA_ECC_FAMILY_TWISTED_EDWARDS"><code class="docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_TWISTED_EDWARDS</span></code></a><code class="docutils literal notranslate"><span class="pre">)</span></code></div>
<div class="line"><a class="reference internal" href="../keys/types.html#c.PSA_KEY_TYPE_ECC_PUBLIC_KEY" title="PSA_KEY_TYPE_ECC_PUBLIC_KEY"><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_ECC_PUBLIC_KEY</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><a class="reference internal" href="../keys/types.html#c.PSA_ECC_FAMILY_TWISTED_EDWARDS" title="PSA_ECC_FAMILY_TWISTED_EDWARDS"><code class="docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_TWISTED_EDWARDS</span></code></a><code class="docutils literal notranslate"><span class="pre">)</span></code> (signature verification only)</div>
</div>
</section>
<section id="c.PSA_ALG_EDDSA_CTX">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_ALG_EDDSA_CTX</span></code> (macro)<a class="headerlink" href="#c.PSA_ALG_EDDSA_CTX" title="Link to this heading">¶</a></h3>
<p>Edwards-curve digital signature algorithm without pre-hashing (PureEdDSA), with a context.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.4.</span></p>
</div>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ALG_EDDSA_CTX" title="PSA_ALG_EDDSA_CTX">PSA_ALG_EDDSA_CTX</a> ((<a class="reference internal" href="algorithms.html#c.psa_algorithm_t" title="psa_algorithm_t">psa_algorithm_t</a>) 0x06000A00)</pre>
<p>This message-signature algorithm can be used with both the message and message with context signature functions.
It cannot be used to sign hashes.</p>
<p>This is the PureEdDSA digital signature algorithm defined by <span><em>Edwards-Curve Digital Signature Algorithm (EdDSA)</em> <a class="reference internal" href="../../about/about.html#cite-rfc8032"><span class="cite">[RFC8032]</span></a></span>, with a context parameter.
The context parameter can be between zero and 255 bytes in length.</p>
<p>PureEdDSA requires an elliptic curve key on a twisted Edwards curve (see <a class="reference internal" href="../keys/types.html#c.PSA_ECC_FAMILY_TWISTED_EDWARDS" title="PSA_ECC_FAMILY_TWISTED_EDWARDS"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_TWISTED_EDWARDS</span></code></a>).
The following curves are supported:</p>
<ul class="simple">
<li><p>Edwards25519: the Ed25519ctx algorithm is computed.
The output signature is a 64-byte string: the concatenation of <span class="math notranslate nohighlight">\(R\)</span> and <span class="math notranslate nohighlight">\(S\)</span> as defined by <a class="reference internal" href="../../about/about.html#cite-rfc8032"><span class="cite">[RFC8032]</span></a> <a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc8032.html#section-5.1.6">§5.1.6</a>.</p></li>
<li><p>Edwards448: the Ed448 algorithm is computed, with a zero-length context.
The output signature is a 114-byte string: the concatenation of <span class="math notranslate nohighlight">\(R\)</span> and <span class="math notranslate nohighlight">\(S\)</span> as defined by <a class="reference internal" href="../../about/about.html#cite-rfc8032"><span class="cite">[RFC8032]</span></a> <a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc8032.html#section-5.2.6">§5.2.6</a>.</p></li>
</ul>
<p>To use a non-zero-length context, use the message-signature functions that accept a context parameter, <a class="reference internal" href="#c.psa_sign_message_with_context" title="psa_sign_message_with_context"><code class="docutils literal notranslate"><span class="pre">psa_sign_message_with_context</span></code></a><code class="docutils literal notranslate"><span class="pre">()</span></code> and <a class="reference internal" href="#c.psa_verify_message_with_context" title="psa_verify_message_with_context"><code class="docutils literal notranslate"><span class="pre">psa_verify_message_with_context</span></code></a><code class="docutils literal notranslate"><span class="pre">()</span></code>
The <a class="reference internal" href="#c.psa_sign_message" title="psa_sign_message"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_sign_message()</span></code></a> and <a class="reference internal" href="#c.psa_verify_message" title="psa_verify_message"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_verify_message()</span></code></a> functions use a zero-length context when computing or verifying signatures.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To sign or verify the pre-computed hash of a message using EdDSA, the HashEdDSA algorithms (<a class="reference internal" href="#c.PSA_ALG_ED25519PH" title="PSA_ALG_ED25519PH"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ED25519PH</span></code></a> and <a class="reference internal" href="#c.PSA_ALG_ED448PH" title="PSA_ALG_ED448PH"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ED448PH</span></code></a>) can be used.
The signature produced by HashEdDSA is distinct from that produced by PureEdDSA.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>With an Edwards25519 curve key, <a class="reference internal" href="#c.PSA_ALG_EDDSA_CTX" title="PSA_ALG_EDDSA_CTX"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_EDDSA_CTX</span></code></a> with a zero-length context creates different signatures to <a class="reference internal" href="#c.PSA_ALG_PURE_EDDSA" title="PSA_ALG_PURE_EDDSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_PURE_EDDSA</span></code></a>.</p>
</div>
<p class="rubric">Usage</p>
<p>This is a message signing algorithm. To calculate a signature, use one of the following approaches:</p>
<ul class="simple">
<li><p>Call <a class="reference internal" href="#c.psa_sign_message" title="psa_sign_message"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_sign_message()</span></code></a> or <a class="reference internal" href="#c.psa_sign_message_with_context" title="psa_sign_message_with_context"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_sign_message_with_context()</span></code></a> with the message.</p></li>
</ul>
<p>Verifying a signature is similar, using <a class="reference internal" href="#c.psa_verify_message" title="psa_verify_message"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_verify_message()</span></code></a> or <a class="reference internal" href="#c.psa_verify_message_with_context" title="psa_verify_message_with_context"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_verify_message_with_context()</span></code></a>.</p>
<p class="rubric">Compatible key types</p>
<div class="line-block">
<div class="line"><a class="reference internal" href="../keys/types.html#c.PSA_KEY_TYPE_ECC_KEY_PAIR" title="PSA_KEY_TYPE_ECC_KEY_PAIR"><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_ECC_KEY_PAIR</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><a class="reference internal" href="../keys/types.html#c.PSA_ECC_FAMILY_TWISTED_EDWARDS" title="PSA_ECC_FAMILY_TWISTED_EDWARDS"><code class="docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_TWISTED_EDWARDS</span></code></a><code class="docutils literal notranslate"><span class="pre">)</span></code></div>
<div class="line"><a class="reference internal" href="../keys/types.html#c.PSA_KEY_TYPE_ECC_PUBLIC_KEY" title="PSA_KEY_TYPE_ECC_PUBLIC_KEY"><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_ECC_PUBLIC_KEY</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><a class="reference internal" href="../keys/types.html#c.PSA_ECC_FAMILY_TWISTED_EDWARDS" title="PSA_ECC_FAMILY_TWISTED_EDWARDS"><code class="docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_TWISTED_EDWARDS</span></code></a><code class="docutils literal notranslate"><span class="pre">)</span></code> (signature verification only)</div>
</div>
</section>
<section id="c.PSA_ALG_ED25519PH">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_ALG_ED25519PH</span></code> (macro)<a class="headerlink" href="#c.PSA_ALG_ED25519PH" title="Link to this heading">¶</a></h3>
<p>Edwards-curve digital signature algorithm with pre-hashing (HashEdDSA), using the Edwards25519 curve.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.1.</span></p>
</div>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ALG_ED25519PH" title="PSA_ALG_ED25519PH">PSA_ALG_ED25519PH</a> ((<a class="reference internal" href="algorithms.html#c.psa_algorithm_t" title="psa_algorithm_t">psa_algorithm_t</a>) 0x0600090B)</pre>
<p>This hash-and-sign signature algorithm can be used with both the message and hash signature functions.</p>
<p>This calculates the Ed25519ph algorithm as specified in <span><em>Edwards-Curve Digital Signature Algorithm (EdDSA)</em> <a class="reference internal" href="../../about/about.html#cite-rfc8032"><span class="cite">[RFC8032]</span></a></span> <a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc8032.html#section-5.1">§5.1</a>, and requires an Edwards25519 curve key.</p>
<p>The pre-hash function is SHA-512, see <a class="reference internal" href="hash.html#c.PSA_ALG_SHA_512" title="PSA_ALG_SHA_512"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_SHA_512</span></code></a>.
When used to sign or verify a hash, the <code class="docutils literal notranslate"><span class="pre">hash</span></code> parameter is the SHA-512 message digest.</p>
<p>The signature functions without a context parameter use a zero-length context when computing or verifying signatures.
To use a non-zero-length context, use the signature functions that accept a context parameter, such as <a class="reference internal" href="#c.psa_sign_hash_with_context" title="psa_sign_hash_with_context"><code class="docutils literal notranslate"><span class="pre">psa_sign_hash_with_context</span></code></a><code class="docutils literal notranslate"><span class="pre">()</span></code> or <a class="reference internal" href="#c.psa_verify_message_with_context" title="psa_verify_message_with_context"><code class="docutils literal notranslate"><span class="pre">psa_verify_message_with_context</span></code></a><code class="docutils literal notranslate"><span class="pre">()</span></code>
The context parameter can be between zero and 255 bytes in length.</p>
<div class="admonition-implementation-note admonition">
<p class="admonition-title">Implementation note</p>
<p>When used to sign or verify a hash, the <code class="docutils literal notranslate"><span class="pre">hash</span></code> parameter to the call should be used as <span class="math notranslate nohighlight">\(\text{PH}(M)\)</span> in the algorithms defined in <a class="reference internal" href="../../about/about.html#cite-rfc8032"><span class="cite">[RFC8032]</span></a> <a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc8032.html#section-5.1">§5.1</a>.</p>
</div>
<p class="rubric">Usage</p>
<p>This is a hash-and-sign algorithm.
To calculate a signature, use one of the following approaches:</p>
<ul class="simple">
<li><p>Call <a class="reference internal" href="#c.psa_sign_message" title="psa_sign_message"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_sign_message()</span></code></a> or <a class="reference internal" href="#c.psa_sign_message_with_context" title="psa_sign_message_with_context"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_sign_message_with_context()</span></code></a> with the message.</p></li>
<li><p>Calculate the SHA-512 hash of the message with <a class="reference internal" href="hash.html#c.psa_hash_compute" title="psa_hash_compute"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_hash_compute()</span></code></a>, or with a multi-part hash operation, using the hash algorithm <a class="reference internal" href="hash.html#c.PSA_ALG_SHA_512" title="PSA_ALG_SHA_512"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_SHA_512</span></code></a>.
Then sign the calculated hash with <a class="reference internal" href="#c.psa_sign_hash" title="psa_sign_hash"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_sign_hash()</span></code></a> or <a class="reference internal" href="#c.psa_sign_hash_with_context" title="psa_sign_hash_with_context"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_sign_hash_with_context()</span></code></a>.</p></li>
</ul>
<p>Verifying a signature is similar, using one of the following approaches:</p>
<ul class="simple">
<li><p>Call <a class="reference internal" href="#c.psa_verify_message" title="psa_verify_message"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_verify_message()</span></code></a>, or <a class="reference internal" href="#c.psa_verify_message_with_context" title="psa_verify_message_with_context"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_verify_message_with_context()</span></code></a> with the message.</p></li>
<li><p>Calculate the SHA-512 hash of the message with <a class="reference internal" href="hash.html#c.psa_hash_compute" title="psa_hash_compute"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_hash_compute()</span></code></a>, or with a multi-part hash operation, using the hash algorithm <a class="reference internal" href="hash.html#c.PSA_ALG_SHA_512" title="PSA_ALG_SHA_512"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_SHA_512</span></code></a>.
Then sign the calculated hash with <a class="reference internal" href="#c.psa_verify_hash" title="psa_verify_hash"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_verify_hash()</span></code></a> or <a class="reference internal" href="#c.psa_verify_hash_with_context" title="psa_verify_hash_with_context"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_verify_hash_with_context()</span></code></a>.</p></li>
</ul>
<p class="rubric">Compatible key types</p>
<div class="line-block">
<div class="line"><a class="reference internal" href="../keys/types.html#c.PSA_KEY_TYPE_ECC_KEY_PAIR" title="PSA_KEY_TYPE_ECC_KEY_PAIR"><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_ECC_KEY_PAIR</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><a class="reference internal" href="../keys/types.html#c.PSA_ECC_FAMILY_TWISTED_EDWARDS" title="PSA_ECC_FAMILY_TWISTED_EDWARDS"><code class="docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_TWISTED_EDWARDS</span></code></a><code class="docutils literal notranslate"><span class="pre">)</span></code></div>
<div class="line"><a class="reference internal" href="../keys/types.html#c.PSA_KEY_TYPE_ECC_PUBLIC_KEY" title="PSA_KEY_TYPE_ECC_PUBLIC_KEY"><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_ECC_PUBLIC_KEY</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><a class="reference internal" href="../keys/types.html#c.PSA_ECC_FAMILY_TWISTED_EDWARDS" title="PSA_ECC_FAMILY_TWISTED_EDWARDS"><code class="docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_TWISTED_EDWARDS</span></code></a><code class="docutils literal notranslate"><span class="pre">)</span></code> (signature verification only)</div>
</div>
</section>
<section id="c.PSA_ALG_ED448PH">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_ALG_ED448PH</span></code> (macro)<a class="headerlink" href="#c.PSA_ALG_ED448PH" title="Link to this heading">¶</a></h3>
<p>Edwards-curve digital signature algorithm with pre-hashing (HashEdDSA), using the Edwards448 curve.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.1.</span></p>
</div>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ALG_ED448PH" title="PSA_ALG_ED448PH">PSA_ALG_ED448PH</a> ((<a class="reference internal" href="algorithms.html#c.psa_algorithm_t" title="psa_algorithm_t">psa_algorithm_t</a>) 0x06000915)</pre>
<p>This hash-and-sign signature algorithm can be used with both the message and hash signature functions.</p>
<p>This calculates the Ed448ph algorithm as specified in <span><em>Edwards-Curve Digital Signature Algorithm (EdDSA)</em> <a class="reference internal" href="../../about/about.html#cite-rfc8032"><span class="cite">[RFC8032]</span></a></span> <a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc8032.html#section-5.2">§5.2</a>, and requires an Edwards448 curve key.</p>
<p>The pre-hash function is the first 64 bytes of the output from SHAKE256, see <a class="reference internal" href="hash.html#c.PSA_ALG_SHAKE256_512" title="PSA_ALG_SHAKE256_512"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_SHAKE256_512</span></code></a>.
When used to sign or verify a hash, the <code class="docutils literal notranslate"><span class="pre">hash</span></code> parameter is the truncated SHAKE256 message digest.</p>
<p>The signature functions without a context parameter use a zero-length context when computing or verifying signatures.
To use a non-zero-length context, use the signature functions that accept a context parameter, for example, <a class="reference internal" href="#c.psa_sign_hash_with_context" title="psa_sign_hash_with_context"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_sign_hash_with_context()</span></code></a> or <a class="reference internal" href="#c.psa_verify_message_with_context" title="psa_verify_message_with_context"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_verify_message_with_context()</span></code></a>
The context parameter can be between zero and 255 bytes in length.</p>
<div class="admonition-implementation-note admonition">
<p class="admonition-title">Implementation note</p>
<p>When used to sign or verify a hash, the <code class="docutils literal notranslate"><span class="pre">hash</span></code> parameter to the call should be used as <span class="math notranslate nohighlight">\(\text{PH}(M)\)</span> in the algorithms defined in <a class="reference internal" href="../../about/about.html#cite-rfc8032"><span class="cite">[RFC8032]</span></a> <a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc8032.html#section-5.2">§5.2</a>.</p>
</div>
<p class="rubric">Usage</p>
<p>This is a hash-and-sign algorithm.
To calculate a signature, use one of the following approaches:</p>
<ul class="simple">
<li><p>Call <a class="reference internal" href="#c.psa_sign_message" title="psa_sign_message"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_sign_message()</span></code></a>, or <a class="reference internal" href="#c.psa_sign_message_with_context" title="psa_sign_message_with_context"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_sign_message_with_context()</span></code></a> with the message.</p></li>
<li><p>Calculate the first 64 bytes of the SHAKE256 output of the message with <a class="reference internal" href="hash.html#c.psa_hash_compute" title="psa_hash_compute"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_hash_compute()</span></code></a>, or with a multi-part hash operation, using the hash algorithm <a class="reference internal" href="hash.html#c.PSA_ALG_SHAKE256_512" title="PSA_ALG_SHAKE256_512"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_SHAKE256_512</span></code></a>.
Then sign the calculated hash with <a class="reference internal" href="#c.psa_sign_hash" title="psa_sign_hash"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_sign_hash()</span></code></a> or <a class="reference internal" href="#c.psa_sign_hash_with_context" title="psa_sign_hash_with_context"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_sign_hash_with_context()</span></code></a>.</p></li>
</ul>
<p>Verifying a signature is similar, using one of the following approaches:</p>
<ul class="simple">
<li><p>Call <a class="reference internal" href="#c.psa_verify_message" title="psa_verify_message"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_verify_message()</span></code></a>, or <a class="reference internal" href="#c.psa_verify_message_with_context" title="psa_verify_message_with_context"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_verify_message_with_context()</span></code></a> with the message.</p></li>
<li><p>Calculate the first 64 bytes of the SHAKE256 output of the message with <a class="reference internal" href="hash.html#c.psa_hash_compute" title="psa_hash_compute"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_hash_compute()</span></code></a>, or with a multi-part hash operation, using the hash algorithm <a class="reference internal" href="hash.html#c.PSA_ALG_SHAKE256_512" title="PSA_ALG_SHAKE256_512"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_SHAKE256_512</span></code></a>.
Then sign the calculated hash with <a class="reference internal" href="#c.psa_verify_hash" title="psa_verify_hash"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_verify_hash()</span></code></a> or <a class="reference internal" href="#c.psa_verify_hash_with_context" title="psa_verify_hash_with_context"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_verify_hash_with_context()</span></code></a>.</p></li>
</ul>
<p class="rubric">Compatible key types</p>
<div class="line-block">
<div class="line"><a class="reference internal" href="../keys/types.html#c.PSA_KEY_TYPE_ECC_KEY_PAIR" title="PSA_KEY_TYPE_ECC_KEY_PAIR"><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_ECC_KEY_PAIR</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><a class="reference internal" href="../keys/types.html#c.PSA_ECC_FAMILY_TWISTED_EDWARDS" title="PSA_ECC_FAMILY_TWISTED_EDWARDS"><code class="docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_TWISTED_EDWARDS</span></code></a><code class="docutils literal notranslate"><span class="pre">)</span></code></div>
<div class="line"><a class="reference internal" href="../keys/types.html#c.PSA_KEY_TYPE_ECC_PUBLIC_KEY" title="PSA_KEY_TYPE_ECC_PUBLIC_KEY"><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_ECC_PUBLIC_KEY</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><a class="reference internal" href="../keys/types.html#c.PSA_ECC_FAMILY_TWISTED_EDWARDS" title="PSA_ECC_FAMILY_TWISTED_EDWARDS"><code class="docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_TWISTED_EDWARDS</span></code></a><code class="docutils literal notranslate"><span class="pre">)</span></code> (signature verification only)</div>
</div>
</section>
<section id="c.PSA_ALG_IS_HASH_EDDSA">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_ALG_IS_HASH_EDDSA</span></code> (macro)<a class="headerlink" href="#c.PSA_ALG_IS_HASH_EDDSA" title="Link to this heading">¶</a></h3>
<p>Whether the specified algorithm is HashEdDSA.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.1.</span></p>
</div>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ALG_IS_HASH_EDDSA" title="PSA_ALG_IS_HASH_EDDSA">PSA_ALG_IS_HASH_EDDSA</a>(alg) <em><a class="reference internal" href="../../overview/implementation.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">alg</span></code></p>
</dt><dd><p>An algorithm identifier: a value of type <a class="reference internal" href="algorithms.html#c.psa_algorithm_t" title="psa_algorithm_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_algorithm_t</span></code></a>.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns</p>
<p><code class="docutils literal notranslate"><span class="pre">1</span></code> if <code class="docutils literal notranslate"><span class="pre">alg</span></code> is a HashEdDSA algorithm, <code class="docutils literal notranslate"><span class="pre">0</span></code> otherwise.</p>
<p>This macro can return either <code class="docutils literal notranslate"><span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code> if <code class="docutils literal notranslate"><span class="pre">alg</span></code> is not a supported algorithm identifier.</p>
</section>
</section>
<section id="asymmetric-signature-functions">
<span id="single-part-signature"></span><h2><span class="section-number">10.9.4 </span>Asymmetric signature functions<a class="headerlink" href="#asymmetric-signature-functions" title="Link to this heading">¶</a></h2>
<section id="c.psa_sign_message">
<h3><code class="docutils literal notranslate"><span class="pre">psa_sign_message</span></code> (function)<a class="headerlink" href="#c.psa_sign_message" title="Link to this heading">¶</a></h3>
<p>Sign a message with a private key.
For hash-and-sign algorithms, this includes the hashing step.</p>
<pre class="literal-block">psa_status_t <a class="reference internal" href="#c.psa_sign_message" title="psa_sign_message">psa_sign_message</a>(<a class="reference internal" href="../keys/ids.html#c.psa_key_id_t" title="psa_key_id_t">psa_key_id_t</a> key,
                              <a class="reference internal" href="algorithms.html#c.psa_algorithm_t" title="psa_algorithm_t">psa_algorithm_t</a> alg,
                              const uint8_t * input,
                              size_t input_length,
                              uint8_t * signature,
                              size_t signature_size,
                              size_t * signature_length);</pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">key</span></code></p>
</dt><dd><p>Identifier of the key to use for the operation. It must be an asymmetric key pair. The key must permit the usage <a class="reference internal" href="../keys/policy.html#c.PSA_KEY_USAGE_SIGN_MESSAGE" title="PSA_KEY_USAGE_SIGN_MESSAGE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_USAGE_SIGN_MESSAGE</span></code></a>.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">alg</span></code></p>
</dt><dd><p>An asymmetric signature algorithm: a value of type <a class="reference internal" href="algorithms.html#c.psa_algorithm_t" title="psa_algorithm_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_algorithm_t</span></code></a> such that <a class="reference internal" href="#c.PSA_ALG_IS_SIGN_MESSAGE" title="PSA_ALG_IS_SIGN_MESSAGE"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_IS_SIGN_MESSAGE</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> is true.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p>
</dt><dd><p>The input message to sign.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">input_length</span></code></p>
</dt><dd><p>Size of the <code class="docutils literal notranslate"><span class="pre">input</span></code> buffer in bytes.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">signature</span></code></p>
</dt><dd><p>Buffer where the signature is to be written.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">signature_size</span></code></p>
</dt><dd><p>Size of the <code class="docutils literal notranslate"><span class="pre">signature</span></code> buffer in bytes.
This must be appropriate for the selected algorithm and key:</p>
<ul class="simple">
<li><p>The required signature size is <a class="reference internal" href="#c.PSA_SIGN_OUTPUT_SIZE" title="PSA_SIGN_OUTPUT_SIZE"><code class="docutils literal notranslate"><span class="pre">PSA_SIGN_OUTPUT_SIZE</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">key_type</span></code><code class="docutils literal notranslate"><span class="pre">,</span> </code><code class="docutils literal notranslate"><span class="pre">key_bits</span></code><code class="docutils literal notranslate"><span class="pre">,</span> </code><code class="docutils literal notranslate"><span class="pre">alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> where <code class="docutils literal notranslate"><span class="pre">key_type</span></code> and <code class="docutils literal notranslate"><span class="pre">key_bits</span></code> are the type and bit-size respectively of <code class="docutils literal notranslate"><span class="pre">key</span></code>.</p></li>
<li><p><a class="reference internal" href="#c.PSA_SIGNATURE_MAX_SIZE" title="PSA_SIGNATURE_MAX_SIZE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_SIGNATURE_MAX_SIZE</span></code></a> evaluates to the maximum signature size of any supported signature algorithm.</p></li>
</ul>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">signature_length</span></code></p>
</dt><dd><p>On success, the number of bytes that make up the returned signature value.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns: <code class="docutils literal notranslate"><span class="pre">psa_status_t</span></code></p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_SUCCESS</span></code></p>
</dt><dd><p>Success.
The first <code class="docutils literal notranslate"><span class="pre">(*signature_length)</span></code> bytes of <code class="docutils literal notranslate"><span class="pre">signature</span></code> contain the signature value.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_BAD_STATE</span></code></p>
</dt><dd><p>The library requires initializing by a call to <a class="reference internal" href="../library/library.html#c.psa_crypto_init" title="psa_crypto_init"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_crypto_init()</span></code></a>.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INVALID_HANDLE</span></code></p>
</dt><dd><p><code class="docutils literal notranslate"><span class="pre">key</span></code> is not a valid key identifier.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_NOT_PERMITTED</span></code></p>
</dt><dd><p>The key does not have the <a class="reference internal" href="../keys/policy.html#c.PSA_KEY_USAGE_SIGN_MESSAGE" title="PSA_KEY_USAGE_SIGN_MESSAGE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_USAGE_SIGN_MESSAGE</span></code></a> flag, or it does not permit the requested algorithm.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_BUFFER_TOO_SMALL</span></code></p>
</dt><dd><p>The size of the <code class="docutils literal notranslate"><span class="pre">signature</span></code> buffer is too small.
<a class="reference internal" href="#c.PSA_SIGN_OUTPUT_SIZE" title="PSA_SIGN_OUTPUT_SIZE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_SIGN_OUTPUT_SIZE()</span></code></a> or <a class="reference internal" href="#c.PSA_SIGNATURE_MAX_SIZE" title="PSA_SIGNATURE_MAX_SIZE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_SIGNATURE_MAX_SIZE</span></code></a> can be used to determine a sufficient buffer size.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INVALID_ARGUMENT</span></code></p>
</dt><dd><p>The following conditions can result in this error:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">alg</span></code> is not an asymmetric signature algorithm that permits signing a message.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">key</span></code> is not an asymmetric key pair, that is compatible with <code class="docutils literal notranslate"><span class="pre">alg</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">input_length</span></code> is too large for the algorithm and key type.</p></li>
</ul>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_NOT_SUPPORTED</span></code></p>
</dt><dd><p>The following conditions can result in this error:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">alg</span></code> is not supported, or is not an asymmetric signature algorithm that permits signing a message.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">key</span></code> is not supported for use with <code class="docutils literal notranslate"><span class="pre">alg</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">input_length</span></code> is too large for the implementation.</p></li>
</ul>
</dd>
<dt><p><a class="reference internal" href="../library/status.html#c.PSA_ERROR_INSUFFICIENT_ENTROPY" title="PSA_ERROR_INSUFFICIENT_ENTROPY"><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INSUFFICIENT_ENTROPY</span></code></a></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INSUFFICIENT_MEMORY</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_COMMUNICATION_FAILURE</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_CORRUPTION_DETECTED</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_STORAGE_FAILURE</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_DATA_CORRUPT</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_DATA_INVALID</span></code></p>
</dt><dd></dd>
</dl>
</div>
<p class="rubric">Description</p>
<p>If the algorithm has a context parameter, a zero-length context is used.
To provide a context value, use <a class="reference internal" href="#c.psa_sign_message_with_context" title="psa_sign_message_with_context"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_sign_message_with_context()</span></code></a> instead.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To perform a multi-part hash-and-sign signature algorithm, first use a <a class="reference internal" href="hash.html#hash-mp"><span class="std std-ref">multi-part hash operation</span></a> and then pass the resulting hash to <a class="reference internal" href="#c.psa_sign_hash" title="psa_sign_hash"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_sign_hash()</span></code></a>.
<a class="reference internal" href="algorithms.html#c.PSA_ALG_GET_HASH" title="PSA_ALG_GET_HASH"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_GET_HASH</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> can be used to determine the hash algorithm to use.</p>
</div>
</section>
<section id="c.psa_sign_message_with_context">
<h3><code class="docutils literal notranslate"><span class="pre">psa_sign_message_with_context</span></code> (function)<a class="headerlink" href="#c.psa_sign_message_with_context" title="Link to this heading">¶</a></h3>
<p>Sign a message with a private key using a supplied context.
For hash-and-sign algorithms, this includes the hashing step.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.4.</span></p>
</div>
<pre class="literal-block">psa_status_t <a class="reference internal" href="#c.psa_sign_message_with_context" title="psa_sign_message_with_context">psa_sign_message_with_context</a>(<a class="reference internal" href="../keys/ids.html#c.psa_key_id_t" title="psa_key_id_t">psa_key_id_t</a> key,
                                           <a class="reference internal" href="algorithms.html#c.psa_algorithm_t" title="psa_algorithm_t">psa_algorithm_t</a> alg,
                                           const uint8_t * input,
                                           size_t input_length,
                                           const uint8_t * context,
                                           size_t context_length,
                                           uint8_t * signature,
                                           size_t signature_size,
                                           size_t * signature_length);</pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">key</span></code></p>
</dt><dd><p>Identifier of the key to use for the operation. It must be an asymmetric key pair. The key must permit the usage <a class="reference internal" href="../keys/policy.html#c.PSA_KEY_USAGE_SIGN_MESSAGE" title="PSA_KEY_USAGE_SIGN_MESSAGE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_USAGE_SIGN_MESSAGE</span></code></a>.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">alg</span></code></p>
</dt><dd><p>An asymmetric signature algorithm: a value of type <a class="reference internal" href="algorithms.html#c.psa_algorithm_t" title="psa_algorithm_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_algorithm_t</span></code></a> such that <a class="reference internal" href="#c.PSA_ALG_IS_SIGN_MESSAGE" title="PSA_ALG_IS_SIGN_MESSAGE"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_IS_SIGN_MESSAGE</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> is true.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p>
</dt><dd><p>The input message to sign.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">input_length</span></code></p>
</dt><dd><p>Size of the <code class="docutils literal notranslate"><span class="pre">input</span></code> buffer in bytes.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">context</span></code></p>
</dt><dd><p>The context to use for this signature.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">context_length</span></code></p>
</dt><dd><p>Size of the <code class="docutils literal notranslate"><span class="pre">context</span></code> buffer in bytes.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">signature</span></code></p>
</dt><dd><p>Buffer where the signature is to be written.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">signature_size</span></code></p>
</dt><dd><p>Size of the <code class="docutils literal notranslate"><span class="pre">signature</span></code> buffer in bytes.
This must be appropriate for the selected algorithm and key:</p>
<ul class="simple">
<li><p>The required signature size is <a class="reference internal" href="#c.PSA_SIGN_OUTPUT_SIZE" title="PSA_SIGN_OUTPUT_SIZE"><code class="docutils literal notranslate"><span class="pre">PSA_SIGN_OUTPUT_SIZE</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">key_type</span></code><code class="docutils literal notranslate"><span class="pre">,</span> </code><code class="docutils literal notranslate"><span class="pre">key_bits</span></code><code class="docutils literal notranslate"><span class="pre">,</span> </code><code class="docutils literal notranslate"><span class="pre">alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> where <code class="docutils literal notranslate"><span class="pre">key_type</span></code> and <code class="docutils literal notranslate"><span class="pre">key_bits</span></code> are the type and bit-size respectively of <code class="docutils literal notranslate"><span class="pre">key</span></code>.</p></li>
<li><p><a class="reference internal" href="#c.PSA_SIGNATURE_MAX_SIZE" title="PSA_SIGNATURE_MAX_SIZE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_SIGNATURE_MAX_SIZE</span></code></a> evaluates to the maximum signature size of any supported signature algorithm.</p></li>
</ul>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">signature_length</span></code></p>
</dt><dd><p>On success, the number of bytes that make up the returned signature value.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns: <code class="docutils literal notranslate"><span class="pre">psa_status_t</span></code></p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_SUCCESS</span></code></p>
</dt><dd><p>Success.
The first <code class="docutils literal notranslate"><span class="pre">(*signature_length)</span></code> bytes of <code class="docutils literal notranslate"><span class="pre">signature</span></code> contain the signature value.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_BAD_STATE</span></code></p>
</dt><dd><p>The library requires initializing by a call to <a class="reference internal" href="../library/library.html#c.psa_crypto_init" title="psa_crypto_init"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_crypto_init()</span></code></a>.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INVALID_HANDLE</span></code></p>
</dt><dd><p><code class="docutils literal notranslate"><span class="pre">key</span></code> is not a valid key identifier.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_NOT_PERMITTED</span></code></p>
</dt><dd><p>The key does not have the <a class="reference internal" href="../keys/policy.html#c.PSA_KEY_USAGE_SIGN_MESSAGE" title="PSA_KEY_USAGE_SIGN_MESSAGE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_USAGE_SIGN_MESSAGE</span></code></a> flag, or it does not permit the requested algorithm.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_BUFFER_TOO_SMALL</span></code></p>
</dt><dd><p>The size of the <code class="docutils literal notranslate"><span class="pre">signature</span></code> buffer is too small.
<a class="reference internal" href="#c.PSA_SIGN_OUTPUT_SIZE" title="PSA_SIGN_OUTPUT_SIZE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_SIGN_OUTPUT_SIZE()</span></code></a> or <a class="reference internal" href="#c.PSA_SIGNATURE_MAX_SIZE" title="PSA_SIGNATURE_MAX_SIZE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_SIGNATURE_MAX_SIZE</span></code></a> can be used to determine a sufficient buffer size.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INVALID_ARGUMENT</span></code></p>
</dt><dd><p>The following conditions can result in this error:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">alg</span></code> is not an asymmetric signature algorithm that permits signing a message with a non-zero-length context.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">key</span></code> is not an asymmetric key pair, that is compatible with <code class="docutils literal notranslate"><span class="pre">alg</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">input_length</span></code> is too large for the algorithm and key type.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">context_length</span></code> is not valid for the algorithm and key type.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">context</span></code> is not a valid input value for the algorithm and key type.</p></li>
</ul>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_NOT_SUPPORTED</span></code></p>
</dt><dd><p>The following conditions can result in this error:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">alg</span></code> is not supported, or is not an asymmetric signature algorithm that permits signing a message.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">key</span></code> is not supported for use with <code class="docutils literal notranslate"><span class="pre">alg</span></code>.</p></li>
<li><p>The implementation does not support this value of <code class="docutils literal notranslate"><span class="pre">context_length</span></code> for <code class="docutils literal notranslate"><span class="pre">alg</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">input_length</span></code> is too large for the implementation.</p></li>
</ul>
</dd>
<dt><p><a class="reference internal" href="../library/status.html#c.PSA_ERROR_INSUFFICIENT_ENTROPY" title="PSA_ERROR_INSUFFICIENT_ENTROPY"><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INSUFFICIENT_ENTROPY</span></code></a></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INSUFFICIENT_MEMORY</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_COMMUNICATION_FAILURE</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_CORRUPTION_DETECTED</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_STORAGE_FAILURE</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_DATA_CORRUPT</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_DATA_INVALID</span></code></p>
</dt><dd></dd>
</dl>
</div>
<p class="rubric">Description</p>
<p>If a context parameter is not required, <a class="reference internal" href="#c.psa_sign_message" title="psa_sign_message"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_sign_message()</span></code></a> can be used instead.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To perform a multi-part hash-and-sign signature algorithm, first use a <a class="reference internal" href="hash.html#hash-mp"><span class="std std-ref">multi-part hash operation</span></a> and then pass the resulting hash to <a class="reference internal" href="#c.psa_sign_hash_with_context" title="psa_sign_hash_with_context"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_sign_hash_with_context()</span></code></a>.
<a class="reference internal" href="algorithms.html#c.PSA_ALG_GET_HASH" title="PSA_ALG_GET_HASH"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_GET_HASH</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> can be used to determine the hash algorithm to use.</p>
</div>
</section>
<section id="c.psa_verify_message">
<h3><code class="docutils literal notranslate"><span class="pre">psa_verify_message</span></code> (function)<a class="headerlink" href="#c.psa_verify_message" title="Link to this heading">¶</a></h3>
<p>Verify the signature of a message with a public key.
For hash-and-sign algorithms, this includes the hashing step.</p>
<pre class="literal-block">psa_status_t <a class="reference internal" href="#c.psa_verify_message" title="psa_verify_message">psa_verify_message</a>(<a class="reference internal" href="../keys/ids.html#c.psa_key_id_t" title="psa_key_id_t">psa_key_id_t</a> key,
                                <a class="reference internal" href="algorithms.html#c.psa_algorithm_t" title="psa_algorithm_t">psa_algorithm_t</a> alg,
                                const uint8_t * input,
                                size_t input_length,
                                const uint8_t * signature,
                                size_t signature_length);</pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">key</span></code></p>
</dt><dd><p>Identifier of the key to use for the operation. It must be a public key or an asymmetric key pair. The key must permit the usage <a class="reference internal" href="../keys/policy.html#c.PSA_KEY_USAGE_VERIFY_MESSAGE" title="PSA_KEY_USAGE_VERIFY_MESSAGE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_USAGE_VERIFY_MESSAGE</span></code></a>.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">alg</span></code></p>
</dt><dd><p>An asymmetric signature algorithm: a value of type <a class="reference internal" href="algorithms.html#c.psa_algorithm_t" title="psa_algorithm_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_algorithm_t</span></code></a> such that <a class="reference internal" href="#c.PSA_ALG_IS_SIGN_MESSAGE" title="PSA_ALG_IS_SIGN_MESSAGE"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_IS_SIGN_MESSAGE</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> is true.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p>
</dt><dd><p>The message whose signature is to be verified.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">input_length</span></code></p>
</dt><dd><p>Size of the <code class="docutils literal notranslate"><span class="pre">input</span></code> buffer in bytes.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">signature</span></code></p>
</dt><dd><p>Buffer containing the signature to verify.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">signature_length</span></code></p>
</dt><dd><p>Size of the <code class="docutils literal notranslate"><span class="pre">signature</span></code> buffer in bytes.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns: <code class="docutils literal notranslate"><span class="pre">psa_status_t</span></code></p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_SUCCESS</span></code></p>
</dt><dd><p>Success.
The signature is valid.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_BAD_STATE</span></code></p>
</dt><dd><p>The library requires initializing by a call to <a class="reference internal" href="../library/library.html#c.psa_crypto_init" title="psa_crypto_init"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_crypto_init()</span></code></a>.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INVALID_HANDLE</span></code></p>
</dt><dd><p><code class="docutils literal notranslate"><span class="pre">key</span></code> is not a valid key identifier.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_NOT_PERMITTED</span></code></p>
</dt><dd><p>The key does not have the <a class="reference internal" href="../keys/policy.html#c.PSA_KEY_USAGE_VERIFY_MESSAGE" title="PSA_KEY_USAGE_VERIFY_MESSAGE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_USAGE_VERIFY_MESSAGE</span></code></a> flag, or it does not permit the requested algorithm.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INVALID_SIGNATURE</span></code></p>
</dt><dd><p><code class="docutils literal notranslate"><span class="pre">signature</span></code> is not the result of signing the <code class="docutils literal notranslate"><span class="pre">input</span></code> message with algorithm <code class="docutils literal notranslate"><span class="pre">alg</span></code> using the private key corresponding to <code class="docutils literal notranslate"><span class="pre">key</span></code>.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INVALID_ARGUMENT</span></code></p>
</dt><dd><p>The following conditions can result in this error:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">alg</span></code> is not an asymmetric signature algorithm that permits verifying a message.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">key</span></code> is not a public key or an asymmetric key pair, that is compatible with <code class="docutils literal notranslate"><span class="pre">alg</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">input_length</span></code> is too large for the algorithm and key type.</p></li>
</ul>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_NOT_SUPPORTED</span></code></p>
</dt><dd><p>The following conditions can result in this error:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">alg</span></code> is not supported, or is not an asymmetric signature algorithm that permits verifying a message.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">key</span></code> is not supported for use with <code class="docutils literal notranslate"><span class="pre">alg</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">input_length</span></code> is too large for the implementation.</p></li>
</ul>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INSUFFICIENT_MEMORY</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_COMMUNICATION_FAILURE</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_CORRUPTION_DETECTED</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_STORAGE_FAILURE</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_DATA_CORRUPT</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_DATA_INVALID</span></code></p>
</dt><dd></dd>
</dl>
</div>
<p class="rubric">Description</p>
<p>If the algorithm has a context parameter, a zero-length context is used.
To provide a context value, use <a class="reference internal" href="#c.psa_verify_message_with_context" title="psa_verify_message_with_context"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_verify_message_with_context()</span></code></a> instead.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To perform a multi-part hash-and-sign signature verification algorithm, first use a <a class="reference internal" href="hash.html#hash-mp"><span class="std std-ref">multi-part hash operation</span></a> to hash the message and then pass the resulting hash to <a class="reference internal" href="#c.psa_verify_hash" title="psa_verify_hash"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_verify_hash()</span></code></a>.
<a class="reference internal" href="algorithms.html#c.PSA_ALG_GET_HASH" title="PSA_ALG_GET_HASH"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_GET_HASH</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> can be used to determine the hash algorithm to use.</p>
</div>
</section>
<section id="c.psa_verify_message_with_context">
<h3><code class="docutils literal notranslate"><span class="pre">psa_verify_message_with_context</span></code> (function)<a class="headerlink" href="#c.psa_verify_message_with_context" title="Link to this heading">¶</a></h3>
<p>Verify the signature of a message with a public key and a supplied context.
For hash-and-sign algorithms, this includes the hashing step.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.4.</span></p>
</div>
<pre class="literal-block">psa_status_t <a class="reference internal" href="#c.psa_verify_message_with_context" title="psa_verify_message_with_context">psa_verify_message_with_context</a>(<a class="reference internal" href="../keys/ids.html#c.psa_key_id_t" title="psa_key_id_t">psa_key_id_t</a> key,
                                             <a class="reference internal" href="algorithms.html#c.psa_algorithm_t" title="psa_algorithm_t">psa_algorithm_t</a> alg,
                                             const uint8_t * input,
                                             size_t input_length,
                                             const uint8_t * context,
                                             size_t context_length,
                                             const uint8_t * signature,
                                             size_t signature_length);</pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">key</span></code></p>
</dt><dd><p>Identifier of the key to use for the operation. It must be a public key or an asymmetric key pair. The key must permit the usage <a class="reference internal" href="../keys/policy.html#c.PSA_KEY_USAGE_VERIFY_MESSAGE" title="PSA_KEY_USAGE_VERIFY_MESSAGE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_USAGE_VERIFY_MESSAGE</span></code></a>.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">alg</span></code></p>
</dt><dd><p>An asymmetric signature algorithm: a value of type <a class="reference internal" href="algorithms.html#c.psa_algorithm_t" title="psa_algorithm_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_algorithm_t</span></code></a> such that <a class="reference internal" href="#c.PSA_ALG_IS_SIGN_MESSAGE" title="PSA_ALG_IS_SIGN_MESSAGE"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_IS_SIGN_MESSAGE</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> is true.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p>
</dt><dd><p>The message whose signature is to be verified.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">input_length</span></code></p>
</dt><dd><p>Size of the <code class="docutils literal notranslate"><span class="pre">input</span></code> buffer in bytes.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">context</span></code></p>
</dt><dd><p>The context to use for this signature.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">context_length</span></code></p>
</dt><dd><p>Size of the <code class="docutils literal notranslate"><span class="pre">context</span></code> buffer in bytes.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">signature</span></code></p>
</dt><dd><p>Buffer containing the signature to verify.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">signature_length</span></code></p>
</dt><dd><p>Size of the <code class="docutils literal notranslate"><span class="pre">signature</span></code> buffer in bytes.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns: <code class="docutils literal notranslate"><span class="pre">psa_status_t</span></code></p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_SUCCESS</span></code></p>
</dt><dd><p>Success.
The signature is valid.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_BAD_STATE</span></code></p>
</dt><dd><p>The library requires initializing by a call to <a class="reference internal" href="../library/library.html#c.psa_crypto_init" title="psa_crypto_init"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_crypto_init()</span></code></a>.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INVALID_HANDLE</span></code></p>
</dt><dd><p><code class="docutils literal notranslate"><span class="pre">key</span></code> is not a valid key identifier.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_NOT_PERMITTED</span></code></p>
</dt><dd><p>The key does not have the <a class="reference internal" href="../keys/policy.html#c.PSA_KEY_USAGE_VERIFY_MESSAGE" title="PSA_KEY_USAGE_VERIFY_MESSAGE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_USAGE_VERIFY_MESSAGE</span></code></a> flag, or it does not permit the requested algorithm.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INVALID_SIGNATURE</span></code></p>
</dt><dd><p><code class="docutils literal notranslate"><span class="pre">signature</span></code> is not the result of signing the <code class="docutils literal notranslate"><span class="pre">input</span></code> message with algorithm <code class="docutils literal notranslate"><span class="pre">alg</span></code> using the private key corresponding to <code class="docutils literal notranslate"><span class="pre">key</span></code>.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INVALID_ARGUMENT</span></code></p>
</dt><dd><p>The following conditions can result in this error:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">alg</span></code> is not an asymmetric signature algorithm that permits verifying a message with a non-zero-length context.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">key</span></code> is not a public key or an asymmetric key pair, that is compatible with <code class="docutils literal notranslate"><span class="pre">alg</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">input_length</span></code> is too large for the algorithm and key type.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">context_length</span></code> is not valid for the algorithm and key type.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">context</span></code> is not a valid input value for the algorithm and key type.</p></li>
</ul>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_NOT_SUPPORTED</span></code></p>
</dt><dd><p>The following conditions can result in this error:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">alg</span></code> is not supported, or is not an asymmetric signature algorithm that permits verifying a message.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">key</span></code> is not supported for use with <code class="docutils literal notranslate"><span class="pre">alg</span></code>.</p></li>
<li><p>The implementation does not support this value of <code class="docutils literal notranslate"><span class="pre">context_length</span></code> for <code class="docutils literal notranslate"><span class="pre">alg</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">input_length</span></code> is too large for the implementation.</p></li>
</ul>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INSUFFICIENT_MEMORY</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_COMMUNICATION_FAILURE</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_CORRUPTION_DETECTED</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_STORAGE_FAILURE</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_DATA_CORRUPT</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_DATA_INVALID</span></code></p>
</dt><dd></dd>
</dl>
</div>
<p class="rubric">Description</p>
<p>If a context parameter is not required, <a class="reference internal" href="#c.psa_verify_message" title="psa_verify_message"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_verify_message()</span></code></a> can be used instead.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To perform a multi-part hash-and-sign signature verification algorithm, first use a <a class="reference internal" href="hash.html#hash-mp"><span class="std std-ref">multi-part hash operation</span></a> to hash the message and then pass the resulting hash to <a class="reference internal" href="#c.psa_verify_hash_with_context" title="psa_verify_hash_with_context"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_verify_hash_with_context()</span></code></a>.
<a class="reference internal" href="algorithms.html#c.PSA_ALG_GET_HASH" title="PSA_ALG_GET_HASH"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_GET_HASH</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> can be used to determine the hash algorithm to use.</p>
</div>
</section>
<section id="c.psa_sign_hash">
<h3><code class="docutils literal notranslate"><span class="pre">psa_sign_hash</span></code> (function)<a class="headerlink" href="#c.psa_sign_hash" title="Link to this heading">¶</a></h3>
<p>Sign a pre-computed hash with a private key.</p>
<pre class="literal-block">psa_status_t <a class="reference internal" href="#c.psa_sign_hash" title="psa_sign_hash">psa_sign_hash</a>(<a class="reference internal" href="../keys/ids.html#c.psa_key_id_t" title="psa_key_id_t">psa_key_id_t</a> key,
                           <a class="reference internal" href="algorithms.html#c.psa_algorithm_t" title="psa_algorithm_t">psa_algorithm_t</a> alg,
                           const uint8_t * hash,
                           size_t hash_length,
                           uint8_t * signature,
                           size_t signature_size,
                           size_t * signature_length);</pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl>
<dt><p><code class="docutils literal notranslate"><span class="pre">key</span></code></p>
</dt><dd><p>Identifier of the key to use for the operation. It must be an asymmetric key pair. The key must permit the usage <a class="reference internal" href="../keys/policy.html#c.PSA_KEY_USAGE_SIGN_HASH" title="PSA_KEY_USAGE_SIGN_HASH"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_USAGE_SIGN_HASH</span></code></a>.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">alg</span></code></p>
</dt><dd><p>An asymmetric signature algorithm that separates the hash and sign operations: a value of type <a class="reference internal" href="algorithms.html#c.psa_algorithm_t" title="psa_algorithm_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_algorithm_t</span></code></a> such that <a class="reference internal" href="#c.PSA_ALG_IS_SIGN_HASH" title="PSA_ALG_IS_SIGN_HASH"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_IS_SIGN_HASH</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> is true.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">hash</span></code></p>
</dt><dd><p>The input to sign. This is usually the hash of a message.</p>
<p>See the description of this function, or the description of individual signature algorithms, for details of the acceptable inputs.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">hash_length</span></code></p>
</dt><dd><p>Size of the <code class="docutils literal notranslate"><span class="pre">hash</span></code> buffer in bytes.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">signature</span></code></p>
</dt><dd><p>Buffer where the signature is to be written.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">signature_size</span></code></p>
</dt><dd><p>Size of the <code class="docutils literal notranslate"><span class="pre">signature</span></code> buffer in bytes.
This must be appropriate for the selected algorithm and key:</p>
<ul class="simple">
<li><p>The required signature size is <a class="reference internal" href="#c.PSA_SIGN_OUTPUT_SIZE" title="PSA_SIGN_OUTPUT_SIZE"><code class="docutils literal notranslate"><span class="pre">PSA_SIGN_OUTPUT_SIZE</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">key_type</span></code><code class="docutils literal notranslate"><span class="pre">,</span> </code><code class="docutils literal notranslate"><span class="pre">key_bits</span></code><code class="docutils literal notranslate"><span class="pre">,</span> </code><code class="docutils literal notranslate"><span class="pre">alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> where <code class="docutils literal notranslate"><span class="pre">key_type</span></code> and <code class="docutils literal notranslate"><span class="pre">key_bits</span></code> are the type and bit-size respectively of <code class="docutils literal notranslate"><span class="pre">key</span></code>.</p></li>
<li><p><a class="reference internal" href="#c.PSA_SIGNATURE_MAX_SIZE" title="PSA_SIGNATURE_MAX_SIZE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_SIGNATURE_MAX_SIZE</span></code></a> evaluates to the maximum signature size of any supported signature algorithm.</p></li>
</ul>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">signature_length</span></code></p>
</dt><dd><p>On success, the number of bytes that make up the returned signature value.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns: <code class="docutils literal notranslate"><span class="pre">psa_status_t</span></code></p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_SUCCESS</span></code></p>
</dt><dd><p>Success.
The first <code class="docutils literal notranslate"><span class="pre">(*signature_length)</span></code> bytes of <code class="docutils literal notranslate"><span class="pre">signature</span></code> contain the signature value.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_BAD_STATE</span></code></p>
</dt><dd><p>The library requires initializing by a call to <a class="reference internal" href="../library/library.html#c.psa_crypto_init" title="psa_crypto_init"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_crypto_init()</span></code></a>.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INVALID_HANDLE</span></code></p>
</dt><dd><p><code class="docutils literal notranslate"><span class="pre">key</span></code> is not a valid key identifier.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_NOT_PERMITTED</span></code></p>
</dt><dd><p>The key does not have the <a class="reference internal" href="../keys/policy.html#c.PSA_KEY_USAGE_SIGN_HASH" title="PSA_KEY_USAGE_SIGN_HASH"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_USAGE_SIGN_HASH</span></code></a> flag, or it does not permit the requested algorithm.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_BUFFER_TOO_SMALL</span></code></p>
</dt><dd><p>The size of the <code class="docutils literal notranslate"><span class="pre">signature</span></code> buffer is too small.
<a class="reference internal" href="#c.PSA_SIGN_OUTPUT_SIZE" title="PSA_SIGN_OUTPUT_SIZE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_SIGN_OUTPUT_SIZE()</span></code></a> or <a class="reference internal" href="#c.PSA_SIGNATURE_MAX_SIZE" title="PSA_SIGNATURE_MAX_SIZE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_SIGNATURE_MAX_SIZE</span></code></a> can be used to determine a sufficient buffer size.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INVALID_ARGUMENT</span></code></p>
</dt><dd><p>The following conditions can result in this error:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">alg</span></code> is not an asymmetric signature algorithm that permits signing a pre-computed hash.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">key</span></code> is not an asymmetric key pair, that is compatible with <code class="docutils literal notranslate"><span class="pre">alg</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hash_length</span></code> is not valid for the algorithm and key type.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hash</span></code> is not a valid input value for the algorithm and key type.</p></li>
</ul>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_NOT_SUPPORTED</span></code></p>
</dt><dd><p>The following conditions can result in this error:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">alg</span></code> is not supported, or is not an asymmetric signature algorithm that permits signing a pre-computed hash.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">key</span></code> is not supported for use with <code class="docutils literal notranslate"><span class="pre">alg</span></code>.</p></li>
</ul>
</dd>
<dt><p><a class="reference internal" href="../library/status.html#c.PSA_ERROR_INSUFFICIENT_ENTROPY" title="PSA_ERROR_INSUFFICIENT_ENTROPY"><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INSUFFICIENT_ENTROPY</span></code></a></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INSUFFICIENT_MEMORY</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_COMMUNICATION_FAILURE</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_CORRUPTION_DETECTED</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_STORAGE_FAILURE</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_DATA_CORRUPT</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_DATA_INVALID</span></code></p>
</dt><dd></dd>
</dl>
</div>
<p class="rubric">Description</p>
<p>For hash-and-sign signature algorithms, the <code class="docutils literal notranslate"><span class="pre">hash</span></code> input to this function is the hash of the message to sign.
The algorithm used to calculate this hash is encoded in the signature algorithm.
For such algorithms, <code class="docutils literal notranslate"><span class="pre">hash_length</span></code> must equal the length of the hash output: <code class="docutils literal notranslate"><span class="pre">hash_length</span></code><code class="docutils literal notranslate"> <span class="pre">==</span> </code><a class="reference internal" href="hash.html#c.PSA_HASH_LENGTH" title="PSA_HASH_LENGTH"><code class="docutils literal notranslate"><span class="pre">PSA_HASH_LENGTH</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><a class="reference internal" href="algorithms.html#c.PSA_ALG_GET_HASH" title="PSA_ALG_GET_HASH"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_GET_HASH</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">alg</span></code><code class="docutils literal notranslate"><span class="pre">))</span></code>.</p>
<p>Specialized signature algorithms can apply a padding or encoding to the hash.
In such cases, the encoded hash must be passed to this function. For example, see <a class="reference internal" href="#c.PSA_ALG_RSA_PKCS1V15_SIGN_RAW" title="PSA_ALG_RSA_PKCS1V15_SIGN_RAW"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_RSA_PKCS1V15_SIGN_RAW</span></code></a>.</p>
<p>If the algorithm has a context parameter, a zero-length context is used.
To provide a context value, use <a class="reference internal" href="#c.psa_sign_hash_with_context" title="psa_sign_hash_with_context"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_sign_hash_with_context()</span></code></a> instead.</p>
</section>
<section id="c.psa_sign_hash_with_context">
<h3><code class="docutils literal notranslate"><span class="pre">psa_sign_hash_with_context</span></code> (function)<a class="headerlink" href="#c.psa_sign_hash_with_context" title="Link to this heading">¶</a></h3>
<p>Sign a pre-computed hash with a private key and a supplied context.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.4.</span></p>
</div>
<pre class="literal-block">psa_status_t <a class="reference internal" href="#c.psa_sign_hash_with_context" title="psa_sign_hash_with_context">psa_sign_hash_with_context</a>(<a class="reference internal" href="../keys/ids.html#c.psa_key_id_t" title="psa_key_id_t">psa_key_id_t</a> key,
                                        <a class="reference internal" href="algorithms.html#c.psa_algorithm_t" title="psa_algorithm_t">psa_algorithm_t</a> alg,
                                        const uint8_t * hash,
                                        size_t hash_length,
                                        const uint8_t * context,
                                        size_t context_length,
                                        uint8_t * signature,
                                        size_t signature_size,
                                        size_t * signature_length);</pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl>
<dt><p><code class="docutils literal notranslate"><span class="pre">key</span></code></p>
</dt><dd><p>Identifier of the key to use for the operation. It must be an asymmetric key pair. The key must permit the usage <a class="reference internal" href="../keys/policy.html#c.PSA_KEY_USAGE_SIGN_HASH" title="PSA_KEY_USAGE_SIGN_HASH"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_USAGE_SIGN_HASH</span></code></a>.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">alg</span></code></p>
</dt><dd><p>An asymmetric signature algorithm that separates the hash and sign operations: a value of type <a class="reference internal" href="algorithms.html#c.psa_algorithm_t" title="psa_algorithm_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_algorithm_t</span></code></a> such that <a class="reference internal" href="#c.PSA_ALG_IS_SIGN_HASH" title="PSA_ALG_IS_SIGN_HASH"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_IS_SIGN_HASH</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> is true.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">hash</span></code></p>
</dt><dd><p>The input to sign. This is usually the hash of a message.</p>
<p>See the description of this function, or the description of individual signature algorithms, for details of the acceptable inputs.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">hash_length</span></code></p>
</dt><dd><p>Size of the <code class="docutils literal notranslate"><span class="pre">hash</span></code> buffer in bytes.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">context</span></code></p>
</dt><dd><p>The context to use for this signature.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">context_length</span></code></p>
</dt><dd><p>Size of the <code class="docutils literal notranslate"><span class="pre">context</span></code> buffer in bytes.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">signature</span></code></p>
</dt><dd><p>Buffer where the signature is to be written.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">signature_size</span></code></p>
</dt><dd><p>Size of the <code class="docutils literal notranslate"><span class="pre">signature</span></code> buffer in bytes.
This must be appropriate for the selected algorithm and key:</p>
<ul class="simple">
<li><p>The required signature size is <a class="reference internal" href="#c.PSA_SIGN_OUTPUT_SIZE" title="PSA_SIGN_OUTPUT_SIZE"><code class="docutils literal notranslate"><span class="pre">PSA_SIGN_OUTPUT_SIZE</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">key_type</span></code><code class="docutils literal notranslate"><span class="pre">,</span> </code><code class="docutils literal notranslate"><span class="pre">key_bits</span></code><code class="docutils literal notranslate"><span class="pre">,</span> </code><code class="docutils literal notranslate"><span class="pre">alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> where <code class="docutils literal notranslate"><span class="pre">key_type</span></code> and <code class="docutils literal notranslate"><span class="pre">key_bits</span></code> are the type and bit-size respectively of <code class="docutils literal notranslate"><span class="pre">key</span></code>.</p></li>
<li><p><a class="reference internal" href="#c.PSA_SIGNATURE_MAX_SIZE" title="PSA_SIGNATURE_MAX_SIZE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_SIGNATURE_MAX_SIZE</span></code></a> evaluates to the maximum signature size of any supported signature algorithm.</p></li>
</ul>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">signature_length</span></code></p>
</dt><dd><p>On success, the number of bytes that make up the returned signature value.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns: <code class="docutils literal notranslate"><span class="pre">psa_status_t</span></code></p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_SUCCESS</span></code></p>
</dt><dd><p>Success.
The first <code class="docutils literal notranslate"><span class="pre">(*signature_length)</span></code> bytes of <code class="docutils literal notranslate"><span class="pre">signature</span></code> contain the signature value.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_BAD_STATE</span></code></p>
</dt><dd><p>The library requires initializing by a call to <a class="reference internal" href="../library/library.html#c.psa_crypto_init" title="psa_crypto_init"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_crypto_init()</span></code></a>.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INVALID_HANDLE</span></code></p>
</dt><dd><p><code class="docutils literal notranslate"><span class="pre">key</span></code> is not a valid key identifier.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_NOT_PERMITTED</span></code></p>
</dt><dd><p>The key does not have the <a class="reference internal" href="../keys/policy.html#c.PSA_KEY_USAGE_SIGN_HASH" title="PSA_KEY_USAGE_SIGN_HASH"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_USAGE_SIGN_HASH</span></code></a> flag, or it does not permit the requested algorithm.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_BUFFER_TOO_SMALL</span></code></p>
</dt><dd><p>The size of the <code class="docutils literal notranslate"><span class="pre">signature</span></code> buffer is too small.
<a class="reference internal" href="#c.PSA_SIGN_OUTPUT_SIZE" title="PSA_SIGN_OUTPUT_SIZE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_SIGN_OUTPUT_SIZE()</span></code></a> or <a class="reference internal" href="#c.PSA_SIGNATURE_MAX_SIZE" title="PSA_SIGNATURE_MAX_SIZE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_SIGNATURE_MAX_SIZE</span></code></a> can be used to determine a sufficient buffer size.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INVALID_ARGUMENT</span></code></p>
</dt><dd><p>The following conditions can result in this error:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">alg</span></code> is not an asymmetric signature algorithm that permits signing a pre-computed hash with a context.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">key</span></code> is not an asymmetric key pair, that is compatible with <code class="docutils literal notranslate"><span class="pre">alg</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hash_length</span></code> is not valid for the algorithm and key type.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hash</span></code> is not a valid input value for the algorithm and key type.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">context_length</span></code> is not valid for the algorithm and key type.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">context</span></code> is not a valid input value for the algorithm and key type.</p></li>
</ul>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_NOT_SUPPORTED</span></code></p>
</dt><dd><p>The following conditions can result in this error:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">alg</span></code> is not supported, or is not an asymmetric signature algorithm that permits signing a pre-computed hash.</p></li>
<li><p>The implementation does not support this value of <code class="docutils literal notranslate"><span class="pre">context_length</span></code> for <code class="docutils literal notranslate"><span class="pre">alg</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">key</span></code> is not supported for use with <code class="docutils literal notranslate"><span class="pre">alg</span></code>.</p></li>
</ul>
</dd>
<dt><p><a class="reference internal" href="../library/status.html#c.PSA_ERROR_INSUFFICIENT_ENTROPY" title="PSA_ERROR_INSUFFICIENT_ENTROPY"><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INSUFFICIENT_ENTROPY</span></code></a></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INSUFFICIENT_MEMORY</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_COMMUNICATION_FAILURE</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_CORRUPTION_DETECTED</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_STORAGE_FAILURE</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_DATA_CORRUPT</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_DATA_INVALID</span></code></p>
</dt><dd></dd>
</dl>
</div>
<p class="rubric">Description</p>
<p>For hash-and-sign signature algorithms, the <code class="docutils literal notranslate"><span class="pre">hash</span></code> input to this function is the hash of the message to sign.
The algorithm used to calculate this hash is encoded in the signature algorithm.
For such algorithms, <code class="docutils literal notranslate"><span class="pre">hash_length</span></code> must equal the length of the hash output: <code class="docutils literal notranslate"><span class="pre">hash_length</span></code><code class="docutils literal notranslate"> <span class="pre">==</span> </code><a class="reference internal" href="hash.html#c.PSA_HASH_LENGTH" title="PSA_HASH_LENGTH"><code class="docutils literal notranslate"><span class="pre">PSA_HASH_LENGTH</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><a class="reference internal" href="algorithms.html#c.PSA_ALG_GET_HASH" title="PSA_ALG_GET_HASH"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_GET_HASH</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">alg</span></code><code class="docutils literal notranslate"><span class="pre">))</span></code>.</p>
<p>Specialized signature algorithms can apply a padding or encoding to the hash.
In such cases, the encoded hash must be passed to this function. For example, see <a class="reference internal" href="#c.PSA_ALG_RSA_PKCS1V15_SIGN_RAW" title="PSA_ALG_RSA_PKCS1V15_SIGN_RAW"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_RSA_PKCS1V15_SIGN_RAW</span></code></a>.</p>
<p>If a context parameter is not required, <a class="reference internal" href="#c.psa_sign_hash" title="psa_sign_hash"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_sign_hash()</span></code></a> can be used instead.</p>
</section>
<section id="c.psa_verify_hash">
<h3><code class="docutils literal notranslate"><span class="pre">psa_verify_hash</span></code> (function)<a class="headerlink" href="#c.psa_verify_hash" title="Link to this heading">¶</a></h3>
<p>Verify the signature of a hash or short message using a public key.</p>
<pre class="literal-block">psa_status_t <a class="reference internal" href="#c.psa_verify_hash" title="psa_verify_hash">psa_verify_hash</a>(<a class="reference internal" href="../keys/ids.html#c.psa_key_id_t" title="psa_key_id_t">psa_key_id_t</a> key,
                             <a class="reference internal" href="algorithms.html#c.psa_algorithm_t" title="psa_algorithm_t">psa_algorithm_t</a> alg,
                             const uint8_t * hash,
                             size_t hash_length,
                             const uint8_t * signature,
                             size_t signature_length);</pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl>
<dt><p><code class="docutils literal notranslate"><span class="pre">key</span></code></p>
</dt><dd><p>Identifier of the key to use for the operation. It must be a public key or an asymmetric key pair. The key must permit the usage <a class="reference internal" href="../keys/policy.html#c.PSA_KEY_USAGE_VERIFY_HASH" title="PSA_KEY_USAGE_VERIFY_HASH"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_USAGE_VERIFY_HASH</span></code></a>.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">alg</span></code></p>
</dt><dd><p>An asymmetric signature algorithm that separates the hash and sign operations: a value of type <a class="reference internal" href="algorithms.html#c.psa_algorithm_t" title="psa_algorithm_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_algorithm_t</span></code></a> such that <a class="reference internal" href="#c.PSA_ALG_IS_SIGN_HASH" title="PSA_ALG_IS_SIGN_HASH"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_IS_SIGN_HASH</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> is true.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">hash</span></code></p>
</dt><dd><p>The input whose signature is to be verified. This is usually the hash of a message.</p>
<p>See the description of this function, or the description of individual signature algorithms, for details of the acceptable inputs.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">hash_length</span></code></p>
</dt><dd><p>Size of the <code class="docutils literal notranslate"><span class="pre">hash</span></code> buffer in bytes.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">signature</span></code></p>
</dt><dd><p>Buffer containing the signature to verify.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">signature_length</span></code></p>
</dt><dd><p>Size of the <code class="docutils literal notranslate"><span class="pre">signature</span></code> buffer in bytes.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns: <code class="docutils literal notranslate"><span class="pre">psa_status_t</span></code></p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_SUCCESS</span></code></p>
</dt><dd><p>Success.
The signature is valid.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_BAD_STATE</span></code></p>
</dt><dd><p>The library requires initializing by a call to <a class="reference internal" href="../library/library.html#c.psa_crypto_init" title="psa_crypto_init"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_crypto_init()</span></code></a>.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INVALID_HANDLE</span></code></p>
</dt><dd><p><code class="docutils literal notranslate"><span class="pre">key</span></code> is not a valid key identifier.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_NOT_PERMITTED</span></code></p>
</dt><dd><p>The key does not have the <a class="reference internal" href="../keys/policy.html#c.PSA_KEY_USAGE_VERIFY_HASH" title="PSA_KEY_USAGE_VERIFY_HASH"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_USAGE_VERIFY_HASH</span></code></a> flag, or it does not permit the requested algorithm.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INVALID_SIGNATURE</span></code></p>
</dt><dd><p><code class="docutils literal notranslate"><span class="pre">signature</span></code> is not the result of signing <code class="docutils literal notranslate"><span class="pre">hash</span></code> with algorithm <code class="docutils literal notranslate"><span class="pre">alg</span></code> using the private key corresponding to <code class="docutils literal notranslate"><span class="pre">key</span></code>.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INVALID_ARGUMENT</span></code></p>
</dt><dd><p>The following conditions can result in this error:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">alg</span></code> is not an asymmetric signature algorithm that permits verifying a pre-computed hash.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">key</span></code> is not a public key or an asymmetric key pair, that is compatible with <code class="docutils literal notranslate"><span class="pre">alg</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hash_length</span></code> is not valid for the algorithm and key type.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hash</span></code> is not a valid input value for the algorithm and key type.</p></li>
</ul>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_NOT_SUPPORTED</span></code></p>
</dt><dd><p>The following conditions can result in this error:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">alg</span></code> is not supported, or is not an asymmetric signature algorithm that permits verifying a pre-computed hash.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">key</span></code> is not supported for use with <code class="docutils literal notranslate"><span class="pre">alg</span></code>.</p></li>
</ul>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INSUFFICIENT_MEMORY</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_COMMUNICATION_FAILURE</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_CORRUPTION_DETECTED</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_STORAGE_FAILURE</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_DATA_CORRUPT</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_DATA_INVALID</span></code></p>
</dt><dd></dd>
</dl>
</div>
<p class="rubric">Description</p>
<p>For hash-and-sign signature algorithms, the <code class="docutils literal notranslate"><span class="pre">hash</span></code> input to this function is the hash of the message to verify.
The algorithm used to calculate this hash is encoded in the signature algorithm.
For such algorithms, <code class="docutils literal notranslate"><span class="pre">hash_length</span></code> must equal the length of the hash output: <code class="docutils literal notranslate"><span class="pre">hash_length</span></code><code class="docutils literal notranslate"> <span class="pre">==</span> </code><a class="reference internal" href="hash.html#c.PSA_HASH_LENGTH" title="PSA_HASH_LENGTH"><code class="docutils literal notranslate"><span class="pre">PSA_HASH_LENGTH</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><a class="reference internal" href="algorithms.html#c.PSA_ALG_GET_HASH" title="PSA_ALG_GET_HASH"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_GET_HASH</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">alg</span></code><code class="docutils literal notranslate"><span class="pre">))</span></code>.</p>
<p>Specialized signature algorithms can apply a padding or encoding to the hash.
In such cases, the encoded hash must be passed to this function. For example, see <a class="reference internal" href="#c.PSA_ALG_RSA_PKCS1V15_SIGN_RAW" title="PSA_ALG_RSA_PKCS1V15_SIGN_RAW"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_RSA_PKCS1V15_SIGN_RAW</span></code></a>.</p>
<p>If the algorithm has a context parameter, a zero-length context is used.
To provide a context value, use <a class="reference internal" href="#c.psa_verify_hash_with_context" title="psa_verify_hash_with_context"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_verify_hash_with_context()</span></code></a> instead.</p>
</section>
<section id="c.psa_verify_hash_with_context">
<h3><code class="docutils literal notranslate"><span class="pre">psa_verify_hash_with_context</span></code> (function)<a class="headerlink" href="#c.psa_verify_hash_with_context" title="Link to this heading">¶</a></h3>
<p>Verify the signature of a hash or short message using a public key and a supplied context.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.4.</span></p>
</div>
<pre class="literal-block">psa_status_t <a class="reference internal" href="#c.psa_verify_hash_with_context" title="psa_verify_hash_with_context">psa_verify_hash_with_context</a>(<a class="reference internal" href="../keys/ids.html#c.psa_key_id_t" title="psa_key_id_t">psa_key_id_t</a> key,
                                          <a class="reference internal" href="algorithms.html#c.psa_algorithm_t" title="psa_algorithm_t">psa_algorithm_t</a> alg,
                                          const uint8_t * hash,
                                          size_t hash_length,
                                          const uint8_t * context,
                                          size_t context_length,
                                          const uint8_t * signature,
                                          size_t signature_length);</pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl>
<dt><p><code class="docutils literal notranslate"><span class="pre">key</span></code></p>
</dt><dd><p>Identifier of the key to use for the operation. It must be a public key or an asymmetric key pair. The key must permit the usage <a class="reference internal" href="../keys/policy.html#c.PSA_KEY_USAGE_VERIFY_HASH" title="PSA_KEY_USAGE_VERIFY_HASH"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_USAGE_VERIFY_HASH</span></code></a>.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">alg</span></code></p>
</dt><dd><p>An asymmetric signature algorithm that separates the hash and sign operations: a value of type <a class="reference internal" href="algorithms.html#c.psa_algorithm_t" title="psa_algorithm_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_algorithm_t</span></code></a> such that <a class="reference internal" href="#c.PSA_ALG_IS_SIGN_HASH" title="PSA_ALG_IS_SIGN_HASH"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_IS_SIGN_HASH</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> is true.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">hash</span></code></p>
</dt><dd><p>The input whose signature is to be verified. This is usually the hash of a message.</p>
<p>See the description of this function, or the description of individual signature algorithms, for details of the acceptable inputs.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">hash_length</span></code></p>
</dt><dd><p>Size of the <code class="docutils literal notranslate"><span class="pre">hash</span></code> buffer in bytes.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">context</span></code></p>
</dt><dd><p>The context to use for this signature.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">context_length</span></code></p>
</dt><dd><p>Size of the <code class="docutils literal notranslate"><span class="pre">context</span></code> buffer in bytes.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">signature</span></code></p>
</dt><dd><p>Buffer containing the signature to verify.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">signature_length</span></code></p>
</dt><dd><p>Size of the <code class="docutils literal notranslate"><span class="pre">signature</span></code> buffer in bytes.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns: <code class="docutils literal notranslate"><span class="pre">psa_status_t</span></code></p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_SUCCESS</span></code></p>
</dt><dd><p>Success.
The signature is valid.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_BAD_STATE</span></code></p>
</dt><dd><p>The library requires initializing by a call to <a class="reference internal" href="../library/library.html#c.psa_crypto_init" title="psa_crypto_init"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_crypto_init()</span></code></a>.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INVALID_HANDLE</span></code></p>
</dt><dd><p><code class="docutils literal notranslate"><span class="pre">key</span></code> is not a valid key identifier.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_NOT_PERMITTED</span></code></p>
</dt><dd><p>The key does not have the <a class="reference internal" href="../keys/policy.html#c.PSA_KEY_USAGE_VERIFY_HASH" title="PSA_KEY_USAGE_VERIFY_HASH"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_USAGE_VERIFY_HASH</span></code></a> flag, or it does not permit the requested algorithm.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INVALID_SIGNATURE</span></code></p>
</dt><dd><p><code class="docutils literal notranslate"><span class="pre">signature</span></code> is not the result of signing <code class="docutils literal notranslate"><span class="pre">hash</span></code> with algorithm <code class="docutils literal notranslate"><span class="pre">alg</span></code> using the private key corresponding to <code class="docutils literal notranslate"><span class="pre">key</span></code>.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INVALID_ARGUMENT</span></code></p>
</dt><dd><p>The following conditions can result in this error:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">alg</span></code> is not an asymmetric signature algorithm that permits verifying a pre-computed hash with a context.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">key</span></code> is not a public key or an asymmetric key pair, that is compatible with <code class="docutils literal notranslate"><span class="pre">alg</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hash_length</span></code> is not valid for the algorithm and key type.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hash</span></code> is not a valid input value for the algorithm and key type.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">context_length</span></code> is not valid for the algorithm and key type.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">context</span></code> is not a valid input value for the algorithm and key type.</p></li>
</ul>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_NOT_SUPPORTED</span></code></p>
</dt><dd><p>The following conditions can result in this error:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">alg</span></code> is not supported, or is not an asymmetric signature algorithm that permits verifying a pre-computed hash.</p></li>
<li><p>The implementation does not support this value of <code class="docutils literal notranslate"><span class="pre">context_length</span></code> for <code class="docutils literal notranslate"><span class="pre">alg</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">key</span></code> is not supported for use with <code class="docutils literal notranslate"><span class="pre">alg</span></code>.</p></li>
</ul>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INSUFFICIENT_MEMORY</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_COMMUNICATION_FAILURE</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_CORRUPTION_DETECTED</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_STORAGE_FAILURE</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_DATA_CORRUPT</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_DATA_INVALID</span></code></p>
</dt><dd></dd>
</dl>
</div>
<p class="rubric">Description</p>
<p>For hash-and-sign signature algorithms, the <code class="docutils literal notranslate"><span class="pre">hash</span></code> input to this function is the hash of the message to verify.
The algorithm used to calculate this hash is encoded in the signature algorithm.
For such algorithms, <code class="docutils literal notranslate"><span class="pre">hash_length</span></code> must equal the length of the hash output: <code class="docutils literal notranslate"><span class="pre">hash_length</span></code><code class="docutils literal notranslate"> <span class="pre">==</span> </code><a class="reference internal" href="hash.html#c.PSA_HASH_LENGTH" title="PSA_HASH_LENGTH"><code class="docutils literal notranslate"><span class="pre">PSA_HASH_LENGTH</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><a class="reference internal" href="algorithms.html#c.PSA_ALG_GET_HASH" title="PSA_ALG_GET_HASH"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_GET_HASH</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">alg</span></code><code class="docutils literal notranslate"><span class="pre">))</span></code>.</p>
<p>Specialized signature algorithms can apply a padding or encoding to the hash.
In such cases, the encoded hash must be passed to this function. For example, see <a class="reference internal" href="#c.PSA_ALG_RSA_PKCS1V15_SIGN_RAW" title="PSA_ALG_RSA_PKCS1V15_SIGN_RAW"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_RSA_PKCS1V15_SIGN_RAW</span></code></a>.</p>
<p>If a context parameter is not required, <a class="reference internal" href="#c.psa_verify_hash" title="psa_verify_hash"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_verify_hash()</span></code></a> can be used instead.</p>
</section>
</section>
<section id="support-macros">
<h2><span class="section-number">10.9.5 </span>Support macros<a class="headerlink" href="#support-macros" title="Link to this heading">¶</a></h2>
<section id="c.PSA_ALG_IS_SIGN_MESSAGE">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_ALG_IS_SIGN_MESSAGE</span></code> (macro)<a class="headerlink" href="#c.PSA_ALG_IS_SIGN_MESSAGE" title="Link to this heading">¶</a></h3>
<p>Whether the specified algorithm is a signature algorithm that can be used with <a class="reference internal" href="#c.psa_sign_message" title="psa_sign_message"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_sign_message()</span></code></a> and <a class="reference internal" href="#c.psa_verify_message" title="psa_verify_message"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_verify_message()</span></code></a>.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ALG_IS_SIGN_MESSAGE" title="PSA_ALG_IS_SIGN_MESSAGE">PSA_ALG_IS_SIGN_MESSAGE</a>(alg) <em><a class="reference internal" href="../../overview/implementation.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">alg</span></code></p>
</dt><dd><p>An algorithm identifier: a value of type <a class="reference internal" href="algorithms.html#c.psa_algorithm_t" title="psa_algorithm_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_algorithm_t</span></code></a>.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns</p>
<p><code class="docutils literal notranslate"><span class="pre">1</span></code> if <code class="docutils literal notranslate"><span class="pre">alg</span></code> is a signature algorithm that can be used to sign a message. <code class="docutils literal notranslate"><span class="pre">0</span></code> if <code class="docutils literal notranslate"><span class="pre">alg</span></code> is a signature algorithm that can only be used to sign a pre-computed hash. <code class="docutils literal notranslate"><span class="pre">0</span></code> if <code class="docutils literal notranslate"><span class="pre">alg</span></code> is not a signature algorithm. This macro can return either <code class="docutils literal notranslate"><span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code> if <code class="docutils literal notranslate"><span class="pre">alg</span></code> is not a supported algorithm identifier.</p>
<p class="rubric">Description</p>
<p>This macro evaluates to <code class="docutils literal notranslate"><span class="pre">1</span></code> for hash-and-sign and message-signature algorithms.</p>
</section>
<section id="c.PSA_ALG_IS_SIGN_HASH">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_ALG_IS_SIGN_HASH</span></code> (macro)<a class="headerlink" href="#c.PSA_ALG_IS_SIGN_HASH" title="Link to this heading">¶</a></h3>
<p>Whether the specified algorithm is a signature algorithm that can be used with <a class="reference internal" href="#c.psa_sign_hash" title="psa_sign_hash"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_sign_hash()</span></code></a> and <a class="reference internal" href="#c.psa_verify_hash" title="psa_verify_hash"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_verify_hash()</span></code></a>.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ALG_IS_SIGN_HASH" title="PSA_ALG_IS_SIGN_HASH">PSA_ALG_IS_SIGN_HASH</a>(alg) <em><a class="reference internal" href="../../overview/implementation.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">alg</span></code></p>
</dt><dd><p>An algorithm identifier: a value of type <a class="reference internal" href="algorithms.html#c.psa_algorithm_t" title="psa_algorithm_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_algorithm_t</span></code></a>.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns</p>
<p><code class="docutils literal notranslate"><span class="pre">1</span></code> if <code class="docutils literal notranslate"><span class="pre">alg</span></code> is a signature algorithm that can be used to sign a hash. <code class="docutils literal notranslate"><span class="pre">0</span></code> if <code class="docutils literal notranslate"><span class="pre">alg</span></code> is a signature algorithm that can only be used to sign a message. <code class="docutils literal notranslate"><span class="pre">0</span></code> if <code class="docutils literal notranslate"><span class="pre">alg</span></code> is not a signature algorithm. This macro can return either <code class="docutils literal notranslate"><span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code> if <code class="docutils literal notranslate"><span class="pre">alg</span></code> is not a supported algorithm identifier.</p>
<p class="rubric">Description</p>
<p>This macro evaluates to <code class="docutils literal notranslate"><span class="pre">1</span></code> for hash-and-sign and specialized signature algorithms.</p>
</section>
<section id="c.PSA_ALG_IS_HASH_AND_SIGN">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_ALG_IS_HASH_AND_SIGN</span></code> (macro)<a class="headerlink" href="#c.PSA_ALG_IS_HASH_AND_SIGN" title="Link to this heading">¶</a></h3>
<p>Whether the specified algorithm is a hash-and-sign algorithm that signs exactly the hash value.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ALG_IS_HASH_AND_SIGN" title="PSA_ALG_IS_HASH_AND_SIGN">PSA_ALG_IS_HASH_AND_SIGN</a>(alg) <em><a class="reference internal" href="../../overview/implementation.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">alg</span></code></p>
</dt><dd><p>An algorithm identifier: a value of type <a class="reference internal" href="algorithms.html#c.psa_algorithm_t" title="psa_algorithm_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_algorithm_t</span></code></a>.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns</p>
<p><code class="docutils literal notranslate"><span class="pre">1</span></code> if <code class="docutils literal notranslate"><span class="pre">alg</span></code> is a hash-and-sign algorithm that signs exactly the hash value, <code class="docutils literal notranslate"><span class="pre">0</span></code> otherwise. This macro can return either <code class="docutils literal notranslate"><span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code> if <code class="docutils literal notranslate"><span class="pre">alg</span></code> is not a supported algorithm identifier.</p>
<p>A wildcard signature algorithm policy, using <a class="reference internal" href="#c.PSA_ALG_ANY_HASH" title="PSA_ALG_ANY_HASH"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ANY_HASH</span></code></a>, returns the same value as the signature algorithm parameterized with a valid hash algorithm.</p>
<p class="rubric">Description</p>
<p>This macro identifies algorithms that can be used with <a class="reference internal" href="#c.psa_sign_hash" title="psa_sign_hash"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_sign_hash()</span></code></a> that use the exact message hash value as an input the signature operation. For example, if <a class="reference internal" href="#c.PSA_ALG_IS_HASH_AND_SIGN" title="PSA_ALG_IS_HASH_AND_SIGN"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_IS_HASH_AND_SIGN</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> is true, the following call sequence is equivalent to <a class="reference internal" href="#c.psa_sign_message" title="psa_sign_message"><code class="docutils literal notranslate"><span class="pre">psa_sign_message</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">key</span></code><code class="docutils literal notranslate"><span class="pre">,</span> </code><code class="docutils literal notranslate"><span class="pre">alg</span></code><code class="docutils literal notranslate"><span class="pre">,</span> </code><code class="docutils literal notranslate"><span class="pre">msg</span></code><code class="docutils literal notranslate"><span class="pre">,</span> </code><code class="docutils literal notranslate"><span class="pre">msg_len</span></code><code class="docutils literal notranslate"><span class="pre">,</span> <span class="pre">...)</span></code>:</p>
<pre class="literal-block">uint8_t hash[<a class="reference internal" href="hash.html#c.PSA_HASH_MAX_SIZE" title="PSA_HASH_MAX_SIZE">PSA_HASH_MAX_SIZE</a>];
size_t hash_len;
<a class="reference internal" href="hash.html#c.psa_hash_compute" title="psa_hash_compute">psa_hash_compute</a>(<a class="reference internal" href="algorithms.html#c.PSA_ALG_GET_HASH" title="PSA_ALG_GET_HASH">PSA_ALG_GET_HASH</a>(alg), msg, msg_len,
                 hash, sizeof(hash), &amp;hash_len);
<a class="reference internal" href="#c.psa_sign_hash" title="psa_sign_hash">psa_sign_hash</a>(key, alg, hash, hash_len, ...);</pre>
</section>
<section id="c.PSA_ALG_SIGN_SUPPORTS_CONTEXT">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_ALG_SIGN_SUPPORTS_CONTEXT</span></code> (macro)<a class="headerlink" href="#c.PSA_ALG_SIGN_SUPPORTS_CONTEXT" title="Link to this heading">¶</a></h3>
<p>Whether the specified signature algorithm can be used with a non-zero-length context.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.4.</span></p>
</div>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ALG_SIGN_SUPPORTS_CONTEXT" title="PSA_ALG_SIGN_SUPPORTS_CONTEXT">PSA_ALG_SIGN_SUPPORTS_CONTEXT</a>(alg) <em><a class="reference internal" href="../../overview/implementation.html#implementation-defined-value"><span class="std std-ref">/* implementation-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">alg</span></code></p>
</dt><dd><p>A signature algorithm identifier: a value of type <a class="reference internal" href="algorithms.html#c.psa_algorithm_t" title="psa_algorithm_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_algorithm_t</span></code></a> such that <a class="reference internal" href="algorithms.html#c.PSA_ALG_IS_SIGN" title="PSA_ALG_IS_SIGN"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_IS_SIGN</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> is true.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns</p>
<p><code class="docutils literal notranslate"><span class="pre">1</span></code> if <code class="docutils literal notranslate"><span class="pre">alg</span></code> is a signature algorithm that can be used with a non-zero-length context.
<code class="docutils literal notranslate"><span class="pre">0</span></code> if <code class="docutils literal notranslate"><span class="pre">alg</span></code> is a signature algorithm that cannot be used with a non-zero-length context.
This macro can return either <code class="docutils literal notranslate"><span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code> if <code class="docutils literal notranslate"><span class="pre">alg</span></code> is not a supported signature algorithm identifier.</p>
<p>A wildcard signature algorithm policy, using <a class="reference internal" href="#c.PSA_ALG_ANY_HASH" title="PSA_ALG_ANY_HASH"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ANY_HASH</span></code></a>, returns the same value as the signature algorithm parameterized with a valid hash algorithm.</p>
<p class="rubric">Description</p>
<p>This macro identifies signature algorithms that have a context parameter, and can be used with the appropriate functions that support non-zero-length contexts.</p>
</section>
<section id="c.PSA_ALG_ANY_HASH">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_ALG_ANY_HASH</span></code> (macro)<a class="headerlink" href="#c.PSA_ALG_ANY_HASH" title="Link to this heading">¶</a></h3>
<p>When setting a hash-and-sign algorithm in a key policy, permit any hash algorithm.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ALG_ANY_HASH" title="PSA_ALG_ANY_HASH">PSA_ALG_ANY_HASH</a> ((<a class="reference internal" href="algorithms.html#c.psa_algorithm_t" title="psa_algorithm_t">psa_algorithm_t</a>)0x020000ff)</pre>
<p>This value can be used to form the permitted-algorithm attribute of a key policy for a signature algorithm that is parametrized by a hash. A key with this policy can then be used to perform operations using the same signature algorithm parametrized with any supported hash.
A signature algorithm created using this macro is a wildcard algorithm, and <a class="reference internal" href="algorithms.html#c.PSA_ALG_IS_WILDCARD" title="PSA_ALG_IS_WILDCARD"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_IS_WILDCARD()</span></code></a> will return true.</p>
<p>This value must not be used to build other algorithms that are parametrized over a hash. For any valid use of this macro to build an algorithm <code class="docutils literal notranslate"><span class="pre">alg</span></code>, <a class="reference internal" href="#c.PSA_ALG_IS_HASH_AND_SIGN" title="PSA_ALG_IS_HASH_AND_SIGN"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_IS_HASH_AND_SIGN</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> is true.</p>
<p>This value cannot be used to build an algorithm specification to perform an operation. If used in this way, the operation will fail with an error.</p>
<p class="rubric">Usage</p>
<p>For example, suppose that <code class="docutils literal notranslate"><span class="pre">PSA_xxx_SIGNATURE</span></code> is one of the following macros:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#c.PSA_ALG_RSA_PKCS1V15_SIGN" title="PSA_ALG_RSA_PKCS1V15_SIGN"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_RSA_PKCS1V15_SIGN</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.PSA_ALG_RSA_PSS" title="PSA_ALG_RSA_PSS"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_RSA_PSS</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.PSA_ALG_RSA_PSS_ANY_SALT" title="PSA_ALG_RSA_PSS_ANY_SALT"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_RSA_PSS_ANY_SALT</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.PSA_ALG_ECDSA" title="PSA_ALG_ECDSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ECDSA</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.PSA_ALG_DETERMINISTIC_ECDSA" title="PSA_ALG_DETERMINISTIC_ECDSA"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_DETERMINISTIC_ECDSA</span></code></a></p></li>
</ul>
<p>The following sequence of operations shows how <a class="reference internal" href="#c.PSA_ALG_ANY_HASH" title="PSA_ALG_ANY_HASH"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ANY_HASH</span></code></a> can be used in a key policy:</p>
<ol class="arabic">
<li><p>Set the key usage flags using <a class="reference internal" href="#c.PSA_ALG_ANY_HASH" title="PSA_ALG_ANY_HASH"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_ANY_HASH</span></code></a>, for example:</p>
<pre class="literal-block"><a class="reference internal" href="../keys/policy.html#c.psa_set_key_usage_flags" title="psa_set_key_usage_flags">psa_set_key_usage_flags</a>(&amp;attributes, <a class="reference internal" href="../keys/policy.html#c.PSA_KEY_USAGE_SIGN_MESSAGE" title="PSA_KEY_USAGE_SIGN_MESSAGE">PSA_KEY_USAGE_SIGN_MESSAGE</a>); <em>// or VERIFY_MESSAGE</em>
<a class="reference internal" href="../keys/policy.html#c.psa_set_key_algorithm" title="psa_set_key_algorithm">psa_set_key_algorithm</a>(&amp;attributes, PSA_xxx_SIGNATURE(<a class="reference internal" href="#c.PSA_ALG_ANY_HASH" title="PSA_ALG_ANY_HASH">PSA_ALG_ANY_HASH</a>));</pre>
</li>
<li><p>Import or generate key material.</p></li>
<li><p>Call <a class="reference internal" href="#c.psa_sign_message" title="psa_sign_message"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_sign_message()</span></code></a> or <a class="reference internal" href="#c.psa_verify_message" title="psa_verify_message"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_verify_message()</span></code></a>, passing an algorithm built from <code class="docutils literal notranslate"><span class="pre">PSA_xxx_SIGNATURE</span></code> and a specific hash. Each call to sign or verify a message can use a different hash algorithm.</p>
<pre class="literal-block"><a class="reference internal" href="#c.psa_sign_message" title="psa_sign_message">psa_sign_message</a>(key, PSA_xxx_SIGNATURE(<a class="reference internal" href="hash.html#c.PSA_ALG_SHA_256" title="PSA_ALG_SHA_256">PSA_ALG_SHA_256</a>), ...);
<a class="reference internal" href="#c.psa_sign_message" title="psa_sign_message">psa_sign_message</a>(key, PSA_xxx_SIGNATURE(<a class="reference internal" href="hash.html#c.PSA_ALG_SHA_512" title="PSA_ALG_SHA_512">PSA_ALG_SHA_512</a>), ...);
<a class="reference internal" href="#c.psa_sign_message" title="psa_sign_message">psa_sign_message</a>(key, PSA_xxx_SIGNATURE(<a class="reference internal" href="hash.html#c.PSA_ALG_SHA3_256" title="PSA_ALG_SHA3_256">PSA_ALG_SHA3_256</a>), ...);</pre>
</li>
</ol>
</section>
<section id="c.PSA_SIGN_OUTPUT_SIZE">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_SIGN_OUTPUT_SIZE</span></code> (macro)<a class="headerlink" href="#c.PSA_SIGN_OUTPUT_SIZE" title="Link to this heading">¶</a></h3>
<p>Sufficient signature buffer size for <a class="reference internal" href="#c.psa_sign_message" title="psa_sign_message"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_sign_message()</span></code></a> and <a class="reference internal" href="#c.psa_sign_hash" title="psa_sign_hash"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_sign_hash()</span></code></a>.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_SIGN_OUTPUT_SIZE" title="PSA_SIGN_OUTPUT_SIZE">PSA_SIGN_OUTPUT_SIZE</a>(key_type, key_bits, alg) \
    <em><a class="reference internal" href="../../overview/implementation.html#implementation-defined-value"><span class="std std-ref">/* implementation-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">key_type</span></code></p>
</dt><dd><p>An asymmetric key type. This can be a key-pair type or a public-key type.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">key_bits</span></code></p>
</dt><dd><p>The size of the key in bits.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">alg</span></code></p>
</dt><dd><p>The signature algorithm.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns</p>
<p>A sufficient signature buffer size for the specified asymmetric signature algorithm and key parameters. An implementation can return either <code class="docutils literal notranslate"><span class="pre">0</span></code> or a correct size for an asymmetric signature algorithm and key parameters that it recognizes, but does not support. If the parameters are not valid, the return value is unspecified.</p>
<p class="rubric">Description</p>
<p>If the size of the signature buffer is at least this large, it is guaranteed that <a class="reference internal" href="#c.psa_sign_message" title="psa_sign_message"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_sign_message()</span></code></a> and <a class="reference internal" href="#c.psa_sign_hash" title="psa_sign_hash"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_sign_hash()</span></code></a> will not fail due to an insufficient buffer size. The actual size of the output might be smaller in any given call.</p>
<p>See also <a class="reference internal" href="#c.PSA_SIGNATURE_MAX_SIZE" title="PSA_SIGNATURE_MAX_SIZE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_SIGNATURE_MAX_SIZE</span></code></a>.</p>
</section>
<section id="c.PSA_SIGNATURE_MAX_SIZE">
<h3><code class="docutils literal notranslate"><span class="pre">PSA_SIGNATURE_MAX_SIZE</span></code> (macro)<a class="headerlink" href="#c.PSA_SIGNATURE_MAX_SIZE" title="Link to this heading">¶</a></h3>
<p>A sufficient signature buffer size for <a class="reference internal" href="#c.psa_sign_message" title="psa_sign_message"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_sign_message()</span></code></a> and <a class="reference internal" href="#c.psa_sign_hash" title="psa_sign_hash"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_sign_hash()</span></code></a>, for any of the supported key types and asymmetric signature algorithms.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_SIGNATURE_MAX_SIZE" title="PSA_SIGNATURE_MAX_SIZE">PSA_SIGNATURE_MAX_SIZE</a> <em><a class="reference internal" href="../../overview/implementation.html#implementation-defined-value"><span class="std std-ref">/* implementation-defined value */</span></a></em></pre>
<p>If the size of the signature buffer is at least this large, it is guaranteed that <a class="reference internal" href="#c.psa_sign_message" title="psa_sign_message"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_sign_message()</span></code></a> and <a class="reference internal" href="#c.psa_sign_hash" title="psa_sign_hash"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_sign_hash()</span></code></a> will not fail due to an insufficient buffer size.</p>
<p>See also <a class="reference internal" href="#c.PSA_SIGN_OUTPUT_SIZE" title="PSA_SIGN_OUTPUT_SIZE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_SIGN_OUTPUT_SIZE()</span></code></a>.</p>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &#169; 2018-2025 Arm Limited and/or its affiliates.
      
    </div>

    

    
  </body>
</html>