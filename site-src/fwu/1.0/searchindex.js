Search.setIndex({"docnames": ["about", "api/api", "appendix/change-history", "appendix/example-header", "appendix/examples", "appendix/sra", "appendix/variations", "index", "overview/architecture", "overview/goals", "overview/intro", "overview/programming-model"], "filenames": ["about.rst", "api\\api.rst", "appendix\\change-history.rst", "appendix\\example-header.rst", "appendix\\examples.rst", "appendix\\sra.rst", "appendix\\variations.rst", "index.rst", "overview\\architecture.rst", "overview\\goals.rst", "overview\\intro.rst", "overview\\programming-model.rst"], "titles": ["About this document", "<span class=\"section-number\">5. </span>API reference", "<span class=\"section-number\">5. </span>Document change history", "<span class=\"section-number\">1. </span>Example header file", "<span class=\"section-number\">2. </span>Example usage", "<span class=\"section-number\">4. </span>Security Risk Assessment", "<span class=\"section-number\">3. </span>Variation in system design parameters", "PSA Certified <br /> Firmware Update API 1.0", "<span class=\"section-number\">3. </span>Architecture", "<span class=\"section-number\">2. </span>Design goals", "<span class=\"section-number\">1. </span>Introduction", "<span class=\"section-number\">4. </span>Programming model"], "terms": {"implement": [0, 2, 3, 4, 7, 8, 10], "defin": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], "ihi": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], "0093": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], "psa": [0, 1, 2, 4, 5, 6, 8, 9, 10, 11], "certifi": [0, 1, 2, 3, 4, 5, 6, 8, 9, 10, 11], "firmwar": [0, 2, 3, 4, 6], "updat": [0, 2, 6], "api": [0, 2, 3, 4, 6, 8, 9, 11], "br": [0, 1, 2, 3, 4, 5, 6, 8, 9, 10, 11], "certifiedpar": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], "1": [0, 1, 3, 4, 5, 6, 8, 9, 10, 11], "0": [0, 1, 3, 4, 5, 6, 8, 9, 10, 11], "0x0100": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], "final": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], "non": [0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11], "confidenti": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], "arm": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], "limit": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], "8": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], "2023": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], "2020": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], "its": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], "affili": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], "address": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], "The": [0, 1, 2, 3, 5, 6, 7, 8, 9, 10], "tabl": [0, 5, 6, 11], "list": [0, 5, 6], "have": [0, 1, 2, 4, 5, 6, 8, 9, 10, 11], "been": [0, 1, 2, 4, 5, 6, 11], "made": [0, 1, 11], "date": [0, 7], "version": [0, 3, 7, 8, 9, 11], "feb": 0, "2021": 0, "7": [0, 1, 3, 4, 5, 6, 7, 11], "beta": [0, 7], "first": [0, 1, 5], "qualiti": [0, 7], "octob": 0, "2022": 0, "major": [0, 1, 3], "program": [0, 1, 6, 7, 10], "model": [0, 1, 2, 7, 8, 10], "relicens": [0, 2], "open": [0, 9, 10], "sourc": [0, 1, 5, 10], "under": [0, 2], "cc": 0, "BY": 0, "sa": 0, "4": [0, 1, 2, 3, 4, 5, 8, 11], "august": 0, "includ": [0, 1, 3, 4, 5, 8, 9, 10, 11], "secur": [0, 1, 2, 7, 8, 9, 11], "risk": [0, 1, 2, 7, 9, 11], "assess": [0, 2, 7], "For": [0, 1, 5, 8, 9, 11], "detail": [0, 2, 7, 8, 10, 11], "see": [0, 1, 2, 4, 5, 6, 8, 10, 11], "copyright": 0, "statement": 0, "reflect": [0, 2, 9], "fact": 0, "some": [0, 1, 2, 5, 6, 8, 9, 10, 11], "draft": 0, "issu": [0, 5, 7], "circul": 0, "text": [0, 2], "illustr": [0, 4, 5, 6], "work": [0, 5], "ar": [0, 1, 2, 3, 4, 6, 8, 9, 10, 11], "attribut": [0, 1, 2, 8], "sharealik": [0, 2], "intern": [0, 2, 5, 11], "To": [0, 1, 5, 11], "view": 0, "copi": [0, 5], "visit": 0, "creativecommon": 0, "org": [0, 10], "grant": 0, "patent": [0, 2], "subject": [0, 7], "condit": [0, 1, 11], "both": [0, 1, 5, 8, 11], "public": [0, 5, 8, 9], "each": [0, 1, 3, 5, 6, 8, 10, 11], "licensor": 0, "herebi": 0, "you": [0, 10], "perpetu": 0, "worldwid": 0, "exclus": 0, "charg": 0, "royalti": 0, "free": [0, 1, 4], "irrevoc": 0, "except": [0, 6, 11], "state": [0, 2, 3, 4, 5, 7, 8], "section": [0, 1, 2, 5, 8, 9, 11], "make": [0, 1, 5, 9, 11], "us": [0, 1, 2, 3, 4, 6, 7, 8, 9, 10], "offer": [0, 11], "sell": 0, "import": [0, 1, 2, 5, 8, 10, 11], "otherwis": [0, 1, 5, 11], "transfer": [0, 1, 8, 9, 11], "materi": 0, "where": [0, 1, 5, 6, 8, 9, 11], "appli": [0, 1, 5, 8, 10, 11], "onli": [0, 1, 4, 5, 6, 9, 11], "those": [0, 5, 8, 9], "claim": [0, 1], "necessarili": 0, "infring": 0, "contribut": 0, "": [0, 1, 5, 6, 8, 9, 11], "alon": 0, "combin": [0, 1, 5, 9, 10], "which": [0, 1, 2, 3, 5, 6, 8, 9, 10, 11], "wa": [0, 1, 11], "submit": 0, "If": [0, 1, 5, 6, 8, 11], "institut": 0, "litig": 0, "against": [0, 1, 5, 8], "ani": [0, 1, 2, 4, 5, 6, 8, 11], "entiti": [0, 5, 9], "cross": 0, "counterclaim": 0, "lawsuit": 0, "alleg": 0, "incorpor": [0, 5, 10], "within": [0, 1, 5, 8, 9, 11], "constitut": 0, "direct": [0, 11], "contributori": 0, "shall": 0, "termin": 0, "i": [0, 1, 2, 3, 4, 5, 6, 8, 9, 10, 11], "file": [0, 7, 8, 10], "trademark": 0, "featur": [0, 7, 9, 11], "here": [0, 10], "regist": [0, 5], "subsidiari": 0, "u": [0, 1, 3], "elsewher": 0, "all": [0, 1, 2, 3, 5, 6, 7, 8, 9, 10, 11], "right": 0, "reserv": [0, 1], "pleas": 0, "com": [0, 10], "compani": 0, "polici": [0, 1, 2, 8, 9, 11], "more": [0, 1, 2, 5, 8, 9, 10, 11], "languag": [0, 5], "addit": [0, 1, 2, 5, 6, 8, 9, 10, 11], "larg": [0, 1, 9, 10], "ident": [0, 8], "3": [0, 1, 3, 4, 5, 8], "apach": [0, 2], "2": [0, 1, 2, 3, 4, 5, 9, 10], "two": [0, 5, 9, 11], "relat": [0, 5, 8, 10, 11], "align": [0, 1, 2], "terminologi": [0, 7, 10], "rather": [0, 1, 5], "than": [0, 1, 4, 5, 8, 11], "exampl": [0, 1, 2, 5, 6, 7, 8, 9, 10, 11], "scope": [0, 7, 8, 9], "defens": 0, "claus": 0, "from": [0, 1, 2, 6, 7, 8, 9, 10, 11], "intend": [0, 5, 8], "help": [0, 5, 10, 11], "maintain": [0, 1, 5, 6], "healthi": 0, "ecosystem": [0, 10], "provid": [0, 1, 3, 5, 6, 8, 9, 10, 11], "protect": [0, 7, 8, 9], "commun": [0, 5, 9, 10], "full": [0, 3, 5, 6, 11], "code": [0, 2, 4, 5, 7, 8, 9, 10, 11], "sampl": [0, 6, 7, 10], "mai": [0, 5, 8, 9], "complianc": [0, 1], "obtain": [0, 4, 5, 8, 10, 11], "unless": [0, 1, 6, 11], "requir": [0, 2, 3, 4, 5, 7, 8, 9, 10, 11], "applic": [0, 1, 7, 8, 10, 11], "law": 0, "agre": 0, "write": [0, 1, 2, 4, 6, 7, 8, 11], "softwar": [0, 5, 8, 9, 10], "distribut": [0, 5], "an": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "AS": 0, "basi": 0, "without": [0, 3, 5, 8, 9, 11], "warranti": 0, "OR": 0, "OF": 0, "kind": [0, 9], "either": [0, 1, 5, 6, 11], "express": [0, 1], "impli": 0, "specif": [0, 2, 3, 5, 7, 8, 9, 10, 11], "govern": 0, "permiss": [0, 5], "follow": [0, 1, 2, 5, 6, 8, 9, 10, 11], "ref": 0, "titl": 0, "c99": [0, 1], "iso": [0, 1], "iec": 0, "9899": 0, "1999": 0, "c": [0, 1, 3, 5], "decemb": 0, "www": [0, 10], "standard": [0, 1, 2, 7, 9, 10, 11], "29237": 0, "html": 0, "ebbr": [0, 9], "contributor": 0, "embed": [0, 9], "base": [0, 1, 5, 9, 10, 11], "boot": [0, 5, 8, 9, 11], "github": [0, 10], "io": [0, 10], "en303645": [0, 9], "en": 0, "303": 0, "645": 0, "etsi": 0, "cyber": [0, 9], "consum": [0, 1, 5, 9], "internet": [0, 5, 9, 10], "thing": [0, 4, 5, 9, 10], "baselin": [0, 9], "june": 0, "get": [0, 2, 4], "search": 0, "20645": 0, "ir8259": [0, 9], "ir": 0, "8259": 0, "nist": [0, 5], "foundat": [0, 5, 9], "cybersecur": [0, 9], "activ": [0, 1, 5, 7, 8, 9], "iot": [0, 1, 5, 9, 10], "devic": [0, 1, 5, 7, 8, 10, 11], "manufactur": [0, 5, 9, 10], "doi": 0, "10": [0, 4, 5, 6], "6028": 0, "lwm2m": [0, 9], "v1": [0, 2, 3], "oma": 0, "lightweight": [0, 9], "m2m": [0, 9], "novemb": 0, "openmobilealli": 0, "lightweightm2m": 0, "cert": [0, 9], "jsa": 0, "den": 0, "002": 0, "level": [0, 1, 7, 9], "profil": [0, 2, 9], "psacertifi": [0, 10], "develop": [0, 1, 5, 8, 9, 10], "resourc": [0, 5, 9, 10, 11], "certif": [0, 8, 9], "leveltwo": 0, "ffm": [0, 1], "0063": 0, "platform": [0, 1, 7, 8], "architectur": [0, 1, 2, 7, 9, 11], "framework": [0, 1, 10], "den0063": 0, "stat": [0, 1], "0097": 0, "statu": [0, 2, 5, 7, 11], "psm": [0, 9], "0128": 0, "den0128": 0, "rfc4122": 0, "ietf": 0, "A": [0, 1, 4, 5, 6, 8, 9, 10, 11], "univers": 0, "uniqu": 0, "identifi": [0, 4, 5, 7, 11], "uuid": [0, 2], "urn": 0, "namespac": 0, "tool": 0, "rfc8240": [0, 5, 10], "iab": 0, "report": [0, 1, 4, 5, 8, 10, 11], "iotsu": [0, 5, 10], "workshop": [0, 5, 10], "2016": [0, 5, 10], "septemb": 0, "2017": 0, "rfc9019": [0, 5, 9], "april": 0, "rfc9124": [0, 5, 9], "manifest": [0, 1, 2, 3, 4, 7, 9], "januari": 0, "sp800": [0, 5], "30": [0, 4, 5], "special": [0, 5, 11], "800": [0, 5], "guid": [0, 5], "conduct": [0, 5], "2012": 0, "sp": 0, "30r1": 0, "suit": [0, 2, 5, 9], "enc": [0, 5], "encrypt": [0, 1, 5, 8, 9], "payload": [0, 5, 9], "datatrack": 0, "doc": 0, "mfst": [0, 9], "concis": [0, 9], "binari": [0, 1, 8, 9], "object": [0, 1, 9, 11], "represent": [0, 9], "cbor": [0, 9], "serial": [0, 8, 9], "format": [0, 2, 7, 11], "februari": 0, "uefi": [0, 9], "v2": 0, "forum": 0, "inc": 0, "unifi": [0, 9], "extens": [0, 9], "interfac": [0, 1, 5, 7, 8, 9, 10, 11], "mean": 0, "main": [0, 5, 8, 9], "typic": [0, 1, 5, 8, 10, 11], "compris": 0, "oper": [0, 1, 2, 6, 7, 8, 9, 10], "system": [0, 1, 2, 4, 5, 7, 8, 9, 10, 11], "o": [0, 1, 5, 9, 11], "task": [0, 5], "On": [0, 1, 11], "isol": [0, 9, 11], "run": [0, 1, 4, 5, 8, 9, 11], "nspe": [0, 8, 9], "root": [0, 5, 7, 8], "trust": [0, 7, 11], "domain": [0, 1, 5], "servic": [0, 1, 5, 6, 7, 9, 10, 11], "immut": 0, "part": [0, 1, 5, 7, 8, 11], "inher": 0, "hardwar": [0, 5, 7, 8, 10], "cannot": [0, 1, 5, 8, 9, 11], "product": [0, 5, 6, 9, 10], "behavior": [0, 1, 5, 6, 7, 8], "individu": [0, 1, 5, 7], "can": [0, 1, 3, 4, 5, 6, 8, 9, 10, 11], "choos": [0, 5], "depend": [0, 1, 5, 6, 7, 8, 9], "must": [0, 1, 3, 5, 8, 9, 11], "awar": [0, 1], "might": [0, 1, 3, 5, 8, 9, 11], "portabl": [0, 1, 10], "anoth": [0, 1, 8, 9, 11], "imag": [0, 2, 6, 7, 9], "metadata": [0, 2, 5, 8], "sign": [0, 1, 5, 8, 9], "cryptograph": [0, 5, 9], "kei": [0, 5, 8], "bundl": [0, 1, 4, 8, 11], "detach": [0, 1, 5, 8, 11], "mpu": [0, 9], "memori": [0, 1, 4, 5, 8, 9, 10, 11], "unit": [0, 5], "process": [0, 1, 8, 9, 11], "environ": [0, 9], "outsid": [0, 1, 5, 9], "It": [0, 1, 5, 8, 11], "contain": [0, 1, 5, 8, 10, 11], "oem": [0, 5, 10], "origin": [0, 5], "equip": [0, 5], "ota": [0, 9], "over": [0, 5, 9, 10, 11], "air": [0, 5, 9, 10], "procedur": 0, "download": [0, 5, 8, 9, 10, 11], "remot": [0, 5, 8, 9, 11], "locat": [0, 1, 3, 5, 8, 11], "pki": [0, 9], "infrastructur": [0, 5], "prot": [0, 8, 9], "overal": [0, 2, 11], "anchor": [0, 5, 7, 11], "ensur": [0, 1, 5, 8, 11], "configur": [0, 1, 5, 8, 10], "establish": [0, 9], "rot": 0, "minim": 0, "set": [0, 1, 4, 5, 10, 11], "data": [0, 2, 4, 5, 7, 8, 9, 11], "implicitli": 0, "deeper": 0, "verifi": [0, 5, 7, 8, 9], "authent": [0, 1, 7, 8, 9], "unmodifi": [0, 5], "technologi": [0, 9, 10], "chain": [0, 5, 6, 8], "compon": [0, 2, 3, 5, 7], "dure": [0, 1, 4, 5, 7, 8, 9], "spe": [0, 8, 9], "stage": [0, 1, 2, 5, 7, 11], "area": [0, 1, 5, 8, 9, 11], "region": [0, 1, 8], "store": [0, 1, 5, 6, 7, 9, 10], "being": [0, 1, 2, 5, 6, 8, 9, 11], "onc": [0, 1, 8, 11], "complet": [0, 1, 4, 5, 6, 8, 11], "instal": [0, 2, 6, 7, 8, 9, 10], "client": [0, 1, 5, 6, 7, 9, 10], "respons": [0, 1, 5, 8, 10, 11], "volatil": [0, 1, 2, 5, 7, 9], "doe": [0, 1, 5, 6, 8, 9, 11], "preserv": [0, 11], "after": [0, 1, 4, 5, 11], "reboot": [0, 1, 2, 4, 5, 7, 11], "prepar": [0, 2, 4, 5, 6, 7, 8], "candid": [0, 2, 5, 6, 7], "whether": [0, 1, 6, 8, 11], "partial": [0, 1, 5, 11], "retain": [0, 1, 5, 11], "reset": [0, 1, 5], "psa_fwu_flag_volatile_stag": [0, 2, 3], "content": [0, 1, 5, 7, 8, 11], "stabl": 0, "small": [0, 5, 8, 9], "option": [0, 1, 2, 5, 6, 9, 11], "clarif": [0, 2], "signific": [0, 1, 5], "affect": [0, 1, 5, 6, 8, 9, 11], "compat": [0, 1, 5], "new": [0, 1, 2, 5, 6, 7, 8, 9, 10], "minor": [0, 1, 3, 5], "ital": 0, "introduc": 0, "denot": 0, "citat": 0, "monospac": 0, "assembl": 0, "syntax": 0, "descript": [0, 1, 6, 10, 11], "pseudocod": 0, "also": [0, 1, 5, 6, 8, 9, 10, 11], "instruct": [0, 8], "mnemon": 0, "other": [0, 1, 2, 4, 5, 6, 8, 9, 10, 11], "item": 0, "appear": 0, "capit": 0, "common": [0, 5, 7, 9, 11], "few": 0, "technic": 0, "red": 0, "indic": [0, 1, 6, 11], "blue": 0, "link": 0, "url": 0, "normal": [0, 1, 5, 11], "written": [0, 1, 2, 4, 5, 10, 11], "decim": 0, "preced": [0, 11], "0b": 0, "hexadecim": 0, "0x": 0, "In": [0, 1, 5, 6, 8, 9, 10, 11], "case": [0, 1, 4, 5, 6, 8, 9, 10], "prefix": [0, 1], "associ": [0, 1, 6, 8, 11], "valu": [0, 1, 3, 5, 8, 11], "font": 0, "0xffff0000": 0, "improv": [0, 1, 2], "readabl": [0, 1], "long": [0, 1], "underscor": 0, "separ": [0, 1, 5, 8, 9, 10], "between": [0, 1, 7, 8, 11], "everi": [0, 11], "four": 0, "charact": 0, "0xffff_0000_0000_0000": 0, "ignor": 0, "when": [0, 1, 2, 5, 8, 11], "interpret": 0, "we": [0, 2, 5], "welcom": 0, "comment": [0, 1], "book": 0, "creat": [0, 5], "project": [0, 2], "give": [0, 5], "your": 0, "explan": [0, 11], "gener": [0, 1, 2, 5], "suggest": 0, "feedback": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], "enabl": [1, 5, 8, 9, 10, 11], "optim": [1, 9], "constrain": [1, 7, 8, 11], "differ": [1, 5, 7, 8, 11], "target": [1, 5, 6, 9], "thi": [1, 2, 3, 4, 6, 7, 8, 9, 10, 11], "need": [1, 4, 5, 8, 9, 10, 11], "recompil": 1, "term": [1, 7, 8], "begin": [1, 5, 11], "psa_": 1, "futur": [1, 2, 9], "same": [1, 5, 11], "element": [1, 3, 4, 5, 9, 10, 11], "recommend": [1, 5, 9, 11], "do": [1, 2, 4, 5, 8, 11], "own": [1, 9], "avoid": [1, 9], "potenti": [1, 7], "conflict": 1, "fix": [1, 2, 5, 10, 11], "width": 1, "integ": [1, 2], "int32_t": 1, "32": [1, 2, 4], "bit": [1, 2], "uint8_t": [1, 2, 3], "unsign": 1, "uint16_t": [1, 3], "16": [1, 4, 5], "uint32_t": [1, 3], "size_t": [1, 3, 4], "enough": [1, 9], "hold": [1, 11], "size": 1, "integr": [1, 5, 8, 9, 11], "clariti": 1, "definit": [1, 2, 3, 7, 9, 10], "psa_status_t": [1, 2, 3, 4], "structur": [1, 2], "declar": [1, 5], "instead": [1, 5], "tag": 1, "fulli": [1, 3, 5, 8], "exactli": [1, 8, 11], "upper": 1, "evalu": [1, 5, 9], "compil": [1, 3, 4], "time": [1, 5, 9, 11], "lower": [1, 5], "permit": [1, 2, 5, 6, 8, 9, 11], "static": [1, 4], "inlin": 1, "linkag": 1, "default": [1, 2], "extern": [1, 3, 5, 9], "like": [1, 5, 8], "take": [1, 5, 8, 9, 11], "expand": [1, 5], "argument": 1, "call": [1, 2, 5, 8, 11], "safe": 1, "arbitrari": 1, "ha": [1, 2, 5, 6, 10, 11], "invalid": [1, 7, 8], "specifi": [1, 2, 5, 9, 11], "space": 1, "null": [1, 4], "result": [1, 5, 6, 9, 11], "psa_success": [1, 4, 11], "posit": 1, "multipl": [1, 2, 5, 7, 8, 9, 11], "undefin": 1, "receiv": [1, 5, 9], "paramet": [1, 2, 5, 7, 11], "encourag": 1, "halt": 1, "manner": [1, 5], "appropri": [1, 4, 5, 11], "detect": [1, 5, 11], "howev": [1, 5, 11], "explicitli": [1, 6, 11], "document": [1, 5, 7, 8, 10, 11], "valid": [1, 5, 8, 11], "consid": [1, 5, 9], "buffer": [1, 5], "point": [1, 3, 11], "arrai": 1, "byte": 1, "alwai": [1, 5, 6, 8, 11], "const": [1, 3, 4], "void": [1, 2, 3, 4], "never": [1, 6, 11], "length": [1, 5], "describ": [1, 2, 5, 6, 8, 9, 10, 11], "input": [1, 7], "read": [1, 5, 10], "output": [1, 5], "writabl": 1, "access": [1, 5, 8], "referenc": 1, "durat": 1, "reduc": [1, 5, 8, 9, 10, 11], "caller": [1, 5, 11], "properli": 1, "handl": [1, 4, 5], "number": [1, 5, 7, 8, 9, 11], "repres": [1, 5, 8], "whose": 1, "These": [1, 4, 5, 8, 9, 11], "place": [1, 5, 11], "underli": 1, "convert": 1, "so": [1, 4, 5, 8, 11], "instanti": 1, "reli": [1, 5, 8], "h": [1, 4, 7], "visibl": [1, 11], "incomplet": [1, 7, 11], "were": [1, 11], "previous": [1, 5, 11], "present": [1, 5, 8, 11], "spec": 1, "mandatori": [1, 2], "simpli": [1, 8], "psa_error_not_support": [1, 11], "restart": [1, 5, 8, 9, 11], "share": [1, 8], "psa_error_not_permit": [1, 2], "133": 1, "134": 1, "psa_error_invalid_argu": 1, "135": 1, "psa_error_bad_st": [1, 2, 11], "137": 1, "psa_error_does_not_exist": [1, 2, 11], "140": 1, "psa_error_insufficient_memori": [1, 4], "141": 1, "psa_error_insufficient_storag": 1, "142": 1, "psa_error_communication_failur": 1, "145": 1, "psa_error_storage_failur": 1, "146": 1, "psa_error_invalid_signatur": 1, "149": 1, "them": [1, 2, 4, 5, 11], "via": [1, 7, 8, 9], "inclus": 1, "156": [1, 3], "newer": 1, "befor": [1, 4, 5, 6, 8, 11], "multi": [1, 7], "rapid": 1, "flash": 1, "exhaust": [1, 5], "160": [1, 3], "excess": [1, 5], "caus": [1, 5, 6, 11], "certain": 1, "wear": 1, "out": [1, 5, 8, 11], "storag": [1, 5, 8, 9, 10, 11], "failur": [1, 4, 5, 6, 9, 11], "unusu": 1, "high": [1, 5, 11], "period": [1, 5, 9, 11], "power": [1, 5, 9], "carri": [1, 8, 11], "request": [1, 2, 5, 11], "161": [1, 3], "determin": [1, 5, 7, 8], "suffici": [1, 8, 9, 11], "energi": [1, 5, 9, 11], "avail": [1, 5, 10, 11], "reliabl": [1, 5, 7, 10, 11], "reprogram": [1, 9], "wait": [1, 4], "until": [1, 2, 5, 11], "fail": [1, 2, 4, 5, 6, 9, 11], "leav": [1, 5, 11], "temporarili": 1, "perman": [1, 11], "action": [1, 5, 11], "successfulli": [1, 8], "singl": [1, 7, 8, 9, 11], "about": [1, 7, 8, 11], "patch": [1, 3], "build": [1, 2, 3], "field": [1, 2, 9, 11], "revis": [1, 2, 5], "correspond": [1, 5, 8, 11], "readi": [1, 2, 4, 5, 6, 8, 10, 11], "start": [1, 2, 3, 4, 5, 11], "mark": [1, 2, 5, 6], "abort": [1, 4, 11], "discard": [1, 6, 11], "queu": 1, "attempt": [1, 5, 9, 11], "cancel": [1, 4, 5, 11], "reason": [1, 8, 9, 11], "eras": [1, 4, 11], "test": [1, 5, 6, 7], "prior": [1, 4, 5, 8, 9, 11], "accept": [1, 5, 6, 11], "5": [1, 3, 4, 5, 8, 11], "reject": [1, 2, 5, 6, 9, 11], "correct": [1, 5], "particularli": [1, 8, 10], "prevent": [1, 5, 8, 11], "rollback": [1, 2, 7, 8], "old": [1, 7], "roll": [1, 5, 11], "back": [1, 5, 11], "previou": [1, 5, 11], "6": [1, 3, 4, 5, 7, 8, 11], "revert": [1, 5, 6, 11], "now": [1, 2, 4, 6, 11], "member": [1, 2], "x00000001u": [1, 3], "while": [1, 4, 5, 9, 11], "expect": [1, 8, 11], "x00000002u": [1, 3], "empti": 1, "max_siz": [1, 3], "impl": [1, 3], "one": [1, 5, 8, 9, 10, 11], "second": [1, 5, 11], "maximum": 1, "extra": 1, "usag": [1, 2, 7, 8, 10], "compress": [1, 8], "retriev": [1, 7, 11], "rational": [1, 5, 7], "mechan": [1, 5, 10, 11], "extract": 1, "capabl": [1, 5, 9, 10, 11], "untrust": [1, 5, 7, 11], "deploy": [1, 7, 10, 11], "verif": [1, 7, 8], "defer": [1, 11], "local": [1, 5, 11], "effect": [1, 2, 5, 9, 11], "info": [1, 3, 4], "There": [1, 5, 6, 8, 9, 11], "id": [1, 2, 4], "author": [1, 5, 8, 9, 11], "queri": [1, 5, 7, 8], "know": 1, "built": [1, 5], "alongsid": 1, "server": [1, 7, 10, 11], "thei": [1, 4, 5, 11], "act": [1, 2], "manifest_s": [1, 3], "compli": [1, 2], "signatur": [1, 11], "check": [1, 5, 8, 11], "unexpect": [1, 5, 11], "none": [1, 5], "abandon": [1, 2, 6, 11], "logarithm": 1, "block": [1, 2, 3, 4, 5, 9, 11], "minimum": [1, 11], "log": 1, "image_offset": [1, 3], "support": [1, 2, 4, 5, 8, 9, 10, 11], "unalign": 1, "let": 1, "write_align_mask": 1, "block_siz": [1, 3], "pad": 1, "up": [1, 7], "next": [1, 4, 11], "neg": 1, "greater": 1, "17": [1, 4, 5], "128": 1, "kb": 1, "protocol": [1, 5, 7, 8, 10], "64": [1, 4], "pass": [1, 5, 8, 11], "complex": [1, 8, 9, 10, 11], "cost": [1, 5, 9, 11], "method": 1, "demonstr": [1, 10], "satisfi": [1, 3, 5, 11], "select": [1, 5, 8, 11], "particular": [1, 5, 8, 9], "ram": [1, 9, 11], "media": 1, "offset": [1, 4], "whole": [1, 5, 8], "lie": [1, 5], "insid": [1, 5], "remain": 1, "continu": [1, 11], "less": [1, 5], "equal": [1, 5], "entir": [1, 5, 8, 11], "extend": [1, 2, 9, 11], "execut": [1, 5, 7, 8, 9, 10], "smaller": [1, 4], "account": 1, "how": [1, 4, 5, 8, 10, 11], "much": [1, 11], "situat": [1, 5, 11], "possibl": [1, 4, 5, 6, 8, 11], "repeat": [1, 9, 11], "again": [1, 4, 11], "correctli": [1, 5, 11], "transit": [1, 2, 5, 6, 7], "deni": [1, 5], "older": 1, "initi": [1, 2, 4, 5, 11], "done": [1, 5, 8, 11], "want": [1, 5], "uninstal": 1, "tidi": 1, "succeed": [1, 11], "perform": [1, 5, 8, 9, 11], "schedul": 1, "disrupt": [1, 7, 11], "clean": [1, 5, 7], "current": [1, 5, 11], "concurr": [1, 2, 5, 11], "exist": [1, 5, 6, 9, 11], "progress": [1, 6, 11], "least": [1, 5, 11], "atom": [1, 2, 4, 5, 11], "occur": [1, 2, 4, 5, 6, 11], "interdepend": 1, "line": 1, "subset": [1, 8, 11], "later": [1, 11], "record": [1, 11], "soon": [1, 5], "chosen": [1, 5], "should": [1, 5, 9, 11], "chang": [1, 7, 11], "true": 1, "One": 1, "automat": [1, 5, 6, 11], "clarifi": 2, "relax": 2, "flag": [2, 3, 7], "impact": [2, 8, 9], "ad": [2, 10], "diagram": [2, 5, 6, 11], "variat": [2, 5, 7, 11], "design": [2, 5, 7, 8, 10, 11], "appendix": [2, 3, 5, 6, 10], "psa_fwu_log2_write_align": [2, 3], "psa_fwu_writ": [2, 3, 4, 11], "licens": [2, 7], "deriv": [2, 5], "remov": [2, 4, 5, 6, 11], "discuss": [2, 5], "earli": [2, 5], "chapter": 2, "cover": [2, 5, 9], "goal": [2, 7, 10], "match": [2, 9, 11], "renam": 2, "psa_image_id_t": 2, "psa_fwu_component_t": [2, 3, 4], "type": [2, 3, 4, 5, 6, 7, 8, 9, 11], "psa_image_info_t": 2, "psa_fwu_component_info_t": [2, 3, 4, 11], "vendor": [2, 9], "class": [2, 5, 8], "psa_fwu_staging_info_t": 2, "directli": [2, 5, 6, 9], "psa_image_version_t": 2, "psa_fwu_image_version_t": [2, 3], "resiz": 2, "rework": 2, "psa_fwu_undefin": 2, "psa_fwu_readi": [2, 3], "reboot_need": 2, "psa_fwu_stag": [2, 3], "pending_instal": 2, "trial": [2, 5, 7], "psa_fwu_tri": [2, 3], "psa_fwu_upd": [2, 3, 4], "psa_fwu_fail": [2, 3, 4], "reintroduc": 2, "yet": 2, "function": [2, 4, 7, 9, 10, 11], "psa_fwu_set_manifest": 2, "psa_fwu_start": [2, 3, 4, 11], "psa_fwu_request_rollback": 2, "psa_fwu_reject": [2, 3, 4, 11], "mirror": 2, "psa_fwu_accept": [2, 3, 11], "psa_fwu_abort": 2, "psa_fwu_clean": [2, 3, 4, 11], "explicit": [2, 5, 8], "add": [2, 5], "psa_fwu_finish": [2, 3, 4, 11], "psa_fwu_cancel": [2, 3, 4, 11], "component_id": 2, "psa_fwu_instal": [2, 3, 4, 11], "refer": [2, 3, 7, 8, 9, 10, 11], "ration": 2, "error": [2, 3, 4, 5, 7, 8], "psa_error_wrong_devic": 2, "psa_error_currently_instal": 2, "psa_error_already_instal": 2, "psa_error_install_interrupt": 2, "psa_error_decryption_failur": 2, "psa_error_missing_manifest": 2, "wrong": [2, 5], "sequenc": [2, 4, 5, 7], "unknown": 2, "discoveri": 2, "psa_fwu_get_image_id_iter": 2, "psa_fwu_get_image_id_next": 2, "psa_fwu_get_image_id_valid": 2, "psa_fwu_get_image_id": 2, "psa_fwu_iterator_t": 2, "past": 2, "psa_fwu_api_version_minor": [2, 3], "increas": [2, 10], "longer": [2, 11], "pointer": [2, 5, 7], "concept": [2, 7, 10], "drop": 2, "name": [2, 3, 7, 11], "success": [2, 4, 6, 7, 11], "mistak": 2, "return": [2, 4, 5, 7, 11], "replac": [2, 5, 11], "psa_error_rollback_detect": 2, "overview": 2, "Not": [3, 4], "miss": [3, 11], "reorder": 3, "rule": [3, 11], "templat": 3, "ifndef": 3, "psa_update_h": 3, "stdint": 3, "ifdef": 3, "__cplusplu": 3, "endif": 3, "psa_fwu_api_version_major": 3, "psa_error_dependency_need": 3, "psa_error_flash_abus": 3, "psa_error_insufficient_pow": 3, "psa_success_reboot": [3, 4, 11], "psa_success_restart": [3, 11], "typedef": 3, "struct": 3, "psa_fwu_candid": [3, 4], "psa_fwu_flag_encrypt": 3, "psa_fwu_impl_info_t": 3, "psa_fwu_queri": [3, 4, 11], "psa_fwu_max_write_s": [3, 4], "psa_fwu_request_reboot": [3, 4, 11], "purpos": 4, "guarante": [4, 5], "mani": [4, 8, 9, 11], "order": [4, 5, 11], "keep": 4, "brief": 4, "real": [4, 5], "variabl": [4, 5], "fit": [4, 5, 9], "show": [4, 5, 8, 10, 11], "assum": [4, 5, 8], "sequenti": 4, "zero": [4, 5], "num_compon": 4, "example_get_installation_info": 4, "9": [4, 5, 6], "rc": 4, "11": [4, 5, 6], "12": [4, 5], "13": [4, 5], "14": [4, 5], "15": [4, 5], "18": [4, 5], "specific_protocol_report": 4, "19": [4, 5], "20": [4, 5], "21": [4, 5], "simpl": [4, 5, 9], "example_install_single_imag": 4, "image_s": 4, "22": [4, 5], "23": 4, "24": 4, "eventu": 4, "25": 4, "26": 4, "happen": [4, 5, 8], "27": 4, "28": 4, "29": 4, "31": 4, "33": 4, "34": 4, "35": 4, "larger": [4, 5], "stdlib": 4, "stddef": 4, "fetch": 4, "increment": [4, 11], "example_install_single_image_multipart": 4, "total_image_s": 4, "to_send": 4, "dynam": 4, "alloc": [4, 8], "malloc": 4, "els": 4, "min": 4, "fetch_next_part_of_imag": 4, "psa_error_generic_error": 4, "break": [4, 5], "36": 4, "37": 4, "38": 4, "39": 4, "40": 4, "41": 4, "42": 4, "43": 4, "44": 4, "45": 4, "46": 4, "47": 4, "48": 4, "49": 4, "50": 4, "51": 4, "52": 4, "53": 4, "54": 4, "55": 4, "56": 4, "57": 4, "58": 4, "59": 4, "60": 4, "61": 4, "62": 4, "63": 4, "65": 4, "66": 4, "67": 4, "togeth": [4, 8, 11], "inter": [4, 11], "becaus": [4, 5, 6, 11], "prepare_imag": 4, "fetch_and_prepare_imag": 4, "fetch_image_data": 4, "example_install_multiple_imag": 4, "psa_fwu_component_id": 4, "num_id": 4, "int": 4, "ix": 4, "68": 4, "69": 4, "70": 4, "71": 4, "72": 4, "73": 4, "74": 4, "75": 4, "76": 4, "77": 4, "78": 4, "79": 4, "forcibli": 4, "example_clean_all_compon": 4, "finish": [4, 11], "switch": [4, 11], "sra": 5, "variou": [5, 10, 11], "problem": 5, "summar": 5, "analys": 5, "itself": [5, 8, 11], "aris": 5, "As": [5, 8], "broad": [5, 10], "recent": 5, "studi": 5, "group": 5, "examin": 5, "challeng": [5, 10], "face": 5, "scale": 5, "inform": [5, 6, 7, 8, 9, 10, 11], "analysi": 5, "substitut": 5, "our": 5, "rate": 5, "approach": [5, 8], "veri": [5, 6, 10, 11], "low": [5, 9], "unlik": 5, "ever": 5, "practic": [5, 10], "mathemat": 5, "imposs": 5, "event": 5, "could": [5, 11], "emploi": 5, "medium": 5, "motiv": 5, "well": [5, 6], "lifetim": 5, "resp": 5, "Will": 5, "instanc": [5, 8], "dai": 5, "virtual": 5, "damag": 5, "probabl": 5, "easili": 5, "toler": 5, "absorb": 5, "would": 5, "cve": 5, "most": [5, 11], "notic": 5, "degrad": 5, "won": 5, "strong": 5, "reduct": 5, "analyst": 5, "paper": 5, "blog": 5, "entri": 5, "partner": 5, "complain": 5, "critic": 5, "consequ": 5, "kill": 5, "sever": 5, "quit": 5, "strongli": 5, "delai": 5, "doubt": 5, "higher": 5, "ones": 5, "devis": 5, "note": 5, "reassess": 5, "usual": 5, "decreas": 5, "residu": 5, "taken": [5, 11], "acronym": 5, "cast": 5, "put": 5, "step": [5, 8, 11], "therebi": 5, "necessari": [5, 11], "market": [5, 9], "suppress": 5, "rise": 5, "suitabl": [5, 7, 8], "parti": [5, 8], "vulner": [5, 10, 11], "sinc": 5, "exacerb": 5, "essenti": [5, 11], "expos": [5, 11], "context": [5, 8, 9], "figur": [5, 6, 8, 10, 11], "reproduct": 5, "deliv": [5, 10], "independ": [5, 7, 8, 10], "deliveri": [5, 9, 10], "manag": [5, 7, 8, 9, 10, 11], "credenti": 5, "provis": [5, 8], "phase": 5, "aid": 5, "understand": 5, "role": 5, "amongst": 5, "therefor": 5, "across": [5, 6, 8, 9, 10, 11], "scenario": [5, 7, 10, 11], "similar": [5, 6], "simplest": 5, "surfac": 5, "li": 5, "relev": 5, "df": 5, "upload": [5, 10], "b": 5, "track": [5, 11], "d": 5, "e": 5, "f": [5, 9], "bootload": [5, 7, 9], "g": 5, "shown": [5, 6, 11], "modif": [5, 8], "benefit": 5, "librari": [5, 7, 8], "although": [5, 8], "suppli": 5, "off": [5, 9], "involv": [5, 8, 10, 11], "am": 5, "abil": [5, 6], "achiev": [5, 11], "who": 5, "That": 5, "robust": [5, 7], "inoper": 5, "denial": 5, "microprocessor": [5, 9], "sram": 5, "psram": 5, "ddr": 5, "rowhamm": 5, "equival": [5, 9], "focus": 5, "latter": [5, 11], "sip": 5, "interest": 5, "isv": 5, "concern": 5, "reveal": 5, "ip": [5, 9], "find": [5, 10], "reput": 5, "regard": [5, 8], "liabil": 5, "scalabl": 5, "flaw": 5, "inabl": 5, "sg": 5, "unabl": 5, "render": 5, "disclos": 5, "wai": [5, 8], "assist": 5, "abstract": [5, 7, 8], "wide": [5, 9, 10], "rang": [5, 9, 10], "sensit": 5, "neither": [5, 7], "physic": [5, 8, 9, 11], "nor": [5, 7], "intercept": 5, "connect": [5, 9, 10], "through": [5, 9, 11], "forg": 5, "replai": 5, "observ": 5, "machin": 5, "craft": 5, "web": 5, "addition": 5, "mount": 5, "map": [5, 8, 11], "monitor": 5, "debug": [5, 9], "side": 5, "channel": 5, "measur": 5, "induc": 5, "raspberri": 5, "crash": 5, "cpu": [5, 9], "intens": 5, "abov": 5, "fault": 5, "inject": 5, "breach": 5, "envelop": [5, 9], "chip": [5, 9], "util": [5, 10], "leakag": 5, "em": 5, "emiss": 5, "consumpt": 5, "photon": 5, "acoust": 5, "plug": 5, "malici": [5, 8], "gain": 5, "interpos": 5, "soc": [5, 9], "transact": 5, "motherboard": 5, "revers": 5, "invas": 5, "decapsul": 5, "laser": 5, "chemic": 5, "etch": 5, "microphotographi": 5, "engin": 5, "focuss": 5, "ion": 5, "beam": 5, "microscop": 5, "gate": 5, "unprotect": 5, "onlin": 5, "tracker": 5, "load": 5, "notif": 5, "altern": [5, 11], "poll": 5, "discov": 5, "immedi": [5, 6, 11], "command": 5, "inspect": 5, "aspect": [5, 11], "convent": [5, 7], "flexibl": [5, 7], "unauthor": 5, "malfunct": 5, "misinterpret": 5, "incorrectli": 5, "stop": 5, "elev": 5, "privileg": 5, "unmitig": 5, "m": 5, "hash": [5, 8, 11], "send": 5, "known": [5, 11], "recov": [5, 9, 11], "repair": 5, "allow": [5, 11], "monoton": 5, "fragil": 5, "left": [5, 11], "check_depend": 5, "verify_earli": 5, "unnecessari": [5, 9], "elimin": [5, 6], "insuffici": 5, "abus": 5, "provok": 5, "inaccess": 5, "invok": [5, 11], "state_model": 5, "enforc": [5, 8], "memory_buff": 5, "validate_paramet": 5, "whatsoev": 5, "protect_then_verifi": 5, "everyth": 5, "forc": 5, "explicit_stag": 5, "breakag": 5, "analyz": 5, "solut": [5, 9], "swap": 5, "robust_instal": 5, "resili": 5, "interrupt": [5, 11], "resum": [5, 11], "robust_download": 5, "synchron": 5, "due": [5, 11], "rel": 5, "expens": [5, 11], "bandwidth": [5, 9, 11], "budget": 5, "fault_harden": 5, "harden": 5, "techniqu": 5, "imperson": 5, "indistinguish": 5, "sent": 5, "organ": [5, 10], "remedi": 5, "recoveri": [5, 9, 11], "collaps": 6, "compromis": [6, 9, 11], "persist": [6, 11], "ye": 6, "No": 6, "basic": [6, 7], "legend": 6, "commit": [6, 11], "simplifi": [6, 10], "flow": [6, 11], "almost": [6, 11], "had": 6, "go": 6, "modifi": [6, 7, 11], "releas": 7, "abbrevi": 7, "introduct": 7, "transport": 7, "composit": 7, "creator": [7, 10, 11], "constant": 7, "header": [7, 10], "methodologi": [7, 10], "lifecycl": 7, "boundari": [7, 8], "assumpt": [7, 8], "constraint": [7, 9, 10, 11], "stakehold": 7, "asset": 7, "adversari": 7, "character": 7, "dataflow": 7, "threat": [7, 10], "t": 7, "tamper": 7, "non_funct": 7, "defect": 7, "skip_intermedi": 7, "skip": 7, "intermedi": 7, "degrade_devic": 7, "repeatedli": 7, "interface_abus": 7, "illeg": 7, "toctou": 7, "partial_upd": 7, "trigger": [7, 11], "incompat": 7, "mismatch": 7, "disclosur": 7, "disrupt_instal": 7, "corrupt": 7, "disrupt_download": 7, "fault_inject": 7, "bypass": 7, "glitch": 7, "attack": [7, 11], "exploit": 7, "spoof": 7, "network": [7, 8, 9, 10], "manipul": 7, "traffic": 7, "mitig": 7, "summari": 7, "user": 7, "histori": 7, "actor": [8, 10], "agent": [8, 10], "consist": [8, 9], "microcontrol": [8, 9], "archiv": 8, "even": 8, "differenti": 8, "interchang": 8, "digest": 8, "hint": 8, "decrypt": 8, "decompress": 8, "logic": [8, 11], "processor": 8, "packag": 8, "form": 8, "numer": 8, "precis": 8, "translat": 8, "identif": 8, "scheme": [8, 9, 10], "construct": 8, "host": 8, "rollout": 8, "attach": 8, "did": 8, "conceptu": 8, "what": 8, "proce": [8, 11], "pre": 8, "conform": [8, 11], "encod": [8, 9], "delta": 8, "accord": 8, "notifi": 8, "primari": 8, "presenc": 8, "proxi": 8, "fulfil": 8, "still": 8, "benefici": 8, "accident": 8, "highli": 8, "further": 8, "pure": 8, "layer": 8, "hal": 8, "clearli": 8, "reus": [8, 10, 11], "focu": 8, "richer": 9, "subsystem": 9, "capac": 9, "wast": 9, "primit": 9, "prescrib": 9, "capsul": 9, "partit": 9, "runtim": 9, "firmware_upd": 9, "toe": 9, "downgrad": [9, 11], "factor": 9, "mutual": 9, "distrust": 9, "regul": 9, "distinct": [9, 11], "owner": 9, "impos": 9, "overhead": 9, "industri": 9, "proprietari": 9, "cloud": 9, "serv": 9, "respect": [9, 11], "wi": 9, "fi": 9, "lte": 9, "lora": 9, "commerci": 9, "adjac": 9, "uart": 9, "bu": 9, "usb": 9, "jtag": 9, "swd": 9, "tailor": 9, "adopt": 9, "just": [9, 11], "effici": [9, 11], "filter": 9, "mixtur": 9, "radio": 9, "enclav": 9, "deploi": [9, 10], "routin": 9, "mode": [9, 11], "trade": 9, "simplic": 9, "fine": [9, 11], "grain": [9, 11], "person": 9, "monolith": 9, "enhanc": 9, "stricter": 9, "omiss": 9, "meet": 10, "silicon": 10, "partnership": 10, "divers": 10, "fwu": 10, "fundament": 10, "highlight": 10, "depict": [10, 11], "announc": 10, "lead": 10, "fragment": 10, "tightli": 10, "coupl": 10, "remaind": 10, "backup": 11, "dirti": 11, "sometim": 11, "kept": 11, "cours": 11, "becom": 11, "relationship": 11, "properti": 11, "characterist": 11, "re": 11, "save": 11, "expir": 11, "enter": 11, "end": 11, "unchang": 11, "slow": 11, "latenc": 11, "weak": 11, "control": 11, "loss": 11, "digit": 11, "treat": 11, "earlier": 11, "ahead": 11, "alreadi": 11, "candiat": 11, "met": 11, "advanc": 11, "outdat": 11, "proceed": 11, "succe": 11, "inact": 11, "reclaim": 11, "restor": 11, "unrecover": 11}, "objects": {"": [[1, 0, 1, "c.PSA_ERROR_DEPENDENCY_NEEDED", "PSA_ERROR_DEPENDENCY_NEEDED"], [1, 0, 1, "c.PSA_ERROR_FLASH_ABUSE", "PSA_ERROR_FLASH_ABUSE"], [1, 0, 1, "c.PSA_ERROR_INSUFFICIENT_POWER", "PSA_ERROR_INSUFFICIENT_POWER"], [1, 0, 1, "c.PSA_FWU_API_VERSION_MAJOR", "PSA_FWU_API_VERSION_MAJOR"], [1, 0, 1, "c.PSA_FWU_API_VERSION_MINOR", "PSA_FWU_API_VERSION_MINOR"], [1, 0, 1, "c.PSA_FWU_CANDIDATE", "PSA_FWU_CANDIDATE"], [1, 0, 1, "c.PSA_FWU_FAILED", "PSA_FWU_FAILED"], [1, 0, 1, "c.PSA_FWU_FLAG_ENCRYPTION", "PSA_FWU_FLAG_ENCRYPTION"], [1, 0, 1, "c.PSA_FWU_FLAG_VOLATILE_STAGING", "PSA_FWU_FLAG_VOLATILE_STAGING"], [1, 0, 1, "c.PSA_FWU_LOG2_WRITE_ALIGN", "PSA_FWU_LOG2_WRITE_ALIGN"], [1, 0, 1, "c.PSA_FWU_MAX_WRITE_SIZE", "PSA_FWU_MAX_WRITE_SIZE"], [1, 0, 1, "c.PSA_FWU_READY", "PSA_FWU_READY"], [1, 0, 1, "c.PSA_FWU_REJECTED", "PSA_FWU_REJECTED"], [1, 0, 1, "c.PSA_FWU_STAGED", "PSA_FWU_STAGED"], [1, 0, 1, "c.PSA_FWU_TRIAL", "PSA_FWU_TRIAL"], [1, 0, 1, "c.PSA_FWU_UPDATED", "PSA_FWU_UPDATED"], [1, 0, 1, "c.PSA_FWU_WRITING", "PSA_FWU_WRITING"], [1, 0, 1, "c.PSA_SUCCESS_REBOOT", "PSA_SUCCESS_REBOOT"], [1, 0, 1, "c.PSA_SUCCESS_RESTART", "PSA_SUCCESS_RESTART"], [1, 1, 1, "c.psa_fwu_accept", "psa_fwu_accept"], [1, 1, 1, "c.psa_fwu_cancel", "psa_fwu_cancel"], [1, 1, 1, "c.psa_fwu_clean", "psa_fwu_clean"], [1, 2, 1, "c.psa_fwu_component_info_t", "psa_fwu_component_info_t"], [1, 3, 1, "c.psa_fwu_component_t", "psa_fwu_component_t"], [1, 1, 1, "c.psa_fwu_finish", "psa_fwu_finish"], [1, 2, 1, "c.psa_fwu_image_version_t", "psa_fwu_image_version_t"], [1, 3, 1, "c.psa_fwu_impl_info_t", "psa_fwu_impl_info_t"], [1, 1, 1, "c.psa_fwu_install", "psa_fwu_install"], [1, 1, 1, "c.psa_fwu_query", "psa_fwu_query"], [1, 1, 1, "c.psa_fwu_reject", "psa_fwu_reject"], [1, 1, 1, "c.psa_fwu_request_reboot", "psa_fwu_request_reboot"], [1, 1, 1, "c.psa_fwu_start", "psa_fwu_start"], [1, 1, 1, "c.psa_fwu_write", "psa_fwu_write"]]}, "objtypes": {"0": "atg_c:macro", "1": "atg_c:function", "2": "atg_c:struct", "3": "atg_c:typedef"}, "objnames": {"0": ["atg_c", "macro", "macro"], "1": ["atg_c", "function", "function"], "2": ["atg_c", "struct", "struct"], "3": ["atg_c", "typedef", "typedef"]}, "titleterms": {"about": [0, 5, 10], "thi": [0, 5], "document": [0, 2], "releas": 0, "inform": [0, 1], "revis": 0, "histori": [0, 2], "licens": 0, "refer": [0, 1], "referenc": 0, "term": 0, "abbrevi": 0, "potenti": 0, "chang": [0, 2], "convent": [0, 1], "typograph": 0, "number": 0, "feedback": 0, "api": [1, 5, 7, 10], "identifi": [1, 8], "name": 1, "basic": 1, "type": 1, "data": 1, "constant": 1, "function": [1, 5], "return": 1, "statu": 1, "pointer": 1, "implement": [1, 5, 6, 9, 11], "specif": 1, "header": [1, 3], "file": [1, 3], "requir": [1, 6], "librari": 1, "manag": 1, "version": [1, 2, 4], "psa_fwu_api_version_major": 1, "macro": 1, "psa_fwu_api_version_minor": 1, "code": 1, "common": 1, "note": [1, 6, 11], "error": [1, 11], "firmwar": [1, 5, 7, 8, 9, 10, 11], "updat": [1, 3, 4, 5, 7, 8, 9, 10, 11], "psa_error_dependency_need": 1, "psa_error_flash_abus": 1, "psa_error_insufficient_pow": 1, "success": 1, "psa_success_reboot": 1, "psa_success_restart": 1, "compon": [1, 4, 6, 8, 11], "psa_fwu_component_t": 1, "typedef": 1, "psa_fwu_image_version_t": 1, "struct": 1, "state": [1, 6, 11], "psa_fwu_readi": 1, "psa_fwu_writ": 1, "psa_fwu_candid": 1, "psa_fwu_stag": 1, "psa_fwu_fail": 1, "psa_fwu_tri": 1, "psa_fwu_reject": 1, "psa_fwu_upd": 1, "flag": 1, "psa_fwu_flag_volatile_stag": 1, "psa_fwu_flag_encrypt": 1, "psa_fwu_impl_info_t": 1, "psa_fwu_component_info_t": 1, "psa_fwu_queri": 1, "instal": [1, 4, 5, 11], "candid": [1, 11], "imag": [1, 4, 5, 8, 11], "prepar": [1, 11], "psa_fwu_start": 1, "psa_fwu_log2_write_align": 1, "psa_fwu_max_write_s": 1, "psa_fwu_finish": 1, "psa_fwu_cancel": 1, "psa_fwu_clean": 1, "psa_fwu_instal": 1, "psa_fwu_request_reboot": 1, "trial": [1, 6, 11], "psa_fwu_accept": 1, "between": [2, 5], "1": [2, 7], "0": [2, 7], "beta": 2, "7": 2, "6": 2, "exampl": [3, 4], "psa": [3, 7], "h": 3, "usag": 4, "retriev": 4, "individu": 4, "singl": 4, "part": 4, "oper": [4, 5, 11], "multi": [4, 11], "multipl": 4, "depend": [4, 11], "clean": [4, 11], "up": [4, 11], "all": 4, "secur": [5, 10], "risk": 5, "assess": 5, "subject": 5, "scope": 5, "methodologi": 5, "likelihood": 5, "level": 5, "impact": 5, "overal": 5, "calcul": 5, "featur": 5, "definit": 5, "introduct": [5, 10], "background": 5, "purpos": 5, "lifecycl": 5, "trust": [5, 8, 9], "boundari": 5, "dataflow": 5, "descript": 5, "process": 5, "deploy": [5, 8], "model": [5, 6, 9, 11], "dm": 5, "untrusted_cli": 5, "untrusted_stag": 5, "assumpt": 5, "constraint": 5, "stakehold": 5, "asset": 5, "goal": [5, 9], "adversari": 5, "character": 5, "detail": 5, "threat": 5, "summari": 5, "t": 5, "tamper": 5, "manifest": [5, 8, 11], "non_funct": 5, "defect": 5, "rollback": [5, 11], "old": 5, "skip_intermedi": 5, "skip": 5, "intermedi": 5, "degrade_devic": 5, "repeatedli": 5, "invalid": 5, "interface_abus": 5, "illeg": 5, "input": 5, "toctou": 5, "modifi": 5, "authent": [5, 11], "us": [5, 11], "partial_upd": 5, "trigger": 5, "incomplet": 5, "incompat": 5, "mismatch": 5, "disclosur": 5, "protect": 5, "disrupt_instal": 5, "corrupt": 5, "disrupt": 5, "disrupt_download": 5, "write": 5, "fault_inject": 5, "verif": [5, 11], "bypass": 5, "via": 5, "glitch": 5, "server": [5, 8], "attack": 5, "from": 5, "exploit": 5, "creator": [5, 8], "spoof": 5, "network": 5, "manipul": 5, "traffic": 5, "mitig": 5, "architectur": [5, 8, 10], "control": 5, "transfer": 5, "format": [5, 8, 9], "ar": 5, "user": 5, "applic": [5, 9], "variat": 6, "system": 6, "design": [6, 9], "paramet": 6, "non": 6, "volatil": [6, 11], "stage": [6, 8], "reboot": 6, "neither": 6, "nor": 6, "certifi": 7, "br": 7, "concept": 8, "terminologi": 8, "client": [8, 11], "servic": 8, "store": [8, 11], "bootload": [8, 11], "anchor": 8, "scenario": 8, "untrust": 8, "suitabl": 9, "constrain": 9, "devic": 9, "platform": [9, 10], "root": 9, "flexibl": 9, "differ": 9, "protocol": 9, "independ": 9, "transport": 9, "hardwar": 9, "composit": 9, "robust": 9, "reliabl": 9, "program": 11, "The": 11, "transit": 11, "behavior": 11, "rational": 11, "case": 11, "implic": 11, "verifi": 11, "an": 11, "queri": 11, "new": 11, "test": 11, "determin": 11, "execut": 11, "activ": 11, "sampl": 11, "sequenc": 11, "dure": 11}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.todo": 2, "atg-sphinx-spec": 11, "sphinx": 57}, "alltitles": {"About this document": [[0, "about-this-document"]], "Release information": [[0, "release-information"]], "Document revision history": [[0, "id4"]], "License": [[0, "license"]], "References": [[0, "references"]], "Documents referenced by this document": [[0, "id5"]], "Terms and abbreviations": [[0, "terms-and-abbreviations"], [0, "id6"]], "Potential for change": [[0, "potential-for-change"]], "Conventions": [[0, "conventions"]], "Typographical conventions": [[0, "typographical-conventions"]], "Numbers": [[0, "numbers"]], "Feedback": [[0, "feedback"]], "API reference": [[1, "api-reference"]], "API conventions": [[1, "api-conventions"]], "Identifier names": [[1, "identifier-names"]], "Basic types": [[1, "basic-types"]], "Data types": [[1, "data-types"]], "Constants": [[1, "constants"]], "Functions": [[1, "functions"]], "Return status": [[1, "return-status"]], "Pointer conventions": [[1, "pointer-conventions"]], "Implementation-specific types": [[1, "implementation-specific-types"]], "Header file": [[1, "header-file"]], "Required functions": [[1, "required-functions"]], "Library management": [[1, "library-management"]], "Library version": [[1, "library-version"]], "PSA_FWU_API_VERSION_MAJOR (macro)": [[1, "c.PSA_FWU_API_VERSION_MAJOR"]], "PSA_FWU_API_VERSION_MINOR (macro)": [[1, "c.PSA_FWU_API_VERSION_MINOR"]], "Status codes": [[1, "status-codes"]], "Common status codes": [[1, "common-status-codes"]], "Implementation note": [[1, null], [1, null], [1, null], [1, null], [1, null], [1, null], [6, null], [11, null], [11, null], [11, null], [11, null], [11, null]], "Error codes specific to the Firmware Update API": [[1, "error-codes-specific-to-the-api"]], "PSA_ERROR_DEPENDENCY_NEEDED (macro)": [[1, "c.PSA_ERROR_DEPENDENCY_NEEDED"]], "PSA_ERROR_FLASH_ABUSE (macro)": [[1, "c.PSA_ERROR_FLASH_ABUSE"]], "PSA_ERROR_INSUFFICIENT_POWER (macro)": [[1, "c.PSA_ERROR_INSUFFICIENT_POWER"]], "Success status codes specific to the Firmware Update API": [[1, "success-status-codes-specific-to-the-api"]], "PSA_SUCCESS_REBOOT (macro)": [[1, "c.PSA_SUCCESS_REBOOT"]], "PSA_SUCCESS_RESTART (macro)": [[1, "c.PSA_SUCCESS_RESTART"]], "Firmware components": [[1, "firmware-components"]], "Component identifier": [[1, "component-identifier"], [8, "component-identifier"]], "psa_fwu_component_t (typedef)": [[1, "c.psa_fwu_component_t"]], "Component version": [[1, "component-version"]], "psa_fwu_image_version_t (struct)": [[1, "c.psa_fwu_image_version_t"]], "Component states": [[1, "component-states"], [11, "tab-states"]], "PSA_FWU_READY (macro)": [[1, "c.PSA_FWU_READY"]], "PSA_FWU_WRITING (macro)": [[1, "c.PSA_FWU_WRITING"]], "PSA_FWU_CANDIDATE (macro)": [[1, "c.PSA_FWU_CANDIDATE"]], "PSA_FWU_STAGED (macro)": [[1, "c.PSA_FWU_STAGED"]], "PSA_FWU_FAILED (macro)": [[1, "c.PSA_FWU_FAILED"]], "PSA_FWU_TRIAL (macro)": [[1, "c.PSA_FWU_TRIAL"]], "PSA_FWU_REJECTED (macro)": [[1, "c.PSA_FWU_REJECTED"]], "PSA_FWU_UPDATED (macro)": [[1, "c.PSA_FWU_UPDATED"]], "Component flags": [[1, "component-flags"]], "PSA_FWU_FLAG_VOLATILE_STAGING (macro)": [[1, "c.PSA_FWU_FLAG_VOLATILE_STAGING"]], "PSA_FWU_FLAG_ENCRYPTION (macro)": [[1, "c.PSA_FWU_FLAG_ENCRYPTION"]], "Component information": [[1, "component-information"]], "psa_fwu_impl_info_t (typedef)": [[1, "c.psa_fwu_impl_info_t"]], "psa_fwu_component_info_t (struct)": [[1, "c.psa_fwu_component_info_t"]], "psa_fwu_query (function)": [[1, "c.psa_fwu_query"]], "Firmware installation": [[1, "firmware-installation"]], "Candidate image preparation": [[1, "candidate-image-preparation"]], "psa_fwu_start (function)": [[1, "c.psa_fwu_start"]], "PSA_FWU_LOG2_WRITE_ALIGN (macro)": [[1, "c.PSA_FWU_LOG2_WRITE_ALIGN"]], "PSA_FWU_MAX_WRITE_SIZE (macro)": [[1, "c.PSA_FWU_MAX_WRITE_SIZE"]], "psa_fwu_write (function)": [[1, "c.psa_fwu_write"]], "psa_fwu_finish (function)": [[1, "c.psa_fwu_finish"]], "psa_fwu_cancel (function)": [[1, "c.psa_fwu_cancel"]], "psa_fwu_clean (function)": [[1, "c.psa_fwu_clean"]], "Image installation": [[1, "image-installation"]], "psa_fwu_install (function)": [[1, "c.psa_fwu_install"]], "psa_fwu_request_reboot (function)": [[1, "c.psa_fwu_request_reboot"]], "psa_fwu_reject (function)": [[1, "c.psa_fwu_reject"]], "Image trial": [[1, "image-trial"]], "psa_fwu_accept (function)": [[1, "c.psa_fwu_accept"]], "Document change history": [[2, "document-change-history"]], "Changes between version 1.0 Beta and 1.0.0": [[2, "changes-between-version-1-0-beta-and-1-0-0"]], "Changes between version 0.7 and 1.0 Beta": [[2, "changes-between-version-0-7-and-1-0-beta"]], "Changes between version 0.6 and 0.7": [[2, "changes-between-version-0-6-and-0-7"]], "Example header file": [[3, "example-header-file"]], "psa/update.h": [[3, "psa-update-h"]], "Example usage": [[4, "example-usage"]], "Retrieve versions of installed images": [[4, "retrieve-versions-of-installed-images"]], "Individual component update (single part operation)": [[4, "individual-component-update-single-part-operation"]], "Individual component update (multi part operation)": [[4, "individual-component-update-multi-part-operation"]], "Multiple components with dependent images": [[4, "multiple-components-with-dependent-images"]], "Clean up all component updates": [[4, "clean-up-all-component-updates"]], "Security Risk Assessment": [[5, "security-risk-assessment"]], "About this assessment": [[5, "about-this-assessment"]], "Subject and scope": [[5, "subject-and-scope"]], "Risk assessment methodology": [[5, "risk-assessment-methodology"]], "Likelihood levels": [[5, "tab-sra-likelihood"]], "Impact levels": [[5, "tab-sra-impact"]], "Overall risk calculation": [[5, "tab-sra-overall-risk"]], "Feature definition": [[5, "feature-definition"]], "Introduction": [[5, "introduction"], [10, "introduction"]], "Background": [[5, "background"]], "Purpose": [[5, "purpose"]], "Function": [[5, "function"]], "Lifecycle": [[5, "lifecycle"]], "Operation and trust boundaries": [[5, "operation-and-trust-boundaries"]], "Dataflow descriptions for the firmware update process": [[5, "tab-dm-dataflow"]], "Deployment models": [[5, "deployment-models"]], "DM.UNTRUSTED_CLIENT deployment model": [[5, "dm-untrusted-client-deployment-model"]], "DM.UNTRUSTED_STAGING deployment model": [[5, "dm-untrusted-staging-deployment-model"]], "Assumptions and constraints": [[5, "assumptions-and-constraints"]], "Stakeholders and assets": [[5, "stakeholders-and-assets"]], "Security goals": [[5, "security-goals"]], "Adversarial model": [[5, "adversarial-model"]], "Feature characterization": [[5, "feature-characterization"]], "Detailed deployment dataflow": [[5, "detailed-deployment-dataflow"]], "Detailed dataflow descriptions for the firmware update process": [[5, "tab-dm-dataflow-detail"]], "Security features of the API": [[5, "security-features-of-the-api"]], "Threats": [[5, "threats"]], "Summary of threats": [[5, "tab-sra-threats"]], "T.TAMPER: Tampering with the firmware image or manifest": [[5, "t-tamper-tampering-with-the-firmware-image-or-manifest"]], "T.NON_FUNCTIONAL: Install defective firmware": [[5, "t-non-functional-install-defective-firmware"]], "T.ROLLBACK: Install old firmware": [[5, "t-rollback-install-old-firmware"]], "T.SKIP_INTERMEDIATE: Skip intermediate update": [[5, "t-skip-intermediate-skip-intermediate-update"]], "T.DEGRADE_DEVICE: Repeatedly install invalid firmware": [[5, "t-degrade-device-repeatedly-install-invalid-firmware"]], "T.INTERFACE_ABUSE: Illegal inputs to the API": [[5, "t-interface-abuse-illegal-inputs-to-the-api"]], "T.TOCTOU: Modify asset between authentication and use": [[5, "t-toctou-modify-asset-between-authentication-and-use"]], "T.PARTIAL_UPDATE: Trigger installation of incomplete update": [[5, "t-partial-update-trigger-installation-of-incomplete-update"]], "T.INCOMPATIBLE: Mismatched firmware": [[5, "t-incompatible-mismatched-firmware"]], "T.DISCLOSURE: Disclosure of protected firmware": [[5, "t-disclosure-disclosure-of-protected-firmware"]], "T.DISRUPT_INSTALL: Corrupt image by disrupting installer": [[5, "t-disrupt-install-corrupt-image-by-disrupting-installer"]], "T.DISRUPT_DOWNLOAD: Corrupt image by disrupting writes": [[5, "t-disrupt-download-corrupt-image-by-disrupting-writes"]], "T.FAULT_INJECTION: Verification bypass via glitching": [[5, "t-fault-injection-verification-bypass-via-glitching"]], "T.SERVER: Attack from exploited update server": [[5, "t-server-attack-from-exploited-update-server"]], "T.CREATOR: Attack from spoof firmware creator": [[5, "t-creator-attack-from-spoof-firmware-creator"]], "T.NETWORK: Manipulate network traffic": [[5, "t-network-manipulate-network-traffic"]], "Mitigation summary": [[5, "mitigation-summary"]], "Architectural mitigations": [[5, "architectural-mitigations"]], "Mitigations controlled by the Firmware Update API": [[5, "tab-sra-api-mitigations"]], "Mitigations transferred to the firmware image and manifest formats": [[5, "tab-sra-format-mitigations"]], "Implementation-level mitigations": [[5, "implementation-level-mitigations"]], "Mitigations that are transferred to the implementation": [[5, "tab-sra-remediations"]], "User-level mitigations": [[5, "user-level-mitigations"]], "Mitigations that are transferred to the application": [[5, "tab-sra-residual-risk"]], "Variation in system design parameters": [[6, "variation-in-system-design-parameters"]], "Variations of the state model": [[6, "tab-variations"]], "Component with non-volatile staging": [[6, "component-with-non-volatile-staging"]], "Component that requires a reboot, but no trial": [[6, "component-that-requires-a-reboot-but-no-trial"]], "Component that requires a trial, but no reboot": [[6, "component-that-requires-a-trial-but-no-reboot"]], "Component that requires neither a reboot, nor a trial": [[6, "component-that-requires-neither-a-reboot-nor-a-trial"]], "Component with volatile staging": [[6, "component-with-volatile-staging"]], "PSA Certified <br /> Firmware Update API 1.0": [[7, "docrsttitle-docversion"]], "Architecture": [[8, "architecture"]], "Concepts and terminology": [[8, "concepts-and-terminology"]], "Firmware image": [[8, "firmware-image"]], "Manifest": [[8, "manifest"]], "Component": [[8, "component"]], "Firmware creator": [[8, "firmware-creator"]], "Update server": [[8, "update-server"]], "Update client": [[8, "update-client"]], "Update service": [[8, "update-service"]], "Firmware store": [[8, "firmware-store"]], "Bootloader": [[8, "bootloader"]], "Trust anchor": [[8, "trust-anchor"]], "Firmware image format": [[8, "firmware-image-format"]], "Deployment scenarios": [[8, "deployment-scenarios"]], "Untrusted client": [[8, "untrusted-client"]], "Untrusted staging": [[8, "untrusted-staging"]], "Trusted client": [[8, "trusted-client"]], "Design goals": [[9, "design-goals"]], "Suitable for constrained devices": [[9, "suitable-for-constrained-devices"]], "Updating the Platform Root of Trust": [[9, "updating-the-platform-root-of-trust"]], "Updating the Application Root of Trust": [[9, "updating-the-application-root-of-trust"]], "Flexibility for different trust models": [[9, "flexibility-for-different-trust-models"]], "Protocol independence": [[9, "protocol-independence"]], "Transport independence": [[9, "transport-independence"]], "Firmware format independence": [[9, "firmware-format-independence"]], "Flexibility for different hardware designs": [[9, "flexibility-for-different-hardware-designs"]], "Suitable for composite devices": [[9, "suitable-for-composite-devices"]], "Robust and reliable update": [[9, "robust-and-reliable-update"]], "Flexibility in implementation design": [[9, "flexibility-in-implementation-design"]], "About Platform Security Architecture": [[10, "about-platform-security-architecture"]], "About the Firmware Update API": [[10, "about-the-api"]], "Firmware update": [[10, "firmware-update"]], "Programming model": [[11, "programming-model"]], "The firmware store": [[11, "the-firmware-store"]], "State model": [[11, "state-model"]], "Component state": [[11, "component-state"]], "Volatile states": [[11, "volatile-states"]], "State transitions": [[11, "state-transitions"]], "Operations on components": [[11, "tab-operations"]], "Behavior on error": [[11, "behavior-on-error"]], "Rationale": [[11, "rationale"]], "Use case implications for the state model": [[11, "tab-model-rationale"]], "Verifying an update": [[11, "verifying-an-update"]], "Manifest verification": [[11, "manifest-verification"]], "Firmware image verification": [[11, "firmware-image-verification"]], "Dependencies": [[11, "dependencies"]], "Update client operation": [[11, "update-client-operation"]], "Querying installed firmware": [[11, "querying-installed-firmware"]], "Preparing a new firmware image": [[11, "preparing-a-new-firmware-image"]], "Multi-component updates": [[11, "multi-component-updates"]], "Installing the candidate firmware image": [[11, "installing-the-candidate-firmware-image"]], "Testing the new firmware image": [[11, "testing-the-new-firmware-image"]], "Cleaning up the firmware store": [[11, "cleaning-up-the-firmware-store"]], "Bootloader operation": [[11, "bootloader-operation"]], "Determine firmware state": [[11, "determine-firmware-state"]], "Install components": [[11, "install-components"]], "Rollback trial components": [[11, "rollback-trial-components"]], "Authenticate and execute active firmware": [[11, "authenticate-and-execute-active-firmware"]], "Sample sequence during firmware update": [[11, "sample-sequence-during-firmware-update"]]}, "indexentries": {}})