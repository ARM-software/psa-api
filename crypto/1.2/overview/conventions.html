---
---


<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<meta property="og:title" content="5. Library conventions" />
<meta property="og:type" content="website" />
<meta property="og:url" content="{{ page.url | absolute_url }}" />
<link rel="canonical" href="{{ page.url | absolute_url }}" />
<meta property="og:site_name" content="PSA Certified Crypto API 1.2" />
<meta property="og:description" content="Header files: The header file for the Crypto API has the name psa/crypto.h. All of the API elements that are provided by an implementation must be visible to an application program that includes th..." />
<meta name="description" content="Header files: The header file for the Crypto API has the name psa/crypto.h. All of the API elements that are provided by an implementation must be visible to an application program that includes th..." />

    <title>5. Library conventions &#8212; PSA Certified Crypto API 1.2</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="preconnect" type="text/css" href="https://fonts.googleapis.com" />
    <link rel="preconnect" type="text/css" href="https://fonts.gstatic.com" />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,400;0,700;1,400&display=swap" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6. Implementation considerations" href="implementation.html" />
    <link rel="prev" title="4. Sample architectures" href="sample-arch.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="library-conventions">
<span id="id1"></span><h1><span class="section-number">5. </span>Library conventions<a class="headerlink" href="#library-conventions" title="Permalink to this heading">¶</a></h1>
<section id="header-files">
<h2><span class="section-number">5.1. </span>Header files<a class="headerlink" href="#header-files" title="Permalink to this heading">¶</a></h2>
<p>The header file for the Crypto API has the name <code class="file docutils literal notranslate"><span class="pre">psa/crypto.h</span></code>. All of the API elements that are provided by an implementation must be visible to an application program that includes this header file.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#include &quot;psa/crypto.h&quot;
</pre></div>
</div>
<p>Implementations must provide their own version of the <code class="file docutils literal notranslate"><span class="pre">psa/crypto.h</span></code> header file. Implementations can provide a subset of the API defined in this specification and a subset of the available algorithms. <a class="reference internal" href="../appendix/example_header.html#appendix-example-header"><span class="secref">Example header file</span></a> provides an incomplete, example header file which includes all of the API elements. See also <a class="reference internal" href="implementation.html#implementation-considerations"><span class="secref">Implementation considerations</span></a>.</p>
<p>The Crypto API uses the status code definitions that are shared with the other PSA Certified APIs. <span><em>PSA Certified Status code API</em> <a class="reference internal" href="../about.html#cite-psa-stat"><span class="cite">[PSA-STAT]</span></a></span> defines these status codes in the <code class="file docutils literal notranslate"><span class="pre">psa/error.h</span></code> header file. Applications are not required to explicitly include the <code class="file docutils literal notranslate"><span class="pre">psa/error.h</span></code> header file when using these status codes with the Crypto API. See <a class="reference internal" href="../api/library/status.html#status-codes"><span class="secref">Status codes</span></a>.</p>
</section>
<section id="api-conventions">
<span id="id2"></span><h2><span class="section-number">5.2. </span>API conventions<a class="headerlink" href="#api-conventions" title="Permalink to this heading">¶</a></h2>
<p>The interface in this specification is defined in terms of C macros, data types, and functions.</p>
<section id="identifier-names">
<h3><span class="section-number">5.2.1. </span>Identifier names<a class="headerlink" href="#identifier-names" title="Permalink to this heading">¶</a></h3>
<p>All of the identifiers defined in the Crypto API begin with the prefix <code class="docutils literal notranslate"><span class="pre">psa_</span></code>, for types and functions, or <code class="docutils literal notranslate"><span class="pre">PSA_</span></code> for macros.</p>
<p>Future versions of this specification will use the same prefix for additional API elements. It is recommended that applications and implementations do not use this prefix for their own identifiers, to avoid a potential conflict with a future version of the Crypto API.</p>
</section>
<section id="basic-types">
<h3><span class="section-number">5.2.2. </span>Basic types<a class="headerlink" href="#basic-types" title="Permalink to this heading">¶</a></h3>
<p>This specification makes use of standard C data types, including the fixed-width integer types from the ISO C99 specification update <a class="reference internal" href="../about.html#cite-c99"><span class="cite">[C99]</span></a>. The following standard C types are used:</p>
<table class="colwidths-auto docutils align-left">
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">int32_t</span></code></p></td>
<td><p>a 32-bit signed integer</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">uint8_t</span></code></p></td>
<td><p>an 8-bit unsigned integer</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">uint16_t</span></code></p></td>
<td><p>a 16-bit unsigned integer</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">uint32_t</span></code></p></td>
<td><p>a 32-bit unsigned integer</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">uint64_t</span></code></p></td>
<td><p>a 64-bit unsigned integer</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">size_t</span></code></p></td>
<td><p>an unsigned integer large enough to hold the size of an object in memory</p></td>
</tr>
</tbody>
</table>
</section>
<section id="data-types">
<h3><span class="section-number">5.2.3. </span>Data types<a class="headerlink" href="#data-types" title="Permalink to this heading">¶</a></h3>
<p>Integral types are defined for specific API elements to provide clarity in the interface definition, and to improve code readability. For example, <a class="reference internal" href="../api/ops/algorithms.html#c.psa_algorithm_t" title="psa_algorithm_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_algorithm_t</span></code></a> and <code class="docutils literal notranslate"><span class="pre">psa_status_t</span></code>.</p>
<p>For enum-like integral types, the value <code class="docutils literal notranslate"><span class="pre">0</span></code> is usually reserved by the API to indicate an unspecified or invalid value.</p>
<p>Structure types are declared using <code class="docutils literal notranslate"><span class="pre">typedef</span></code> instead of a <code class="docutils literal notranslate"><span class="pre">struct</span></code> tag, also to improve code readability.</p>
<p>Fully-defined types must be declared exactly as defined in this specification. Types that are not fully defined in this specification must be defined by an implementation. See <a class="reference internal" href="implementation.html#implementation-defined-type"><span class="secref">Implementation-specific types</span></a>.</p>
</section>
<section id="constants">
<h3><span class="section-number">5.2.4. </span>Constants<a class="headerlink" href="#constants" title="Permalink to this heading">¶</a></h3>
<p>Constant values are defined using C macros. Constants defined in this specification have names that are all upper-case.</p>
<p>A constant macro evaluates to a compile-time constant expression.</p>
</section>
<section id="function-like-macros">
<h3><span class="section-number">5.2.5. </span>Function-like macros<a class="headerlink" href="#function-like-macros" title="Permalink to this heading">¶</a></h3>
<p>Function-like macros are C macros that take parameters, providing supporting functionality in the API. Function-like macros defined in this specification have names that are all upper-case.</p>
<p>Function-like macros are permitted to evaluate each argument multiple times or zero times. Providing arguments that have side effects will result in <a class="reference internal" href="../about.html#term-implementation-defined"><span class="scterm">IMPLEMENTATION DEFINED</span></a> behavior, and is non-portable.</p>
<p>If all of the arguments to a function-like macro are compile-time constant expressions, the then result evaluates to a compile-time constant expression.</p>
<p>If an argument to a function-like macro has an invalid value (for example, a value outside the domain of the function-like macro), then the result is <a class="reference internal" href="../about.html#term-implementation-defined"><span class="scterm">IMPLEMENTATION DEFINED</span></a>.</p>
</section>
<section id="functions">
<h3><span class="section-number">5.2.6. </span>Functions<a class="headerlink" href="#functions" title="Permalink to this heading">¶</a></h3>
<p>Functions defined in this specification have names that are all lower-case.</p>
<p>An implementation is permitted to declare any API function with <code class="docutils literal notranslate"><span class="pre">static</span> <span class="pre">inline</span></code> linkage, instead of the default <code class="docutils literal notranslate"><span class="pre">extern</span></code> linkage.</p>
<p>An implementation is permitted to also define a function-like macro with the same name as a function in this specification. If an implementation defines a function-like macro for a function from this specification, then:</p>
<ul class="simple">
<li><p>The implementation must also provide a definition of the function. This enables an application to take the address of a function defined in this specification.</p></li>
<li><p>The function-like macro must expand to code that evaluates each of its arguments exactly once, as if the call was made to a C function. This enables an application to safely use arbitrary expressions as arguments to a function defined in this specification.</p></li>
</ul>
<p>If a non-pointer argument to a function has an invalid value (for example, a value outside the domain of the function), then the function will normally return an error, as specified in the function definition. See also <a class="reference internal" href="#error-handling"><span class="secref">Error handling</span></a>.</p>
<p>If a pointer argument to a function has an invalid value (for example, a pointer outside the address space of the program, or a null pointer), the result is <a class="reference internal" href="../about.html#term-implementation-defined"><span class="scterm">IMPLEMENTATION DEFINED</span></a>. See also <a class="reference internal" href="#pointer-conventions"><span class="secref">Pointer conventions</span></a>.</p>
</section>
</section>
<section id="error-handling">
<span id="id3"></span><h2><span class="section-number">5.3. </span>Error handling<a class="headerlink" href="#error-handling" title="Permalink to this heading">¶</a></h2>
<section id="return-status">
<h3><span class="section-number">5.3.1. </span>Return status<a class="headerlink" href="#return-status" title="Permalink to this heading">¶</a></h3>
<p>Almost all functions return a status indication of type <code class="docutils literal notranslate"><span class="pre">psa_status_t</span></code>. This
is an enumeration of integer values, with <code class="docutils literal notranslate"><span class="pre">0</span></code> (<code class="docutils literal notranslate"><span class="pre">PSA_SUCCESS</span></code>) indicating
successful operation and other values indicating errors. The exceptions are
functions which only access objects that are intended to be implemented as
simple data structures. Such functions cannot fail and either return
<code class="docutils literal notranslate"><span class="pre">void</span></code> or a data value.</p>
<p>Unless specified otherwise, if multiple error conditions apply, an
implementation is free to return any of the applicable error codes. The choice
of error code is considered an implementation quality issue. Different
implementations can make different choices, for example to favor code size over
ease of debugging or vice versa.</p>
<p>If the behavior is undefined, for example, if a function receives an invalid
pointer as a parameter, this specification makes no guarantee that the function
will return an error. Implementations are encouraged to return an error or halt
the application in a manner that is appropriate for the platform if the
undefined behavior condition can be detected. However, application developers need to be aware that undefined behavior conditions cannot be detected in general.</p>
</section>
<section id="behavior-on-error">
<h3><span class="section-number">5.3.2. </span>Behavior on error<a class="headerlink" href="#behavior-on-error" title="Permalink to this heading">¶</a></h3>
<p>In general, function calls must be implemented atomically:</p>
<ul class="simple">
<li><p>When a function returns a type other than <code class="docutils literal notranslate"><span class="pre">psa_status_t</span></code>, the requested
action has been carried out.</p></li>
<li><p>When a function returns the status <code class="docutils literal notranslate"><span class="pre">PSA_SUCCESS</span></code>, the requested action has
been carried out.</p></li>
<li><p>When a function returns another status of type <code class="docutils literal notranslate"><span class="pre">psa_status_t</span></code>, no action
has been carried out. Unless otherwise documented by the API or the
implementation, the content of output parameters is not defined. The state of
the system has not changed, except as described below.</p></li>
</ul>
<p>In general, functions that modify the system state, for example, creating or
destroying a key, must leave the system state unchanged if they return an error
code. There are specific conditions that can result in different behavior:</p>
<ul class="simple">
<li><p>The status <code class="docutils literal notranslate"><span class="pre">PSA_ERROR_BAD_STATE</span></code> indicates that a parameter was not in a
valid state for the requested action. This parameter might have been modified
by the call and is now in an error state. The only valid action on an
object in an error state is to abort it with the appropriate
<code class="docutils literal notranslate"><span class="pre">psa_xxx_abort()</span></code> function. See <a class="reference internal" href="functionality.html#multi-part-operations"><span class="secref">Multi-part operations</span></a>.</p></li>
<li><p>The status <code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INSUFFICIENT_DATA</span></code> indicates that a key
derivation object has reached its maximum capacity. The key derivation
operation might have been modified by the call. Any further attempt to obtain
output from the key derivation operation will return
<code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INSUFFICIENT_DATA</span></code>.</p></li>
<li><p>The status <code class="docutils literal notranslate"><span class="pre">PSA_ERROR_COMMUNICATION_FAILURE</span></code> indicates that the
communication between the application and the cryptoprocessor has broken
down. In this case, the cryptoprocessor must either finish the requested
action successfully, or interrupt the action and roll back the system to its
original state. Because it is often impossible to report the outcome to the
application after a communication failure, this specification does not
provide a way for the application to determine whether the action was
successful.</p></li>
<li><p>The statuses <code class="docutils literal notranslate"><span class="pre">PSA_ERROR_STORAGE_FAILURE</span></code>, <code class="docutils literal notranslate"><span class="pre">PSA_ERROR_DATA_CORRUPT</span></code>, <code class="docutils literal notranslate"><span class="pre">PSA_ERROR_HARDWARE_FAILURE</span></code>
and <code class="docutils literal notranslate"><span class="pre">PSA_ERROR_CORRUPTION_DETECTED</span></code> might indicate data corruption in the
system state. When a function returns one of these statuses, the system state
might have changed from its previous state before the function call, even
though the function call failed.</p></li>
<li><p>Some system states cannot be rolled back, for example, the internal state of
the random number generator or the content of access logs.</p></li>
</ul>
<div class="admonition-implementation-note admonition">
<p class="admonition-title">Implementation note</p>
<p>When a function returns an error status, it is recommended
that implementations set output parameters to safe defaults to avoid leaking
confidential data and limit risk, in case an application does not properly
handle all errors.</p>
</div>
</section>
</section>
<section id="parameter-conventions">
<h2><span class="section-number">5.4. </span>Parameter conventions<a class="headerlink" href="#parameter-conventions" title="Permalink to this heading">¶</a></h2>
<section id="pointer-conventions">
<span id="id4"></span><h3><span class="section-number">5.4.1. </span>Pointer conventions<a class="headerlink" href="#pointer-conventions" title="Permalink to this heading">¶</a></h3>
<p>Unless explicitly stated in the documentation of a function, all pointers must
be valid pointers to an object of the specified type.</p>
<p>A parameter is considered a <strong>buffer</strong> if it points to an array of bytes. A
buffer parameter always has the type <code class="docutils literal notranslate"><span class="pre">uint8_t</span> <span class="pre">*</span></code> or <code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">uint8_t</span> <span class="pre">*</span></code>, and
always has an associated parameter indicating the size of the array. Note that a
parameter of type <code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">*</span></code> is never considered a buffer.</p>
<p>All parameters of pointer type must be valid non-null pointers, unless the
pointer is to a buffer of length <code class="docutils literal notranslate"><span class="pre">0</span></code> or the function’s documentation
explicitly describes the behavior when the pointer is null. Passing a null
pointer as a function parameter in other cases is expected to abort the caller
on implementations where this is the normal behavior for a null pointer
dereference.</p>
<p>Pointers to input parameters can be in read-only memory. Output parameters must
be in writable memory. Output parameters that are not buffers must also be
readable, and the implementation must be able to write to a non-buffer output
parameter and read back the same value, as explained in
<a class="reference internal" href="#stability-of-parameters"><span class="secref">Stability of parameters</span></a>.</p>
</section>
<section id="input-buffer-sizes">
<h3><span class="section-number">5.4.2. </span>Input buffer sizes<a class="headerlink" href="#input-buffer-sizes" title="Permalink to this heading">¶</a></h3>
<p>For input buffers, the parameter convention is:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">uint8_t</span> <span class="pre">*foo</span></code></dt><dd><p>Pointer to the first byte of the data. The pointer
can be invalid if the buffer size is <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">size_t</span> <span class="pre">foo_length</span></code></dt><dd><p>Size of the buffer in bytes.</p>
</dd>
</dl>
<p>The interface never uses input-output buffers.</p>
</section>
<section id="output-buffer-sizes">
<span id="output-buffers"></span><h3><span class="section-number">5.4.3. </span>Output buffer sizes<a class="headerlink" href="#output-buffer-sizes" title="Permalink to this heading">¶</a></h3>
<p>For output buffers, the parameter convention is:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">uint8_t</span> <span class="pre">*foo</span></code></dt><dd><p>Pointer to the first byte of the data. The pointer can be
invalid if the buffer size is <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">size_t</span> <span class="pre">foo_size</span></code></dt><dd><p>The size of the buffer in bytes.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">size_t</span> <span class="pre">*foo_length</span></code></dt><dd><p>On successful return, contains the length of the
output in bytes.</p>
</dd>
</dl>
<p>The content of the data buffer and of <code class="docutils literal notranslate"><span class="pre">*foo_length</span></code> on errors is unspecified,
unless explicitly mentioned in the function description. They might be unmodified
or set to a safe default. On successful completion, the content of the buffer
between the offsets <code class="docutils literal notranslate"><span class="pre">*foo_length</span></code> and <code class="docutils literal notranslate"><span class="pre">foo_size</span></code> is also unspecified.</p>
<p>Functions return <code class="docutils literal notranslate"><span class="pre">PSA_ERROR_BUFFER_TOO_SMALL</span></code> if the buffer size is
insufficient to carry out the requested operation. The interface defines macros
to calculate a sufficient buffer size for each operation that has an output
buffer. These macros return compile-time constants if their arguments are
compile-time constants, so they are suitable for static or stack allocation.
Refer to an individual function’s documentation for the associated output size
macro.</p>
<p>Some functions always return exactly as much data as the size of the output
buffer. In this case, the parameter convention changes to:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">uint8_t</span> <span class="pre">*foo</span></code></dt><dd><p>Pointer to the first byte of the output. The pointer can be
invalid if the buffer size is <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">size_t</span> <span class="pre">foo_length</span></code></dt><dd><p>The number of bytes to return in <code class="docutils literal notranslate"><span class="pre">foo</span></code> if
successful.</p>
</dd>
</dl>
</section>
<section id="overlap-between-parameters">
<span id="buffer-overlap"></span><h3><span class="section-number">5.4.4. </span>Overlap between parameters<a class="headerlink" href="#overlap-between-parameters" title="Permalink to this heading">¶</a></h3>
<p>Output parameters that are not buffers must not overlap with any input buffer or
with any other output parameter. Otherwise, the behavior is undefined.</p>
<p>Output buffers can overlap with input buffers. In this event, the implementation
must return the same result as if the buffers did not overlap. The
implementation must behave as if it had copied all the inputs into temporary
memory, as far as the result is concerned. However, it is possible that overlap
between parameters will affect the performance of a function call. Overlap might
also affect memory management security if the buffer is located in memory that
the caller shares with another security context, as described in
<a class="reference internal" href="#stability-of-parameters"><span class="secref">Stability of parameters</span></a>.</p>
</section>
<section id="stability-of-parameters">
<span id="id5"></span><h3><span class="section-number">5.4.5. </span>Stability of parameters<a class="headerlink" href="#stability-of-parameters" title="Permalink to this heading">¶</a></h3>
<p>In some environments, it is possible for the content of a parameter to change
while a function is executing. It might also be possible for the content of an
output parameter to be read before the function terminates. This can happen if
the application is multithreaded. In some implementations, memory can be shared
between security contexts, for example, between tasks in a multitasking
operating system, between a user land task and the kernel, or between the
Non-secure world and the Secure world of a trusted execution environment.</p>
<p>This section describes the assumptions that an implementation can make about
function parameters, and the guarantees that the implementation must provide
about how it accesses parameters.</p>
<p>Parameters that are not buffers are assumed to be under the caller’s full
control. In a shared memory environment, this means that the parameter must be
in memory that is exclusively accessible by the application. In a multithreaded
environment, this means that the parameter must not be modified during the
execution, and the value of an output parameter is undetermined until the
function returns. The implementation can read an input parameter that is not a
buffer multiple times and expect to read the same data. The implementation can
write to an output parameter that is not a buffer and expect to read back the
value that it last wrote. The implementation has the same permissions on buffers
that overlap with a buffer in the opposite direction.</p>
<p>In an environment with multiple threads or with shared memory, the
implementation carefully accesses non-overlapping buffer parameters in order to
prevent any security risk resulting from the content of the buffer being
modified or observed during the execution of the function. In an input buffer
that does not overlap with an output buffer, the implementation reads each byte
of the input once, at most. The implementation does not read from an output
buffer that does not overlap with an input buffer. Additionally, the
implementation does not write data to a non-overlapping output buffer if this
data is potentially confidential and the implementation has not yet verified
that outputting this data is authorized.</p>
<p>Unless otherwise specified, the implementation must not keep a reference to any
parameter once a function call has returned.</p>
</section>
</section>
<section id="key-types-and-algorithms">
<h2><span class="section-number">5.5. </span>Key types and algorithms<a class="headerlink" href="#key-types-and-algorithms" title="Permalink to this heading">¶</a></h2>
<p>Types of cryptographic keys and cryptographic algorithms are encoded separately.
Each is encoded by using an integral type: <a class="reference internal" href="../api/keys/types.html#c.psa_key_type_t" title="psa_key_type_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_key_type_t</span></code></a> and
<a class="reference internal" href="../api/ops/algorithms.html#c.psa_algorithm_t" title="psa_algorithm_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_algorithm_t</span></code></a>, respectively.</p>
<p>There is some overlap in the information conveyed by key types and algorithms.
Both types contain enough information, so that the meaning of an algorithm type
value does not depend on what type of key it is used with, and vice versa.
However, the particular instance of an algorithm might depend on the key type. For
example, the algorithm <a class="reference internal" href="../api/ops/aead.html#c.PSA_ALG_GCM" title="PSA_ALG_GCM"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_GCM</span></code></a> can be instantiated as any AEAD algorithm
using the GCM mode over a block cipher. The underlying block cipher is
determined by the key type.</p>
<p>Key types do not encode the key size. For example, AES-128, AES-192 and AES-256
share a key type <a class="reference internal" href="../api/keys/types.html#c.PSA_KEY_TYPE_AES" title="PSA_KEY_TYPE_AES"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_AES</span></code></a>.</p>
<section id="structure-of-key-types-and-algorithms">
<h3><span class="section-number">5.5.1. </span>Structure of key types and algorithms<a class="headerlink" href="#structure-of-key-types-and-algorithms" title="Permalink to this heading">¶</a></h3>
<p>Both types use a partial bitmask structure, which allows the analysis and
building of values from parts. However, the interface defines constants, so that
applications do not need to depend on the encoding, and an implementation might
only care about the encoding for code size optimization.</p>
<p>The encodings follows a few conventions:</p>
<ul class="simple">
<li><p>The highest bit is a vendor flag. Current and future versions of this
specification will only define values where this bit is clear.
Implementations that wish to define additional implementation-specific values
must use values where this bit is set, to avoid conflicts with future
versions of this specification.</p></li>
<li><p>The next few highest bits indicate the algorithm or key category:
hash, MAC, symmetric cipher, asymmetric encryption, and so on.</p></li>
<li><p>The following bits identify a family of algorithms or keys in a category-dependent
manner.</p></li>
<li><p>In some categories and algorithm families, the lowest-order bits indicate a
variant in a systematic way. For example, algorithm families that are
parametrized around a hash function encode the hash in the 8 lowest bits.</p></li>
</ul>
<p>The <a class="reference internal" href="../appendix/encodings.html#appendix-encodings"><span class="secref">Algorithm and key type encoding</span></a> appendix provides a full definition of the encoding of key types and algorithm identifiers.</p>
</section>
</section>
<section id="concurrent-calls">
<span id="concurrency"></span><h2><span class="section-number">5.6. </span>Concurrent calls<a class="headerlink" href="#concurrent-calls" title="Permalink to this heading">¶</a></h2>
<p>In some environments, an application can make calls to the Crypto API in
separate threads. In such an environment, <em>concurrent calls</em> are two or more
calls to the API whose execution can overlap in time.</p>
<dl>
<dt><strong>Sequential consistency</strong></dt><dd><p>The result of two or more concurrent calls must be consistent with the
same set of calls being executed sequentially in some order, provided that
the calls obey the following constraints:</p>
<ul class="simple">
<li><p>There is no overlap between an output parameter of one call and an
input or output parameter of another call. Overlap between input
parameters is permitted.</p></li>
<li><p>A call to <a class="reference internal" href="../api/keys/management.html#c.psa_destroy_key" title="psa_destroy_key"><code class="docutils literal notranslate"><span class="pre">psa_destroy_key</span></code></a><code class="docutils literal notranslate"><span class="pre">()</span></code> must not overlap with a concurrent
call to any of the following functions:</p>
<ul>
<li><p>Any call where the same key identifier is a parameter to the call.</p></li>
<li><p>Any call in a multi-part operation, where the same key identifier
was used as a parameter to a previous step in the multi-part
operation.</p></li>
</ul>
</li>
<li><p>Concurrent calls must not use the same operation object.</p></li>
</ul>
<p>If any of these constraints are violated, the behavior is undefined.</p>
<p>The consistency requirement does not apply to errors that arise
from resource failures or limitations. For example, errors resulting from
resource exhaustion can arise in concurrent execution that do not arise in
sequential execution.</p>
<p>As an example of this rule: suppose two calls are executed concurrently
which both attempt to create a new key with the same key identifier that is
not already in the key store. Then:</p>
<ul class="simple">
<li><p>If one call returns <code class="docutils literal notranslate"><span class="pre">PSA_ERROR_ALREADY_EXISTS</span></code>, then the other
call must succeed.</p></li>
<li><p>If one of the calls succeeds, then the other must fail: either with
<code class="docutils literal notranslate"><span class="pre">PSA_ERROR_ALREADY_EXISTS</span></code> or some other error status.</p></li>
<li><p>Both calls can fail with error codes that are not
<code class="docutils literal notranslate"><span class="pre">PSA_ERROR_ALREADY_EXISTS</span></code>.</p></li>
</ul>
</dd>
<dt><strong>Parameter stability</strong></dt><dd><p>If the application concurrently modifies an input parameter while a
function call is in progress, the behavior is undefined.</p>
</dd>
</dl>
<p>Individual implementations can provide additional guarantees.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/Arm_logo_blue_RGB.svg" alt="Logo"/>
            </a></p><hr />
<h3><a href="../index.html"><b>PSA Certified<br />Crypto API</b></a></h3>
IHI 0086<br/>
Non-confidential<br/>
Version 1.2.1
<hr />
<ul>
<li class="toctree-l1"><a class="reference internal" href="../about.html">About this document</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="goals.html">2. Design goals</a></li>
<li class="toctree-l1"><a class="reference internal" href="functionality.html">3. Functionality overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="sample-arch.html">4. Sample architectures</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">5. Library conventions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#header-files">5.1. Header files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#api-conventions">5.2. API conventions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#identifier-names">5.2.1. Identifier names</a></li>
<li class="toctree-l3"><a class="reference internal" href="#basic-types">5.2.2. Basic types</a></li>
<li class="toctree-l3"><a class="reference internal" href="#data-types">5.2.3. Data types</a></li>
<li class="toctree-l3"><a class="reference internal" href="#constants">5.2.4. Constants</a></li>
<li class="toctree-l3"><a class="reference internal" href="#function-like-macros">5.2.5. Function-like macros</a></li>
<li class="toctree-l3"><a class="reference internal" href="#functions">5.2.6. Functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#error-handling">5.3. Error handling</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#return-status">5.3.1. Return status</a></li>
<li class="toctree-l3"><a class="reference internal" href="#behavior-on-error">5.3.2. Behavior on error</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#parameter-conventions">5.4. Parameter conventions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pointer-conventions">5.4.1. Pointer conventions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#input-buffer-sizes">5.4.2. Input buffer sizes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#output-buffer-sizes">5.4.3. Output buffer sizes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#overlap-between-parameters">5.4.4. Overlap between parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#stability-of-parameters">5.4.5. Stability of parameters</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#key-types-and-algorithms">5.5. Key types and algorithms</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#structure-of-key-types-and-algorithms">5.5.1. Structure of key types and algorithms</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#concurrent-calls">5.6. Concurrent calls</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="implementation.html">6. Implementation considerations</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">7. Usage considerations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/library/index.html">8. Library management reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/keys/index.html">9. Key management reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/ops/index.html">10. Cryptographic operation reference</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../appendix/example_header.html">A. Example header file</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/encodings.html">B. Algorithm and key type encoding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/specdef_values.html">C. Example macro implementations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/sra.html">D. Security Risk Assessment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/history.html">E. Changes to the API</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../atg_c-identifiers.html">Index of API elements</a></li>
</ul>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy; 2018-2024 Arm Limited and/or its affiliates.
      
    </div>

    

    
  </body>
</html>