---
---


<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<meta property="og:title" content="2. Password-authenticated key exchange (PAKE)" />
<meta property="og:type" content="website" />
<meta property="og:url" content="{{ page.url | absolute_url }}" />
<link rel="canonical" href="{{ page.url | absolute_url }}" />
<meta property="og:site_name" content="PSA Certified Crypto API 1.2 PAKE Extension" />
<meta property="og:description" content="This chapter is divided into the following sections: Common API for PAKE — the common interface elements, including the PAKE operation., The J-PAKE protocol — the J-PAKE protocol, and the associate..." />
<meta name="description" content="This chapter is divided into the following sections: Common API for PAKE — the common interface elements, including the PAKE operation., The J-PAKE protocol — the J-PAKE protocol, and the associate..." />

    <title>2. Password-authenticated key exchange (PAKE) &#8212; PSA Certified Crypto API 1.2 PAKE Extension</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="preconnect" type="text/css" href="https://fonts.googleapis.com" />
    <link rel="preconnect" type="text/css" href="https://fonts.gstatic.com" />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,400;0,700;1,400&display=swap" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script>window.MathJax = {"chtml": {"mtextInheritFont": true}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3. Algorithm and key type encoding" href="encodings.html" />
    <link rel="prev" title="1. Introduction" href="../overview/intro.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="password-authenticated-key-exchange-pake">
<h1><span class="section-number">2. </span>Password-authenticated key exchange (PAKE)<a class="headerlink" href="#password-authenticated-key-exchange-pake" title="Permalink to this heading">¶</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The API defined in this specification will be integrated into a future version of <a class="reference internal" href="../about.html#cite-psa-crypt"><span class="cite">[PSA-CRYPT]</span></a>.</p>
</div>
<p>This chapter is divided into the following sections:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#pake-common-api"><span class="secref">Common API for PAKE</span></a> — the common interface elements, including the PAKE operation.</p></li>
<li><p><a class="reference internal" href="#pake-jpake"><span class="secref">The J-PAKE protocol</span></a> — the J-PAKE protocol, and the associated interface elements.</p></li>
<li><p><a class="reference internal" href="#pake-spake2p"><span class="secref">The SPAKE2+ protocol</span></a> — the SPAKE2+ protocols, and the associated interface elements.</p></li>
</ul>
<p>PAKE also introduces additional algorithm identifiers and key types to the Crypto API.
See <a class="reference internal" href="encodings.html#pake-encodings"><span class="secref">Algorithm and key type encoding</span></a> for the encoding of these values.</p>
<div class="rationale admonition docutils container">
<p class="admonition-title"><strong>Rationale</strong></p>
<p>PAKE protocols are more complex operations, when compared with the other types of cryptographic operation in the Crypto API.
PAKE protocols can also have multiple phases, some of which are carried out prior to the PAKE operation itself, using other parts of the Crypto API.</p>
<p>To improve the understanding and correct use of PAKE protocols, it helps to show the protocol flow, and to demonstrate how to implement this with this API.</p>
</div>
<section id="common-api-for-pake">
<span id="pake-common-api"></span><h2><span class="section-number">2.1. </span>Common API for PAKE<a class="headerlink" href="#common-api-for-pake" title="Permalink to this heading">¶</a></h2>
<p>This section defines all of the common interfaces used to carry out a PAKE protocol:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#pake-algorithms"><span class="secref">PAKE algorithms</span></a></p></li>
<li><p><a class="reference internal" href="#pake-primitive"><span class="secref">PAKE primitives</span></a></p></li>
<li><p><a class="reference internal" href="#pake-cipher-suite"><span class="secref">PAKE cipher suites</span></a></p></li>
<li><p><a class="reference internal" href="#pake-roles"><span class="secref">PAKE roles</span></a></p></li>
<li><p><a class="reference internal" href="#pake-steps"><span class="secref">PAKE step types</span></a></p></li>
<li><p><a class="reference internal" href="#pake-operation"><span class="secref">Multi-part PAKE operations</span></a></p></li>
<li><p><a class="reference internal" href="#pake-support"><span class="secref">PAKE support macros</span></a></p></li>
</ul>
<section id="pake-algorithms">
<span id="id1"></span><h3><span class="section-number">2.1.1. </span>PAKE algorithms<a class="headerlink" href="#pake-algorithms" title="Permalink to this heading">¶</a></h3>
<section id="c.PSA_ALG_IS_PAKE">
<h4><code class="docutils literal notranslate"><span class="pre">PSA_ALG_IS_PAKE</span></code> (macro)<a class="headerlink" href="#c.PSA_ALG_IS_PAKE" title="Permalink to this heading">¶</a></h4>
<p>Whether the specified algorithm is a password-authenticated key exchange.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ALG_IS_PAKE" title="PSA_ALG_IS_PAKE">PSA_ALG_IS_PAKE</a>(alg) <em><a class="reference internal" href="../appendix/specdef_values.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">alg</span></code></p>
</dt><dd><p>An algorithm identifier: a value of type <code class="docutils literal notranslate"><span class="pre">psa_algorithm_t</span></code>.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns</p>
<p><code class="docutils literal notranslate"><span class="pre">1</span></code> if <code class="docutils literal notranslate"><span class="pre">alg</span></code> is a password-authenticated key exchange (PAKE) algorithm, <code class="docutils literal notranslate"><span class="pre">0</span></code> otherwise.
This macro can return either <code class="docutils literal notranslate"><span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code> if <code class="docutils literal notranslate"><span class="pre">alg</span></code> is not a supported algorithm identifier.</p>
</section>
</section>
<section id="pake-primitives">
<span id="pake-primitive"></span><h3><span class="section-number">2.1.2. </span>PAKE primitives<a class="headerlink" href="#pake-primitives" title="Permalink to this heading">¶</a></h3>
<p>A PAKE algorithm specifies a sequence of interactions between the participants.
Many PAKE algorithms are designed to allow different cryptographic primitives to be used for the key establishment operation, so long as all the participants are using the same underlying cryptography.</p>
<p>The cryptographic primitive for a PAKE operation is specified using a <a class="reference internal" href="#c.psa_pake_primitive_t" title="psa_pake_primitive_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_primitive_t</span></code></a> value, which can be constructed using the <a class="reference internal" href="#c.PSA_PAKE_PRIMITIVE" title="PSA_PAKE_PRIMITIVE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_PRIMITIVE()</span></code></a> macro, or can be provided as a numerical constant value.</p>
<p>A PAKE primitive is required when constructing a PAKE cipher-suite object, <a class="reference internal" href="#c.psa_pake_cipher_suite_t" title="psa_pake_cipher_suite_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_cipher_suite_t</span></code></a>, which fully specifies the PAKE operation to be carried out.</p>
<section id="c.psa_pake_primitive_t">
<h4><code class="docutils literal notranslate"><span class="pre">psa_pake_primitive_t</span></code> (typedef)<a class="headerlink" href="#c.psa_pake_primitive_t" title="Permalink to this heading">¶</a></h4>
<p>Encoding of the primitive associated with the PAKE.</p>
<pre class="literal-block">typedef uint32_t <a class="reference internal" href="#c.psa_pake_primitive_t" title="psa_pake_primitive_t">psa_pake_primitive_t</a>;</pre>
<p>PAKE primitive values are constructed using <a class="reference internal" href="#c.PSA_PAKE_PRIMITIVE" title="PSA_PAKE_PRIMITIVE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_PRIMITIVE()</span></code></a>.</p>
<p><span><a class="reference internal" href="#fig-pake-primitive"><span class="numref">Figure 1</span></a></span> shows how the components of the primitive are encoded into a <a class="reference internal" href="#c.psa_pake_primitive_t" title="psa_pake_primitive_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_primitive_t</span></code></a> value.</p>
<figure class="align-default" id="fig-pake-primitive">
<img alt="../_images/pake_primitive.svg" src="../_images/pake_primitive.svg" /><figcaption>
<p><span class="caption-number">Figure 1 </span><span class="caption-text">PAKE primitive encoding</span><a class="headerlink" href="#fig-pake-primitive" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<div class="rationale admonition docutils container">
<p class="admonition-title"><strong>Rationale</strong></p>
<p>An integral type is required for <a class="reference internal" href="#c.psa_pake_primitive_t" title="psa_pake_primitive_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_primitive_t</span></code></a> to enable values of this type to be compile-time-constants.
This allows them to be used in <code class="docutils literal notranslate"><span class="pre">case</span></code> statements, and used to calculate static buffer sizes with <a class="reference internal" href="#c.PSA_PAKE_OUTPUT_SIZE" title="PSA_PAKE_OUTPUT_SIZE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_OUTPUT_SIZE()</span></code></a> and <a class="reference internal" href="#c.PSA_PAKE_INPUT_SIZE" title="PSA_PAKE_INPUT_SIZE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_INPUT_SIZE()</span></code></a>.</p>
</div>
<p>The components of a PAKE primitive value can be extracted using the <a class="reference internal" href="#c.PSA_PAKE_PRIMITIVE_GET_TYPE" title="PSA_PAKE_PRIMITIVE_GET_TYPE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_PRIMITIVE_GET_TYPE()</span></code></a>, <a class="reference internal" href="#c.PSA_PAKE_PRIMITIVE_GET_FAMILY" title="PSA_PAKE_PRIMITIVE_GET_FAMILY"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_PRIMITIVE_GET_FAMILY()</span></code></a>, and <a class="reference internal" href="#c.PSA_PAKE_PRIMITIVE_GET_BITS" title="PSA_PAKE_PRIMITIVE_GET_BITS"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_PRIMITIVE_GET_BITS()</span></code></a>.
These can be used to set key attributes for keys used in PAKE algorithms.
<a class="reference internal" href="#spake2p-registration"><span class="secref">SPAKE2+ registration</span></a> provides an example of this usage.</p>
</section>
<section id="c.psa_pake_primitive_type_t">
<h4><code class="docutils literal notranslate"><span class="pre">psa_pake_primitive_type_t</span></code> (typedef)<a class="headerlink" href="#c.psa_pake_primitive_type_t" title="Permalink to this heading">¶</a></h4>
<p>Encoding of the type of the PAKE’s primitive.</p>
<pre class="literal-block">typedef uint8_t <a class="reference internal" href="#c.psa_pake_primitive_type_t" title="psa_pake_primitive_type_t">psa_pake_primitive_type_t</a>;</pre>
<p>The range of PAKE primitive type values is divided as follows:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">0</span></code><code class="docutils literal notranslate"><span class="pre">x00</span></code></dt><dd><p>Reserved as an invalid primitive type.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">0</span></code><code class="docutils literal notranslate"><span class="pre">x01</span></code><code class="docutils literal notranslate"> <span class="pre">–</span> <span class="pre">0</span></code><code class="docutils literal notranslate"><span class="pre">x7f</span></code></dt><dd><p>Specification-defined primitive type.
Primitive types defined by this standard always have bit 7 clear.
Unallocated primitive type values in this range are reserved for future use.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">0</span></code><code class="docutils literal notranslate"><span class="pre">x80</span></code><code class="docutils literal notranslate"> <span class="pre">–</span> <span class="pre">0</span></code><code class="docutils literal notranslate"><span class="pre">xff</span></code></dt><dd><p>Implementation-defined primitive type.
Implementations that define additional primitive types must use an encoding with bit 7 set.</p>
</dd>
</dl>
<p>For specification-defined primitive types, see <a class="reference internal" href="#c.PSA_PAKE_PRIMITIVE_TYPE_ECC" title="PSA_PAKE_PRIMITIVE_TYPE_ECC"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_PRIMITIVE_TYPE_ECC</span></code></a> and <a class="reference internal" href="#c.PSA_PAKE_PRIMITIVE_TYPE_DH" title="PSA_PAKE_PRIMITIVE_TYPE_DH"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_PRIMITIVE_TYPE_DH</span></code></a>.</p>
</section>
<section id="c.PSA_PAKE_PRIMITIVE_TYPE_ECC">
<h4><code class="docutils literal notranslate"><span class="pre">PSA_PAKE_PRIMITIVE_TYPE_ECC</span></code> (macro)<a class="headerlink" href="#c.PSA_PAKE_PRIMITIVE_TYPE_ECC" title="Permalink to this heading">¶</a></h4>
<p>The PAKE primitive type indicating the use of elliptic curves.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_PAKE_PRIMITIVE_TYPE_ECC" title="PSA_PAKE_PRIMITIVE_TYPE_ECC">PSA_PAKE_PRIMITIVE_TYPE_ECC</a> ((<a class="reference internal" href="#c.psa_pake_primitive_type_t" title="psa_pake_primitive_type_t">psa_pake_primitive_type_t</a>)0x01)</pre>
<p>The values of the <code class="docutils literal notranslate"><span class="pre">family</span></code> and <code class="docutils literal notranslate"><span class="pre">bits</span></code> components of the PAKE primitive identify a specific elliptic curve, using the same mapping that is used for ECC keys.
See the definition of <code class="docutils literal notranslate"><span class="pre">psa_ecc_family_t</span></code>.
Here <code class="docutils literal notranslate"><span class="pre">family</span></code> and <code class="docutils literal notranslate"><span class="pre">bits</span></code> refer to the values used to construct the PAKE primitive using <a class="reference internal" href="#c.PSA_PAKE_PRIMITIVE" title="PSA_PAKE_PRIMITIVE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_PRIMITIVE()</span></code></a>.</p>
<p>Input and output during the operation can involve group elements and scalar values:</p>
<ul class="simple">
<li><p>The format for group elements is the same as that for public keys on the specific Elliptic curve.
For more information, consult the documentation of key formats in <a class="reference internal" href="../about.html#cite-psa-crypt"><span class="cite atg_c atg_c-cite">[PSA-CRYPT]</span></a>.</p></li>
<li><p>The format for scalars is the same as that for private keys on the specific Elliptic curve.
For more information, consult the documentation of key formats in <a class="reference internal" href="../about.html#cite-psa-crypt"><span class="cite atg_c atg_c-cite">[PSA-CRYPT]</span></a>.</p></li>
</ul>
</section>
<section id="c.PSA_PAKE_PRIMITIVE_TYPE_DH">
<h4><code class="docutils literal notranslate"><span class="pre">PSA_PAKE_PRIMITIVE_TYPE_DH</span></code> (macro)<a class="headerlink" href="#c.PSA_PAKE_PRIMITIVE_TYPE_DH" title="Permalink to this heading">¶</a></h4>
<p>The PAKE primitive type indicating the use of Diffie-Hellman groups.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_PAKE_PRIMITIVE_TYPE_DH" title="PSA_PAKE_PRIMITIVE_TYPE_DH">PSA_PAKE_PRIMITIVE_TYPE_DH</a> ((<a class="reference internal" href="#c.psa_pake_primitive_type_t" title="psa_pake_primitive_type_t">psa_pake_primitive_type_t</a>)0x02)</pre>
<p>The values of the <code class="docutils literal notranslate"><span class="pre">family</span></code> and <code class="docutils literal notranslate"><span class="pre">bits</span></code> components of the PAKE primitive identify a specific Diffie-Hellman group, using the same mapping that is used for Diffie-Hellman keys.
See the definition of <code class="docutils literal notranslate"><span class="pre">psa_dh_family_t</span></code>.
Here <code class="docutils literal notranslate"><span class="pre">family</span></code> and <code class="docutils literal notranslate"><span class="pre">bits</span></code> refer to the values used to construct the PAKE primitive using <a class="reference internal" href="#c.PSA_PAKE_PRIMITIVE" title="PSA_PAKE_PRIMITIVE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_PRIMITIVE()</span></code></a>.</p>
<p>Input and output during the operation can involve group elements and scalar values:</p>
<ul class="simple">
<li><p>The format for group elements is the same as that for public keys in the specific Diffie-Hellman group.
For more information, consult the documentation of key formats in <a class="reference internal" href="../about.html#cite-psa-crypt"><span class="cite atg_c atg_c-cite">[PSA-CRYPT]</span></a>.</p></li>
<li><p>The format for scalars is the same as that for private keys in the specific Diffie-Hellman group.
For more information, consult the documentation of key formats in <a class="reference internal" href="../about.html#cite-psa-crypt"><span class="cite atg_c atg_c-cite">[PSA-CRYPT]</span></a>.</p></li>
</ul>
</section>
<section id="c.psa_pake_family_t">
<h4><code class="docutils literal notranslate"><span class="pre">psa_pake_family_t</span></code> (typedef)<a class="headerlink" href="#c.psa_pake_family_t" title="Permalink to this heading">¶</a></h4>
<p>Encoding of the family of the primitive associated with the PAKE.</p>
<pre class="literal-block">typedef uint8_t <a class="reference internal" href="#c.psa_pake_family_t" title="psa_pake_family_t">psa_pake_family_t</a>;</pre>
<p>For more information on the family values, see <a class="reference internal" href="#c.PSA_PAKE_PRIMITIVE_TYPE_ECC" title="PSA_PAKE_PRIMITIVE_TYPE_ECC"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_PRIMITIVE_TYPE_ECC</span></code></a> and <a class="reference internal" href="#c.PSA_PAKE_PRIMITIVE_TYPE_DH" title="PSA_PAKE_PRIMITIVE_TYPE_DH"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_PRIMITIVE_TYPE_DH</span></code></a>.</p>
</section>
<section id="c.PSA_PAKE_PRIMITIVE">
<h4><code class="docutils literal notranslate"><span class="pre">PSA_PAKE_PRIMITIVE</span></code> (macro)<a class="headerlink" href="#c.PSA_PAKE_PRIMITIVE" title="Permalink to this heading">¶</a></h4>
<p>Construct a PAKE primitive from type, family and bit-size.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_PAKE_PRIMITIVE" title="PSA_PAKE_PRIMITIVE">PSA_PAKE_PRIMITIVE</a>(pake_type, pake_family, pake_bits) \
    <em><a class="reference internal" href="../appendix/specdef_values.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">pake_type</span></code></p>
</dt><dd><p>The type of the primitive: a value of type <a class="reference internal" href="#c.psa_pake_primitive_type_t" title="psa_pake_primitive_type_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_primitive_type_t</span></code></a>.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">pake_family</span></code></p>
</dt><dd><p>The family of the primitive.
The type and interpretation of this parameter depends on <code class="docutils literal notranslate"><span class="pre">pake_type</span></code>.
For more information, see <a class="reference internal" href="#c.PSA_PAKE_PRIMITIVE_TYPE_ECC" title="PSA_PAKE_PRIMITIVE_TYPE_ECC"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_PRIMITIVE_TYPE_ECC</span></code></a> and <a class="reference internal" href="#c.PSA_PAKE_PRIMITIVE_TYPE_DH" title="PSA_PAKE_PRIMITIVE_TYPE_DH"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_PRIMITIVE_TYPE_DH</span></code></a>.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">pake_bits</span></code></p>
</dt><dd><p>The bit-size of the primitive: a value of type <code class="docutils literal notranslate"><span class="pre">size_t</span></code>.
The interpretation of this parameter depends on <code class="docutils literal notranslate"><span class="pre">pake_type</span></code> and <code class="docutils literal notranslate"><span class="pre">family</span></code>.
For more information, see <a class="reference internal" href="#c.PSA_PAKE_PRIMITIVE_TYPE_ECC" title="PSA_PAKE_PRIMITIVE_TYPE_ECC"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_PRIMITIVE_TYPE_ECC</span></code></a> and <a class="reference internal" href="#c.PSA_PAKE_PRIMITIVE_TYPE_DH" title="PSA_PAKE_PRIMITIVE_TYPE_DH"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_PRIMITIVE_TYPE_DH</span></code></a>.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns: <a class="reference internal" href="#c.psa_pake_primitive_t" title="psa_pake_primitive_t"><code class="docutils literal notranslate"><span class="pre">psa_pake_primitive_t</span></code></a></p>
<p>The constructed primitive value.
Return <code class="docutils literal notranslate"><span class="pre">0</span></code> if the requested primitive can’t be encoded as <a class="reference internal" href="#c.psa_pake_primitive_t" title="psa_pake_primitive_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_primitive_t</span></code></a>.</p>
<p class="rubric">Description</p>
<p>A PAKE primitive value is used to specify a PAKE operation, as part of a PAKE cipher suite.</p>
</section>
<section id="c.PSA_PAKE_PRIMITIVE_GET_TYPE">
<h4><code class="docutils literal notranslate"><span class="pre">PSA_PAKE_PRIMITIVE_GET_TYPE</span></code> (macro)<a class="headerlink" href="#c.PSA_PAKE_PRIMITIVE_GET_TYPE" title="Permalink to this heading">¶</a></h4>
<p>Extract the PAKE primitive type from a PAKE primitive.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_PAKE_PRIMITIVE_GET_TYPE" title="PSA_PAKE_PRIMITIVE_GET_TYPE">PSA_PAKE_PRIMITIVE_GET_TYPE</a>(pake_primitive) \
    <em><a class="reference internal" href="../appendix/specdef_values.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">pake_primitive</span></code></p>
</dt><dd><p>A PAKE primitive: a value of type <a class="reference internal" href="#c.psa_pake_primitive_t" title="psa_pake_primitive_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_primitive_t</span></code></a>.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns: <a class="reference internal" href="#c.psa_pake_primitive_type_t" title="psa_pake_primitive_type_t"><code class="docutils literal notranslate"><span class="pre">psa_pake_primitive_type_t</span></code></a></p>
<p>The PAKE primitive type, if <code class="docutils literal notranslate"><span class="pre">pake_primitive</span></code> is a supported PAKE primitive.
Unspecified if <code class="docutils literal notranslate"><span class="pre">pake_primitive</span></code> is not a supported PAKE primitive.</p>
</section>
<section id="c.PSA_PAKE_PRIMITIVE_GET_FAMILY">
<h4><code class="docutils literal notranslate"><span class="pre">PSA_PAKE_PRIMITIVE_GET_FAMILY</span></code> (macro)<a class="headerlink" href="#c.PSA_PAKE_PRIMITIVE_GET_FAMILY" title="Permalink to this heading">¶</a></h4>
<p>Extract the family from a PAKE primitive.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_PAKE_PRIMITIVE_GET_FAMILY" title="PSA_PAKE_PRIMITIVE_GET_FAMILY">PSA_PAKE_PRIMITIVE_GET_FAMILY</a>(pake_primitive) \
    <em><a class="reference internal" href="../appendix/specdef_values.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">pake_primitive</span></code></p>
</dt><dd><p>A PAKE primitive: a value of type <a class="reference internal" href="#c.psa_pake_primitive_t" title="psa_pake_primitive_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_primitive_t</span></code></a>.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns: <a class="reference internal" href="#c.psa_pake_family_t" title="psa_pake_family_t"><code class="docutils literal notranslate"><span class="pre">psa_pake_family_t</span></code></a></p>
<p>The PAKE primitive family, if <code class="docutils literal notranslate"><span class="pre">pake_primitive</span></code> is a supported PAKE primitive.
Unspecified if <code class="docutils literal notranslate"><span class="pre">pake_primitive</span></code> is not a supported PAKE primitive.</p>
<p class="rubric">Description</p>
<p>For more information on the family values, see <a class="reference internal" href="#c.PSA_PAKE_PRIMITIVE_TYPE_ECC" title="PSA_PAKE_PRIMITIVE_TYPE_ECC"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_PRIMITIVE_TYPE_ECC</span></code></a> and <a class="reference internal" href="#c.PSA_PAKE_PRIMITIVE_TYPE_DH" title="PSA_PAKE_PRIMITIVE_TYPE_DH"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_PRIMITIVE_TYPE_DH</span></code></a>.</p>
</section>
<section id="c.PSA_PAKE_PRIMITIVE_GET_BITS">
<h4><code class="docutils literal notranslate"><span class="pre">PSA_PAKE_PRIMITIVE_GET_BITS</span></code> (macro)<a class="headerlink" href="#c.PSA_PAKE_PRIMITIVE_GET_BITS" title="Permalink to this heading">¶</a></h4>
<p>Extract the bit-size from a PAKE primitive.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_PAKE_PRIMITIVE_GET_BITS" title="PSA_PAKE_PRIMITIVE_GET_BITS">PSA_PAKE_PRIMITIVE_GET_BITS</a>(pake_primitive) \
    <em><a class="reference internal" href="../appendix/specdef_values.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">pake_primitive</span></code></p>
</dt><dd><p>A PAKE primitive: a value of type <a class="reference internal" href="#c.psa_pake_primitive_t" title="psa_pake_primitive_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_primitive_t</span></code></a>.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns: <code class="docutils literal notranslate"><span class="pre">size_t</span></code></p>
<p>The PAKE primitive bit-size, if <code class="docutils literal notranslate"><span class="pre">pake_primitive</span></code> is a supported PAKE primitive.
Unspecified if <code class="docutils literal notranslate"><span class="pre">pake_primitive</span></code> is not a supported PAKE primitive.</p>
<p class="rubric">Description</p>
<p>For more information on the bit-size values, see <a class="reference internal" href="#c.PSA_PAKE_PRIMITIVE_TYPE_ECC" title="PSA_PAKE_PRIMITIVE_TYPE_ECC"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_PRIMITIVE_TYPE_ECC</span></code></a> and <a class="reference internal" href="#c.PSA_PAKE_PRIMITIVE_TYPE_DH" title="PSA_PAKE_PRIMITIVE_TYPE_DH"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_PRIMITIVE_TYPE_DH</span></code></a>.</p>
</section>
</section>
<section id="pake-cipher-suites">
<span id="pake-cipher-suite"></span><h3><span class="section-number">2.1.3. </span>PAKE cipher suites<a class="headerlink" href="#pake-cipher-suites" title="Permalink to this heading">¶</a></h3>
<p>Most PAKE algorithms have parameters that must be specified by the application.
These parameters include the following:</p>
<ul class="simple">
<li><p>The cryptographic primitive used for key establishment, specified using a <a class="reference internal" href="#pake-primitive"><span class="std std-ref">PAKE primitive</span></a>.</p></li>
<li><p>A cryptographic hash algorithm.</p></li>
<li><p>Whether the application requires the shared secret before, or after, it is confirmed.</p></li>
</ul>
<p>The hash algorithm is encoded into the PAKE algorithm identifier. The <a class="reference internal" href="#c.psa_pake_cipher_suite_t" title="psa_pake_cipher_suite_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_cipher_suite_t</span></code></a> object is used to fully specify a PAKE operation, combining the PAKE protocol with all of the above parameters.</p>
<p>A PAKE cipher suite is required when setting up a PAKE operation in <a class="reference internal" href="#c.psa_pake_setup" title="psa_pake_setup"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_setup()</span></code></a>.</p>
<section id="c.psa_pake_cipher_suite_t">
<h4><code class="docutils literal notranslate"><span class="pre">psa_pake_cipher_suite_t</span></code> (typedef)<a class="headerlink" href="#c.psa_pake_cipher_suite_t" title="Permalink to this heading">¶</a></h4>
<p>The type of an object describing a PAKE cipher suite.</p>
<pre class="literal-block">typedef <em>/* implementation-defined type */</em> <a class="reference internal" href="#c.psa_pake_cipher_suite_t" title="psa_pake_cipher_suite_t">psa_pake_cipher_suite_t</a>;</pre>
<p>This is the object that represents the cipher suite used for a PAKE algorithm.
The PAKE cipher suite specifies the PAKE algorithm, and the options selected for that algorithm.
The cipher suite includes the following attributes:</p>
<ul class="simple">
<li><p>The PAKE algorithm itself.</p></li>
<li><p>The hash algorithm, encoded within the PAKE algorithm.</p></li>
<li><p>The PAKE primitive, which identifies the prime order group used for the key exchange operation.
See <a class="reference internal" href="#pake-primitive"><span class="secref">PAKE primitives</span></a>.</p></li>
<li><p>Whether to confirm the shared secret.</p></li>
</ul>
<p>This is an implementation-defined type.
Applications that make assumptions about the content of this object will result in implementation-specific behavior, and are non-portable.</p>
<p>Before calling any function on a PAKE cipher suite object, the application must initialize it by any of the following means:</p>
<ul>
<li><p>Set the object to all-bits-zero, for example:</p>
<pre class="literal-block"><a class="reference internal" href="#c.psa_pake_cipher_suite_t" title="psa_pake_cipher_suite_t">psa_pake_cipher_suite_t</a> cipher_suite;
memset(&amp;cipher_suite, 0, sizeof(cipher_suite));</pre>
</li>
<li><p>Initialize the object to logical zero values by declaring the object as static or global without an explicit initializer, for example:</p>
<pre class="literal-block">static <a class="reference internal" href="#c.psa_pake_cipher_suite_t" title="psa_pake_cipher_suite_t">psa_pake_cipher_suite_t</a> cipher_suite;</pre>
</li>
<li><p>Initialize the object to the initializer <a class="reference internal" href="#c.PSA_PAKE_CIPHER_SUITE_INIT" title="PSA_PAKE_CIPHER_SUITE_INIT"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_CIPHER_SUITE_INIT</span></code></a>, for example:</p>
<pre class="literal-block"><a class="reference internal" href="#c.psa_pake_cipher_suite_t" title="psa_pake_cipher_suite_t">psa_pake_cipher_suite_t</a> cipher_suite = <a class="reference internal" href="#c.PSA_PAKE_CIPHER_SUITE_INIT" title="PSA_PAKE_CIPHER_SUITE_INIT">PSA_PAKE_CIPHER_SUITE_INIT</a>;</pre>
</li>
<li><p>Assign the result of the function <a class="reference internal" href="#c.psa_pake_cipher_suite_init" title="psa_pake_cipher_suite_init"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_cipher_suite_init()</span></code></a> to the object, for example:</p>
<pre class="literal-block"><a class="reference internal" href="#c.psa_pake_cipher_suite_t" title="psa_pake_cipher_suite_t">psa_pake_cipher_suite_t</a> cipher_suite;
cipher_suite = <a class="reference internal" href="#c.psa_pake_cipher_suite_init" title="psa_pake_cipher_suite_init">psa_pake_cipher_suite_init</a>();</pre>
</li>
</ul>
<p>Following initialization, the cipher-suite object contains the following values:</p>
<table class="colwidths-given docutils align-left">
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Attribute</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>algorithm</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">PSA_ALG_NONE</span></code> — an invalid algorithm identifier.</p></td>
</tr>
<tr class="row-odd"><td><p>primitive</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0</span></code> — an invalid PAKE primitive.</p></td>
</tr>
<tr class="row-even"><td><p>key confirmation</p></td>
<td><p><a class="reference internal" href="#c.PSA_PAKE_CONFIRMED_KEY" title="PSA_PAKE_CONFIRMED_KEY"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_CONFIRMED_KEY</span></code></a> — requesting that the secret key is confirmed before it can be returned.</p></td>
</tr>
</tbody>
</table>
<p>Valid algorithm, primitive, and key confirmation values must be set when using a PAKE cipher suite.</p>
<div class="admonition-implementation-note admonition">
<p class="admonition-title">Implementation note</p>
<p>Implementations are recommended to define the cipher-suite object as a simple data structure, with fields corresponding to the individual cipher suite attributes.
In such an implementation, each function <code class="docutils literal notranslate"><span class="pre">psa_pake_cs_set_xxx()</span></code> sets a field and the corresponding function <code class="docutils literal notranslate"><span class="pre">psa_pake_cs_get_xxx()</span></code> retrieves the value of the field.</p>
<p>An implementation can report attribute values that are equivalent to the original one, but have a different encoding.
For example, an implementation can use a more compact representation for attributes where many bit-patterns are invalid or not supported, and store all values that it does not support as a special marker value.
In such an implementation, after setting an invalid value, the corresponding get function returns an invalid value which might not be the one that was originally stored.</p>
</div>
</section>
<section id="c.PSA_PAKE_CIPHER_SUITE_INIT">
<h4><code class="docutils literal notranslate"><span class="pre">PSA_PAKE_CIPHER_SUITE_INIT</span></code> (macro)<a class="headerlink" href="#c.PSA_PAKE_CIPHER_SUITE_INIT" title="Permalink to this heading">¶</a></h4>
<p>This macro returns a suitable initializer for a PAKE cipher suite object of type <a class="reference internal" href="#c.psa_pake_cipher_suite_t" title="psa_pake_cipher_suite_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_cipher_suite_t</span></code></a>.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_PAKE_CIPHER_SUITE_INIT" title="PSA_PAKE_CIPHER_SUITE_INIT">PSA_PAKE_CIPHER_SUITE_INIT</a> <em>/* implementation-defined value */</em></pre>
</section>
<section id="c.psa_pake_cipher_suite_init">
<h4><code class="docutils literal notranslate"><span class="pre">psa_pake_cipher_suite_init</span></code> (function)<a class="headerlink" href="#c.psa_pake_cipher_suite_init" title="Permalink to this heading">¶</a></h4>
<p>Return an initial value for a PAKE cipher suite object.</p>
<pre class="literal-block"><a class="reference internal" href="#c.psa_pake_cipher_suite_t" title="psa_pake_cipher_suite_t">psa_pake_cipher_suite_t</a> <a class="reference internal" href="#c.psa_pake_cipher_suite_init" title="psa_pake_cipher_suite_init">psa_pake_cipher_suite_init</a>(void);</pre>
<p class="rubric">Returns: <a class="reference internal" href="#c.psa_pake_cipher_suite_t" title="psa_pake_cipher_suite_t"><code class="docutils literal notranslate"><span class="pre">psa_pake_cipher_suite_t</span></code></a></p>
</section>
<section id="c.psa_pake_cs_get_algorithm">
<h4><code class="docutils literal notranslate"><span class="pre">psa_pake_cs_get_algorithm</span></code> (function)<a class="headerlink" href="#c.psa_pake_cs_get_algorithm" title="Permalink to this heading">¶</a></h4>
<p>Retrieve the PAKE algorithm from a PAKE cipher suite.</p>
<pre class="literal-block">psa_algorithm_t <a class="reference internal" href="#c.psa_pake_cs_get_algorithm" title="psa_pake_cs_get_algorithm">psa_pake_cs_get_algorithm</a>(const <a class="reference internal" href="#c.psa_pake_cipher_suite_t" title="psa_pake_cipher_suite_t">psa_pake_cipher_suite_t</a>* cipher_suite);</pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">cipher_suite</span></code></p>
</dt><dd><p>The cipher suite object to query.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns: <code class="docutils literal notranslate"><span class="pre">psa_algorithm_t</span></code></p>
<p>The PAKE algorithm stored in the cipher suite object.</p>
<p class="rubric">Description</p>
<div class="admonition-implementation-note admonition">
<p class="admonition-title">Implementation note</p>
<p>This is a simple accessor function that is not required to validate its inputs.
It can be efficiently implemented as a <code class="docutils literal notranslate"><span class="pre">static</span> <span class="pre">inline</span></code> function or a function-like macro.</p>
</div>
</section>
<section id="c.psa_pake_cs_set_algorithm">
<h4><code class="docutils literal notranslate"><span class="pre">psa_pake_cs_set_algorithm</span></code> (function)<a class="headerlink" href="#c.psa_pake_cs_set_algorithm" title="Permalink to this heading">¶</a></h4>
<p>Declare the PAKE algorithm for the cipher suite.</p>
<pre class="literal-block">void <a class="reference internal" href="#c.psa_pake_cs_set_algorithm" title="psa_pake_cs_set_algorithm">psa_pake_cs_set_algorithm</a>(<a class="reference internal" href="#c.psa_pake_cipher_suite_t" title="psa_pake_cipher_suite_t">psa_pake_cipher_suite_t</a>* cipher_suite,
                               psa_algorithm_t alg);</pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">cipher_suite</span></code></p>
</dt><dd><p>The cipher suite object to write to.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">alg</span></code></p>
</dt><dd><p>The PAKE algorithm to write: a value of type <code class="docutils literal notranslate"><span class="pre">psa_algorithm_t</span></code> such that <a class="reference internal" href="#c.PSA_ALG_IS_PAKE" title="PSA_ALG_IS_PAKE"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_IS_PAKE</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> is true.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns: <code class="docutils literal notranslate"><span class="pre">void</span></code></p>
<p class="rubric">Description</p>
<p>This function overwrites any PAKE algorithm previously set in <code class="docutils literal notranslate"><span class="pre">cipher_suite</span></code>.</p>
<div class="admonition-implementation-note admonition">
<p class="admonition-title">Implementation note</p>
<p>This is a simple accessor function that is not required to validate its inputs.
It can be efficiently implemented as a <code class="docutils literal notranslate"><span class="pre">static</span> <span class="pre">inline</span></code> function or a function-like macro.</p>
</div>
</section>
<section id="c.psa_pake_cs_get_primitive">
<h4><code class="docutils literal notranslate"><span class="pre">psa_pake_cs_get_primitive</span></code> (function)<a class="headerlink" href="#c.psa_pake_cs_get_primitive" title="Permalink to this heading">¶</a></h4>
<p>Retrieve the primitive from a PAKE cipher suite.</p>
<pre class="literal-block"><a class="reference internal" href="#c.psa_pake_primitive_t" title="psa_pake_primitive_t">psa_pake_primitive_t</a> <a class="reference internal" href="#c.psa_pake_cs_get_primitive" title="psa_pake_cs_get_primitive">psa_pake_cs_get_primitive</a>(const <a class="reference internal" href="#c.psa_pake_cipher_suite_t" title="psa_pake_cipher_suite_t">psa_pake_cipher_suite_t</a>* cipher_suite);</pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">cipher_suite</span></code></p>
</dt><dd><p>The cipher suite object to query.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns: <a class="reference internal" href="#c.psa_pake_primitive_t" title="psa_pake_primitive_t"><code class="docutils literal notranslate"><span class="pre">psa_pake_primitive_t</span></code></a></p>
<p>The primitive stored in the cipher suite object.</p>
<p class="rubric">Description</p>
<div class="admonition-implementation-note admonition">
<p class="admonition-title">Implementation note</p>
<p>This is a simple accessor function that is not required to validate its inputs.
It can be efficiently implemented as a <code class="docutils literal notranslate"><span class="pre">static</span> <span class="pre">inline</span></code> function or a function-like macro.</p>
</div>
</section>
<section id="c.psa_pake_cs_set_primitive">
<h4><code class="docutils literal notranslate"><span class="pre">psa_pake_cs_set_primitive</span></code> (function)<a class="headerlink" href="#c.psa_pake_cs_set_primitive" title="Permalink to this heading">¶</a></h4>
<p>Declare the primitive for a PAKE cipher suite.</p>
<pre class="literal-block">void <a class="reference internal" href="#c.psa_pake_cs_set_primitive" title="psa_pake_cs_set_primitive">psa_pake_cs_set_primitive</a>(<a class="reference internal" href="#c.psa_pake_cipher_suite_t" title="psa_pake_cipher_suite_t">psa_pake_cipher_suite_t</a>* cipher_suite,
                               <a class="reference internal" href="#c.psa_pake_primitive_t" title="psa_pake_primitive_t">psa_pake_primitive_t</a> primitive);</pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">cipher_suite</span></code></p>
</dt><dd><p>The cipher suite object to write to.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">primitive</span></code></p>
</dt><dd><p>The PAKE primitive to write: a value of type <a class="reference internal" href="#c.psa_pake_primitive_t" title="psa_pake_primitive_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_primitive_t</span></code></a>.
If this is <code class="docutils literal notranslate"><span class="pre">0</span></code>, the primitive type in <code class="docutils literal notranslate"><span class="pre">cipher_suite</span></code> becomes unspecified.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns: <code class="docutils literal notranslate"><span class="pre">void</span></code></p>
<p class="rubric">Description</p>
<p>This function overwrites any primitive previously set in <code class="docutils literal notranslate"><span class="pre">cipher_suite</span></code>.</p>
<div class="admonition-implementation-note admonition">
<p class="admonition-title">Implementation note</p>
<p>This is a simple accessor function that is not required to validate its inputs.
It can be efficiently implemented as a <code class="docutils literal notranslate"><span class="pre">static</span> <span class="pre">inline</span></code> function or a function-like macro.</p>
</div>
</section>
<section id="c.PSA_PAKE_CONFIRMED_KEY">
<h4><code class="docutils literal notranslate"><span class="pre">PSA_PAKE_CONFIRMED_KEY</span></code> (macro)<a class="headerlink" href="#c.PSA_PAKE_CONFIRMED_KEY" title="Permalink to this heading">¶</a></h4>
<p>A key confirmation value that indicates an confirmed key in a PAKE cipher suite.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_PAKE_CONFIRMED_KEY" title="PSA_PAKE_CONFIRMED_KEY">PSA_PAKE_CONFIRMED_KEY</a> 0</pre>
<p>This key confirmation value will result in the PAKE algorithm exchanging data to verify that the shared key is identical for both parties.
This is the default key confirmation value in an initialized PAKE cipher suite object.</p>
<p>Some algorithms do not include confirmation of the shared key.</p>
</section>
<section id="c.PSA_PAKE_UNCONFIRMED_KEY">
<h4><code class="docutils literal notranslate"><span class="pre">PSA_PAKE_UNCONFIRMED_KEY</span></code> (macro)<a class="headerlink" href="#c.PSA_PAKE_UNCONFIRMED_KEY" title="Permalink to this heading">¶</a></h4>
<p>A key confirmation value that indicates an unconfirmed key in a PAKE cipher suite.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_PAKE_UNCONFIRMED_KEY" title="PSA_PAKE_UNCONFIRMED_KEY">PSA_PAKE_UNCONFIRMED_KEY</a> 1</pre>
<p>This key confirmation value will result in the PAKE algorithm terminating prior to confirming that the resulting shared key is identical for both parties.</p>
<p>Some algorithms do not support returning an unconfirmed shared key.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When the shared key is not confirmed as part of the PAKE operation, the application is responsible for mitigating risks that arise from the possible mismatch in the output keys.</p>
</div>
</section>
<section id="c.psa_pake_cs_get_key_confirmation">
<h4><code class="docutils literal notranslate"><span class="pre">psa_pake_cs_get_key_confirmation</span></code> (function)<a class="headerlink" href="#c.psa_pake_cs_get_key_confirmation" title="Permalink to this heading">¶</a></h4>
<p>Retrieve the key confirmation from a PAKE cipher suite.</p>
<pre class="literal-block">uint32_t <a class="reference internal" href="#c.psa_pake_cs_get_key_confirmation" title="psa_pake_cs_get_key_confirmation">psa_pake_cs_get_key_confirmation</a>(const <a class="reference internal" href="#c.psa_pake_cipher_suite_t" title="psa_pake_cipher_suite_t">psa_pake_cipher_suite_t</a>* cipher_suite);</pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">cipher_suite</span></code></p>
</dt><dd><p>The cipher suite object to query.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns: <code class="docutils literal notranslate"><span class="pre">uint32_t</span></code></p>
<p>A key confirmation value: either <a class="reference internal" href="#c.PSA_PAKE_CONFIRMED_KEY" title="PSA_PAKE_CONFIRMED_KEY"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_CONFIRMED_KEY</span></code></a> or <a class="reference internal" href="#c.PSA_PAKE_UNCONFIRMED_KEY" title="PSA_PAKE_UNCONFIRMED_KEY"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_UNCONFIRMED_KEY</span></code></a>.</p>
<p class="rubric">Description</p>
<div class="admonition-implementation-note admonition">
<p class="admonition-title">Implementation note</p>
<p>This is a simple accessor function that is not required to validate its inputs.
It can be efficiently implemented as a <code class="docutils literal notranslate"><span class="pre">static</span> <span class="pre">inline</span></code> function or a function-like macro.</p>
</div>
</section>
<section id="c.psa_pake_cs_set_key_confirmation">
<h4><code class="docutils literal notranslate"><span class="pre">psa_pake_cs_set_key_confirmation</span></code> (function)<a class="headerlink" href="#c.psa_pake_cs_set_key_confirmation" title="Permalink to this heading">¶</a></h4>
<p>Declare the key confirmation from a PAKE cipher suite.</p>
<pre class="literal-block">void <a class="reference internal" href="#c.psa_pake_cs_set_key_confirmation" title="psa_pake_cs_set_key_confirmation">psa_pake_cs_set_key_confirmation</a>(<a class="reference internal" href="#c.psa_pake_cipher_suite_t" title="psa_pake_cipher_suite_t">psa_pake_cipher_suite_t</a>* cipher_suite,
                                      uint32_t key_confirmation);</pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">cipher_suite</span></code></p>
</dt><dd><p>The cipher suite object to write to.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">key_confirmation</span></code></p>
</dt><dd><p>The key confirmation value to write: either <a class="reference internal" href="#c.PSA_PAKE_CONFIRMED_KEY" title="PSA_PAKE_CONFIRMED_KEY"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_CONFIRMED_KEY</span></code></a> or <a class="reference internal" href="#c.PSA_PAKE_UNCONFIRMED_KEY" title="PSA_PAKE_UNCONFIRMED_KEY"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_UNCONFIRMED_KEY</span></code></a>.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns: <code class="docutils literal notranslate"><span class="pre">void</span></code></p>
<p class="rubric">Description</p>
<p>This function overwrites any key confirmation previously set in <code class="docutils literal notranslate"><span class="pre">cipher_suite</span></code>.</p>
<p>The documentation of individual PAKE algorithms specifies which key confirmation values are valid for the algorithm.</p>
<div class="admonition-implementation-note admonition">
<p class="admonition-title">Implementation note</p>
<p>This is a simple accessor function that is not required to validate its inputs.
It can be efficiently implemented as a <code class="docutils literal notranslate"><span class="pre">static</span> <span class="pre">inline</span></code> function or a function-like macro.</p>
</div>
</section>
</section>
<section id="pake-roles">
<span id="id2"></span><h3><span class="section-number">2.1.4. </span>PAKE roles<a class="headerlink" href="#pake-roles" title="Permalink to this heading">¶</a></h3>
<p>Some PAKE algorithms need to know which role each participant is taking in the algorithm.
For example:</p>
<ul class="simple">
<li><p>Augmented PAKE algorithms typically have a client and a server participant.</p></li>
<li><p>Some symmetric PAKE algorithms assign an order to the two participants.</p></li>
</ul>
<section id="c.psa_pake_role_t">
<h4><code class="docutils literal notranslate"><span class="pre">psa_pake_role_t</span></code> (typedef)<a class="headerlink" href="#c.psa_pake_role_t" title="Permalink to this heading">¶</a></h4>
<p>Encoding of the application role in a PAKE algorithm.</p>
<pre class="literal-block">typedef uint8_t <a class="reference internal" href="#c.psa_pake_role_t" title="psa_pake_role_t">psa_pake_role_t</a>;</pre>
<p>This type is used to encode the application’s role in the algorithm being executed.
For more information see the documentation of individual PAKE role constants.</p>
</section>
<section id="c.PSA_PAKE_ROLE_NONE">
<h4><code class="docutils literal notranslate"><span class="pre">PSA_PAKE_ROLE_NONE</span></code> (macro)<a class="headerlink" href="#c.PSA_PAKE_ROLE_NONE" title="Permalink to this heading">¶</a></h4>
<p>A value to indicate no role in a PAKE algorithm.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_PAKE_ROLE_NONE" title="PSA_PAKE_ROLE_NONE">PSA_PAKE_ROLE_NONE</a> ((<a class="reference internal" href="#c.psa_pake_role_t" title="psa_pake_role_t">psa_pake_role_t</a>)0x00)</pre>
<p>This value can be used in a call to <a class="reference internal" href="#c.psa_pake_set_role" title="psa_pake_set_role"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_set_role()</span></code></a> for symmetric PAKE algorithms which do not assign roles.</p>
</section>
<section id="c.PSA_PAKE_ROLE_FIRST">
<h4><code class="docutils literal notranslate"><span class="pre">PSA_PAKE_ROLE_FIRST</span></code> (macro)<a class="headerlink" href="#c.PSA_PAKE_ROLE_FIRST" title="Permalink to this heading">¶</a></h4>
<p>The first peer in a balanced PAKE.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_PAKE_ROLE_FIRST" title="PSA_PAKE_ROLE_FIRST">PSA_PAKE_ROLE_FIRST</a> ((<a class="reference internal" href="#c.psa_pake_role_t" title="psa_pake_role_t">psa_pake_role_t</a>)0x01)</pre>
<p>Although balanced PAKE algorithms are symmetric, some of them need the peers to be ordered for the transcript calculations.
If the algorithm does not need a specific ordering, then either do not call <a class="reference internal" href="#c.psa_pake_set_role" title="psa_pake_set_role"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_set_role()</span></code></a>, or use <a class="reference internal" href="#c.PSA_PAKE_ROLE_NONE" title="PSA_PAKE_ROLE_NONE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_ROLE_NONE</span></code></a> as the role parameter.</p>
</section>
<section id="c.PSA_PAKE_ROLE_SECOND">
<h4><code class="docutils literal notranslate"><span class="pre">PSA_PAKE_ROLE_SECOND</span></code> (macro)<a class="headerlink" href="#c.PSA_PAKE_ROLE_SECOND" title="Permalink to this heading">¶</a></h4>
<p>The second peer in a balanced PAKE.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_PAKE_ROLE_SECOND" title="PSA_PAKE_ROLE_SECOND">PSA_PAKE_ROLE_SECOND</a> ((<a class="reference internal" href="#c.psa_pake_role_t" title="psa_pake_role_t">psa_pake_role_t</a>)0x02)</pre>
<p>Although balanced PAKE algorithms are symmetric, some of them need the peers to be ordered for the transcript calculations.
If the algorithm does not need a specific ordering, then either do not call <a class="reference internal" href="#c.psa_pake_set_role" title="psa_pake_set_role"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_set_role()</span></code></a>, or use <a class="reference internal" href="#c.PSA_PAKE_ROLE_NONE" title="PSA_PAKE_ROLE_NONE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_ROLE_NONE</span></code></a> as the role parameter.</p>
</section>
<section id="c.PSA_PAKE_ROLE_CLIENT">
<h4><code class="docutils literal notranslate"><span class="pre">PSA_PAKE_ROLE_CLIENT</span></code> (macro)<a class="headerlink" href="#c.PSA_PAKE_ROLE_CLIENT" title="Permalink to this heading">¶</a></h4>
<p>The client in an augmented PAKE.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_PAKE_ROLE_CLIENT" title="PSA_PAKE_ROLE_CLIENT">PSA_PAKE_ROLE_CLIENT</a> ((<a class="reference internal" href="#c.psa_pake_role_t" title="psa_pake_role_t">psa_pake_role_t</a>)0x11)</pre>
<p>Augmented PAKE algorithms need to differentiate between client and server.</p>
</section>
<section id="c.PSA_PAKE_ROLE_SERVER">
<h4><code class="docutils literal notranslate"><span class="pre">PSA_PAKE_ROLE_SERVER</span></code> (macro)<a class="headerlink" href="#c.PSA_PAKE_ROLE_SERVER" title="Permalink to this heading">¶</a></h4>
<p>The server in an augmented PAKE.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_PAKE_ROLE_SERVER" title="PSA_PAKE_ROLE_SERVER">PSA_PAKE_ROLE_SERVER</a> ((<a class="reference internal" href="#c.psa_pake_role_t" title="psa_pake_role_t">psa_pake_role_t</a>)0x12)</pre>
<p>Augmented PAKE algorithms need to differentiate between client and server.</p>
</section>
</section>
<section id="pake-step-types">
<span id="pake-steps"></span><h3><span class="section-number">2.1.5. </span>PAKE step types<a class="headerlink" href="#pake-step-types" title="Permalink to this heading">¶</a></h3>
<section id="c.psa_pake_step_t">
<h4><code class="docutils literal notranslate"><span class="pre">psa_pake_step_t</span></code> (typedef)<a class="headerlink" href="#c.psa_pake_step_t" title="Permalink to this heading">¶</a></h4>
<p>Encoding of input and output steps for a PAKE algorithm.</p>
<pre class="literal-block">typedef uint8_t <a class="reference internal" href="#c.psa_pake_step_t" title="psa_pake_step_t">psa_pake_step_t</a>;</pre>
<p>Some PAKE algorithms need to exchange more data than a single key share.
This type encodes additional input and output steps for such algorithms.</p>
</section>
<section id="c.PSA_PAKE_STEP_KEY_SHARE">
<h4><code class="docutils literal notranslate"><span class="pre">PSA_PAKE_STEP_KEY_SHARE</span></code> (macro)<a class="headerlink" href="#c.PSA_PAKE_STEP_KEY_SHARE" title="Permalink to this heading">¶</a></h4>
<p>The key share being sent to or received from the peer.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_PAKE_STEP_KEY_SHARE" title="PSA_PAKE_STEP_KEY_SHARE">PSA_PAKE_STEP_KEY_SHARE</a> ((<a class="reference internal" href="#c.psa_pake_step_t" title="psa_pake_step_t">psa_pake_step_t</a>)0x01)</pre>
<p>The format for both input and output using this step is the same as the format for public keys on the group specified by the PAKE operation’s primitive.</p>
<p>The public key formats are defined in the documentation for <code class="docutils literal notranslate"><span class="pre">psa_export_public_key</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code>.</p>
<p>For information regarding how the group is determined, consult the documentation <a class="reference internal" href="#c.PSA_PAKE_PRIMITIVE" title="PSA_PAKE_PRIMITIVE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_PRIMITIVE()</span></code></a>.</p>
</section>
<section id="c.PSA_PAKE_STEP_ZK_PUBLIC">
<h4><code class="docutils literal notranslate"><span class="pre">PSA_PAKE_STEP_ZK_PUBLIC</span></code> (macro)<a class="headerlink" href="#c.PSA_PAKE_STEP_ZK_PUBLIC" title="Permalink to this heading">¶</a></h4>
<p>A Schnorr NIZKP public key.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_PAKE_STEP_ZK_PUBLIC" title="PSA_PAKE_STEP_ZK_PUBLIC">PSA_PAKE_STEP_ZK_PUBLIC</a> ((<a class="reference internal" href="#c.psa_pake_step_t" title="psa_pake_step_t">psa_pake_step_t</a>)0x02)</pre>
<p>This is the ephemeral public key in the Schnorr Non-Interactive Zero-Knowledge Proof, this is the value denoted by <em>V</em> in <a class="reference internal" href="../about.html#cite-rfc8235"><span class="cite">[RFC8235]</span></a>.</p>
<p>The format for both input and output at this step is the same as that for public keys on the group specified by the PAKE operation’s primitive.</p>
<p>For more information on the format, consult the documentation of <code class="docutils literal notranslate"><span class="pre">psa_export_public_key</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code>.</p>
<p>For information regarding how the group is determined, consult the documentation <a class="reference internal" href="#c.PSA_PAKE_PRIMITIVE" title="PSA_PAKE_PRIMITIVE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_PRIMITIVE()</span></code></a>.</p>
</section>
<section id="c.PSA_PAKE_STEP_ZK_PROOF">
<h4><code class="docutils literal notranslate"><span class="pre">PSA_PAKE_STEP_ZK_PROOF</span></code> (macro)<a class="headerlink" href="#c.PSA_PAKE_STEP_ZK_PROOF" title="Permalink to this heading">¶</a></h4>
<p>A Schnorr NIZKP proof.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_PAKE_STEP_ZK_PROOF" title="PSA_PAKE_STEP_ZK_PROOF">PSA_PAKE_STEP_ZK_PROOF</a> ((<a class="reference internal" href="#c.psa_pake_step_t" title="psa_pake_step_t">psa_pake_step_t</a>)0x03)</pre>
<p>This is the proof in the Schnorr Non-Interactive Zero-Knowledge Proof, this is the value denoted by <em>r</em> in <a class="reference internal" href="../about.html#cite-rfc8235"><span class="cite">[RFC8235]</span></a>.</p>
<p>Both for input and output, the value at this step is an integer less than the order of the group specified by the PAKE operation’s primitive.
The format depends on the group as well:</p>
<ul class="simple">
<li><p>For Montgomery curves, the encoding is little endian.</p></li>
<li><p>For other Elliptic curves, and for Diffie-Hellman groups, the encoding is big endian. See <a class="reference internal" href="../about.html#cite-sec1"><span class="cite">[SEC1]</span></a> §2.3.8.</p></li>
</ul>
<p>In both cases leading zeroes are permitted as long as the length in bytes does not exceed the byte length of the group order.</p>
<p>For information regarding how the group is determined, consult the documentation <a class="reference internal" href="#c.PSA_PAKE_PRIMITIVE" title="PSA_PAKE_PRIMITIVE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_PRIMITIVE()</span></code></a>.</p>
</section>
<section id="c.PSA_PAKE_STEP_CONFIRM">
<h4><code class="docutils literal notranslate"><span class="pre">PSA_PAKE_STEP_CONFIRM</span></code> (macro)<a class="headerlink" href="#c.PSA_PAKE_STEP_CONFIRM" title="Permalink to this heading">¶</a></h4>
<p>The key confirmation value.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_PAKE_STEP_CONFIRM" title="PSA_PAKE_STEP_CONFIRM">PSA_PAKE_STEP_CONFIRM</a> ((<a class="reference internal" href="#c.psa_pake_step_t" title="psa_pake_step_t">psa_pake_step_t</a>)0x04)</pre>
<p>This value is used during the key confirmation phase of a PAKE protocol. The format of the value depends on the algorithm and cipher suite:</p>
<ul class="simple">
<li><p>For <code class="docutils literal notranslate"><span class="pre">PSA_ALG_SPAKE2P</span></code>, the format for both input and output at this step is the same as the output of the MAC algorithm specified in the cipher suite.</p></li>
</ul>
</section>
</section>
<section id="multi-part-pake-operations">
<span id="pake-operation"></span><h3><span class="section-number">2.1.6. </span>Multi-part PAKE operations<a class="headerlink" href="#multi-part-pake-operations" title="Permalink to this heading">¶</a></h3>
<section id="c.psa_pake_operation_t">
<h4><code class="docutils literal notranslate"><span class="pre">psa_pake_operation_t</span></code> (typedef)<a class="headerlink" href="#c.psa_pake_operation_t" title="Permalink to this heading">¶</a></h4>
<p>The type of the state object for PAKE operations.</p>
<pre class="literal-block">typedef <em>/* implementation-defined type */</em> <a class="reference internal" href="#c.psa_pake_operation_t" title="psa_pake_operation_t">psa_pake_operation_t</a>;</pre>
<p>Before calling any function on a PAKE operation object, the application must initialize it by any of the following means:</p>
<ul>
<li><p>Set the object to all-bits-zero, for example:</p>
<pre class="literal-block"><a class="reference internal" href="#c.psa_pake_operation_t" title="psa_pake_operation_t">psa_pake_operation_t</a> operation;
memset(&amp;operation, 0, sizeof(operation));</pre>
</li>
<li><p>Initialize the object to logical zero values by declaring the object as static or global without an explicit initializer, for example:</p>
<pre class="literal-block">static <a class="reference internal" href="#c.psa_pake_operation_t" title="psa_pake_operation_t">psa_pake_operation_t</a> operation;</pre>
</li>
<li><p>Initialize the object to the initializer <a class="reference internal" href="#c.PSA_PAKE_OPERATION_INIT" title="PSA_PAKE_OPERATION_INIT"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_OPERATION_INIT</span></code></a>, for example:</p>
<pre class="literal-block"><a class="reference internal" href="#c.psa_pake_operation_t" title="psa_pake_operation_t">psa_pake_operation_t</a> operation = <a class="reference internal" href="#c.PSA_PAKE_OPERATION_INIT" title="PSA_PAKE_OPERATION_INIT">PSA_PAKE_OPERATION_INIT</a>;</pre>
</li>
<li><p>Assign the result of the function <a class="reference internal" href="#c.psa_pake_cipher_suite_init" title="psa_pake_cipher_suite_init"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_cipher_suite_init()</span></code></a> to the object, for example:</p>
<pre class="literal-block"><a class="reference internal" href="#c.psa_pake_operation_t" title="psa_pake_operation_t">psa_pake_operation_t</a> operation;
operation = <a class="reference internal" href="#c.psa_pake_operation_init" title="psa_pake_operation_init">psa_pake_operation_init</a>();</pre>
</li>
</ul>
<p>This is an implementation-defined type.
Applications that make assumptions about the content of this object will result in implementation-specific behavior, and are non-portable.</p>
</section>
<section id="c.PSA_PAKE_OPERATION_INIT">
<h4><code class="docutils literal notranslate"><span class="pre">PSA_PAKE_OPERATION_INIT</span></code> (macro)<a class="headerlink" href="#c.PSA_PAKE_OPERATION_INIT" title="Permalink to this heading">¶</a></h4>
<p>This macro returns a suitable initializer for a PAKE operation object of type <a class="reference internal" href="#c.psa_pake_operation_t" title="psa_pake_operation_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_operation_t</span></code></a>.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_PAKE_OPERATION_INIT" title="PSA_PAKE_OPERATION_INIT">PSA_PAKE_OPERATION_INIT</a> <em>/* implementation-defined value */</em></pre>
</section>
<section id="c.psa_pake_operation_init">
<h4><code class="docutils literal notranslate"><span class="pre">psa_pake_operation_init</span></code> (function)<a class="headerlink" href="#c.psa_pake_operation_init" title="Permalink to this heading">¶</a></h4>
<p>Return an initial value for a PAKE operation object.</p>
<pre class="literal-block"><a class="reference internal" href="#c.psa_pake_operation_t" title="psa_pake_operation_t">psa_pake_operation_t</a> <a class="reference internal" href="#c.psa_pake_operation_init" title="psa_pake_operation_init">psa_pake_operation_init</a>(void);</pre>
<p class="rubric">Returns: <a class="reference internal" href="#c.psa_pake_operation_t" title="psa_pake_operation_t"><code class="docutils literal notranslate"><span class="pre">psa_pake_operation_t</span></code></a></p>
</section>
<section id="c.psa_pake_setup">
<h4><code class="docutils literal notranslate"><span class="pre">psa_pake_setup</span></code> (function)<a class="headerlink" href="#c.psa_pake_setup" title="Permalink to this heading">¶</a></h4>
<p>Setup a password-authenticated key exchange.</p>
<pre class="literal-block">psa_status_t <a class="reference internal" href="#c.psa_pake_setup" title="psa_pake_setup">psa_pake_setup</a>(<a class="reference internal" href="#c.psa_pake_operation_t" title="psa_pake_operation_t">psa_pake_operation_t</a> *operation,
                            psa_key_id_t password_key,
                            const <a class="reference internal" href="#c.psa_pake_cipher_suite_t" title="psa_pake_cipher_suite_t">psa_pake_cipher_suite_t</a> *cipher_suite);</pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl>
<dt><p><code class="docutils literal notranslate"><span class="pre">operation</span></code></p>
</dt><dd><p>The operation object to set up.
It must have been initialized as per the documentation for <a class="reference internal" href="#c.psa_pake_operation_t" title="psa_pake_operation_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_operation_t</span></code></a> and not yet in use.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">password_key</span></code></p>
</dt><dd><p>Identifier of the key holding the password or a value derived from the password.
It must remain valid until the operation terminates.</p>
<p>The valid key types depend on the PAKE algorithm, and participant role.
Refer to the documentation of individual PAKE algorithms for more information, see <a class="reference internal" href="#pake-algorithms"><span class="secref">PAKE algorithms</span></a>.</p>
<p>The key must permit the usage <code class="docutils literal notranslate"><span class="pre">PSA_KEY_USAGE_DERIVE</span></code>.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">cipher_suite</span></code></p>
</dt><dd><p>The cipher suite to use.
A PAKE cipher suite fully characterizes a PAKE algorithm, including the PAKE algorithm.</p>
<p>The cipher suite must be compatible with the key type of <code class="docutils literal notranslate"><span class="pre">password_key</span></code>.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns: <code class="docutils literal notranslate"><span class="pre">psa_status_t</span></code></p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_SUCCESS</span></code></p>
</dt><dd><p>Success. The operation is now active.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_BAD_STATE</span></code></p>
</dt><dd><p>The following conditions can result in this error:</p>
<ul class="simple">
<li><p>The operation state is not valid: it must be inactive.</p></li>
<li><p>The library requires initializing by a call to <code class="docutils literal notranslate"><span class="pre">psa_crypto_init</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code>.</p></li>
</ul>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INVALID_HANDLE</span></code></p>
</dt><dd><p><code class="docutils literal notranslate"><span class="pre">password_key</span></code> is not a valid key identifier.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_NOT_PERMITTED</span></code></p>
</dt><dd><p><code class="docutils literal notranslate"><span class="pre">psssword_key</span></code> does not have the <code class="docutils literal notranslate"><span class="pre">PSA_KEY_USAGE_DERIVE</span></code> flag, or it does not permit the algorithm in <code class="docutils literal notranslate"><span class="pre">cipher_suite</span></code>.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INVALID_ARGUMENT</span></code></p>
</dt><dd><p>The following conditions can result in this error:</p>
<ul class="simple">
<li><p>The algorithm in <code class="docutils literal notranslate"><span class="pre">cipher_suite</span></code> is not a PAKE algorithm, or encodes an invalid hash algorithm.</p></li>
<li><p>The PAKE primitive in <code class="docutils literal notranslate"><span class="pre">cipher_suite</span></code> is not compatible with the PAKE algorithm.</p></li>
<li><p>The key confirmation value in <code class="docutils literal notranslate"><span class="pre">cipher_suite</span></code> is not compatible with the PAKE algorithm and primitive.</p></li>
<li><p>The key type or key size of <code class="docutils literal notranslate"><span class="pre">password_key</span></code> is not compatible with <code class="docutils literal notranslate"><span class="pre">cipher_suite</span></code>.</p></li>
</ul>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_NOT_SUPPORTED</span></code></p>
</dt><dd><p>The following conditions can result in this error:</p>
<ul class="simple">
<li><p>The algorithm in <code class="docutils literal notranslate"><span class="pre">cipher_suite</span></code> is not a supported PAKE algorithm, or encodes an unsupported hash algorithm.</p></li>
<li><p>The PAKE primitive in <code class="docutils literal notranslate"><span class="pre">cipher_suite</span></code> is not supported or not compatible with the PAKE algorithm.</p></li>
<li><p>The key confirmation value in <code class="docutils literal notranslate"><span class="pre">cipher_suite</span></code> is not supported, or not compatible, with the PAKE algorithm and primitive.</p></li>
<li><p>The key type or key size of <code class="docutils literal notranslate"><span class="pre">password_key</span></code> is not supported with <code class="docutils literal notranslate"><span class="pre">cipher</span> <span class="pre">suite</span></code>.</p></li>
</ul>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_COMMUNICATION_FAILURE</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_CORRUPTION_DETECTED</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_STORAGE_FAILURE</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_DATA_CORRUPT</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_DATA_INVALID</span></code></p>
</dt><dd></dd>
</dl>
</div>
<p class="rubric">Description</p>
<p>The sequence of operations to set up a password-authenticated key exchange operation is as follows:</p>
<ol class="arabic simple">
<li><p>Allocate a PAKE operation object which will be passed to all the functions listed here.</p></li>
<li><p>Initialize the operation object with one of the methods described in the documentation for <a class="reference internal" href="#c.psa_pake_operation_t" title="psa_pake_operation_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_operation_t</span></code></a>.
For example, using <a class="reference internal" href="#c.PSA_PAKE_OPERATION_INIT" title="PSA_PAKE_OPERATION_INIT"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_OPERATION_INIT</span></code></a>.</p></li>
<li><p>Call <a class="reference internal" href="#c.psa_pake_setup" title="psa_pake_setup"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_setup()</span></code></a> to specify the cipher suite.</p></li>
<li><p>Call <code class="docutils literal notranslate"><span class="pre">psa_pake_set_xxx()</span></code> functions on the operation to complete the setup.
The exact sequence of <code class="docutils literal notranslate"><span class="pre">psa_pake_set_xxx()</span></code> functions that needs to be called depends on the algorithm in use.</p></li>
</ol>
<p>A typical sequence of calls to perform a password-authenticated key exchange:</p>
<ol class="arabic simple">
<li><p>Call <a class="reference internal" href="#c.psa_pake_output" title="psa_pake_output"><code class="docutils literal notranslate"><span class="pre">psa_pake_output</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">operation</span></code><code class="docutils literal notranslate"><span class="pre">,</span> </code><a class="reference internal" href="#c.PSA_PAKE_STEP_KEY_SHARE" title="PSA_PAKE_STEP_KEY_SHARE"><code class="docutils literal notranslate"><span class="pre">PSA_PAKE_STEP_KEY_SHARE</span></code></a><code class="docutils literal notranslate"><span class="pre">,</span> <span class="pre">...)</span></code> to get the key share that needs to be sent to the peer.</p></li>
<li><p>Call <a class="reference internal" href="#c.psa_pake_input" title="psa_pake_input"><code class="docutils literal notranslate"><span class="pre">psa_pake_input</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">operation</span></code><code class="docutils literal notranslate"><span class="pre">,</span> </code><a class="reference internal" href="#c.PSA_PAKE_STEP_KEY_SHARE" title="PSA_PAKE_STEP_KEY_SHARE"><code class="docutils literal notranslate"><span class="pre">PSA_PAKE_STEP_KEY_SHARE</span></code></a><code class="docutils literal notranslate"><span class="pre">,</span> <span class="pre">...)</span></code> to provide the key share that was received from the peer.</p></li>
<li><p>Depending on the algorithm additional calls to <a class="reference internal" href="#c.psa_pake_output" title="psa_pake_output"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_output()</span></code></a> and <a class="reference internal" href="#c.psa_pake_input" title="psa_pake_input"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_input()</span></code></a> might be necessary.</p></li>
<li><p>Call <a class="reference internal" href="#c.psa_pake_get_shared_key" title="psa_pake_get_shared_key"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_get_shared_key()</span></code></a> to access the shared secret.</p></li>
</ol>
<p>Refer to the documentation of individual PAKE algorithms for details on the required set up and operation for each algorithm, and for constraints on the format and content of valid passwords.
See <a class="reference internal" href="#pake-algorithms"><span class="secref">PAKE algorithms</span></a>.</p>
<p>After a successful call to <a class="reference internal" href="#c.psa_pake_setup" title="psa_pake_setup"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_setup()</span></code></a>, the operation is active, and the application must eventually terminate the operation.
The following events terminate an operation:</p>
<ul class="simple">
<li><p>A successful call to <a class="reference internal" href="#c.psa_pake_get_shared_key" title="psa_pake_get_shared_key"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_get_shared_key()</span></code></a>.</p></li>
<li><p>A call to <a class="reference internal" href="#c.psa_pake_abort" title="psa_pake_abort"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_abort()</span></code></a>.</p></li>
</ul>
<p>If <a class="reference internal" href="#c.psa_pake_setup" title="psa_pake_setup"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_setup()</span></code></a> returns an error, the operation object is unchanged.
If a subsequent function call with an active operation returns an error, the operation enters an error state.</p>
<p>To abandon an active operation, or reset an operation in an error state, call <a class="reference internal" href="#c.psa_pake_abort" title="psa_pake_abort"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_abort()</span></code></a>.</p>
</section>
<section id="c.psa_pake_set_role">
<h4><code class="docutils literal notranslate"><span class="pre">psa_pake_set_role</span></code> (function)<a class="headerlink" href="#c.psa_pake_set_role" title="Permalink to this heading">¶</a></h4>
<p>Set the application role for a password-authenticated key exchange.</p>
<pre class="literal-block">psa_status_t <a class="reference internal" href="#c.psa_pake_set_role" title="psa_pake_set_role">psa_pake_set_role</a>(<a class="reference internal" href="#c.psa_pake_operation_t" title="psa_pake_operation_t">psa_pake_operation_t</a> *operation,
                               <a class="reference internal" href="#c.psa_pake_role_t" title="psa_pake_role_t">psa_pake_role_t</a> role);</pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">operation</span></code></p>
</dt><dd><p>Active PAKE operation.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">role</span></code></p>
</dt><dd><p>A value of type <a class="reference internal" href="#c.psa_pake_role_t" title="psa_pake_role_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_role_t</span></code></a> indicating the application role in the PAKE algorithm.
See <a class="reference internal" href="#pake-roles"><span class="secref">PAKE roles</span></a>.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns: <code class="docutils literal notranslate"><span class="pre">psa_status_t</span></code></p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_SUCCESS</span></code></p>
</dt><dd><p>Success.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_BAD_STATE</span></code></p>
</dt><dd><p>The following conditions can result in this error:</p>
<ul class="simple">
<li><p>The operation state is not valid: it must be active, and <a class="reference internal" href="#c.psa_pake_set_role" title="psa_pake_set_role"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_set_role()</span></code></a>, <a class="reference internal" href="#c.psa_pake_input" title="psa_pake_input"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_input()</span></code></a>, and <a class="reference internal" href="#c.psa_pake_output" title="psa_pake_output"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_output()</span></code></a> must not have been called yet.</p></li>
<li><p>The library requires initializing by a call to <code class="docutils literal notranslate"><span class="pre">psa_crypto_init</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code>.</p></li>
</ul>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INVALID_ARGUMENT</span></code></p>
</dt><dd><p>The following conditions can result in this error:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">role</span></code> is not a valid PAKE role in the operation’s algorithm.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">role</span></code> is not compatible with the operation’s key type.</p></li>
</ul>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_NOT_SUPPORTED</span></code></p>
</dt><dd><p>The following conditions can result in this error:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">role</span></code> is not a valid PAKE role, or is not supported for the operation’s algorithm.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">role</span></code> is not supported with the operation’s key type.</p></li>
</ul>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_COMMUNICATION_FAILURE</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_CORRUPTION_DETECTED</span></code></p>
</dt><dd></dd>
</dl>
</div>
<p class="rubric">Description</p>
<p>Not all PAKE algorithms need to differentiate the communicating participants.
For PAKE algorithms that do not require a role to be specified, the application can do either of the following:</p>
<ul class="simple">
<li><p>Not call <a class="reference internal" href="#c.psa_pake_set_role" title="psa_pake_set_role"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_set_role()</span></code></a> on the PAKE operation.</p></li>
<li><p>Call <a class="reference internal" href="#c.psa_pake_set_role" title="psa_pake_set_role"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_set_role()</span></code></a> with the <a class="reference internal" href="#c.PSA_PAKE_ROLE_NONE" title="PSA_PAKE_ROLE_NONE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_ROLE_NONE</span></code></a> role.</p></li>
</ul>
<p>Refer to the documentation of individual PAKE algorithms for more information.
See <a class="reference internal" href="#pake-algorithms"><span class="secref">PAKE algorithms</span></a>.</p>
</section>
<section id="c.psa_pake_set_user">
<h4><code class="docutils literal notranslate"><span class="pre">psa_pake_set_user</span></code> (function)<a class="headerlink" href="#c.psa_pake_set_user" title="Permalink to this heading">¶</a></h4>
<p>Set the user ID for a password-authenticated key exchange.</p>
<pre class="literal-block">psa_status_t <a class="reference internal" href="#c.psa_pake_set_user" title="psa_pake_set_user">psa_pake_set_user</a>(<a class="reference internal" href="#c.psa_pake_operation_t" title="psa_pake_operation_t">psa_pake_operation_t</a> *operation,
                               const uint8_t *user_id,
                               size_t user_id_len);</pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">operation</span></code></p>
</dt><dd><p>Active PAKE operation.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">user_id</span></code></p>
</dt><dd><p>The user ID to authenticate with.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">user_id_len</span></code></p>
</dt><dd><p>Size of the <code class="docutils literal notranslate"><span class="pre">user_id</span></code> buffer in bytes.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns: <code class="docutils literal notranslate"><span class="pre">psa_status_t</span></code></p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_SUCCESS</span></code></p>
</dt><dd><p>Success.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_BAD_STATE</span></code></p>
</dt><dd><p>The following conditions can result in this error:</p>
<ul class="simple">
<li><p>The operation state is not valid: it must be active, and <a class="reference internal" href="#c.psa_pake_set_user" title="psa_pake_set_user"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_set_user()</span></code></a>, <a class="reference internal" href="#c.psa_pake_input" title="psa_pake_input"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_input()</span></code></a>, and <a class="reference internal" href="#c.psa_pake_output" title="psa_pake_output"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_output()</span></code></a> must not have been called yet.</p></li>
<li><p>The library requires initializing by a call to <code class="docutils literal notranslate"><span class="pre">psa_crypto_init</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code>.</p></li>
</ul>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INVALID_ARGUMENT</span></code></p>
</dt><dd><p><code class="docutils literal notranslate"><span class="pre">user_id</span></code> is not valid for the operation’s algorithm and cipher suite.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_NOT_SUPPORTED</span></code></p>
</dt><dd><p>The value of <code class="docutils literal notranslate"><span class="pre">user_id</span></code> is not supported by the implementation.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INSUFFICIENT_MEMORY</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_COMMUNICATION_FAILURE</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_CORRUPTION_DETECTED</span></code></p>
</dt><dd></dd>
</dl>
</div>
<p class="rubric">Description</p>
<p>Call this function to set the user ID.
For PAKE algorithms that associate a user identifier with both participants in the session, also call <a class="reference internal" href="#c.psa_pake_set_peer" title="psa_pake_set_peer"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_set_peer()</span></code></a> with the peer ID.
For PAKE algorithms that associate a single user identifier with the session, call <a class="reference internal" href="#c.psa_pake_set_user" title="psa_pake_set_user"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_set_user()</span></code></a> only.</p>
<p>Refer to the documentation of individual PAKE algorithms for more information.
See <a class="reference internal" href="#pake-algorithms"><span class="secref">PAKE algorithms</span></a>.</p>
</section>
<section id="c.psa_pake_set_peer">
<h4><code class="docutils literal notranslate"><span class="pre">psa_pake_set_peer</span></code> (function)<a class="headerlink" href="#c.psa_pake_set_peer" title="Permalink to this heading">¶</a></h4>
<p>Set the peer ID for a password-authenticated key exchange.</p>
<pre class="literal-block">psa_status_t <a class="reference internal" href="#c.psa_pake_set_peer" title="psa_pake_set_peer">psa_pake_set_peer</a>(<a class="reference internal" href="#c.psa_pake_operation_t" title="psa_pake_operation_t">psa_pake_operation_t</a> *operation,
                               const uint8_t *peer_id,
                               size_t peer_id_len);</pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">operation</span></code></p>
</dt><dd><p>Active PAKE operation.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">peer_id</span></code></p>
</dt><dd><p>The peer’s ID to authenticate.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">peer_id_len</span></code></p>
</dt><dd><p>Size of the <code class="docutils literal notranslate"><span class="pre">peer_id</span></code> buffer in bytes.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns: <code class="docutils literal notranslate"><span class="pre">psa_status_t</span></code></p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_SUCCESS</span></code></p>
</dt><dd><p>Success.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_BAD_STATE</span></code></p>
</dt><dd><p>The following conditions can result in this error:</p>
<ul class="simple">
<li><p>The operation state is not valid: it must be active, and <a class="reference internal" href="#c.psa_pake_set_peer" title="psa_pake_set_peer"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_set_peer()</span></code></a>, <a class="reference internal" href="#c.psa_pake_input" title="psa_pake_input"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_input()</span></code></a>, and <a class="reference internal" href="#c.psa_pake_output" title="psa_pake_output"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_output()</span></code></a> must not have been called yet.</p></li>
<li><p>Calling <a class="reference internal" href="#c.psa_pake_set_peer" title="psa_pake_set_peer"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_set_peer()</span></code></a> is invalid with the operation’s algorithm.</p></li>
<li><p>The library requires initializing by a call to <code class="docutils literal notranslate"><span class="pre">psa_crypto_init</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code>.</p></li>
</ul>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INVALID_ARGUMENT</span></code></p>
</dt><dd><p><code class="docutils literal notranslate"><span class="pre">peer_id</span></code> is not valid for the operation’s algorithm and cipher suite.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_NOT_SUPPORTED</span></code></p>
</dt><dd><p>The value of <code class="docutils literal notranslate"><span class="pre">peer_id</span></code> is not supported by the implementation.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_NOT_SUPPORTED</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INSUFFICIENT_MEMORY</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_COMMUNICATION_FAILURE</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_CORRUPTION_DETECTED</span></code></p>
</dt><dd></dd>
</dl>
</div>
<p class="rubric">Description</p>
<p>Call this function in addition to <a class="reference internal" href="#c.psa_pake_set_user" title="psa_pake_set_user"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_set_user()</span></code></a> for PAKE algorithms that associate a user identifier with both participants in the session.
For PAKE algorithms that associate a single user identifier with the session, call <a class="reference internal" href="#c.psa_pake_set_user" title="psa_pake_set_user"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_set_user()</span></code></a> only.</p>
<p>Refer to the documentation of individual PAKE algorithms for more information.
See <a class="reference internal" href="#pake-algorithms"><span class="secref">PAKE algorithms</span></a>.</p>
</section>
<section id="c.psa_pake_set_context">
<h4><code class="docutils literal notranslate"><span class="pre">psa_pake_set_context</span></code> (function)<a class="headerlink" href="#c.psa_pake_set_context" title="Permalink to this heading">¶</a></h4>
<p>Set the context data for a password-authenticated key exchange.</p>
<pre class="literal-block">psa_status_t <a class="reference internal" href="#c.psa_pake_set_context" title="psa_pake_set_context">psa_pake_set_context</a>(<a class="reference internal" href="#c.psa_pake_operation_t" title="psa_pake_operation_t">psa_pake_operation_t</a> *operation,
                                  const uint8_t *context,
                                  size_t context_len);</pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">operation</span></code></p>
</dt><dd><p>Active PAKE operation.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">context</span></code></p>
</dt><dd><p>The peer’s ID to authenticate.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">context_len</span></code></p>
</dt><dd><p>Size of the <code class="docutils literal notranslate"><span class="pre">context</span></code> buffer in bytes.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns: <code class="docutils literal notranslate"><span class="pre">psa_status_t</span></code></p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_SUCCESS</span></code></p>
</dt><dd><p>Success.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_BAD_STATE</span></code></p>
</dt><dd><p>The following conditions can result in this error:</p>
<ul class="simple">
<li><p>The operation state is not valid: it must be active, and <a class="reference internal" href="#c.psa_pake_set_context" title="psa_pake_set_context"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_set_context()</span></code></a>, <a class="reference internal" href="#c.psa_pake_input" title="psa_pake_input"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_input()</span></code></a>, and <a class="reference internal" href="#c.psa_pake_output" title="psa_pake_output"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_output()</span></code></a> must not have been called yet.</p></li>
<li><p>Calling <a class="reference internal" href="#c.psa_pake_set_context" title="psa_pake_set_context"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_set_context()</span></code></a> is invalid with the operation’s algorithm.</p></li>
<li><p>The library requires initializing by a call to <code class="docutils literal notranslate"><span class="pre">psa_crypto_init</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code>.</p></li>
</ul>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INVALID_ARGUMENT</span></code></p>
</dt><dd><p><code class="docutils literal notranslate"><span class="pre">context</span></code> is not valid for the operation’s algorithm and cipher suite.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_NOT_SUPPORTED</span></code></p>
</dt><dd><p>The value of <code class="docutils literal notranslate"><span class="pre">context</span></code> is not supported by the implementation.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_NOT_SUPPORTED</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INSUFFICIENT_MEMORY</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_COMMUNICATION_FAILURE</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_CORRUPTION_DETECTED</span></code></p>
</dt><dd></dd>
</dl>
</div>
<p class="rubric">Description</p>
<p>Call this function for PAKE algorithms that accept additional context data as part of the protocol setup.</p>
<p>Refer to the documentation of individual PAKE algorithms for more information.
See <a class="reference internal" href="#pake-algorithms"><span class="secref">PAKE algorithms</span></a>.</p>
</section>
<section id="c.psa_pake_output">
<h4><code class="docutils literal notranslate"><span class="pre">psa_pake_output</span></code> (function)<a class="headerlink" href="#c.psa_pake_output" title="Permalink to this heading">¶</a></h4>
<p>Get output for a step of a password-authenticated key exchange.</p>
<pre class="literal-block">psa_status_t <a class="reference internal" href="#c.psa_pake_output" title="psa_pake_output">psa_pake_output</a>(<a class="reference internal" href="#c.psa_pake_operation_t" title="psa_pake_operation_t">psa_pake_operation_t</a> *operation,
                             <a class="reference internal" href="#c.psa_pake_step_t" title="psa_pake_step_t">psa_pake_step_t</a> step,
                             uint8_t *output,
                             size_t output_size,
                             size_t *output_length);</pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">operation</span></code></p>
</dt><dd><p>Active PAKE operation.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">step</span></code></p>
</dt><dd><p>The step of the algorithm for which the output is requested.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">output</span></code></p>
</dt><dd><p>Buffer where the output is to be written.
The format of the output depends on the <code class="docutils literal notranslate"><span class="pre">step</span></code>, see <a class="reference internal" href="#pake-steps"><span class="secref">PAKE step types</span></a>.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">output_size</span></code></p>
</dt><dd><p>Size of the <code class="docutils literal notranslate"><span class="pre">output</span></code> buffer in bytes.
This must be appropriate for the cipher suite and output step:</p>
<ul class="simple">
<li><p>A sufficient output size is <a class="reference internal" href="#c.PSA_PAKE_OUTPUT_SIZE" title="PSA_PAKE_OUTPUT_SIZE"><code class="docutils literal notranslate"><span class="pre">PSA_PAKE_OUTPUT_SIZE</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">alg</span></code><code class="docutils literal notranslate"><span class="pre">,</span> </code><code class="docutils literal notranslate"><span class="pre">primitive</span></code><code class="docutils literal notranslate"><span class="pre">,</span> </code><code class="docutils literal notranslate"><span class="pre">step</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> where <code class="docutils literal notranslate"><span class="pre">alg</span></code> and <code class="docutils literal notranslate"><span class="pre">primitive</span></code> are the PAKE algorithm and primitive in the operation’s cipher suite, and <code class="docutils literal notranslate"><span class="pre">step</span></code> is the output step.</p></li>
<li><p><a class="reference internal" href="#c.PSA_PAKE_OUTPUT_MAX_SIZE" title="PSA_PAKE_OUTPUT_MAX_SIZE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_OUTPUT_MAX_SIZE</span></code></a> evaluates to the maximum output size of any supported PAKE algorithm, primitive and step.</p></li>
</ul>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">output_length</span></code></p>
</dt><dd><p>On success, the number of bytes of the returned output.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns: <code class="docutils literal notranslate"><span class="pre">psa_status_t</span></code></p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_SUCCESS</span></code></p>
</dt><dd><p>Success.
The first <code class="docutils literal notranslate"><span class="pre">(*output_length)</span></code> bytes of <code class="docutils literal notranslate"><span class="pre">output</span></code> contain the output.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_BAD_STATE</span></code></p>
</dt><dd><p>The following conditions can result in this error:</p>
<ul class="simple">
<li><p>The operation state is not valid: it must be active and fully set up, and this call must conform to the algorithm’s requirements for ordering of input and output steps.</p></li>
<li><p>The library requires initializing by a call to <code class="docutils literal notranslate"><span class="pre">psa_crypto_init</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code>.</p></li>
</ul>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_BUFFER_TOO_SMALL</span></code></p>
</dt><dd><p>The size of the <code class="docutils literal notranslate"><span class="pre">output</span></code> buffer is too small.
<a class="reference internal" href="#c.PSA_PAKE_OUTPUT_SIZE" title="PSA_PAKE_OUTPUT_SIZE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_OUTPUT_SIZE()</span></code></a> or <a class="reference internal" href="#c.PSA_PAKE_OUTPUT_MAX_SIZE" title="PSA_PAKE_OUTPUT_MAX_SIZE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_OUTPUT_MAX_SIZE</span></code></a> can be used to determine a sufficient buffer size.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INVALID_ARGUMENT</span></code></p>
</dt><dd><p><code class="docutils literal notranslate"><span class="pre">step</span></code> is not compatible with the operation’s algorithm.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_NOT_SUPPORTED</span></code></p>
</dt><dd><p><code class="docutils literal notranslate"><span class="pre">step</span></code> is not supported with the operation’s algorithm.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INSUFFICIENT_ENTROPY</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INSUFFICIENT_MEMORY</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_COMMUNICATION_FAILURE</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_CORRUPTION_DETECTED</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_STORAGE_FAILURE</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_DATA_CORRUPT</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_DATA_INVALID</span></code></p>
</dt><dd></dd>
</dl>
</div>
<p class="rubric">Description</p>
<p>Depending on the algorithm being executed, you might need to call this function several times or you might not need to call this at all.</p>
<p>The exact sequence of calls to perform a password-authenticated key exchange depends on the algorithm in use.
Refer to the documentation of individual PAKE algorithms for more information.
See <a class="reference internal" href="#pake-algorithms"><span class="secref">PAKE algorithms</span></a>.</p>
<p>If this function returns an error status, the operation enters an error state and must be aborted by calling <a class="reference internal" href="#c.psa_pake_abort" title="psa_pake_abort"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_abort()</span></code></a>.</p>
</section>
<section id="c.psa_pake_input">
<h4><code class="docutils literal notranslate"><span class="pre">psa_pake_input</span></code> (function)<a class="headerlink" href="#c.psa_pake_input" title="Permalink to this heading">¶</a></h4>
<p>Provide input for a step of a password-authenticated key exchange.</p>
<pre class="literal-block">psa_status_t <a class="reference internal" href="#c.psa_pake_input" title="psa_pake_input">psa_pake_input</a>(<a class="reference internal" href="#c.psa_pake_operation_t" title="psa_pake_operation_t">psa_pake_operation_t</a> *operation,
                            <a class="reference internal" href="#c.psa_pake_step_t" title="psa_pake_step_t">psa_pake_step_t</a> step,
                            const uint8_t *input,
                            size_t input_length);</pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">operation</span></code></p>
</dt><dd><p>Active PAKE operation.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">step</span></code></p>
</dt><dd><p>The step for which the input is provided.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">input</span></code></p>
</dt><dd><p>Buffer containing the input.
The format of the input depends on the <code class="docutils literal notranslate"><span class="pre">step</span></code>, see <a class="reference internal" href="#pake-steps"><span class="secref">PAKE step types</span></a>.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">input_length</span></code></p>
</dt><dd><p>Size of the <code class="docutils literal notranslate"><span class="pre">input</span></code> buffer in bytes.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns: <code class="docutils literal notranslate"><span class="pre">psa_status_t</span></code></p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_SUCCESS</span></code></p>
</dt><dd><p>Success.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_BAD_STATE</span></code></p>
</dt><dd><p>The following conditions can result in this error:</p>
<ul class="simple">
<li><p>The operation state is not valid: it must be active and fully set up, and this call must conform to the algorithm’s requirements for ordering of input and output steps.</p></li>
<li><p>The library requires initializing by a call to <code class="docutils literal notranslate"><span class="pre">psa_crypto_init</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code>.</p></li>
</ul>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INVALID_SIGNATURE</span></code></p>
</dt><dd><p>The verification fails for a <a class="reference internal" href="#c.PSA_PAKE_STEP_ZK_PROOF" title="PSA_PAKE_STEP_ZK_PROOF"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_STEP_ZK_PROOF</span></code></a> or <a class="reference internal" href="#c.PSA_PAKE_STEP_CONFIRM" title="PSA_PAKE_STEP_CONFIRM"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_STEP_CONFIRM</span></code></a> input step.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INVALID_ARGUMENT</span></code></p>
</dt><dd><p>The following conditions can result in this error:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">step</span></code> is not compatible with the operation’s algorithm.</p></li>
<li><p>The input is not valid for the operation’s algorithm, cipher suite or <code class="docutils literal notranslate"><span class="pre">step</span></code>.</p></li>
</ul>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_NOT_SUPPORTED</span></code></p>
</dt><dd><p>The following conditions can result in this error:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">step</span></code> is not supported with the operation’s algorithm.</p></li>
<li><p>The input is not supported for the operation’s algorithm, cipher suite or <code class="docutils literal notranslate"><span class="pre">step</span></code>.</p></li>
</ul>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INSUFFICIENT_MEMORY</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_COMMUNICATION_FAILURE</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_CORRUPTION_DETECTED</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_STORAGE_FAILURE</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_DATA_CORRUPT</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_DATA_INVALID</span></code></p>
</dt><dd></dd>
</dl>
</div>
<p class="rubric">Description</p>
<p>Depending on the algorithm being executed, you might need to call this function several times or you might not need to call this at all.</p>
<p>The exact sequence of calls to perform a password-authenticated key exchange depends on the algorithm in use.
Refer to the documentation of individual PAKE algorithms for more information.
See <a class="reference internal" href="#pake-algorithms"><span class="secref">PAKE algorithms</span></a>.</p>
<p><a class="reference internal" href="#c.PSA_PAKE_INPUT_SIZE" title="PSA_PAKE_INPUT_SIZE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_INPUT_SIZE()</span></code></a> or <a class="reference internal" href="#c.PSA_PAKE_INPUT_MAX_SIZE" title="PSA_PAKE_INPUT_MAX_SIZE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_INPUT_MAX_SIZE</span></code></a> can be used to allocate buffers of sufficient size to transfer inputs that are received from the peer into the operation.</p>
<p>If this function returns an error status, the operation enters an error state and must be aborted by calling <a class="reference internal" href="#c.psa_pake_abort" title="psa_pake_abort"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_abort()</span></code></a>.</p>
</section>
<section id="c.psa_pake_get_shared_key">
<h4><code class="docutils literal notranslate"><span class="pre">psa_pake_get_shared_key</span></code> (function)<a class="headerlink" href="#c.psa_pake_get_shared_key" title="Permalink to this heading">¶</a></h4>
<p>Extract the shared secret from the PAKE as a key.</p>
<pre class="literal-block">psa_status_t <a class="reference internal" href="#c.psa_pake_get_shared_key" title="psa_pake_get_shared_key">psa_pake_get_shared_key</a>(<a class="reference internal" href="#c.psa_pake_operation_t" title="psa_pake_operation_t">psa_pake_operation_t</a> *operation,
                                     const psa_key_attributes_t * attributes,
                                     psa_key_id_t * key);</pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl>
<dt><p><code class="docutils literal notranslate"><span class="pre">operation</span></code></p>
</dt><dd><p>Active PAKE operation.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">attributes</span></code></p>
</dt><dd><p>The attributes for the new key.
This function uses the attributes as follows:</p>
<ul class="simple">
<li><p>The key type is required.
All PAKE algorithms can output a key of type <code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_DERIVE</span></code> or <code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_HMAC</span></code>.
PAKE algorithms that produce a pseudo-random shared secret, can also output block-cipher key types, for example <code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_AES</span></code>.
Refer to the documentation of individual PAKE algorithms for more information.
See <a class="reference internal" href="#pake-algorithms"><span class="secref">PAKE algorithms</span></a>.</p></li>
<li><p>The key size in <code class="docutils literal notranslate"><span class="pre">attributes</span></code> must be zero.
The returned key size is always determined from the PAKE shared secret.</p></li>
<li><p>The key permitted-algorithm policy is required for keys that will be used for a cryptographic operation.</p>
</li>
<li><p>The key usage flags define what operations are permitted with the key.</p>
</li>
<li><p>The key lifetime and identifier are required for a persistent key.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is an input parameter: it is not updated with the final key attributes.
The final attributes of the new key can be queried by calling <code class="docutils literal notranslate"><span class="pre">psa_get_key_attributes</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code> with the key’s identifier.</p>
</div>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">key</span></code></p>
</dt><dd><p>On success, an identifier for the newly created key. <code class="docutils literal notranslate"><span class="pre">PSA_KEY_ID_NULL</span></code> on failure.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns: <code class="docutils literal notranslate"><span class="pre">psa_status_t</span></code></p>
<div class="apisubitem docutils container">
<dl>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_SUCCESS</span></code></p>
</dt><dd><p>Success.
If the key is persistent, the key material and the key’s metadata have been saved to persistent storage.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_BAD_STATE</span></code></p>
</dt><dd><p>The following conditions can result in this error:</p>
<ul>
<li><p>The state of PAKE operation <code class="docutils literal notranslate"><span class="pre">operation</span></code> is not valid: it must be ready to return the shared secret.</p>
<p>For an unconfirmed key, this will be when the key-exchange output and input steps are complete, but prior to any key-confirmation output and input steps.</p>
<p>For a confirmed key, this will be when all key-exchange and key-confirmation output and input steps are complete.</p>
</li>
<li><p>The library requires initializing by a call to <code class="docutils literal notranslate"><span class="pre">psa_crypto_init</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code>.</p></li>
</ul>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_NOT_PERMITTED</span></code></p>
</dt><dd><p>The implementation does not permit creating a key with the specified attributes due to some implementation-specific policy.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_ALREADY_EXISTS</span></code></p>
</dt><dd><p>This is an attempt to create a persistent key, and there is already a persistent key with the given identifier.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INVALID_ARGUMENT</span></code></p>
</dt><dd><p>The following conditions can result in this error:</p>
<ul class="simple">
<li><p>The key type is not valid for output from this operation’s algorithm.</p></li>
<li><p>The key size is nonzero.</p></li>
<li><p>The key lifetime is invalid.</p></li>
<li><p>The key identifier is not valid for the key lifetime.</p></li>
<li><p>The key usage flags include invalid values.</p></li>
<li><p>The key’s permitted-usage algorithm is invalid.</p></li>
<li><p>The key attributes, as a whole, are invalid.</p></li>
</ul>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_NOT_SUPPORTED</span></code></p>
</dt><dd><p>The key attributes, as a whole, are not supported for creation from a PAKE secret, either by the implementation in general or in the specified storage location.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INSUFFICIENT_MEMORY</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_COMMUNICATION_FAILURE</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_CORRUPTION_DETECTED</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_STORAGE_FAILURE</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_DATA_CORRUPT</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_DATA_INVALID</span></code></p>
</dt><dd></dd>
</dl>
</div>
<p class="rubric">Description</p>
<p>This is the final call in a PAKE operation, which retrieves the shared secret as a key.
It is recommended that this key is used as an input to a key derivation operation to produce additional cryptographic keys.
For some PAKE algorithms, the shared secret is also suitable for use as a key in cryptographic operations such as encryption.
Refer to the documentation of individual PAKE algorithms for more information, see <a class="reference internal" href="#pake-algorithms"><span class="secref">PAKE algorithms</span></a>.</p>
<p>Depending on the key confirmation requested in the cipher suite, <a class="reference internal" href="#c.psa_pake_get_shared_key" title="psa_pake_get_shared_key"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_get_shared_key()</span></code></a> must be called either before or after the key-confirmation output and input steps for the PAKE algorithm.
The key confirmation affects the guarantees that can be made about the shared key:</p>
<table class="colwidths-given borderless docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>Unconfirmed key</strong></p></td>
<td><p>If the cipher suite used to set up the operation requested an unconfirmed key, the application must call <a class="reference internal" href="#c.psa_pake_get_shared_key" title="psa_pake_get_shared_key"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_get_shared_key()</span></code></a> after the key-exchange output and input steps are completed.
The PAKE algorithm provides a cryptographic guarantee that only a peer who used the same password, and identity inputs, is able to compute the same key.
However, there is no guarantee that the peer is the participant it claims to be, and was able to compute the same key.</p>
<p>Since the peer is not authenticated, no action should be taken that assumes that the peer is who it claims to be.
For example, do not access restricted resources on the peer’s behalf until an explicit authentication has succeeded.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Some PAKE algorithms do not enable the output of the shared secret until it has been confirmed.</p>
</div>
</td>
</tr>
<tr class="row-even"><td><p><strong>Confirmed key</strong></p></td>
<td><p>If the cipher suite used to set up the operation requested a confirmed key, the application must call <a class="reference internal" href="#c.psa_pake_get_shared_key" title="psa_pake_get_shared_key"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_get_shared_key()</span></code></a> after the key-exchange and key-confirmation output and input steps are completed.</p>
<p>Following key confirmation, the PAKE algorithm provides a cryptographic guarantee that the peer used the same password and identity inputs, and has computed the identical shared secret key.</p>
<p>Since the peer is not authenticated, no action should be taken that assumes that the peer is who it claims to be.
For example, do not access restricted resources on the peer’s behalf until an explicit authentication has succeeded.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Some PAKE algorithms do not include any key-confirmation steps.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p>The exact sequence of calls to perform a password-authenticated key exchange depends on the algorithm in use.
Refer to the documentation of individual PAKE algorithms for more information.
See <a class="reference internal" href="#pake-algorithms"><span class="secref">PAKE algorithms</span></a>.</p>
<p>When this function returns successfully, <code class="docutils literal notranslate"><span class="pre">operation</span></code> becomes inactive.
If this function returns an error status, the operation enters an error state and must be aborted by calling <a class="reference internal" href="#c.psa_pake_abort" title="psa_pake_abort"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_abort()</span></code></a>.</p>
</section>
<section id="c.psa_pake_abort">
<h4><code class="docutils literal notranslate"><span class="pre">psa_pake_abort</span></code> (function)<a class="headerlink" href="#c.psa_pake_abort" title="Permalink to this heading">¶</a></h4>
<p>Abort a PAKE operation.</p>
<pre class="literal-block">psa_status_t <a class="reference internal" href="#c.psa_pake_abort" title="psa_pake_abort">psa_pake_abort</a>(<a class="reference internal" href="#c.psa_pake_operation_t" title="psa_pake_operation_t">psa_pake_operation_t</a> * operation);</pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">operation</span></code></p>
</dt><dd><p>Initialized PAKE operation.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns: <code class="docutils literal notranslate"><span class="pre">psa_status_t</span></code></p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_SUCCESS</span></code></p>
</dt><dd><p>Success.
The operation object can now be discarded or reused.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_BAD_STATE</span></code></p>
</dt><dd><p>The library requires initializing by a call to <code class="docutils literal notranslate"><span class="pre">psa_crypto_init</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code>.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_COMMUNICATION_FAILURE</span></code></p>
</dt><dd></dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">PSA_ERROR_CORRUPTION_DETECTED</span></code></p>
</dt><dd></dd>
</dl>
</div>
<p class="rubric">Description</p>
<p>Aborting an operation frees all associated resources except for the <code class="docutils literal notranslate"><span class="pre">operation</span></code> object itself.
Once aborted, the operation object can be reused for another operation by calling <a class="reference internal" href="#c.psa_pake_setup" title="psa_pake_setup"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_setup()</span></code></a> again.</p>
<p>This function can be called any time after the operation object has been initialized as described in <a class="reference internal" href="#c.psa_pake_operation_t" title="psa_pake_operation_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_operation_t</span></code></a>.</p>
<p>In particular, calling <a class="reference internal" href="#c.psa_pake_abort" title="psa_pake_abort"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_abort()</span></code></a> after the operation has been terminated by a call to <a class="reference internal" href="#c.psa_pake_abort" title="psa_pake_abort"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_abort()</span></code></a> or <a class="reference internal" href="#c.psa_pake_get_shared_key" title="psa_pake_get_shared_key"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_get_shared_key()</span></code></a> is safe and has no effect.</p>
</section>
</section>
<section id="pake-support-macros">
<span id="pake-support"></span><h3><span class="section-number">2.1.7. </span>PAKE support macros<a class="headerlink" href="#pake-support-macros" title="Permalink to this heading">¶</a></h3>
<section id="c.PSA_PAKE_OUTPUT_SIZE">
<h4><code class="docutils literal notranslate"><span class="pre">PSA_PAKE_OUTPUT_SIZE</span></code> (macro)<a class="headerlink" href="#c.PSA_PAKE_OUTPUT_SIZE" title="Permalink to this heading">¶</a></h4>
<p>Sufficient output buffer size for <a class="reference internal" href="#c.psa_pake_output" title="psa_pake_output"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_output()</span></code></a>, in bytes.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_PAKE_OUTPUT_SIZE" title="PSA_PAKE_OUTPUT_SIZE">PSA_PAKE_OUTPUT_SIZE</a>(alg, primitive, output_step) \
    <em>/* implementation-defined value */</em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">alg</span></code></p>
</dt><dd><p>A PAKE algorithm: a value of type <code class="docutils literal notranslate"><span class="pre">psa_algorithm_t</span></code> such that <a class="reference internal" href="#c.PSA_ALG_IS_PAKE" title="PSA_ALG_IS_PAKE"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_IS_PAKE</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> is true.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">primitive</span></code></p>
</dt><dd><p>A primitive of type <a class="reference internal" href="#c.psa_pake_primitive_t" title="psa_pake_primitive_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_primitive_t</span></code></a> that is compatible with algorithm <code class="docutils literal notranslate"><span class="pre">alg</span></code>.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">output_step</span></code></p>
</dt><dd><p>A value of type <a class="reference internal" href="#c.psa_pake_step_t" title="psa_pake_step_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_step_t</span></code></a> that is valid for the algorithm <code class="docutils literal notranslate"><span class="pre">alg</span></code>.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns</p>
<p>A sufficient output buffer size for the specified PAKE algorithm, primitive, and output step.
An implementation can return either <code class="docutils literal notranslate"><span class="pre">0</span></code> or a correct size for a PAKE algorithm, primitive, and output step that it recognizes, but does not support.
If the parameters are not valid, the return value is unspecified.</p>
<p class="rubric">Description</p>
<p>If the size of the output buffer is at least this large, it is guaranteed that <a class="reference internal" href="#c.psa_pake_output" title="psa_pake_output"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_output()</span></code></a> will not fail due to an insufficient buffer size.
The actual size of the output might be smaller in any given call.</p>
<p>See also <a class="reference internal" href="#c.PSA_PAKE_OUTPUT_MAX_SIZE" title="PSA_PAKE_OUTPUT_MAX_SIZE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_OUTPUT_MAX_SIZE</span></code></a></p>
</section>
<section id="c.PSA_PAKE_OUTPUT_MAX_SIZE">
<h4><code class="docutils literal notranslate"><span class="pre">PSA_PAKE_OUTPUT_MAX_SIZE</span></code> (macro)<a class="headerlink" href="#c.PSA_PAKE_OUTPUT_MAX_SIZE" title="Permalink to this heading">¶</a></h4>
<p>Sufficient output buffer size for <a class="reference internal" href="#c.psa_pake_output" title="psa_pake_output"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_output()</span></code></a> for any of the supported PAKE algorithms, primitives and output steps.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_PAKE_OUTPUT_MAX_SIZE" title="PSA_PAKE_OUTPUT_MAX_SIZE">PSA_PAKE_OUTPUT_MAX_SIZE</a> <em>/* implementation-defined value */</em></pre>
<p>If the size of the output buffer is at least this large, it is guaranteed that <a class="reference internal" href="#c.psa_pake_output" title="psa_pake_output"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_output()</span></code></a> will not fail due to an insufficient buffer size.</p>
<p>See also <a class="reference internal" href="#c.PSA_PAKE_OUTPUT_SIZE" title="PSA_PAKE_OUTPUT_SIZE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_OUTPUT_SIZE()</span></code></a>.</p>
</section>
<section id="c.PSA_PAKE_INPUT_SIZE">
<h4><code class="docutils literal notranslate"><span class="pre">PSA_PAKE_INPUT_SIZE</span></code> (macro)<a class="headerlink" href="#c.PSA_PAKE_INPUT_SIZE" title="Permalink to this heading">¶</a></h4>
<p>Sufficient buffer size for inputs to <a class="reference internal" href="#c.psa_pake_input" title="psa_pake_input"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_input()</span></code></a>.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_PAKE_INPUT_SIZE" title="PSA_PAKE_INPUT_SIZE">PSA_PAKE_INPUT_SIZE</a>(alg, primitive, input_step) \
    <em>/* implementation-defined value */</em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">alg</span></code></p>
</dt><dd><p>A PAKE algorithm: a value of type <code class="docutils literal notranslate"><span class="pre">psa_algorithm_t</span></code> such that <a class="reference internal" href="#c.PSA_ALG_IS_PAKE" title="PSA_ALG_IS_PAKE"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_IS_PAKE</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> is true.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">primitive</span></code></p>
</dt><dd><p>A primitive of type <a class="reference internal" href="#c.psa_pake_primitive_t" title="psa_pake_primitive_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_primitive_t</span></code></a> that is compatible with algorithm <code class="docutils literal notranslate"><span class="pre">alg</span></code>.</p>
</dd>
<dt><p><code class="docutils literal notranslate"><span class="pre">input_step</span></code></p>
</dt><dd><p>A value of type <a class="reference internal" href="#c.psa_pake_step_t" title="psa_pake_step_t"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_step_t</span></code></a> that is valid for the algorithm <code class="docutils literal notranslate"><span class="pre">alg</span></code>.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns</p>
<p>A sufficient buffer size for the specified PAKE algorithm, primitive, and input step.
An implementation can return either <code class="docutils literal notranslate"><span class="pre">0</span></code> or a correct size for a PAKE algorithm, primitive, and output step that it recognizes, but does not support.
If the parameters are not valid, the return value is unspecified.</p>
<p class="rubric">Description</p>
<p>The value returned by this macro is guaranteed to be large enough for any valid input to <a class="reference internal" href="#c.psa_pake_input" title="psa_pake_input"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_input()</span></code></a> in an operation with the specified parameters.</p>
<p>This macro can be useful when transferring inputs from the peer into the PAKE operation.</p>
<p>See also <a class="reference internal" href="#c.PSA_PAKE_INPUT_MAX_SIZE" title="PSA_PAKE_INPUT_MAX_SIZE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_INPUT_MAX_SIZE</span></code></a></p>
</section>
<section id="c.PSA_PAKE_INPUT_MAX_SIZE">
<h4><code class="docutils literal notranslate"><span class="pre">PSA_PAKE_INPUT_MAX_SIZE</span></code> (macro)<a class="headerlink" href="#c.PSA_PAKE_INPUT_MAX_SIZE" title="Permalink to this heading">¶</a></h4>
<p>Sufficient buffer size for inputs to <a class="reference internal" href="#c.psa_pake_input" title="psa_pake_input"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_input()</span></code></a> for any of the supported PAKE algorithms, primitives and input steps.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_PAKE_INPUT_MAX_SIZE" title="PSA_PAKE_INPUT_MAX_SIZE">PSA_PAKE_INPUT_MAX_SIZE</a> <em>/* implementation-defined value */</em></pre>
<p>This macro can be useful when transferring inputs from the peer into the PAKE operation.</p>
<p>See also <a class="reference internal" href="#c.PSA_PAKE_INPUT_SIZE" title="PSA_PAKE_INPUT_SIZE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_INPUT_SIZE()</span></code></a>.</p>
</section>
</section>
</section>
<section id="the-j-pake-protocol">
<span id="pake-jpake"></span><h2><span class="section-number">2.2. </span>The J-PAKE protocol<a class="headerlink" href="#the-j-pake-protocol" title="Permalink to this heading">¶</a></h2>
<p>J-PAKE is the password-authenticated key exchange by juggling protocol, defined by <span><em>J-PAKE: Password-Authenticated Key Exchange by Juggling</em> <a class="reference internal" href="../about.html#cite-rfc8236"><span class="cite">[RFC8236]</span></a></span>.
This protocol uses the Schnorr Non-Interactive Zero-Knowledge Proof (NIZKP), as defined by <span><em>Schnorr Non-interactive Zero-Knowledge Proof</em> <a class="reference internal" href="../about.html#cite-rfc8235"><span class="cite">[RFC8235]</span></a></span>.</p>
<p>J-PAKE is a balanced PAKE, without key confirmation.</p>
<section id="j-pake-cipher-suites">
<span id="jpake-cipher-suites"></span><h3><span class="section-number">2.2.1. </span>J-PAKE cipher suites<a class="headerlink" href="#j-pake-cipher-suites" title="Permalink to this heading">¶</a></h3>
<p>When setting up a PAKE cipher suite to use the J-PAKE protocol:</p>
<ul class="simple">
<li><p>Use the <a class="reference internal" href="#c.PSA_ALG_JPAKE" title="PSA_ALG_JPAKE"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_JPAKE</span></code></a><code class="docutils literal notranslate"><span class="pre">()</span></code> algorithm, parameterized by the required hash algorithm.</p></li>
<li><p>Use a PAKE primitive for the required elliptic curve, or finite field group.</p></li>
<li><p>J-PAKE does not confirm the shared secret key that results from the key exchange.</p></li>
</ul>
<p>For example, the following code creates a cipher suite to select J-PAKE using P-256 with the SHA-256 hash function:</p>
<pre class="literal-block"><a class="reference internal" href="#c.psa_pake_cipher_suite_t" title="psa_pake_cipher_suite_t">psa_pake_cipher_suite_t</a> cipher_suite = <a class="reference internal" href="#c.PSA_PAKE_CIPHER_SUITE_INIT" title="PSA_PAKE_CIPHER_SUITE_INIT">PSA_PAKE_CIPHER_SUITE_INIT</a>;

<a class="reference internal" href="#c.psa_pake_cs_set_algorithm" title="psa_pake_cs_set_algorithm">psa_pake_cs_set_algorithm</a>(&amp;cipher_suite, <a class="reference internal" href="#c.PSA_ALG_JPAKE" title="PSA_ALG_JPAKE">PSA_ALG_JPAKE</a>(PSA_ALG_SHA_256));
<a class="reference internal" href="#c.psa_pake_cs_set_primitive" title="psa_pake_cs_set_primitive">psa_pake_cs_set_primitive</a>(&amp;cipher_suite,
                          <a class="reference internal" href="#c.PSA_PAKE_PRIMITIVE" title="PSA_PAKE_PRIMITIVE">PSA_PAKE_PRIMITIVE</a>(<a class="reference internal" href="#c.PSA_PAKE_PRIMITIVE_TYPE_ECC" title="PSA_PAKE_PRIMITIVE_TYPE_ECC">PSA_PAKE_PRIMITIVE_TYPE_ECC</a>,
                                             PSA_ECC_FAMILY_SECP_R1, 256));
<a class="reference internal" href="#c.psa_pake_cs_set_key_confirmation" title="psa_pake_cs_set_key_confirmation">psa_pake_cs_set_key_confirmation</a>(&amp;cipher_suite, <a class="reference internal" href="#c.PSA_PAKE_UNCONFIRMED_KEY" title="PSA_PAKE_UNCONFIRMED_KEY">PSA_PAKE_UNCONFIRMED_KEY</a>);</pre>
<p>More information on selecting a specific Elliptic curve or Diffie-Hellman field is provided with the <a class="reference internal" href="#c.PSA_PAKE_PRIMITIVE_TYPE_ECC" title="PSA_PAKE_PRIMITIVE_TYPE_ECC"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_PRIMITIVE_TYPE_ECC</span></code></a> and <a class="reference internal" href="#c.PSA_PAKE_PRIMITIVE_TYPE_DH" title="PSA_PAKE_PRIMITIVE_TYPE_DH"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_PRIMITIVE_TYPE_DH</span></code></a> constants.</p>
</section>
<section id="j-pake-password-processing">
<span id="jpake-passwords"></span><h3><span class="section-number">2.2.2. </span>J-PAKE password processing<a class="headerlink" href="#j-pake-password-processing" title="Permalink to this heading">¶</a></h3>
<p>The PAKE operation for J-PAKE expects a key of type type <code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_PASSWORD</span></code> or <code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_PASSWORD_HASH</span></code>.
The same key value must be provided to the PAKE operation in both participants.</p>
<p>The key can be the password text itself, in an agreed character encoding, or some value derived from the password, as required by a higher level protocol.
For low-entropy passwords, it is recommended that a key-stretching derivation algorithm, such as PBKDF2, is used, and the resulting password hash is used as the key input to the PAKE operation.</p>
</section>
<section id="j-pake-operation">
<h3><span class="section-number">2.2.3. </span>J-PAKE operation<a class="headerlink" href="#j-pake-operation" title="Permalink to this heading">¶</a></h3>
<p>The J-PAKE operation follows the protocol shown in <span><a class="reference internal" href="#fig-jpake"><span class="numref">Figure 2</span></a></span>.</p>
<figure class="align-default" id="fig-jpake">
<img alt="../_images/j-pake.svg" src="../_images/j-pake.svg" /><figcaption>
<p><span class="caption-number">Figure 2 </span><span class="caption-text">The J-PAKE protocol</span><a class="headerlink" href="#fig-jpake" title="Permalink to this image">¶</a></p>
<div class="legend">
<p>The variable names <span class="math notranslate nohighlight">\(x1\)</span>, <span class="math notranslate nohighlight">\(g1\)</span>, and so on, are taken from the finite field implementation of J-PAKE in <a class="reference internal" href="../about.html#cite-rfc8236"><span class="cite">[RFC8236]</span></a> <a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc8236.html#section-2">§2</a>.</p>
<p>Details of the computation for the key shares and zero-knowledge proofs are in <a class="reference internal" href="../about.html#cite-rfc8236"><span class="cite">[RFC8236]</span></a> and <a class="reference internal" href="../about.html#cite-rfc8235"><span class="cite">[RFC8235]</span></a>.</p>
</div>
</figcaption>
</figure>
<section id="setup">
<h4>Setup<a class="headerlink" href="#setup" title="Permalink to this heading">¶</a></h4>
<p>J-PAKE does not assign roles to the participants, so it is not necessary to call <a class="reference internal" href="#c.psa_pake_set_role" title="psa_pake_set_role"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_set_role()</span></code></a>.</p>
<p>J-PAKE requires both an application and a peer identity.
If the peer identity provided to <a class="reference internal" href="#c.psa_pake_set_peer" title="psa_pake_set_peer"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_set_peer()</span></code></a> does not match the data received from the peer, then the call to <a class="reference internal" href="#c.psa_pake_input" title="psa_pake_input"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_input()</span></code></a> for the <a class="reference internal" href="#c.PSA_PAKE_STEP_ZK_PROOF" title="PSA_PAKE_STEP_ZK_PROOF"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_STEP_ZK_PROOF</span></code></a> step will fail with <code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INVALID_SIGNATURE</span></code>.</p>
<p>The following steps demonstrate the application code for ‘User’ in <span><a class="reference internal" href="#fig-jpake"><span class="numref">Figure 2</span></a></span>. The code flow for the ‘Peer’ is the same as for ‘User’, as J-PAKE is a balanced PAKE.</p>
<ol class="arabic">
<li><p>To prepare a J-PAKE operation, initialize and set up a <a class="reference internal" href="#c.psa_pake_operation_t" title="psa_pake_operation_t"><code class="docutils literal notranslate"><span class="pre">psa_pake_operation_t</span></code></a> object by calling the following functions:</p>
<pre class="literal-block"><a class="reference internal" href="#c.psa_pake_operation_t" title="psa_pake_operation_t">psa_pake_operation_t</a> jpake = <a class="reference internal" href="#c.PSA_PAKE_OPERATION_INIT" title="PSA_PAKE_OPERATION_INIT">PSA_PAKE_OPERATION_INIT</a>;

<a class="reference internal" href="#c.psa_pake_setup" title="psa_pake_setup">psa_pake_setup</a>(&amp;jpake, pake_key, &amp;cipher_suite);
<a class="reference internal" href="#c.psa_pake_set_user" title="psa_pake_set_user">psa_pake_set_user</a>(&amp;jpake, ...);
<a class="reference internal" href="#c.psa_pake_set_peer" title="psa_pake_set_peer">psa_pake_set_peer</a>(&amp;jpake, ...);</pre>
<p>See <a class="reference internal" href="#jpake-cipher-suites"><span class="secref">J-PAKE cipher suites</span></a> and <a class="reference internal" href="#jpake-passwords"><span class="secref">J-PAKE password processing</span></a> for details on the requirements for the cipher suite and key.</p>
<p>The key material is used as an array of bytes, which is converted to an integer as described in <span><em>SEC 1: Elliptic Curve Cryptography</em> <a class="reference internal" href="../about.html#cite-sec1"><span class="cite">[SEC1]</span></a></span> §2.3.8, before reducing it modulo <span class="math notranslate nohighlight">\(q\)</span>.
Here, <span class="math notranslate nohighlight">\(q\)</span> is the order of the group defined by the cipher-suite primitive.
<a class="reference internal" href="#c.psa_pake_setup" title="psa_pake_setup"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_setup()</span></code></a> will return an error if the result of the conversion and reduction is <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p>
</li>
</ol>
</section>
<section id="key-exchange">
<h4>Key exchange<a class="headerlink" href="#key-exchange" title="Permalink to this heading">¶</a></h4>
<p>After setup, the key exchange flow for J-PAKE is as follows:</p>
<ol class="arabic" start="2">
<li><p>Round one.</p>
<p>The application can either extract the round one output values first, and then provide the round one inputs that are received from the Peer; or provide the peer inputs first, and then extract the outputs.</p>
<ul>
<li><p>To get the first round data that needs to be sent to the peer, make the following calls to <a class="reference internal" href="#c.psa_pake_output" title="psa_pake_output"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_output()</span></code></a>, in the order shown:</p>
<pre class="literal-block"><em>// Get g1</em>
<a class="reference internal" href="#c.psa_pake_output" title="psa_pake_output">psa_pake_output</a>(&amp;jpake, <a class="reference internal" href="#c.PSA_PAKE_STEP_KEY_SHARE" title="PSA_PAKE_STEP_KEY_SHARE">PSA_PAKE_STEP_KEY_SHARE</a>, ...);
<em>// Get V1, the ZKP public key for x1</em>
<a class="reference internal" href="#c.psa_pake_output" title="psa_pake_output">psa_pake_output</a>(&amp;jpake, <a class="reference internal" href="#c.PSA_PAKE_STEP_ZK_PUBLIC" title="PSA_PAKE_STEP_ZK_PUBLIC">PSA_PAKE_STEP_ZK_PUBLIC</a>, ...);
<em>// Get r1, the ZKP proof for x1</em>
<a class="reference internal" href="#c.psa_pake_output" title="psa_pake_output">psa_pake_output</a>(&amp;jpake, <a class="reference internal" href="#c.PSA_PAKE_STEP_ZK_PROOF" title="PSA_PAKE_STEP_ZK_PROOF">PSA_PAKE_STEP_ZK_PROOF</a>, ...);
<em>// Get g2</em>
<a class="reference internal" href="#c.psa_pake_output" title="psa_pake_output">psa_pake_output</a>(&amp;jpake, <a class="reference internal" href="#c.PSA_PAKE_STEP_KEY_SHARE" title="PSA_PAKE_STEP_KEY_SHARE">PSA_PAKE_STEP_KEY_SHARE</a>, ...);
<em>// Get V2, the ZKP public key for x2</em>
<a class="reference internal" href="#c.psa_pake_output" title="psa_pake_output">psa_pake_output</a>(&amp;jpake, <a class="reference internal" href="#c.PSA_PAKE_STEP_ZK_PUBLIC" title="PSA_PAKE_STEP_ZK_PUBLIC">PSA_PAKE_STEP_ZK_PUBLIC</a>, ...);
<em>// Get r2, the ZKP proof for x2</em>
<a class="reference internal" href="#c.psa_pake_output" title="psa_pake_output">psa_pake_output</a>(&amp;jpake, <a class="reference internal" href="#c.PSA_PAKE_STEP_ZK_PROOF" title="PSA_PAKE_STEP_ZK_PROOF">PSA_PAKE_STEP_ZK_PROOF</a>, ...);</pre>
</li>
<li><p>To provide the first round data received from the peer to the operation, make the following calls to <a class="reference internal" href="#c.psa_pake_input" title="psa_pake_input"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_input()</span></code></a>, in the order shown:</p>
<pre class="literal-block"><em>// Set g3</em>
<a class="reference internal" href="#c.psa_pake_input" title="psa_pake_input">psa_pake_input</a>(&amp;jpake, <a class="reference internal" href="#c.PSA_PAKE_STEP_KEY_SHARE" title="PSA_PAKE_STEP_KEY_SHARE">PSA_PAKE_STEP_KEY_SHARE</a>, ...);
<em>// Set V3, the ZKP public key for x3</em>
<a class="reference internal" href="#c.psa_pake_input" title="psa_pake_input">psa_pake_input</a>(&amp;jpake, <a class="reference internal" href="#c.PSA_PAKE_STEP_ZK_PUBLIC" title="PSA_PAKE_STEP_ZK_PUBLIC">PSA_PAKE_STEP_ZK_PUBLIC</a>, ...);
<em>// Set r3, the ZKP proof for x3</em>
<a class="reference internal" href="#c.psa_pake_input" title="psa_pake_input">psa_pake_input</a>(&amp;jpake, <a class="reference internal" href="#c.PSA_PAKE_STEP_ZK_PROOF" title="PSA_PAKE_STEP_ZK_PROOF">PSA_PAKE_STEP_ZK_PROOF</a>, ...);
<em>// Set g4</em>
<a class="reference internal" href="#c.psa_pake_input" title="psa_pake_input">psa_pake_input</a>(&amp;jpake, <a class="reference internal" href="#c.PSA_PAKE_STEP_KEY_SHARE" title="PSA_PAKE_STEP_KEY_SHARE">PSA_PAKE_STEP_KEY_SHARE</a>, ...);
<em>// Set V4, the ZKP public key for x4</em>
<a class="reference internal" href="#c.psa_pake_input" title="psa_pake_input">psa_pake_input</a>(&amp;jpake, <a class="reference internal" href="#c.PSA_PAKE_STEP_ZK_PUBLIC" title="PSA_PAKE_STEP_ZK_PUBLIC">PSA_PAKE_STEP_ZK_PUBLIC</a>, ...);
<em>// Set r4, the ZKP proof for x4</em>
<a class="reference internal" href="#c.psa_pake_input" title="psa_pake_input">psa_pake_input</a>(&amp;jpake, <a class="reference internal" href="#c.PSA_PAKE_STEP_ZK_PROOF" title="PSA_PAKE_STEP_ZK_PROOF">PSA_PAKE_STEP_ZK_PROOF</a>, ...);</pre>
</li>
</ul>
</li>
<li><p>Round two.</p>
<p>The application can either extract the round two output values first, and then provide the round two inputs that are received from the Peer; or provide the peer inputs first, and then extract the outputs.</p>
<ul>
<li><p>To get the second round data that needs to be sent to the peer, make the following calls to <a class="reference internal" href="#c.psa_pake_output" title="psa_pake_output"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_output()</span></code></a>, in the order shown:</p>
<pre class="literal-block"><em>// Get A</em>
<a class="reference internal" href="#c.psa_pake_output" title="psa_pake_output">psa_pake_output</a>(&amp;jpake, <a class="reference internal" href="#c.PSA_PAKE_STEP_KEY_SHARE" title="PSA_PAKE_STEP_KEY_SHARE">PSA_PAKE_STEP_KEY_SHARE</a>, ...);
<em>// Get V5, the ZKP public key for x2*s</em>
<a class="reference internal" href="#c.psa_pake_output" title="psa_pake_output">psa_pake_output</a>(&amp;jpake, <a class="reference internal" href="#c.PSA_PAKE_STEP_ZK_PUBLIC" title="PSA_PAKE_STEP_ZK_PUBLIC">PSA_PAKE_STEP_ZK_PUBLIC</a>, ...);
<em>// Get r5, the ZKP proof for x2*s</em>
<a class="reference internal" href="#c.psa_pake_output" title="psa_pake_output">psa_pake_output</a>(&amp;jpake, <a class="reference internal" href="#c.PSA_PAKE_STEP_ZK_PROOF" title="PSA_PAKE_STEP_ZK_PROOF">PSA_PAKE_STEP_ZK_PROOF</a>, ...);</pre>
</li>
<li><p>To provide the second round data received from the peer to the operation, make the following calls to <a class="reference internal" href="#c.psa_pake_input" title="psa_pake_input"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_input()</span></code></a>, in the order shown:</p>
<pre class="literal-block"><em>// Set B</em>
<a class="reference internal" href="#c.psa_pake_input" title="psa_pake_input">psa_pake_input</a>(&amp;jpake, <a class="reference internal" href="#c.PSA_PAKE_STEP_KEY_SHARE" title="PSA_PAKE_STEP_KEY_SHARE">PSA_PAKE_STEP_KEY_SHARE</a>, ...);
<em>// Set V6, the ZKP public key for x4*s</em>
<a class="reference internal" href="#c.psa_pake_input" title="psa_pake_input">psa_pake_input</a>(&amp;jpake, <a class="reference internal" href="#c.PSA_PAKE_STEP_ZK_PUBLIC" title="PSA_PAKE_STEP_ZK_PUBLIC">PSA_PAKE_STEP_ZK_PUBLIC</a>, ...);
<em>// Set r6, the ZKP proof for x4*s</em>
<a class="reference internal" href="#c.psa_pake_input" title="psa_pake_input">psa_pake_input</a>(&amp;jpake, <a class="reference internal" href="#c.PSA_PAKE_STEP_ZK_PROOF" title="PSA_PAKE_STEP_ZK_PROOF">PSA_PAKE_STEP_ZK_PROOF</a>, ...);</pre>
</li>
</ul>
</li>
<li><p>To use the shared secret, extract it as a key-derivation key. For example, to extract a derivation key for HKDF-SHA-256:</p>
<pre class="literal-block"><em>// Set up the key attributes</em>
psa_key_attributes_t att = PSA_KEY_ATTRIBUTES_INIT;
psa_key_set_type(&amp;att, PSA_KEY_TYPE_DERIVE);
psa_key_set_usage_flags(&amp;att, PSA_KEY_USAGE_DERIVE);
psa_key_set_algorithm(&amp;att, PSA_ALG_HKDF(PSA_ALG_SHA_256));

<em>// Get Ka=Kb=K</em>
psa_key_id_t shared_key;
<a class="reference internal" href="#c.psa_pake_get_shared_key" title="psa_pake_get_shared_key">psa_pake_get_shared_key</a>(&amp;jpake, &amp;att, &amp;shared_key);</pre>
</li>
</ol>
<p>For more information about the format of the values which are passed for each step, see <a class="reference internal" href="#pake-steps"><span class="secref">PAKE step types</span></a>.</p>
<p>If the verification of a Zero-knowledge proof provided by the peer fails, then the corresponding call to <a class="reference internal" href="#c.psa_pake_input" title="psa_pake_input"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_input()</span></code></a> for the <a class="reference internal" href="#c.PSA_PAKE_STEP_ZK_PROOF" title="PSA_PAKE_STEP_ZK_PROOF"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_STEP_ZK_PROOF</span></code></a> step will return <code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INVALID_SIGNATURE</span></code>.</p>
<p>The shared secret that is produced by J-PAKE is not suitable for use as an encryption key.
It must be used as an input to a key derivation operation to produce additional cryptographic keys.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>At the end of this sequence there is a cryptographic guarantee that only a peer that used the same password is able to compute the same key.
But there is no guarantee that the peer is the participant it claims to be, or that the peer used the same password during the exchange.</p>
<p>At this point, authentication is implicit — material encrypted or authenticated using the computed key can only be decrypted or verified by someone with the same key.
The peer is not authenticated at this point, and no action should be taken by the application which assumes that the peer is authenticated, for example, by accessing restricted resources.</p>
<p>To make the authentication explicit, there are various methods to confirm that both parties have the same key. See <a class="reference internal" href="../about.html#cite-rfc8236"><span class="cite">[RFC8236]</span></a> <a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc8236.html#section-5">§5</a> for two examples.</p>
</div>
</section>
</section>
<section id="j-pake-algorithms">
<h3><span class="section-number">2.2.4. </span>J-PAKE algorithms<a class="headerlink" href="#j-pake-algorithms" title="Permalink to this heading">¶</a></h3>
<section id="c.PSA_ALG_JPAKE">
<h4><code class="docutils literal notranslate"><span class="pre">PSA_ALG_JPAKE</span></code> (macro)<a class="headerlink" href="#c.PSA_ALG_JPAKE" title="Permalink to this heading">¶</a></h4>
<p>Macro to build the Password-authenticated key exchange by juggling (J-PAKE) algorithm.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ALG_JPAKE" title="PSA_ALG_JPAKE">PSA_ALG_JPAKE</a>(hash_alg) <em><a class="reference internal" href="../appendix/specdef_values.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">hash_alg</span></code></p>
</dt><dd><p>A hash algorithm: a value of type <code class="docutils literal notranslate"><span class="pre">psa_algorithm_t</span></code> such that <code class="docutils literal notranslate"><span class="pre">PSA_ALG_IS_HASH</span></code><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">hash_alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> is true.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns</p>
<p>A J-PAKE algorithm, parameterized by a specific hash.</p>
<p>Unspecified if <code class="docutils literal notranslate"><span class="pre">hash_alg</span></code> is not a supported hash algorithm.</p>
<p class="rubric">Description</p>
<p>This is J-PAKE as defined by <a class="reference internal" href="../about.html#cite-rfc8236"><span class="cite">[RFC8236]</span></a>, instantiated with the following parameters:</p>
<ul class="simple">
<li><p>The primitive group can be either an elliptic curve or defined over a finite field.</p></li>
<li><p>The Schnorr NIZKP, using the same group as the J-PAKE algorithm.</p></li>
<li><p>The cryptographic hash function, <code class="docutils literal notranslate"><span class="pre">hash_alg</span></code>.</p></li>
</ul>
<p>J-PAKE does not confirm the shared secret key that results from the key exchange.</p>
<p>The shared secret that is produced by J-PAKE is not suitable for use as an encryption key.
It must be used as an input to a key derivation operation to produce additional cryptographic keys.</p>
<p>See <a class="reference internal" href="#pake-jpake"><span class="secref">The J-PAKE protocol</span></a> for the J-PAKE protocol flow and how to implement it with the Crypto API.</p>
<p class="rubric">Compatible key types</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_PASSWORD</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_PASSWORD_HASH</span></code></div>
</div>
</section>
<section id="c.PSA_ALG_IS_JPAKE">
<h4><code class="docutils literal notranslate"><span class="pre">PSA_ALG_IS_JPAKE</span></code> (macro)<a class="headerlink" href="#c.PSA_ALG_IS_JPAKE" title="Permalink to this heading">¶</a></h4>
<p>Whether the specified algorithm is a J-PAKE algorithm.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ALG_IS_JPAKE" title="PSA_ALG_IS_JPAKE">PSA_ALG_IS_JPAKE</a>(alg) <em><a class="reference internal" href="../appendix/specdef_values.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">alg</span></code></p>
</dt><dd><p>An algorithm identifier: a value of type <code class="docutils literal notranslate"><span class="pre">psa_algorithm_t</span></code>.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns</p>
<p><code class="docutils literal notranslate"><span class="pre">1</span></code> if <code class="docutils literal notranslate"><span class="pre">alg</span></code> is a J-PAKE algorithm, <code class="docutils literal notranslate"><span class="pre">0</span></code> otherwise.
This macro can return either <code class="docutils literal notranslate"><span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code> if <code class="docutils literal notranslate"><span class="pre">alg</span></code> is not a supported PAKE algorithm identifier.</p>
<p class="rubric">Description</p>
<p>J-PAKE algorithms are constructed using <a class="reference internal" href="#c.PSA_ALG_JPAKE" title="PSA_ALG_JPAKE"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_JPAKE</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">hash_alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code>.</p>
</section>
</section>
</section>
<section id="the-spake2-protocol">
<span id="pake-spake2p"></span><h2><span class="section-number">2.3. </span>The SPAKE2+ protocol<a class="headerlink" href="#the-spake2-protocol" title="Permalink to this heading">¶</a></h2>
<p>SPAKE2+ is the augmented password-authenticated key exchange protocol, defined by <span><em>SPAKE2+, an Augmented Password-Authenticated Key Exchange (PAKE) Protocol</em> <a class="reference internal" href="../about.html#cite-rfc9383"><span class="cite">[RFC9383]</span></a></span>.
SPAKE2+ includes confirmation of the shared secret key that results from the key exchange.</p>
<p>SPAKE2+ is required by <span><em>Matter Specification, Version 1.2</em> <a class="reference internal" href="../about.html#cite-matter"><span class="cite">[MATTER]</span></a></span>, as MATTER_PAKE.
<a class="reference internal" href="../about.html#cite-matter"><span class="cite">[MATTER]</span></a> uses an earlier draft of the SPAKE2+ protocol, <span><em>SPAKE2+, an Augmented PAKE (Draft 02)</em> <a class="reference internal" href="../about.html#cite-spake2p-2"><span class="cite">[SPAKE2P-2]</span></a></span>.</p>
<p>Although the operation of the PAKE is similar for both of these variants, they have different key schedules for the derivation of the shared secret.</p>
<section id="spake2-cipher-suites">
<span id="spake2p-cipher-suites"></span><h3><span class="section-number">2.3.1. </span>SPAKE2+ cipher suites<a class="headerlink" href="#spake2-cipher-suites" title="Permalink to this heading">¶</a></h3>
<p>SPAKE2+ is instantiated with the following parameters:</p>
<blockquote>
<div><ul class="simple">
<li><p>An elliptic curve group.</p></li>
<li><p>A cryptographic hash function.</p></li>
<li><p>A key derivation function.</p></li>
<li><p>A keyed MAC function.</p></li>
</ul>
</div></blockquote>
<p>Valid combinations of these parameters are defined in the table of cipher suites in <a class="reference internal" href="../about.html#cite-rfc9383"><span class="cite">[RFC9383]</span></a> <a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc9383.html#section-4">§4</a>.</p>
<p>When setting up a PAKE cipher suite to use the SPAKE2+ protocol defined in <a class="reference internal" href="../about.html#cite-rfc9383"><span class="cite">[RFC9383]</span></a>:</p>
<ul class="simple">
<li><p>For cipher-suites that use HMAC for key confirmation, use the <a class="reference internal" href="#c.PSA_ALG_SPAKE2P_HMAC" title="PSA_ALG_SPAKE2P_HMAC"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_SPAKE2P_HMAC</span></code></a><code class="docutils literal notranslate"><span class="pre">()</span></code> algorithm, parameterized by the required hash algorithm.</p></li>
<li><p>For cipher-suites that use CMAC-AES-128 for key confirmation, use the <a class="reference internal" href="#c.PSA_ALG_SPAKE2P_CMAC" title="PSA_ALG_SPAKE2P_CMAC"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_SPAKE2P_CMAC</span></code></a><code class="docutils literal notranslate"><span class="pre">()</span></code> algorithm, parameterized by the required hash algorithm.</p></li>
<li><p>Use a PAKE primitive for the required elliptic curve.</p></li>
</ul>
<p>For example, the following code creates a cipher suite to select SPAKE2+ using edwards25519 with the SHA-256 hash function:</p>
<pre class="literal-block"><a class="reference internal" href="#c.psa_pake_cipher_suite_t" title="psa_pake_cipher_suite_t">psa_pake_cipher_suite_t</a> cipher_suite = <a class="reference internal" href="#c.PSA_PAKE_CIPHER_SUITE_INIT" title="PSA_PAKE_CIPHER_SUITE_INIT">PSA_PAKE_CIPHER_SUITE_INIT</a>;

<a class="reference internal" href="#c.psa_pake_cs_set_algorithm" title="psa_pake_cs_set_algorithm">psa_pake_cs_set_algorithm</a>(&amp;cipher_suite, <a class="reference internal" href="#c.PSA_ALG_SPAKE2P_HMAC" title="PSA_ALG_SPAKE2P_HMAC">PSA_ALG_SPAKE2P_HMAC</a>(PSA_ALG_SHA_256));
<a class="reference internal" href="#c.psa_pake_cs_set_primitive" title="psa_pake_cs_set_primitive">psa_pake_cs_set_primitive</a>(&amp;cipher_suite,
                          <a class="reference internal" href="#c.PSA_PAKE_PRIMITIVE" title="PSA_PAKE_PRIMITIVE">PSA_PAKE_PRIMITIVE</a>(<a class="reference internal" href="#c.PSA_PAKE_PRIMITIVE_TYPE_ECC" title="PSA_PAKE_PRIMITIVE_TYPE_ECC">PSA_PAKE_PRIMITIVE_TYPE_ECC</a>,
                                             PSA_ECC_FAMILY_TWISTED_EDWARDS, 255));</pre>
<p>When setting up a PAKE cipher suite to use the SPAKE2+ protocol used by <a class="reference internal" href="../about.html#cite-matter"><span class="cite">[MATTER]</span></a>:</p>
<ul class="simple">
<li><p>Use the <a class="reference internal" href="#c.PSA_ALG_SPAKE2P_MATTER" title="PSA_ALG_SPAKE2P_MATTER"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_SPAKE2P_MATTER</span></code></a> algorithm.</p></li>
<li><p>Use the <a class="reference internal" href="#c.PSA_PAKE_PRIMITIVE" title="PSA_PAKE_PRIMITIVE"><code class="docutils literal notranslate"><span class="pre">PSA_PAKE_PRIMITIVE</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><a class="reference internal" href="#c.PSA_PAKE_PRIMITIVE_TYPE_ECC" title="PSA_PAKE_PRIMITIVE_TYPE_ECC"><code class="docutils literal notranslate"><span class="pre">PSA_PAKE_PRIMITIVE_TYPE_ECC</span></code></a><code class="docutils literal notranslate"><span class="pre">,</span> </code><code class="docutils literal notranslate"><span class="pre">PSA_ECC_FAMILY_SECP_R1</span></code><code class="docutils literal notranslate"><span class="pre">,</span> <span class="pre">256)</span></code> PAKE primitive.</p></li>
</ul>
<p>The following code creates a cipher suite to select the <a class="reference internal" href="../about.html#cite-matter"><span class="cite">[MATTER]</span></a> variant of SPAKE2+:</p>
<pre class="literal-block"><a class="reference internal" href="#c.psa_pake_cipher_suite_t" title="psa_pake_cipher_suite_t">psa_pake_cipher_suite_t</a> cipher_suite = <a class="reference internal" href="#c.PSA_PAKE_CIPHER_SUITE_INIT" title="PSA_PAKE_CIPHER_SUITE_INIT">PSA_PAKE_CIPHER_SUITE_INIT</a>;

<a class="reference internal" href="#c.psa_pake_cs_set_algorithm" title="psa_pake_cs_set_algorithm">psa_pake_cs_set_algorithm</a>(&amp;cipher_suite, <a class="reference internal" href="#c.PSA_ALG_SPAKE2P_MATTER" title="PSA_ALG_SPAKE2P_MATTER">PSA_ALG_SPAKE2P_MATTER</a>);
<a class="reference internal" href="#c.psa_pake_cs_set_primitive" title="psa_pake_cs_set_primitive">psa_pake_cs_set_primitive</a>(&amp;cipher_suite,
                          <a class="reference internal" href="#c.PSA_PAKE_PRIMITIVE" title="PSA_PAKE_PRIMITIVE">PSA_PAKE_PRIMITIVE</a>(<a class="reference internal" href="#c.PSA_PAKE_PRIMITIVE_TYPE_ECC" title="PSA_PAKE_PRIMITIVE_TYPE_ECC">PSA_PAKE_PRIMITIVE_TYPE_ECC</a>,
                                             PSA_ECC_FAMILY_SECP_R1, 256));</pre>
</section>
<section id="spake2-registration">
<span id="spake2p-registration"></span><h3><span class="section-number">2.3.2. </span>SPAKE2+ registration<a class="headerlink" href="#spake2-registration" title="Permalink to this heading">¶</a></h3>
<p>The SPAKE2+ protocol has distinct roles for the two participants:</p>
<ul class="simple">
<li><p>The <em>Prover</em> takes the role of client.
It uses the protocol to prove that it knows the secret password, and produce a shared secret.</p></li>
<li><p>The <em>Verifier</em> takes the role of server.
It uses the protocol to verify the client’s proof, and produce a shared secret.</p></li>
</ul>
<p>The registration phase of SPAKE2+ provides the initial password processing, described in <a class="reference internal" href="../about.html#cite-rfc9383"><span class="cite">[RFC9383]</span></a> <a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc9383.html#section-3.2">§3.2</a>.
The result of registration is two pairs of values — <span class="math notranslate nohighlight">\((w0, w1)\)</span> and <span class="math notranslate nohighlight">\((w0, L)\)</span> — that need to be provided during the authentication phase to the Prover and Verifier, respectively.
The design of SPAKE2+ ensures that knowledge of <span class="math notranslate nohighlight">\((w0, L)\)</span> does not enable an attacker to determine the password, or to compute <span class="math notranslate nohighlight">\(w1\)</span>.</p>
<p>In the Crypto API, the registration output values are managed as an asymmetric key-pair:</p>
<ul class="simple">
<li><p>The Prover values, <span class="math notranslate nohighlight">\((w0, w1)\)</span>, are stored in a key of type <a class="reference internal" href="#c.PSA_KEY_TYPE_SPAKE2P_KEY_PAIR" title="PSA_KEY_TYPE_SPAKE2P_KEY_PAIR"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_SPAKE2P_KEY_PAIR()</span></code></a>.</p></li>
<li><p>The Verifier values, <span class="math notranslate nohighlight">\((w0, L)\)</span>, are stored in a key of type <a class="reference internal" href="#c.PSA_KEY_TYPE_SPAKE2P_PUBLIC_KEY" title="PSA_KEY_TYPE_SPAKE2P_PUBLIC_KEY"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_SPAKE2P_PUBLIC_KEY()</span></code></a>, or derived from the matching <a class="reference internal" href="#c.PSA_KEY_TYPE_SPAKE2P_KEY_PAIR" title="PSA_KEY_TYPE_SPAKE2P_KEY_PAIR"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_SPAKE2P_KEY_PAIR()</span></code></a>.</p></li>
</ul>
<p>The SPAKE2+ key types are parameterized by the same elliptic curve as the SPAKE2+ cipher suite.</p>
<p>The key pair is derived from the initial SPAKE2+ password prior to starting the PAKE operation.
It is recommended to use a key-stretching derivation algorithm, for example PBKDF2.
This process can take place immediately before the PAKE operation, or derived at some earlier point and stored by the participant.
Alternatively, the Verifier can be provisioned with the <a class="reference internal" href="#c.PSA_KEY_TYPE_SPAKE2P_PUBLIC_KEY" title="PSA_KEY_TYPE_SPAKE2P_PUBLIC_KEY"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_SPAKE2P_PUBLIC_KEY()</span></code></a> for the protocol, by the Prover, or some other agent.
<span><a class="reference internal" href="#fig-spake2p-reg"><span class="numref">Figure 3</span></a></span> illustrates some example SPAKE2+ key derivation flows.</p>
<p>The resulting SPAKE2+ key-pair must be protected at least as well as the password.
The public key, exported from the key pair, does not need to be kept confidential.
It is recommended that the Verifier stores only the public key, because disclosure of the public key does not enable an attacker to impersonate the Prover.</p>
<figure class="align-default" id="fig-spake2p-reg">
<img alt="../_images/spake2plus-reg.svg" src="../_images/spake2plus-reg.svg" /><figcaption>
<p><span class="caption-number">Figure 3 </span><span class="caption-text">Examples of SPAKE2+ key derivation procedures</span><a class="headerlink" href="#fig-spake2p-reg" title="Permalink to this image">¶</a></p>
<div class="legend">
<p>The variable names <span class="math notranslate nohighlight">\(w0\)</span>, <span class="math notranslate nohighlight">\(w1\)</span>, and <span class="math notranslate nohighlight">\(L\)</span> are taken from the description of SPAKE2+ in <a class="reference internal" href="../about.html#cite-rfc9383"><span class="cite">[RFC9383]</span></a>.</p>
<p>Details of the computation for the key derivation values are in <a class="reference internal" href="../about.html#cite-rfc9383"><span class="cite">[RFC9383]</span></a> <a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc9383.html#section-3.2">§3.2</a>.</p>
</div>
</figcaption>
</figure>
<p>The following steps demonstrate the derivation of a SPAKE2+ key pair using PBKDF2-HMAC-SHA256, for use with a SPAKE2+ cipher suite, <code class="docutils literal notranslate"><span class="pre">cipher_suite</span></code>. See <a class="reference internal" href="#spake2p-cipher-suites"><span class="secref">SPAKE2+ cipher suites</span></a> for an example of how to construct the cipher suite object.</p>
<ol class="arabic">
<li><p>Allocate and initialize a key derivation object:</p>
<pre class="literal-block">psa_key_derivation_operation_t pbkdf = PSA_KEY_DERIVATION_OPERATION_INIT;</pre>
</li>
<li><p>Setup the key derivation from the SPAKE2+ password, <code class="docutils literal notranslate"><span class="pre">password_key</span></code>, and parameters <code class="docutils literal notranslate"><span class="pre">pbkdf2_params</span></code>:</p>
<pre class="literal-block">psa_key_derivation_setup(&amp;pbkdf, PSA_ALG_PBKDF2_HMAC(PSA_ALG_SHA_256));
psa_key_derivation_input_key(&amp;pbkdf, PSA_KEY_DERIVATION_INPUT_PASSWORD, password_key);
psa_key_derivation_input_integer(&amp;pbkdf, PSA_KEY_DERIVATION_INPUT_COST, pbkdf2_params.cost);
psa_key_derivation_input_bytes(&amp;pbkdf, PSA_KEY_DERIVATION_INPUT_SALT,
                                       &amp;pbkdf2_params.salt, pbkdf2_params.salt_len);</pre>
</li>
<li><p>Allocate and initialize a key attributes object:</p>
<pre class="literal-block">psa_key_attributes_t att = PSA_KEY_ATTRIBUTES_INIT;</pre>
</li>
<li><p>Set the key type, size, and policy from the <code class="docutils literal notranslate"><span class="pre">cipher_suite</span></code> object:</p>
<pre class="literal-block">const <a class="reference internal" href="#c.psa_pake_primitive_t" title="psa_pake_primitive_t">psa_pake_primitive_t</a> primitive = <a class="reference internal" href="#c.psa_pake_cs_get_primitive" title="psa_pake_cs_get_primitive">psa_pake_cs_get_primitive</a>(&amp;cipher_suite);

psa_set_key_type(&amp;att,
                 <a class="reference internal" href="#c.PSA_KEY_TYPE_SPAKE2P_KEY_PAIR" title="PSA_KEY_TYPE_SPAKE2P_KEY_PAIR">PSA_KEY_TYPE_SPAKE2P_KEY_PAIR</a>(<a class="reference internal" href="#c.PSA_PAKE_PRIMITIVE_GET_FAMILY" title="PSA_PAKE_PRIMITIVE_GET_FAMILY">PSA_PAKE_PRIMITIVE_GET_FAMILY</a>(primitive)));
psa_set_key_bits(&amp;att, <a class="reference internal" href="#c.PSA_PAKE_PRIMITIVE_GET_BITS" title="PSA_PAKE_PRIMITIVE_GET_BITS">PSA_PAKE_PRIMITIVE_GET_BITS</a>(primitive));
psa_set_key_usage_flags(&amp;att, PSA_KEY_USAGE_DERIVE);
psa_set_key_algorithm(&amp;att, <a class="reference internal" href="#c.psa_pake_cs_get_algorithm" title="psa_pake_cs_get_algorithm">psa_pake_cs_get_algorithm</a>(&amp;cipher_suite));</pre>
</li>
<li><p>Derive the key:</p>
<pre class="literal-block">psa_key_id_t spake2p_key;
psa_key_derivation_output_key(&amp;att, &amp;pbkdf, &amp;spake2p_key);
psa_key_derivation_abort(&amp;pbkdf);</pre>
</li>
</ol>
<p>See <a class="reference internal" href="#spake2p-keys"><span class="secref">SPAKE2+ keys</span></a> for details of the key types, key pair derivation, and public key format.</p>
</section>
<section id="spake2-operation">
<span id="spake2p-operation"></span><h3><span class="section-number">2.3.3. </span>SPAKE2+ operation<a class="headerlink" href="#spake2-operation" title="Permalink to this heading">¶</a></h3>
<p>The SPAKE2+ operation follows the protocol shown in <span><a class="reference internal" href="#fig-spake2p"><span class="numref">Figure 4</span></a></span>.</p>
<figure class="align-default" id="fig-spake2p">
<img alt="../_images/spake2plus.svg" src="../_images/spake2plus.svg" /><figcaption>
<p><span class="caption-number">Figure 4 </span><span class="caption-text">The SPAKE2+ authentication and key confirmation protocol</span><a class="headerlink" href="#fig-spake2p" title="Permalink to this image">¶</a></p>
<div class="legend">
<p>The variable names <span class="math notranslate nohighlight">\(w0\)</span>, <span class="math notranslate nohighlight">\(w1\)</span>, <span class="math notranslate nohighlight">\(L\)</span>, and so on, are taken from the description of SPAKE2+ in <a class="reference internal" href="../about.html#cite-rfc9383"><span class="cite">[RFC9383]</span></a>.</p>
<p>Details of the computation for the key shares is in <a class="reference internal" href="../about.html#cite-rfc9383"><span class="cite">[RFC9383]</span></a> <a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc9383.html#section-3.3">§3.3</a> and confirmation values in <a class="reference internal" href="../about.html#cite-rfc9383"><span class="cite">[RFC9383]</span></a> <a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc9383.html#section-3.4">§3.4</a>.</p>
</div>
</figcaption>
</figure>
<section id="id3">
<h4>Setup<a class="headerlink" href="#id3" title="Permalink to this heading">¶</a></h4>
<p>In SPAKE2+, the Prover uses the <a class="reference internal" href="#c.PSA_PAKE_ROLE_CLIENT" title="PSA_PAKE_ROLE_CLIENT"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_ROLE_CLIENT</span></code></a> role, and the Verifier uses the <a class="reference internal" href="#c.PSA_PAKE_ROLE_SERVER" title="PSA_PAKE_ROLE_SERVER"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_ROLE_SERVER</span></code></a> role.</p>
<p>The key passed to the Prover must be a SPAKE2+ key-pair, which is derived as recommended in <a class="reference internal" href="#spake2p-registration"><span class="secref">SPAKE2+ registration</span></a>.
The key passed to the Verifier can either be a SPAKE2+ key-pair, or a SPAKE2+ public key.
A SPAKE2+ public key is imported from data that is output by calling <code class="docutils literal notranslate"><span class="pre">psa_export_public_key</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code> on a SPAKE2+ key-pair.</p>
<p>Both participants in SPAKE2+ have an optional identity.
If no identity value is provided, then a zero-length string is used for that identity in the protocol.
If the participants do not supply the same identity values to the protocol, the computed secrets will be different, and key confirmation will fail.</p>
<p>The following steps demonstrate the application code for both Prover and Verifier in <span><a class="reference internal" href="#fig-spake2p"><span class="numref">Figure 4</span></a></span>.</p>
<dl>
<dt><strong>Prover</strong></dt><dd><p>To prepare a SPAKE2+ operation for the Prover, initialize and set up a <a class="reference internal" href="#c.psa_pake_operation_t" title="psa_pake_operation_t"><code class="docutils literal notranslate"><span class="pre">psa_pake_operation_t</span></code></a> object by calling the following functions:</p>
<pre class="literal-block"><a class="reference internal" href="#c.psa_pake_operation_t" title="psa_pake_operation_t">psa_pake_operation_t</a> spake2p_p = <a class="reference internal" href="#c.PSA_PAKE_OPERATION_INIT" title="PSA_PAKE_OPERATION_INIT">PSA_PAKE_OPERATION_INIT</a>;

<a class="reference internal" href="#c.psa_pake_setup" title="psa_pake_setup">psa_pake_setup</a>(&amp;spake2p_p, pake_key_p, &amp;cipher_suite);
<a class="reference internal" href="#c.psa_pake_set_role" title="psa_pake_set_role">psa_pake_set_role</a>(&amp;spake2p_p, <a class="reference internal" href="#c.PSA_PAKE_ROLE_CLIENT" title="PSA_PAKE_ROLE_CLIENT">PSA_PAKE_ROLE_CLIENT</a>);</pre>
<p>The key <code class="docutils literal notranslate"><span class="pre">pake_key_p</span></code> is a SPAKE2+ key pair, <a class="reference internal" href="#c.PSA_KEY_TYPE_SPAKE2P_KEY_PAIR" title="PSA_KEY_TYPE_SPAKE2P_KEY_PAIR"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_SPAKE2P_KEY_PAIR()</span></code></a>.
See <a class="reference internal" href="#spake2p-cipher-suites"><span class="secref">SPAKE2+ cipher suites</span></a> for details on constructing a suitable cipher suite.</p>
</dd>
<dt><strong>Prover</strong></dt><dd><p>Provide any additional, optional, parameters:</p>
<pre class="literal-block"><a class="reference internal" href="#c.psa_pake_set_user" title="psa_pake_set_user">psa_pake_set_user</a>(&amp;spake2p_p, ...);       <em>// Prover identity</em>
<a class="reference internal" href="#c.psa_pake_set_peer" title="psa_pake_set_peer">psa_pake_set_peer</a>(&amp;spake2p_p, ...);       <em>// Verifier identity</em>
<a class="reference internal" href="#c.psa_pake_set_context" title="psa_pake_set_context">psa_pake_set_context</a>(&amp;spake2p_p, ...);</pre>
</dd>
<dt><strong>Verifier</strong></dt><dd><p>To prepare a SPAKE2+ operation for the Verifier, initialize and set up a <a class="reference internal" href="#c.psa_pake_operation_t" title="psa_pake_operation_t"><code class="docutils literal notranslate"><span class="pre">psa_pake_operation_t</span></code></a> object by calling the following functions:</p>
<pre class="literal-block"><a class="reference internal" href="#c.psa_pake_operation_t" title="psa_pake_operation_t">psa_pake_operation_t</a> spake2p_v = <a class="reference internal" href="#c.PSA_PAKE_OPERATION_INIT" title="PSA_PAKE_OPERATION_INIT">PSA_PAKE_OPERATION_INIT</a>;

<a class="reference internal" href="#c.psa_pake_setup" title="psa_pake_setup">psa_pake_setup</a>(&amp;spake2p_v, pake_key_v, &amp;cipher_suite);
<a class="reference internal" href="#c.psa_pake_set_role" title="psa_pake_set_role">psa_pake_set_role</a>(&amp;spake2p_v, <a class="reference internal" href="#c.PSA_PAKE_ROLE_SERVER" title="PSA_PAKE_ROLE_SERVER">PSA_PAKE_ROLE_SERVER</a>);</pre>
<p>The key <code class="docutils literal notranslate"><span class="pre">pake_key_v</span></code> is a SPAKE2+ key pair, <a class="reference internal" href="#c.PSA_KEY_TYPE_SPAKE2P_KEY_PAIR" title="PSA_KEY_TYPE_SPAKE2P_KEY_PAIR"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_SPAKE2P_KEY_PAIR()</span></code></a>, or public key, <a class="reference internal" href="#c.PSA_KEY_TYPE_SPAKE2P_PUBLIC_KEY" title="PSA_KEY_TYPE_SPAKE2P_PUBLIC_KEY"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_SPAKE2P_PUBLIC_KEY()</span></code></a>.
See <a class="reference internal" href="#spake2p-cipher-suites"><span class="secref">SPAKE2+ cipher suites</span></a> for details on constructing a suitable cipher suite.</p>
</dd>
<dt><strong>Verifier</strong></dt><dd><p>Provide any additional, optional, parameters:</p>
<pre class="literal-block"><a class="reference internal" href="#c.psa_pake_set_user" title="psa_pake_set_user">psa_pake_set_user</a>(&amp;spake2p_v, ...);       <em>// Verifier identity</em>
<a class="reference internal" href="#c.psa_pake_set_peer" title="psa_pake_set_peer">psa_pake_set_peer</a>(&amp;spake2p_v, ...);       <em>// Prover identity</em>
<a class="reference internal" href="#c.psa_pake_set_context" title="psa_pake_set_context">psa_pake_set_context</a>(&amp;spake2p_v, ...);</pre>
</dd>
</dl>
</section>
<section id="id4">
<h4>Key exchange<a class="headerlink" href="#id4" title="Permalink to this heading">¶</a></h4>
<p>After setup, the key exchange and confirmation flow for SPAKE2+ is as follows.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The sequence of calls for the Prover, and the sequence for the Verifier, must be in exactly this order.</p>
</div>
<dl>
<dt><strong>Prover</strong></dt><dd><p>To get the key share to send to the Verifier, call:</p>
<pre class="literal-block"><em>// Get shareP</em>
<a class="reference internal" href="#c.psa_pake_output" title="psa_pake_output">psa_pake_output</a>(&amp;spake2p_p, <a class="reference internal" href="#c.PSA_PAKE_STEP_KEY_SHARE" title="PSA_PAKE_STEP_KEY_SHARE">PSA_PAKE_STEP_KEY_SHARE</a>, ...);</pre>
</dd>
<dt><strong>Verifier</strong></dt><dd><p>To provide and validate the key share received from the Prover, call:</p>
<pre class="literal-block"><em>// Set shareP</em>
<a class="reference internal" href="#c.psa_pake_input" title="psa_pake_input">psa_pake_input</a>(&amp;spake2p_v, <a class="reference internal" href="#c.PSA_PAKE_STEP_KEY_SHARE" title="PSA_PAKE_STEP_KEY_SHARE">PSA_PAKE_STEP_KEY_SHARE</a>, ...);</pre>
</dd>
<dt><strong>Verifier</strong></dt><dd><p>To get the Verifier key share and confirmation value to send to the Prover, call:</p>
<pre class="literal-block"><em>// Get shareV</em>
<a class="reference internal" href="#c.psa_pake_output" title="psa_pake_output">psa_pake_output</a>(&amp;spake2p_v, <a class="reference internal" href="#c.PSA_PAKE_STEP_KEY_SHARE" title="PSA_PAKE_STEP_KEY_SHARE">PSA_PAKE_STEP_KEY_SHARE</a>, ...);
<em>// Get confirmV</em>
<a class="reference internal" href="#c.psa_pake_output" title="psa_pake_output">psa_pake_output</a>(&amp;spake2p_v, <a class="reference internal" href="#c.PSA_PAKE_STEP_CONFIRM" title="PSA_PAKE_STEP_CONFIRM">PSA_PAKE_STEP_CONFIRM</a>, ...);</pre>
</dd>
<dt><strong>Prover</strong></dt><dd><p>To provide and validate the key share and verify the confirmation value received from the Verifier, call:</p>
<pre class="literal-block"><em>// Set shareV</em>
<a class="reference internal" href="#c.psa_pake_input" title="psa_pake_input">psa_pake_input</a>(&amp;spake2p_p, <a class="reference internal" href="#c.PSA_PAKE_STEP_KEY_SHARE" title="PSA_PAKE_STEP_KEY_SHARE">PSA_PAKE_STEP_KEY_SHARE</a>, ...);
<em>// Set confirmV</em>
<a class="reference internal" href="#c.psa_pake_input" title="psa_pake_input">psa_pake_input</a>(&amp;spake2p_p, PSA_PAKE_STEP_KEY_CONFIRM, ...);</pre>
</dd>
<dt><strong>Prover</strong></dt><dd><p>To get the Prover key confirmation value to send to the Verifier, call:</p>
<pre class="literal-block"><em>// Get confirmP</em>
<a class="reference internal" href="#c.psa_pake_output" title="psa_pake_output">psa_pake_output</a>(&amp;spake2p_p, <a class="reference internal" href="#c.PSA_PAKE_STEP_CONFIRM" title="PSA_PAKE_STEP_CONFIRM">PSA_PAKE_STEP_CONFIRM</a>, ...);</pre>
</dd>
<dt><strong>Verifier</strong></dt><dd><p>To verify the confirmation value received from the Prover, call:</p>
<pre class="literal-block"><em>// Set confirmP</em>
<a class="reference internal" href="#c.psa_pake_input" title="psa_pake_input">psa_pake_input</a>(&amp;spake2p_v, <a class="reference internal" href="#c.PSA_PAKE_STEP_CONFIRM" title="PSA_PAKE_STEP_CONFIRM">PSA_PAKE_STEP_CONFIRM</a>, ...);</pre>
</dd>
<dt><strong>Prover</strong></dt><dd><p>To use the shared secret, extract it as a key-derivation key.
For example, to extract a derivation key for HKDF-SHA-256:</p>
<pre class="literal-block"><em>// Set up the key attributes</em>
psa_key_attributes_t att = PSA_KEY_ATTRIBUTES_INIT;
psa_key_set_type(&amp;att, PSA_KEY_TYPE_DERIVE);
psa_key_set_usage_flags(&amp;att, PSA_KEY_USAGE_DERIVE);
psa_key_set_algorithm(&amp;att, PSA_ALG_HKDF(PSA_ALG_SHA_256));

<em>// Get K_shared</em>
psa_key_id_t shared_key;
<a class="reference internal" href="#c.psa_pake_get_shared_key" title="psa_pake_get_shared_key">psa_pake_get_shared_key</a>(&amp;spake2p_p, &amp;att, &amp;shared_key);</pre>
</dd>
<dt><strong>Verifier</strong></dt><dd><p>To use the shared secret, extract it as a key-derivation key.
The same key attributes can be used as the Prover:</p>
<pre class="literal-block"><em>// Get K_shared</em>
psa_key_id_t shared_key;
<a class="reference internal" href="#c.psa_pake_get_shared_key" title="psa_pake_get_shared_key">psa_pake_get_shared_key</a>(&amp;spake2p_v, &amp;att, &amp;shared_key);</pre>
</dd>
</dl>
<p>The shared secret that is produced by SPAKE2+ is pseudorandom.
Although it can be used directly as an encryption key, it is recommended to use the shared secret as an input to a key derivation operation to produce additional cryptographic keys.</p>
<p>For more information about the format of the values which are passed for each step, see <a class="reference internal" href="#pake-steps"><span class="secref">PAKE step types</span></a>.</p>
<p>If the validation of a key share fails, then the corresponding call to <a class="reference internal" href="#c.psa_pake_input" title="psa_pake_input"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_input()</span></code></a> for the <a class="reference internal" href="#c.PSA_PAKE_STEP_KEY_SHARE" title="PSA_PAKE_STEP_KEY_SHARE"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_STEP_KEY_SHARE</span></code></a> step will return <code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INVALID_ARGUMENT</span></code>.
If the verification of a key confirmation value fails, then the corresponding call to <a class="reference internal" href="#c.psa_pake_input" title="psa_pake_input"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">psa_pake_input()</span></code></a> for the <a class="reference internal" href="#c.PSA_PAKE_STEP_CONFIRM" title="PSA_PAKE_STEP_CONFIRM"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_PAKE_STEP_CONFIRM</span></code></a> step will return <code class="docutils literal notranslate"><span class="pre">PSA_ERROR_INVALID_SIGNATURE</span></code>.</p>
</section>
</section>
<section id="spake2-keys">
<span id="spake2p-keys"></span><h3><span class="section-number">2.3.4. </span>SPAKE2+ keys<a class="headerlink" href="#spake2-keys" title="Permalink to this heading">¶</a></h3>
<section id="c.PSA_KEY_TYPE_SPAKE2P_KEY_PAIR">
<h4><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_SPAKE2P_KEY_PAIR</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_SPAKE2P_KEY_PAIR" title="Permalink to this heading">¶</a></h4>
<p>SPAKE2+ key pair: both the prover and verifier key.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_SPAKE2P_KEY_PAIR" title="PSA_KEY_TYPE_SPAKE2P_KEY_PAIR">PSA_KEY_TYPE_SPAKE2P_KEY_PAIR</a>(curve) <em><a class="reference internal" href="../appendix/specdef_values.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">curve</span></code></p>
</dt><dd><p>A value of type <code class="docutils literal notranslate"><span class="pre">psa_ecc_family_t</span></code> that identifies the Elliptic curve family to be used.</p>
</dd>
</dl>
</div>
<p class="rubric">Description</p>
<p>The bit size of a SPAKE2+ key is the size associated with the Elliptic curve group, that is, <span class="math notranslate nohighlight">\(\lceil{log_2(q)}\rceil\)</span> for a curve over a field <span class="math notranslate nohighlight">\(\mathbb{F}_q\)</span>.
See the documentation of each Elliptic curve family for details.</p>
<p>To construct a SPAKE2+ key pair, it must either be output from a key derivation operation, or imported.</p>
<p>The corresponding public key can be exported using <code class="docutils literal notranslate"><span class="pre">psa_export_public_key</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code>.
See also <a class="reference internal" href="#c.PSA_KEY_TYPE_SPAKE2P_PUBLIC_KEY" title="PSA_KEY_TYPE_SPAKE2P_PUBLIC_KEY"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_SPAKE2P_PUBLIC_KEY()</span></code></a>.</p>
<p class="rubric">Key derivation</p>
<p>A SPAKE2+ key pair can be output from a key derivation using <code class="docutils literal notranslate"><span class="pre">psa_key_derivation_output_key</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code>.
The SPAKE2+ protocol recommends that a key-stretching key-derivation function, such as PBKDF2, is used to hash the SPAKE2+ password.
See <a class="reference internal" href="../about.html#cite-rfc9383"><span class="cite">[RFC9383]</span></a> for details.</p>
<p>The key derivation process in <code class="docutils literal notranslate"><span class="pre">psa_key_derivation_output_key</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code> follows the recommendations for the registration process in <a class="reference internal" href="../about.html#cite-rfc9383"><span class="cite">[RFC9383]</span></a>, and matches the specification of this process in <a class="reference internal" href="../about.html#cite-matter"><span class="cite">[MATTER]</span></a>.</p>
<p>For the Crypto API:</p>
<ul>
<li><p>The derivation of SPAKE2+ keys extracts <span class="math notranslate nohighlight">\(\lceil{log_2(p)/8}\rceil+8\)</span> bytes from the PBKDF for each of <span class="math notranslate nohighlight">\(w0s\)</span> and <span class="math notranslate nohighlight">\(w1s\)</span>, where <span class="math notranslate nohighlight">\(p\)</span> is the prime factor of the order of the elliptic curve group.
The following sizes are used for extracting <span class="math notranslate nohighlight">\(w0s\)</span> and <span class="math notranslate nohighlight">\(w1s\)</span>, depending on the elliptic curve:</p>
<table class="colwidths-auto docutils align-left">
<thead>
<tr class="row-odd"><th class="head"><p>Elliptic curve</p></th>
<th class="head"><p>Size of <span class="math notranslate nohighlight">\(w0s\)</span> and <span class="math notranslate nohighlight">\(w1s\)</span>, in bytes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>P-256</p></td>
<td><p>40</p></td>
</tr>
<tr class="row-odd"><td><p>P-384</p></td>
<td><p>56</p></td>
</tr>
<tr class="row-even"><td><p>P-521</p></td>
<td><p>74</p></td>
</tr>
<tr class="row-odd"><td><p>edwards25519</p></td>
<td><p>40</p></td>
</tr>
<tr class="row-even"><td><p>edwards448</p></td>
<td><p>64</p></td>
</tr>
</tbody>
</table>
</li>
<li><p>The calculation of <span class="math notranslate nohighlight">\(w0\)</span>, <span class="math notranslate nohighlight">\(w1\)</span>, and <span class="math notranslate nohighlight">\(L\)</span> then proceeds as described in the RFC.</p>
<div class="admonition-implementation-note admonition">
<p class="admonition-title">Implementation note</p>
<p>The values of <span class="math notranslate nohighlight">\(w0\)</span> and <span class="math notranslate nohighlight">\(w1\)</span> are required as part of the SPAKE2+ key pair.</p>
<p>It is <a class="reference internal" href="../about.html#term-implementation-defined"><span class="scterm">implementation defined</span></a> whether <span class="math notranslate nohighlight">\(L\)</span> is computed during key derivation, and stored as part of the key pair; or only computed when required from the key pair.</p>
</div>
</li>
</ul>
<p class="rubric">Key-pair format</p>
<p>A SPAKE2+ key pair can be exported and imported.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>To create a new SPAKE2+ key pair, use <code class="docutils literal notranslate"><span class="pre">psa_key_derivation_output_key</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code> as described in <a class="reference internal" href="#spake2p-registration"><span class="secref">SPAKE2+ registration</span></a>.
This follows the recommended process described in <a class="reference internal" href="../about.html#cite-rfc9383"><span class="cite">[RFC9383]</span></a>.</p>
<p>Do not call <code class="docutils literal notranslate"><span class="pre">psa_import_key</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code> with data extracted from a key derivation operation using <code class="docutils literal notranslate"><span class="pre">psa_key_derivation_output_bytes</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code>. If the data is not considered invalid by <code class="docutils literal notranslate"><span class="pre">psa_import_key</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code>, this will result in a different, insecure key pair.</p>
</div>
<p>The key consists of the two values <span class="math notranslate nohighlight">\(w0\)</span> and <span class="math notranslate nohighlight">\(w1\)</span>, which result from the SPAKE2+ registration phase.
<span class="math notranslate nohighlight">\(w0\)</span> and <span class="math notranslate nohighlight">\(w1\)</span> are scalars in the same range as an Elliptic curve private key from the group used as the SPAKE2+ primitive group.</p>
<p>For the Crypto API, the default format for a SPAKE2+ key pair is the concatenation of the formatted values for <span class="math notranslate nohighlight">\(w0\)</span> and <span class="math notranslate nohighlight">\(w1\)</span>, using the standard formats for Elliptic curve keys used by the Crypto API.
For example, for SPAKE2+ over P-256 (secp256r1), the output from <code class="docutils literal notranslate"><span class="pre">psa_export_key</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code> would be the concatenation of:</p>
<ul class="simple">
<li><p>The P-256 private key <span class="math notranslate nohighlight">\(w0\)</span>.
This is a 32-byte big-endian encoding of the integer <span class="math notranslate nohighlight">\(w0\)</span>.</p></li>
<li><p>The P-256 private key <span class="math notranslate nohighlight">\(w1\)</span>.
This is a 32-byte big-endian encoding of the integer <span class="math notranslate nohighlight">\(w1\)</span>.</p></li>
</ul>
<p class="rubric">Compatible algorithms</p>
<div class="line-block">
<div class="line"><a class="reference internal" href="#c.PSA_ALG_SPAKE2P_HMAC" title="PSA_ALG_SPAKE2P_HMAC"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_SPAKE2P_HMAC</span></code></a></div>
<div class="line"><a class="reference internal" href="#c.PSA_ALG_SPAKE2P_CMAC" title="PSA_ALG_SPAKE2P_CMAC"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_SPAKE2P_CMAC</span></code></a></div>
<div class="line"><a class="reference internal" href="#c.PSA_ALG_SPAKE2P_MATTER" title="PSA_ALG_SPAKE2P_MATTER"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_SPAKE2P_MATTER</span></code></a></div>
</div>
</section>
<section id="c.PSA_KEY_TYPE_SPAKE2P_PUBLIC_KEY">
<h4><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_SPAKE2P_PUBLIC_KEY</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_SPAKE2P_PUBLIC_KEY" title="Permalink to this heading">¶</a></h4>
<p>SPAKE2+ public key: the verifier key.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_SPAKE2P_PUBLIC_KEY" title="PSA_KEY_TYPE_SPAKE2P_PUBLIC_KEY">PSA_KEY_TYPE_SPAKE2P_PUBLIC_KEY</a>(curve) \
    <em><a class="reference internal" href="../appendix/specdef_values.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">curve</span></code></p>
</dt><dd><p>A value of type <code class="docutils literal notranslate"><span class="pre">psa_ecc_family_t</span></code> that identifies the Elliptic curve family to be used.</p>
</dd>
</dl>
</div>
<p class="rubric">Description</p>
<p>The size of an SPAKE2+ public key is the same as the corresponding private key.
See <a class="reference internal" href="#c.PSA_KEY_TYPE_SPAKE2P_KEY_PAIR" title="PSA_KEY_TYPE_SPAKE2P_KEY_PAIR"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_SPAKE2P_KEY_PAIR()</span></code></a> and the documentation of each Elliptic curve family for details.</p>
<p>To construct a SPAKE2+ public key, it must be imported.</p>
<p class="rubric">Public key format</p>
<p>A SPAKE2+ public key can be exported and imported, to enable use cases that require offline registration.</p>
<p>The public key consists of the two values <span class="math notranslate nohighlight">\(w0\)</span> and <span class="math notranslate nohighlight">\(L\)</span>, which result from the SPAKE2+ registration phase.
<span class="math notranslate nohighlight">\(w0\)</span> is a scalar in the same range as a Elliptic curve private key from the group used as the SPAKE2+ primitive group.
<span class="math notranslate nohighlight">\(L\)</span> is a point on the curve, similar to a public key from the same group, corresponding to the <span class="math notranslate nohighlight">\(w1\)</span> value in the key pair.</p>
<p>For the Crypto API, the default format for a SPAKE2+ public key is the concatenation of the formatted values for <span class="math notranslate nohighlight">\(w0\)</span> and <span class="math notranslate nohighlight">\(L\)</span>, using the standard formats for Elliptic curve keys used by the Crypto API.
For example, for SPAKE2+ over P-256 (secp256r1), the output from <code class="docutils literal notranslate"><span class="pre">psa_export_public_key</span></code><code class="docutils literal notranslate"><span class="pre">()</span></code> would be the concatenation of:</p>
<ul class="simple">
<li><p>The P-256 private key <span class="math notranslate nohighlight">\(w0\)</span>.
This is a 32-byte big-endian encoding of the integer <span class="math notranslate nohighlight">\(w0\)</span>.</p></li>
<li><p>The P-256 public key <span class="math notranslate nohighlight">\(L\)</span>.
This is a 65-byte concatenation of:</p>
<ul>
<li><p>The byte <code class="docutils literal notranslate"><span class="pre">0x04</span></code>.</p></li>
<li><p>The 32-byte big-endian encoding of the x-coordinate of <span class="math notranslate nohighlight">\(L\)</span>.</p></li>
<li><p>The 32-byte big-endian encoding of the y-coordinate of <span class="math notranslate nohighlight">\(L\)</span>.</p></li>
</ul>
</li>
</ul>
<p class="rubric">Compatible algorithms</p>
<div class="line-block">
<div class="line"><a class="reference internal" href="#c.PSA_ALG_SPAKE2P_HMAC" title="PSA_ALG_SPAKE2P_HMAC"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_SPAKE2P_HMAC</span></code></a> (verification only)</div>
<div class="line"><a class="reference internal" href="#c.PSA_ALG_SPAKE2P_CMAC" title="PSA_ALG_SPAKE2P_CMAC"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_SPAKE2P_CMAC</span></code></a> (verification only)</div>
<div class="line"><a class="reference internal" href="#c.PSA_ALG_SPAKE2P_MATTER" title="PSA_ALG_SPAKE2P_MATTER"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_SPAKE2P_MATTER</span></code></a> (verification only)</div>
</div>
</section>
<section id="c.PSA_KEY_TYPE_IS_SPAKE2P">
<h4><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_IS_SPAKE2P</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_IS_SPAKE2P" title="Permalink to this heading">¶</a></h4>
<p>Whether a key type is a SPAKE2+ key, either a key pair or a public key.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_IS_SPAKE2P" title="PSA_KEY_TYPE_IS_SPAKE2P">PSA_KEY_TYPE_IS_SPAKE2P</a>(type) <em><a class="reference internal" href="../appendix/specdef_values.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">type</span></code></p>
</dt><dd><p>A key type: a value of type <code class="docutils literal notranslate"><span class="pre">psa_key_type_t</span></code>.</p>
</dd>
</dl>
</div>
</section>
<section id="c.PSA_KEY_TYPE_IS_SPAKE2P_KEY_PAIR">
<h4><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_IS_SPAKE2P_KEY_PAIR</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_IS_SPAKE2P_KEY_PAIR" title="Permalink to this heading">¶</a></h4>
<p>Whether a key type is a SPAKE2+ key pair.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_IS_SPAKE2P_KEY_PAIR" title="PSA_KEY_TYPE_IS_SPAKE2P_KEY_PAIR">PSA_KEY_TYPE_IS_SPAKE2P_KEY_PAIR</a>(type) \
    <em><a class="reference internal" href="../appendix/specdef_values.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">type</span></code></p>
</dt><dd><p>A key type: a value of type <code class="docutils literal notranslate"><span class="pre">psa_key_type_t</span></code>.</p>
</dd>
</dl>
</div>
</section>
<section id="c.PSA_KEY_TYPE_IS_SPAKE2P_PUBLIC_KEY">
<h4><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_IS_SPAKE2P_PUBLIC_KEY</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_IS_SPAKE2P_PUBLIC_KEY" title="Permalink to this heading">¶</a></h4>
<p>Whether a key type is a SPAKE2+ public key.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_IS_SPAKE2P_PUBLIC_KEY" title="PSA_KEY_TYPE_IS_SPAKE2P_PUBLIC_KEY">PSA_KEY_TYPE_IS_SPAKE2P_PUBLIC_KEY</a>(type) \
    <em><a class="reference internal" href="../appendix/specdef_values.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">type</span></code></p>
</dt><dd><p>A key type: a value of type <code class="docutils literal notranslate"><span class="pre">psa_key_type_t</span></code>.</p>
</dd>
</dl>
</div>
</section>
<section id="c.PSA_KEY_TYPE_SPAKE2P_GET_FAMILY">
<h4><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_SPAKE2P_GET_FAMILY</span></code> (macro)<a class="headerlink" href="#c.PSA_KEY_TYPE_SPAKE2P_GET_FAMILY" title="Permalink to this heading">¶</a></h4>
<p>Extract the curve family from a SPAKE2+ key type.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_KEY_TYPE_SPAKE2P_GET_FAMILY" title="PSA_KEY_TYPE_SPAKE2P_GET_FAMILY">PSA_KEY_TYPE_SPAKE2P_GET_FAMILY</a>(type) <em><a class="reference internal" href="../appendix/specdef_values.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">type</span></code></p>
</dt><dd><p>A SPAKE2+ key type: a value of type <code class="docutils literal notranslate"><span class="pre">psa_key_type_t</span></code> such that <a class="reference internal" href="#c.PSA_KEY_TYPE_IS_SPAKE2P" title="PSA_KEY_TYPE_IS_SPAKE2P"><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_IS_SPAKE2P</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">type</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> is true.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns: <code class="docutils literal notranslate"><span class="pre">psa_ecc_family_t</span></code></p>
<p>The elliptic curve family id, if <code class="docutils literal notranslate"><span class="pre">type</span></code> is a supported SPAKE2+ key. Unspecified if <code class="docutils literal notranslate"><span class="pre">type</span></code> is not a supported SPAKE2+ key.</p>
</section>
</section>
<section id="spake2-algorithms">
<span id="spake2p-algorithms"></span><h3><span class="section-number">2.3.5. </span>SPAKE2+ algorithms<a class="headerlink" href="#spake2-algorithms" title="Permalink to this heading">¶</a></h3>
<section id="c.PSA_ALG_SPAKE2P_HMAC">
<h4><code class="docutils literal notranslate"><span class="pre">PSA_ALG_SPAKE2P_HMAC</span></code> (macro)<a class="headerlink" href="#c.PSA_ALG_SPAKE2P_HMAC" title="Permalink to this heading">¶</a></h4>
<p>Macro to build the SPAKE2+ algorithm, using HMAC-based key confirmation.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ALG_SPAKE2P_HMAC" title="PSA_ALG_SPAKE2P_HMAC">PSA_ALG_SPAKE2P_HMAC</a>(hash_alg) <em><a class="reference internal" href="../appendix/specdef_values.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">hash_alg</span></code></p>
</dt><dd><p>A hash algorithm: a value of type <code class="docutils literal notranslate"><span class="pre">psa_algorithm_t</span></code> such that <code class="docutils literal notranslate"><span class="pre">PSA_ALG_IS_HASH</span></code><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">hash_alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> is true.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns</p>
<p>A SPAKE2+ algorithm, using HMAC for key confirmation, parameterized by a specific hash.</p>
<p>Unspecified if <code class="docutils literal notranslate"><span class="pre">hash_alg</span></code> is not a supported hash algorithm.</p>
<p class="rubric">Description</p>
<p>This is SPAKE2+, as defined by <span><em>SPAKE2+, an Augmented Password-Authenticated Key Exchange (PAKE) Protocol</em> <a class="reference internal" href="../about.html#cite-rfc9383"><span class="cite">[RFC9383]</span></a></span>, for cipher suites that use HMAC for key confirmation.
SPAKE2+ cipher suites are specified in <a class="reference internal" href="../about.html#cite-rfc9383"><span class="cite">[RFC9383]</span></a> <a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc9383.html#section-4">§4</a>.
The cipher suite’s hash algorithm is used as input to <a class="reference internal" href="#c.PSA_ALG_SPAKE2P_HMAC" title="PSA_ALG_SPAKE2P_HMAC"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_SPAKE2P_HMAC()</span></code></a>.</p>
<p>The shared secret that is produced by SPAKE2+ is pseudorandom.
Although it can be used directly as an encryption key, it is recommended to use the shared secret as an input to a key derivation operation to produce additional cryptographic keys.</p>
<p>See <a class="reference internal" href="#pake-spake2p"><span class="secref">The SPAKE2+ protocol</span></a> for the SPAKE2+ protocol flow and how to implement it with the Crypto API.</p>
<p class="rubric">Compatible key types</p>
<div class="line-block">
<div class="line"><a class="reference internal" href="#c.PSA_KEY_TYPE_SPAKE2P_KEY_PAIR" title="PSA_KEY_TYPE_SPAKE2P_KEY_PAIR"><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_SPAKE2P_KEY_PAIR</span></code></a></div>
<div class="line"><a class="reference internal" href="#c.PSA_KEY_TYPE_SPAKE2P_PUBLIC_KEY" title="PSA_KEY_TYPE_SPAKE2P_PUBLIC_KEY"><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_SPAKE2P_PUBLIC_KEY</span></code></a> (verification only)</div>
</div>
</section>
<section id="c.PSA_ALG_SPAKE2P_CMAC">
<h4><code class="docutils literal notranslate"><span class="pre">PSA_ALG_SPAKE2P_CMAC</span></code> (macro)<a class="headerlink" href="#c.PSA_ALG_SPAKE2P_CMAC" title="Permalink to this heading">¶</a></h4>
<p>Macro to build the SPAKE2+ algorithm, using CMAC-based key confirmation.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ALG_SPAKE2P_CMAC" title="PSA_ALG_SPAKE2P_CMAC">PSA_ALG_SPAKE2P_CMAC</a>(hash_alg) <em><a class="reference internal" href="../appendix/specdef_values.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">hash_alg</span></code></p>
</dt><dd><p>A hash algorithm: a value of type <code class="docutils literal notranslate"><span class="pre">psa_algorithm_t</span></code> such that <code class="docutils literal notranslate"><span class="pre">PSA_ALG_IS_HASH</span></code><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">hash_alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code> is true.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns</p>
<p>A SPAKE2+ algorithm, using CMAC for key confirmation, parameterized by a specific hash.</p>
<p>Unspecified if <code class="docutils literal notranslate"><span class="pre">hash_alg</span></code> is not a supported hash algorithm.</p>
<p class="rubric">Description</p>
<p>This is SPAKE2+, as defined by <span><em>SPAKE2+, an Augmented Password-Authenticated Key Exchange (PAKE) Protocol</em> <a class="reference internal" href="../about.html#cite-rfc9383"><span class="cite">[RFC9383]</span></a></span>, for cipher suites that use CMAC-AES-128 for key confirmation.
SPAKE2+ cipher suites are specified in <a class="reference internal" href="../about.html#cite-rfc9383"><span class="cite">[RFC9383]</span></a> <a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc9383.html#section-4">§4</a>.
The cipher suite’s hash algorithm is used as input to <a class="reference internal" href="#c.PSA_ALG_SPAKE2P_CMAC" title="PSA_ALG_SPAKE2P_CMAC"><code class="xref any atg_c atg_c-ref docutils literal notranslate"><span class="pre">PSA_ALG_SPAKE2P_CMAC()</span></code></a>.</p>
<p>The shared secret that is produced by SPAKE2+ is pseudorandom.
Although it can be used directly as an encryption key, it is recommended to use the shared secret as an input to a key derivation operation to produce additional cryptographic keys.</p>
<p>See <a class="reference internal" href="#pake-spake2p"><span class="secref">The SPAKE2+ protocol</span></a> for the SPAKE2+ protocol flow and how to implement it with the Crypto API.</p>
<p class="rubric">Compatible key types</p>
<div class="line-block">
<div class="line"><a class="reference internal" href="#c.PSA_KEY_TYPE_SPAKE2P_KEY_PAIR" title="PSA_KEY_TYPE_SPAKE2P_KEY_PAIR"><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_SPAKE2P_KEY_PAIR</span></code></a></div>
<div class="line"><a class="reference internal" href="#c.PSA_KEY_TYPE_SPAKE2P_PUBLIC_KEY" title="PSA_KEY_TYPE_SPAKE2P_PUBLIC_KEY"><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_SPAKE2P_PUBLIC_KEY</span></code></a> (verification only)</div>
</div>
</section>
<section id="c.PSA_ALG_SPAKE2P_MATTER">
<h4><code class="docutils literal notranslate"><span class="pre">PSA_ALG_SPAKE2P_MATTER</span></code> (macro)<a class="headerlink" href="#c.PSA_ALG_SPAKE2P_MATTER" title="Permalink to this heading">¶</a></h4>
<p>The SPAKE2+ algorithm, as used by the Matter v1 specification.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ALG_SPAKE2P_MATTER" title="PSA_ALG_SPAKE2P_MATTER">PSA_ALG_SPAKE2P_MATTER</a> ((psa_algoirithm_t)0x0A000609)</pre>
<p>This is the PAKE algorithm specified as MATTER_PAKE in <span><em>Matter Specification, Version 1.2</em> <a class="reference internal" href="../about.html#cite-matter"><span class="cite">[MATTER]</span></a></span>.
This is based on draft-02 of the SPAKE2+ protocol, <span><em>SPAKE2+, an Augmented PAKE (Draft 02)</em> <a class="reference internal" href="../about.html#cite-spake2p-2"><span class="cite">[SPAKE2P-2]</span></a></span>.
<a class="reference internal" href="../about.html#cite-matter"><span class="cite">[MATTER]</span></a> specifies a single SPAKE2+ cipher suite, P256-SHA256-HKDF-HMAC-SHA256.</p>
<p>The shared secret that is produced by this operation must be processed as directed by the <a class="reference internal" href="../about.html#cite-matter"><span class="cite">[MATTER]</span></a> specification.</p>
<p>This algorithm uses the same SPAKE2+ key types, key derivation, protocol flow, and the API usage described in <a class="reference internal" href="#pake-spake2p"><span class="secref">The SPAKE2+ protocol</span></a>.
However, the following aspects are different:</p>
<ul>
<li><p>The key schedule is different.
This affects the computation of the shared secret and key confirmation values.</p></li>
<li><p>The protocol inputs and outputs have been renamed between draft-02 and the final RFC, as follows:</p>
<table class="colwidths-auto docutils align-left">
<thead>
<tr class="row-odd"><th class="head"><p>RFC 9383</p></th>
<th class="head"><p>Draft-02</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>shareP</p></td>
<td><p>pA</p></td>
</tr>
<tr class="row-odd"><td><p>shareV</p></td>
<td><p>pB</p></td>
</tr>
<tr class="row-even"><td><p>confirmP</p></td>
<td><p>cA</p></td>
</tr>
<tr class="row-odd"><td><p>confirmV</p></td>
<td><p>cB</p></td>
</tr>
<tr class="row-even"><td><p>K_shared</p></td>
<td><p>Ke</p></td>
</tr>
</tbody>
</table>
</li>
</ul>
<p class="rubric">Compatible key types</p>
<div class="line-block">
<div class="line"><a class="reference internal" href="#c.PSA_KEY_TYPE_SPAKE2P_KEY_PAIR" title="PSA_KEY_TYPE_SPAKE2P_KEY_PAIR"><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_SPAKE2P_KEY_PAIR</span></code></a></div>
<div class="line"><a class="reference internal" href="#c.PSA_KEY_TYPE_SPAKE2P_PUBLIC_KEY" title="PSA_KEY_TYPE_SPAKE2P_PUBLIC_KEY"><code class="docutils literal notranslate"><span class="pre">PSA_KEY_TYPE_SPAKE2P_PUBLIC_KEY</span></code></a> (verification only)</div>
</div>
</section>
<section id="c.PSA_ALG_IS_SPAKE2P">
<h4><code class="docutils literal notranslate"><span class="pre">PSA_ALG_IS_SPAKE2P</span></code> (macro)<a class="headerlink" href="#c.PSA_ALG_IS_SPAKE2P" title="Permalink to this heading">¶</a></h4>
<p>Whether the specified algorithm is a SPAKE2+ algorithm.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ALG_IS_SPAKE2P" title="PSA_ALG_IS_SPAKE2P">PSA_ALG_IS_SPAKE2P</a>(alg) <em><a class="reference internal" href="../appendix/specdef_values.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">alg</span></code></p>
</dt><dd><p>An algorithm identifier: a value of type <code class="docutils literal notranslate"><span class="pre">psa_algorithm_t</span></code>.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns</p>
<p><code class="docutils literal notranslate"><span class="pre">1</span></code> if <code class="docutils literal notranslate"><span class="pre">alg</span></code> is a SPAKE2+ algorithm, <code class="docutils literal notranslate"><span class="pre">0</span></code> otherwise.
This macro can return either <code class="docutils literal notranslate"><span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code> if <code class="docutils literal notranslate"><span class="pre">alg</span></code> is not a supported PAKE algorithm identifier.</p>
<p class="rubric">Description</p>
<p>SPAKE2+ algorithms are constructed using <a class="reference internal" href="#c.PSA_ALG_SPAKE2P_HMAC" title="PSA_ALG_SPAKE2P_HMAC"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_SPAKE2P_HMAC</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">hash_alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code>, <a class="reference internal" href="#c.PSA_ALG_SPAKE2P_CMAC" title="PSA_ALG_SPAKE2P_CMAC"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_SPAKE2P_CMAC</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">hash_alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code>, or <a class="reference internal" href="#c.PSA_ALG_SPAKE2P_MATTER" title="PSA_ALG_SPAKE2P_MATTER"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_SPAKE2P_MATTER</span></code></a>.</p>
</section>
<section id="c.PSA_ALG_IS_SPAKE2P_HMAC">
<h4><code class="docutils literal notranslate"><span class="pre">PSA_ALG_IS_SPAKE2P_HMAC</span></code> (macro)<a class="headerlink" href="#c.PSA_ALG_IS_SPAKE2P_HMAC" title="Permalink to this heading">¶</a></h4>
<p>Whether the specified algorithm is a SPAKE2+ algorithm that uses a HMAC-based key confirmation.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ALG_IS_SPAKE2P_HMAC" title="PSA_ALG_IS_SPAKE2P_HMAC">PSA_ALG_IS_SPAKE2P_HMAC</a>(alg) <em><a class="reference internal" href="../appendix/specdef_values.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">alg</span></code></p>
</dt><dd><p>An algorithm identifier: a value of type <code class="docutils literal notranslate"><span class="pre">psa_algorithm_t</span></code>.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns</p>
<p><code class="docutils literal notranslate"><span class="pre">1</span></code> if <code class="docutils literal notranslate"><span class="pre">alg</span></code> is a SPAKE2+ algorithm that uses a HMAC-based key confirmation, <code class="docutils literal notranslate"><span class="pre">0</span></code> otherwise.
This macro can return either <code class="docutils literal notranslate"><span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code> if <code class="docutils literal notranslate"><span class="pre">alg</span></code> is not a supported PAKE algorithm identifier.</p>
<p class="rubric">Description</p>
<p>SPAKE2+ algorithms, using HMAC-based key confirmation, are constructed using <a class="reference internal" href="#c.PSA_ALG_SPAKE2P_HMAC" title="PSA_ALG_SPAKE2P_HMAC"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_SPAKE2P_HMAC</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">hash_alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code>.</p>
</section>
<section id="c.PSA_ALG_IS_SPAKE2P_CMAC">
<h4><code class="docutils literal notranslate"><span class="pre">PSA_ALG_IS_SPAKE2P_CMAC</span></code> (macro)<a class="headerlink" href="#c.PSA_ALG_IS_SPAKE2P_CMAC" title="Permalink to this heading">¶</a></h4>
<p>Whether the specified algorithm is a SPAKE2+ algorithm that uses a CMAC-based key confirmation.</p>
<pre class="literal-block">#define <a class="reference internal" href="#c.PSA_ALG_IS_SPAKE2P_CMAC" title="PSA_ALG_IS_SPAKE2P_CMAC">PSA_ALG_IS_SPAKE2P_CMAC</a>(alg) <em><a class="reference internal" href="../appendix/specdef_values.html#specification-defined-value"><span class="std std-ref">/* specification-defined value */</span></a></em></pre>
<p class="rubric">Parameters</p>
<div class="apisubitem docutils container">
<dl class="simple">
<dt><p><code class="docutils literal notranslate"><span class="pre">alg</span></code></p>
</dt><dd><p>An algorithm identifier: a value of type <code class="docutils literal notranslate"><span class="pre">psa_algorithm_t</span></code>.</p>
</dd>
</dl>
</div>
<p class="rubric">Returns</p>
<p><code class="docutils literal notranslate"><span class="pre">1</span></code> if <code class="docutils literal notranslate"><span class="pre">alg</span></code> is a SPAKE2+ algorithm that uses a CMAC-based key confirmation, <code class="docutils literal notranslate"><span class="pre">0</span></code> otherwise.
This macro can return either <code class="docutils literal notranslate"><span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code> if <code class="docutils literal notranslate"><span class="pre">alg</span></code> is not a supported PAKE algorithm identifier.</p>
<p class="rubric">Description</p>
<p>SPAKE2+ algorithms, using CMAC-based key confirmation, are constructed using <a class="reference internal" href="#c.PSA_ALG_SPAKE2P_CMAC" title="PSA_ALG_SPAKE2P_CMAC"><code class="docutils literal notranslate"><span class="pre">PSA_ALG_SPAKE2P_CMAC</span></code></a><code class="docutils literal notranslate"><span class="pre">(</span></code><code class="docutils literal notranslate"><span class="pre">hash_alg</span></code><code class="docutils literal notranslate"><span class="pre">)</span></code>.</p>
</section>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/Arm_logo_blue_RGB.svg" alt="Logo"/>
            </a></p><hr />
<h3><a href="../index.html"><b>PSA Certified<br />Crypto API</b></a></h3>
AES 0058<br/>
Non-confidential<br/>
Version 1.2 PAKE Extension.0
<hr />
<ul>
<li class="toctree-l1"><a class="reference internal" href="../about.html">About this document</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview/intro.html">1. Introduction</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">2. Password-authenticated key exchange (PAKE)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#common-api-for-pake">2.1. Common API for PAKE</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pake-algorithms">2.1.1. PAKE algorithms</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pake-primitives">2.1.2. PAKE primitives</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pake-cipher-suites">2.1.3. PAKE cipher suites</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pake-roles">2.1.4. PAKE roles</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pake-step-types">2.1.5. PAKE step types</a></li>
<li class="toctree-l3"><a class="reference internal" href="#multi-part-pake-operations">2.1.6. Multi-part PAKE operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pake-support-macros">2.1.7. PAKE support macros</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#the-j-pake-protocol">2.2. The J-PAKE protocol</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#j-pake-cipher-suites">2.2.1. J-PAKE cipher suites</a></li>
<li class="toctree-l3"><a class="reference internal" href="#j-pake-password-processing">2.2.2. J-PAKE password processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#j-pake-operation">2.2.3. J-PAKE operation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#j-pake-algorithms">2.2.4. J-PAKE algorithms</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#the-spake2-protocol">2.3. The SPAKE2+ protocol</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#spake2-cipher-suites">2.3.1. SPAKE2+ cipher suites</a></li>
<li class="toctree-l3"><a class="reference internal" href="#spake2-registration">2.3.2. SPAKE2+ registration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#spake2-operation">2.3.3. SPAKE2+ operation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#spake2-keys">2.3.4. SPAKE2+ keys</a></li>
<li class="toctree-l3"><a class="reference internal" href="#spake2-algorithms">2.3.5. SPAKE2+ algorithms</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="encodings.html">3. Algorithm and key type encoding</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../appendix/example_header.html">A. Example header file</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/specdef_values.html">B. Example macro implementations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/history.html">C. Changes to the API</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../atg_c-identifiers.html">Index of API elements</a></li>
</ul>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy; 2022-2024 Arm Limited and/or its affiliates.
      
    </div>

    

    
  </body>
</html>