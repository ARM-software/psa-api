<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="205px" preserveAspectRatio="none" style="width:736px;height:205px;background:#FFFFFF55;" version="1.1" viewBox="0 0 736 205" width="736px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" fill-opacity="0.33333" height="205" style="stroke:none;stroke-width:1;" width="736" x="0" y="0"/><rect fill="#E0E0E0" height="186.176" rx="4" ry="4" style="stroke:none;stroke-width:0.5;" width="484.453" x="246.541" y="6"/><text fill="#000000" font-family="Lato,sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="120.78" x="428.3775" y="17.844">Platform Root of Trust</text><g><title>Application</title><rect fill="#000000" fill-opacity="0.00000" height="129.976" width="8" x="37.832" y="68.2"/><line style="stroke:#808080;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="41" x2="41" y1="68.2" y2="198.176"/></g><g><title>Cryptography</title><rect fill="#000000" fill-opacity="0.00000" height="129.976" width="8" x="289.832" y="68.2"/><line style="stroke:#808080;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="293.541" x2="293.541" y1="68.2" y2="198.176"/></g><g><title>Internal Trusted</title><rect fill="#000000" fill-opacity="0.00000" height="129.976" width="8" x="673.832" y="68.2"/><line style="stroke:#808080;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="677.67" x2="677.67" y1="68.2" y2="198.176"/></g><g class="participant participant-head" data-participant="app"><rect fill="#FFFFFF" height="28.4" rx="4" ry="4" style="stroke:#000000;stroke-width:1;" width="73.664" x="5" y="38.8"/><text fill="#000000" font-family="Lato,sans-serif" font-size="12" lengthAdjust="spacing" textLength="59.664" x="12" y="57.644">Application</text></g><g class="participant participant-head" data-participant="crypto"><rect fill="#FFFFFF" height="42.8" rx="4" ry="4" style="stroke:#000000;stroke-width:1;" width="86.582" x="250.541" y="24.4"/><text fill="#000000" font-family="Lato,sans-serif" font-size="12" lengthAdjust="spacing" textLength="72.582" x="257.541" y="43.244">Cryptography</text><text fill="#000000" font-family="Lato,sans-serif" font-size="12" lengthAdjust="spacing" textLength="37.038" x="275.313" y="57.644">service</text></g><g class="participant participant-head" data-participant="trusted_storage"><rect fill="#FFFFFF" height="42.8" rx="4" ry="4" style="stroke:#000000;stroke-width:1;" width="98.324" x="628.67" y="24.4"/><text fill="#000000" font-family="Lato,sans-serif" font-size="12" lengthAdjust="spacing" textLength="84.324" x="635.67" y="43.244">Internal Trusted</text><text fill="#000000" font-family="Lato,sans-serif" font-size="12" lengthAdjust="spacing" textLength="80.634" x="637.515" y="57.644">Storage service</text></g><g class="message" data-participant-1="app" data-participant-2="crypto"><polygon fill="#000000" points="281.832,92.788,291.832,96.788,281.832,100.788" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="41.832" x2="287.832" y1="96.788" y2="96.788"/><text fill="#000000" font-family="Inconsolata,monospace" font-size="12" lengthAdjust="spacing" textLength="228" x="48.832" y="92.508">psa_import_key(key_slot, key_material)</text></g><g class="message" data-participant-1="crypto" data-participant-2="trusted_storage"><polygon fill="#000000" points="665.832,119.376,675.832,123.376,665.832,127.376" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="293.832" x2="671.832" y1="123.376" y2="123.376"/><text fill="#000000" font-family="Inconsolata,monospace" font-size="12" lengthAdjust="spacing" textLength="360" x="300.832" y="119.096">psa_its_set(partition_id&lt;&lt;32 | key_identifier, key_material)</text></g><g class="message" data-participant-1="trusted_storage" data-participant-2="crypto"><polygon fill="#000000" points="304.832,147.776,294.832,151.776,304.832,155.776" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="298.832" x2="676.832" y1="151.776" y2="151.776"/><text fill="#000000" font-family="Lato,sans-serif" font-size="12" lengthAdjust="spacing" textLength="44.388" x="310.832" y="147.22">pass/fail</text></g><g class="message" data-participant-1="crypto" data-participant-2="app"><polygon fill="#000000" points="52.832,176.176,42.832,180.176,52.832,184.176" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="46.832" x2="292.832" y1="180.176" y2="180.176"/><text fill="#000000" font-family="Lato,sans-serif" font-size="12" lengthAdjust="spacing" textLength="44.388" x="58.832" y="175.62">pass/fail</text></g></g></svg>