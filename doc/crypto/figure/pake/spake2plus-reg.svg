<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="497px" preserveAspectRatio="none" style="width:804px;height:497px;background:#FFFFFF55;" version="1.1" viewBox="0 0 804 497" width="804px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" fill-opacity="0.33333" height="497" style="stroke:none;stroke-width:1;" width="804" x="0" y="0"/><rect fill="#FFFFFF" fill-opacity="0.50196" height="247.152" rx="4" ry="4" style="stroke:#808080;stroke-width:1;" width="788.992" x="9" y="191.964"/><path d="M9,314.528 L797.992,314.528 L797.992,435.116 A4,4 0 0 1 793.992,439.116 L13,439.116 A4,4 0 0 1 9,435.116 L9,314.528" fill="#FFFFFF" fill-opacity="0.50196" style="stroke:none;stroke-width:1;"/><g><title>Prover  //(Client role)//</title><rect fill="#000000" fill-opacity="0.00000" height="456.116" width="8" x="197.081" y="34.4"/><line style="stroke:#808080;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="200.827" x2="200.827" y1="34.4" y2="490.516"/></g><g><title>Verifier  //(Server role)//</title><rect fill="#000000" fill-opacity="0.00000" height="456.116" width="8" x="493.081" y="34.4"/><line style="stroke:#808080;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="496.602" x2="496.602" y1="34.4" y2="490.516"/></g><g class="participant participant-head" data-participant="Prover"><rect fill="#FFFFFF" height="28.4" rx="4" ry="4" style="stroke:#000000;stroke-width:1;" width="112.508" x="144.827" y="5"/><text fill="#000000" font-family="Lato,sans-serif" font-size="12" lengthAdjust="spacing" textLength="35.274" x="151.827" y="23.844">Prover</text><text fill="#000000" font-family="Lato,sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="57.09" x="193.245" y="23.844">(Client role)</text></g><g class="participant participant-head" data-participant="Verifier"><rect fill="#FFFFFF" height="28.4" rx="4" ry="4" style="stroke:#000000;stroke-width:1;" width="118.958" x="437.602" y="5"/><text fill="#000000" font-family="Lato,sans-serif" font-size="12" lengthAdjust="spacing" textLength="39.498" x="444.602" y="23.844">Verifier</text><text fill="#000000" font-family="Lato,sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="59.316" x="490.244" y="23.844">(Server role)</text></g><path d="M145,53.4 L145,69.4 A4,4 0 0 0 149,73.4 L547,73.4 A4,4 0 0 0 551,69.4 L551,59.4 L541,49.4 L149,49.4 A4,4 0 0 0 145,53.4" fill="#E8E8E8" style="stroke:#7D868C;stroke-width:1;"/><path d="M541,49.4 L541,57.4 A2,2 0 0 0 543,59.4 L551,59.4 L541,49.4" fill="#E8E8E8" style="stroke:#7D868C;stroke-width:1;"/><text fill="#000000" font-family="Lato,sans-serif" font-size="12" lengthAdjust="spacing" textLength="166.536" x="193.7495" y="66.244">Initial information : cipher suite,</text><text fill="#000000" font-family="Lato,sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="77.4" x="363.3575" y="66.244">PBKDF-params</text><text fill="#000000" font-family="Lato,sans-serif" font-size="12" lengthAdjust="spacing" textLength="2.724" x="440.7575" y="66.244">,</text><text fill="#000000" font-family="Lato,sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="47.43" x="446.5535" y="66.244">password</text><g class="message" data-participant-1="Prover" data-participant-2="Prover"><line style="stroke:#000000;stroke-width:1;" x1="201.081" x2="243.081" y1="124.376" y2="124.376"/><line style="stroke:#000000;stroke-width:1;" x1="243.081" x2="243.081" y1="124.376" y2="137.376"/><line style="stroke:#000000;stroke-width:1;" x1="202.081" x2="243.081" y1="137.376" y2="137.376"/><polygon fill="#000000" points="212.081,133.376,202.081,137.376,212.081,141.376" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Inconsolata,monospace" font-size="12" lengthAdjust="spacing" textLength="186" x="208.081" y="93.108">psa_key_derivation_setup(PBKDF)</text><text fill="#000000" font-family="Inconsolata,monospace" font-size="12" lengthAdjust="spacing" textLength="228" x="208.081" y="105.696">psa_key_derivation_input_key(password)</text><text fill="#000000" font-family="Inconsolata,monospace" font-size="12" lengthAdjust="spacing" textLength="180" x="208.081" y="120.096">psa_key_derivation_input_xxx()</text><text fill="#000000" font-family="Lato,sans-serif" font-size="12" lengthAdjust="spacing" textLength="15.378" x="391.153" y="119.82">for</text><text fill="#000000" font-family="Lato,sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="77.4" x="409.603" y="119.82">PBKDF-params</text></g><g class="message" data-participant-1="Prover" data-participant-2="Prover"><line style="stroke:#000000;stroke-width:1;" x1="201.081" x2="243.081" y1="163.964" y2="163.964"/><line style="stroke:#000000;stroke-width:1;" x1="243.081" x2="243.081" y1="163.964" y2="176.964"/><line style="stroke:#000000;stroke-width:1;" x1="202.081" x2="243.081" y1="176.964" y2="176.964"/><polygon fill="#000000" points="212.081,172.964,202.081,176.964,212.081,180.964" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Inconsolata,monospace" font-size="12" lengthAdjust="spacing" textLength="282" x="208.081" y="159.684">psa_key_derivation_output_key(SPAKE2P_KEY_PAIR)</text></g><path d="M35,156.97 L35,172.97 A4,4 0 0 0 39,176.97 L191,176.97 A4,4 0 0 0 195,172.97 L195,162.97 L185,152.97 L39,152.97 A4,4 0 0 0 35,156.97" fill="#E8E8E8" style="stroke:#7D868C;stroke-width:1;"/><path d="M185,152.97 L185,160.97 A2,2 0 0 0 187,162.97 L195,162.97 L185,152.97" fill="#E8E8E8" style="stroke:#7D868C;stroke-width:1;"/><text fill="#000000" font-family="Lato,sans-serif" font-size="12" lengthAdjust="spacing" textLength="99.72" x="41" y="169.814">Compute key pair (</text><text fill="#000000" font-family="Lato,sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="15.636" x="140.72" y="169.814">w0</text><text fill="#000000" font-family="Lato,sans-serif" font-size="12" lengthAdjust="spacing" textLength="2.724" x="156.356" y="169.814">,</text><text fill="#000000" font-family="Lato,sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="15.636" x="162.152" y="169.814">w1</text><text fill="#000000" font-family="Lato,sans-serif" font-size="12" lengthAdjust="spacing" textLength="3.204" x="177.788" y="169.814">)</text><path d="M13,191.964 L67.098,191.964 L67.098,198.364 L57.098,208.364 L9,208.364 L9,195.964 A4,4 0 0 1 13,191.964" fill="#F0F0F0" style="stroke:#808080;stroke-width:1.5;"/><rect fill="none" height="247.152" rx="4" ry="4" style="stroke:#808080;stroke-width:1;" width="788.992" x="9" y="191.964"/><text fill="#000000" font-family="Lato,sans-serif" font-size="12" lengthAdjust="spacing" textLength="13.098" x="24" y="204.808">alt</text><text fill="#000000" font-family="Lato,sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="128.491" x="82.098" y="204.821">[Independent registration]</text><g class="message" data-participant-1="Verifier" data-participant-2="Verifier"><line style="stroke:#000000;stroke-width:1;" x1="497.081" x2="539.081" y1="253.94" y2="253.94"/><line style="stroke:#000000;stroke-width:1;" x1="539.081" x2="539.081" y1="253.94" y2="266.94"/><line style="stroke:#000000;stroke-width:1;" x1="498.081" x2="539.081" y1="266.94" y2="266.94"/><polygon fill="#000000" points="508.081,262.94,498.081,266.94,508.081,270.94" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Inconsolata,monospace" font-size="12" lengthAdjust="spacing" textLength="186" x="504.081" y="222.672">psa_key_derivation_setup(PBKDF)</text><text fill="#000000" font-family="Inconsolata,monospace" font-size="12" lengthAdjust="spacing" textLength="228" x="504.081" y="235.26">psa_key_derivation_input_key(password)</text><text fill="#000000" font-family="Inconsolata,monospace" font-size="12" lengthAdjust="spacing" textLength="180" x="504.081" y="249.66">psa_key_derivation_input_xxx()</text><text fill="#000000" font-family="Lato,sans-serif" font-size="12" lengthAdjust="spacing" textLength="15.378" x="687.153" y="249.384">for</text><text fill="#000000" font-family="Lato,sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="77.4" x="705.603" y="249.384">PBKDF-params</text></g><g class="message" data-participant-1="Verifier" data-participant-2="Verifier"><line style="stroke:#000000;stroke-width:1;" x1="497.081" x2="539.081" y1="293.528" y2="293.528"/><line style="stroke:#000000;stroke-width:1;" x1="539.081" x2="539.081" y1="293.528" y2="306.528"/><line style="stroke:#000000;stroke-width:1;" x1="498.081" x2="539.081" y1="306.528" y2="306.528"/><polygon fill="#000000" points="508.081,302.528,498.081,306.528,508.081,310.528" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Inconsolata,monospace" font-size="12" lengthAdjust="spacing" textLength="282" x="504.081" y="289.248">psa_key_derivation_output_key(SPAKE2P_KEY_PAIR)</text></g><path d="M331,286.534 L331,302.534 A4,4 0 0 0 335,306.534 L487,306.534 A4,4 0 0 0 491,302.534 L491,292.534 L481,282.534 L335,282.534 A4,4 0 0 0 331,286.534" fill="#E8E8E8" style="stroke:#7D868C;stroke-width:1;"/><path d="M481,282.534 L481,290.534 A2,2 0 0 0 483,292.534 L491,292.534 L481,282.534" fill="#E8E8E8" style="stroke:#7D868C;stroke-width:1;"/><text fill="#000000" font-family="Lato,sans-serif" font-size="12" lengthAdjust="spacing" textLength="99.72" x="337" y="299.378">Compute key pair (</text><text fill="#000000" font-family="Lato,sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="15.636" x="436.72" y="299.378">w0</text><text fill="#000000" font-family="Lato,sans-serif" font-size="12" lengthAdjust="spacing" textLength="2.724" x="452.356" y="299.378">,</text><text fill="#000000" font-family="Lato,sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="15.636" x="458.152" y="299.378">w1</text><text fill="#000000" font-family="Lato,sans-serif" font-size="12" lengthAdjust="spacing" textLength="3.204" x="473.788" y="299.378">)</text><line style="stroke:#808080;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="9" x2="797.992" y1="315.528" y2="315.528"/><text fill="#000000" font-family="Lato,sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="119.559" x="14" y="326.385">[Connected registration]</text><g class="message" data-participant-1="Prover" data-participant-2="Prover"><line style="stroke:#000000;stroke-width:1;" x1="201.081" x2="243.081" y1="348.316" y2="348.316"/><line style="stroke:#000000;stroke-width:1;" x1="243.081" x2="243.081" y1="348.316" y2="361.316"/><line style="stroke:#000000;stroke-width:1;" x1="202.081" x2="243.081" y1="361.316" y2="361.316"/><polygon fill="#000000" points="212.081,357.316,202.081,361.316,212.081,365.316" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Inconsolata,monospace" font-size="12" lengthAdjust="spacing" textLength="138" x="208.081" y="344.036">psa_export_public_key()</text></g><path d="M19,341.322 L19,357.322 A4,4 0 0 0 23,361.322 L191,361.322 A4,4 0 0 0 195,357.322 L195,347.322 L185,337.322 L23,337.322 A4,4 0 0 0 19,341.322" fill="#E8E8E8" style="stroke:#7D868C;stroke-width:1;"/><path d="M185,337.322 L185,345.322 A2,2 0 0 0 187,347.322 L195,347.322 L185,337.322" fill="#E8E8E8" style="stroke:#7D868C;stroke-width:1;"/><text fill="#000000" font-family="Lato,sans-serif" font-size="12" lengthAdjust="spacing" textLength="48.744" x="25" y="354.166">Compute</text><text fill="#000000" font-family="Lato,sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="5.706" x="76.816" y="354.166">L</text><text fill="#000000" font-family="Lato,sans-serif" font-size="12" lengthAdjust="spacing" textLength="57.966" x="85.594" y="354.166">and output</text><text fill="#000000" font-family="Lato,sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="15.636" x="146.632" y="354.166">w0</text><text fill="#000000" font-family="Lato,sans-serif" font-size="12" lengthAdjust="spacing" textLength="6.012" x="165.34" y="354.166">||</text><text fill="#000000" font-family="Lato,sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="5.706" x="174.424" y="354.166">L</text><g class="message" data-participant-1="Prover" data-participant-2="Verifier"><line style="stroke:#000000;stroke-width:1;" x1="495.081" x2="485.081" y1="389.716" y2="385.716"/><line style="stroke:#000000;stroke-width:1;" x1="495.081" x2="485.081" y1="389.716" y2="393.716"/><line style="stroke:#000000;stroke-width:1;" x1="201.081" x2="496.081" y1="389.716" y2="389.716"/><text fill="#000000" font-family="Lato,sans-serif" font-size="12" lengthAdjust="spacing" textLength="107.16" x="208.081" y="385.16">Registration record (</text><text fill="#000000" font-family="Lato,sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="15.636" x="318.313" y="385.16">w0</text><text fill="#000000" font-family="Lato,sans-serif" font-size="12" lengthAdjust="spacing" textLength="6.012" x="337.021" y="385.16">||</text><text fill="#000000" font-family="Lato,sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="5.706" x="346.105" y="385.16">L</text><text fill="#000000" font-family="Lato,sans-serif" font-size="12" lengthAdjust="spacing" textLength="3.204" x="354.883" y="385.16">)</text></g><g class="message" data-participant-1="Verifier" data-participant-2="Verifier"><line style="stroke:#000000;stroke-width:1;" x1="497.081" x2="539.081" y1="418.116" y2="418.116"/><line style="stroke:#000000;stroke-width:1;" x1="539.081" x2="539.081" y1="418.116" y2="431.116"/><line style="stroke:#000000;stroke-width:1;" x1="498.081" x2="539.081" y1="431.116" y2="431.116"/><polygon fill="#000000" points="508.081,427.116,498.081,431.116,508.081,435.116" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Inconsolata,monospace" font-size="12" lengthAdjust="spacing" textLength="204" x="504.081" y="413.836">psa_import_key(SPAKE2P_PUBLIC_KEY)</text><text fill="#000000" font-family="Lato,sans-serif" font-size="12" lengthAdjust="spacing" textLength="25.248" x="711.153" y="413.56">from</text><text fill="#000000" font-family="Lato,sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="15.636" x="739.473" y="413.56">w0</text><text fill="#000000" font-family="Lato,sans-serif" font-size="12" lengthAdjust="spacing" textLength="6.012" x="758.181" y="413.56">||</text><text fill="#000000" font-family="Lato,sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="5.706" x="767.265" y="413.56">L</text></g><path d="M342,410.216 L342,426.216 A4,4 0 0 0 346,430.216 L487,430.216 A4,4 0 0 0 491,426.216 L491,416.216 L481,406.216 L346,406.216 A4,4 0 0 0 342,410.216" fill="#E8E8E8" style="stroke:#7D868C;stroke-width:1;"/><path d="M481,406.216 L481,414.216 A2,2 0 0 0 483,416.216 L491,416.216 L481,406.216" fill="#E8E8E8" style="stroke:#7D868C;stroke-width:1;"/><text fill="#000000" font-family="Lato,sans-serif" font-size="12" lengthAdjust="spacing" textLength="98.046" x="348" y="423.06">Import public key (</text><text fill="#000000" font-family="Lato,sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="15.636" x="446.046" y="423.06">w0</text><text fill="#000000" font-family="Lato,sans-serif" font-size="12" lengthAdjust="spacing" textLength="2.724" x="461.682" y="423.06">,</text><text fill="#000000" font-family="Lato,sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="5.706" x="467.478" y="423.06">L</text><text fill="#000000" font-family="Lato,sans-serif" font-size="12" lengthAdjust="spacing" textLength="3.204" x="473.184" y="423.06">)</text><path d="M96,455.116 L96,471.116 A4,4 0 0 0 100,475.116 L302,475.116 A4,4 0 0 0 306,471.116 L306,461.116 L296,451.116 L100,451.116 A4,4 0 0 0 96,455.116" fill="#E8E8E8" style="stroke:#7D868C;stroke-width:1;"/><path d="M296,451.116 L296,459.116 A2,2 0 0 0 298,461.116 L306,461.116 L296,451.116" fill="#E8E8E8" style="stroke:#7D868C;stroke-width:1;"/><text fill="#000000" font-family="Lato,sans-serif" font-size="12" lengthAdjust="spacing" textLength="189.162" x="102" y="467.96">Use key pair for authentication flow</text><path d="M403,455.116 L403,471.116 A4,4 0 0 0 407,475.116 L586,475.116 A4,4 0 0 0 590,471.116 L590,461.116 L580,451.116 L407,451.116 A4,4 0 0 0 403,455.116" fill="#E8E8E8" style="stroke:#7D868C;stroke-width:1;"/><path d="M580,451.116 L580,459.116 A2,2 0 0 0 582,461.116 L590,461.116 L580,451.116" fill="#E8E8E8" style="stroke:#7D868C;stroke-width:1;"/><text fill="#000000" font-family="Lato,sans-serif" font-size="12" lengthAdjust="spacing" textLength="166.152" x="409" y="467.96">Use key for authentication flow</text></g></svg>